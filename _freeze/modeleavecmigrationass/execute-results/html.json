{
  "hash": "6bbd53773e71a3c16357f9064e86711e",
  "result": {
    "markdown": "---\ntitle: Modèle logistique structuré avec migration assymétrique\n---\n\n*Modules à importer :*\n\n\n\n## Définition du modèle\n\nLe but d'un augmentorium est de confiner les ravageurs dans un espace clos qui ne laisse pas (ou peu) s'échapper ceux-ci.  \nAinsi, il s'établit une migration assymétrique entre les deux structures qu'on peut modéliser en établissant le modèle suivant d'après @arditi2018 : \n\n$$ \n\\left\\{\\begin{array}{l}\n\\dot x = r_xx(1-\\frac{x}{K_x})+\\beta\\left(\\frac{y}{\\gamma_y}-\\frac{x}{\\gamma_x}\\right)\\\\\n\\dot y = r_yy(1-\\frac{y}{K_y})+\\beta\\left(\\frac{x}{\\gamma_x}-\\frac{y}{\\gamma_y}\\right)\n\\end{array}\\right.\n$$ {#eq-modamig}\n\navec :  \n- $x$ la population de ravageurs dans la culture,  \n- $y$ la population de ravageurs dans l'augmentorium,  \n- $r_x$ et $r_y$ le taux de croissance dans la culture et dans l'augmentorium,  \n- $K_x$ et $K_y$ les capacités de charges de la culture de de l'augmentorium,  \n- $\\beta$ la force de migration entre les structures,  \n- $\\gamma_x$ et $\\gamma_y$ caractérisant l'assymétrie de  migration.\n\n### Nouvelles hypothèses\n\nEn plus des hypothèses faites [avant](modelesansmigrationass.qmd) on peut aussi dire que le taux de fuite des ravageurs ($\\frac{1}{\\gamma_y}$) se doit d'être beaucoup plus petit que le taux de migration ($\\frac{1}{\\gamma_x}$).  \nOn a donc $\\gamma_x << \\gamma_y$.\n\n## Dynamique du modèle\n\nEncore une fois on simule la dynamique des deux populations en fonction du temps en codant comme dans la première partie\n\nOn définit le système sous [Python](https://www.python.org/):\n\n\n\nEt on définit les paramètres, le temps d'intégration etc. :\n\n\n\nOn trace la figure :\n\n::: {.cell execution_count=4}\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\nText(0, 0.5, 'Densité de pop.')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](modeleavecmigrationass_files/figure-html/cell-5-output-2.png){width=598 height=477}\n:::\n:::\n\n\nCette dynamique, comme en première partie, présente un équilibre de maintien de la population.  \nNéanmoins on observe que, pour les mêmes paramètres que dans la première partie, la population dans la culture est bien plus faible.    \nLa migration assymétrique vers l'augmentorium semble être bénéfique à la culture.\n\n## Plan de phase \n\n### Equilibres et leur stabilité \n\nA l'équilibre on a le système suivant :\n\n$$ \n\\left\\{\\begin{array}{l}\n\\dot x = 0 \\Leftrightarrow  y^*=\\gamma_y\\left(\\frac{x}{\\gamma_x}-\\frac{r_xx}{\\beta}\\left(1-\\frac{x}{K_x}\\right)\\right)\\\\\n\\dot y =0 \\Leftrightarrow   x^*=\\gamma_x\\left(\\frac{y}{\\gamma_y}-\\frac{r_yy}{\\beta}\\left(1-\\frac{y}{K_y}\\right)\\right)\n\\end{array}\\right.\n$${#eq-pdpamig}\n\nOn voit tout de suite qu'on a deux paraboles qui se croisent en $(0,0)$ et en $(x^*,y^*)$.  \nOn va donc avoir deux équilibres, ceux ci vivent sur une ellipse de même équation qu'en première partie.   \nEn effet on peut voir que cette ellipse ne dépend d'aucun des paramètres de migration.  \nEn fonction des racines des paraboles on va avoir des plans de phases différents qu'on va tracer via les mêmes techniques qu'en première partie :\n\n::: {.cell execution_count=5}\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n<matplotlib.legend.Legend at 0x7f2018c4c700>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](modeleavecmigrationass_files/figure-html/cell-6-output-2.png){width=740 height=396}\n:::\n:::\n\n\nEn fonction des valeurs de $\\beta$ on observe des profils différents de plan de phase. Pour mieux le visualiser on pourra utiliser l'animation [Geogebra](https://www.geogebra.org/) mise à disposition à la fin de l'analyse.\n\nD'après le champ de vecteurs on voit clairement que l'équilibre en $(0,0)$ est instable et l'équilibre $(x^*,y^*)$. est stable.  \n\nPour calculer l'équilibre on procède de la même manière que dans la première partie, c'est à dire le croisement des deux paraboles qui s'obtient en résolvant le polynôme suivant : \n\n$$\n\\frac{r_xr_y\\gamma_x\\gamma_y}{\\beta}-\\gamma_yr_y-\\gamma_xr_x +\\\\ y\\left[\\frac{r_y\\gamma_y}{K_y}-\\frac{r_xr_y\\gamma_x\\gamma_y}{\\beta K_y}+ \\frac{r_xr_y^2\\gamma_x^2\\gamma_y}{\\beta^2K_x}+\\frac{r_x\\gamma_x^2}{\\gamma_yK_x}-\\frac{2r_xr_y\\gamma_x^2}{\\beta K_x}   \\right] +\\\\[.2cm]\n\\frac{2r_yr_x\\gamma_xy^2}{\\beta K_xK_y}\\left(1-\\frac{r_y\\gamma_y}{\\beta}\\right) + \\frac{r_xr_y^2\\gamma_x^2\\gamma_yy^3}{\\beta^2K_xK_y^2} = 0\n$${#eq-pol}\n\nCe polynôme est résoluble par `numpy` similairement à la première partie :\n\n\n\n### Analyse du plan de phase\n\nOn va tracer le plan de phase complet et l'analyser.  \nPour cela on trace l'ellipse de la même manière que dans la première figure.  \nEnsuite on va tracer la droite correspondant à $K_x+K_y=x^*+y^*$. Ceci va permettre de voir si le système subit une [inflation](contexte.qmd) ou une déflation.  \nEnfin on trace la parabole donnée par $\\dot x =0$ pour $\\beta = 0$ et $\\beta = \\infty$.\n\n::: {.cell execution_count=7}\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\n<matplotlib.legend.Legend at 0x7f2019870a60>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](modeleavecmigrationass_files/figure-html/cell-8-output-2.png){width=688 height=480}\n:::\n:::\n\n\nSi $r_x<r_y$, alors d'après @arditi2018 :\n\n---\n\n- Si on note $A$ l'intersection entre la parabole en $0$ et l'ellipse et $B$ l'intersection entre la parabole en $0$ et en $+\\infty$ alors pour que $x^* < K_x$ (ce que l'on veut) il faut que la coordonnée en $y$ de $B$ soit supérieur à celle de $A$.\n\n    Le point $A$ est défini par :\n    $A=(K_x,K_y)$\n\n    Le point $B$ est défini par :\n    $B=\\left(K_x,\\frac{\\gamma_yK_x}{\\gamma_x}\\right)$\n\nAutrement dit, **si** $\\frac{\\gamma_y}{\\gamma_x}>\\frac{K_y}{K_x}$ alors on a toujours l'augmentorium qui est efficace, ie le système est déflationiste quelque soit le taux de migration $\\beta$.\n  \n  \n---   \n\n- Si on note $C$ l'intersection entre l'ellipse et la parabole en $+\\infty$ on a alors la valeur de l'équilibre en $\\beta =+\\infty$.\n  \n    Le point $C$ est défini par :\n    $C=\\left(\\frac{\\left(\\frac{\\gamma_x}{\\gamma_y}\\right)r_x + r_y}{\\left(\\frac{\\gamma_x}{\\gamma_y}\\right)\\frac{r_x}{K_x}+\\left(\\frac{\\gamma_y}{\\gamma_x}\\right)\\frac{r_y}{K_y}} , \\frac{\\left(\\frac{\\gamma_y}{\\gamma_x}\\right)r_y + r_x}{\\left(\\frac{\\gamma_x}{\\gamma_y}\\right)\\frac{r_x}{K_x}+\\left(\\frac{\\gamma_y}{\\gamma_x}\\right)\\frac{r_y}{K_y}} \\right)$\n  \n    Maintenant notons $D$ la valeur de l'intersection entre le droite des capacités et l'ellipse.\n  \n    Le point $D$ est défini par :\n    $D=\\left(\\frac{r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x} , \\frac{r_xK_y(K_x+K_y)}{r_xKy+r_yK_x}\\right)$  \n  \n    Ainsi, quand $\\beta$ augmente le point d'équilibre se déplace entre $A$ et $C$. On voit donc que l'équilibre peut soit être tout le temps déflationiste si $C$ est avant $A$ (point précédent) sur l'ellipse soit être constamment inflationiste si $C$ est entre $A$ et $D$ soit être les deux si $C$ est après $D$.\n  \n    Voyons ceci en terme de coefficient de droite, on a alors les exactes mêmes conditions mais sur les pentes des droites passant par ces points, qu'on peut calculer.\n    On a déja par le premier point la condition sur les paramètres pour avoir le système déflationiste.\n  \n**Si** $\\frac{\\gamma_y}{\\gamma_x} < \\frac{r_xK_y}{r_yK_x}$ alors on a des équilibres à la fois inflationiste et déflationiste. En effet ceci traduit que C est après D, graphiquement on voit que l'équilibre est au début au dessus de la droite cyan et à la fin en dessous (après avoir passé D).   \n\n**Si** $\\frac{r_xK_y}{r_yK_x} < \\frac{\\gamma_y}{\\gamma_x} < \\frac{K_y}{K_x}$ alors les équilibres sont constamment inflationiste. \n\n---\n\n-  Enfin on observe que si la droite cyan est tangente à l'ellipse alors on a que le système est constamment déflationiste. Ceci correspond au même calcul que dans la première partie et on trouve que **si** $r_x=r_y$ le système est tout le temps déflationiste pour tout $\\beta$.\n\n---\n\nMaintenant si on prend $r_x>r_y$ on a un autre cas qui apparaît d'après @gao2022\nEn effet, et on le voit bien sur l'animation, on peut alors avoir $C$ entre $D$ et $A$ avec $C$ plus haut que $A$ et ainsi on peut avoir un cas où le système est complètement inflationiste avec des valeurs de la somme des équilibres plus grands que $C$.\nCette situation ne nous intéresse que peu car ce n'est pas un cas qui est biologiquement réaliste.\n\n##### Preuves: \n\n- Point $B$:  \n  La première coordonnée est forcément $K_x$ car on considère le croisement avec la parabole en $\\beta = 0$.  \n  On sait que la parabole en $\\beta = +\\infty$ est définie par $y = \\frac{\\gamma_y}{\\gamma_x}x$.  \n  On a le résultat pour $x=K_x$.\n  \n- Point $C$:  \n  La parabole en $\\beta = +\\infty$\n est définie par $y = \\frac{\\gamma_y}{\\gamma_x}x$ et l'ellipse par $r_xx\\left(1-\\frac{x}   {K_x}\\right) + r_yy\\left(1-\\frac{y}{K_y}\\right) = 0$. Il suffit de remplacer dans l'expression de l'ellipse la valeur de y donnée par la parabole pour trouver la première coordonnée.   \n  Pour trouver la deuxième on utilise l'expression de la parabole.\n\n- Point $D$:\n  On fait la même que précédemment. La droite des capacités est définie par $y= -x +K_x+K_y$ qu'on remplace dans l'expression de l'ellipse pour trouver la première coordonnée (après simplification). La deuxième est déduite de la la première grâce à l'expression de la droite. \n  \nPour les conditions sur les équilibres on se rappelle que la pente de la parabole en $\\beta = +\\infty$ est définie par $\\frac{\\gamma_y}{\\gamma_x}$.   \nAinsi, quand cette pente est inférieure à celle de la droite passant par le point $D$ (qui a une pente de $\\frac{r_xK_y}{r_yK_x}$) on a soit déflationiste soit inflationiste. \nOn a donc pour condition $\\frac{\\gamma_y}{\\gamma_x} < \\frac{r_xK_y}{r_yK_x}$.  \n  \nEnsuite pour que le système soit entièrement inflationiste on veut que la pente de $\\beta = +\\infty$ soit entre celle de la droite passant par $D$ et celle passant par $A$ (première condition détaillée au premier point de l'analyse.) \nCeci donne le résultat.\n\n### Animation\n\n::: {.cell execution_count=8}\n\n::: {#fig-anim .cell-output .cell-output-display execution_count=8}\n```{=html}\n\n<iframe width = \"700\" height = \"550\" src = \"https://www.geogebra.org/classic/bhhpgtqv\" style = \"border: 1px solid black\"></iframe>\n```\n\nAnimation Geogebra permettant de voir quels paramètres influencent le système.\n:::\n:::\n\n\n## Somme des équilibres en fonction de la migration\n\n### Illustration des propositions précédentes\n\nOn va illustrer les propositions précédentes en traçant la somme des équilibres en fonction de $\\beta$.\nPour cela on va simuler avec `odeint` (pendant un temps assez large pour atteindre l'équilibre) pour chaque valeur de $\\beta$. \n\nOn définit une fonction qui dépend de $\\beta$ : \n\n\n\net on pose le temps d'intégration, les paramètres et les conditions initiales :\n\n\n\nEt enfin on trace les quatre figures :\n\n::: {.cell execution_count=11}\n\n::: {.cell-output .cell-output-display execution_count=11}\n```\nText(0.5, 1.0, 'Inflation')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](modeleavecmigrationass_files/figure-html/cell-12-output-2.png){width=754 height=411}\n:::\n:::\n\n\nOn voit donc que la structuration de l'espace peut causer dans plusieurs cas une inflation. C'est ce que l'on souhaite éviter à tout prix avec l'augmentorium.   \n\nMais, les hypothèses sur l'augmentorium limitent les situations qu'on peut atteindre.   \nEn effet, comme $r_x<r_y$ la quatrième situation est impossible. \nDe plus, comme $\\gamma_x << \\gamma_y$ on a $\\frac{\\gamma_y}{\\gamma_x}>>1$. Et, puisque la capacité K entre l'augmentorium et la culture diffère en fonction des types de cultures mais reste généralement proche entre les deux.   \nAinsi le rapport entre ces deux capacités est proche de 1 que ce soit inférieurement ou supérieurement.   \nOn a donc en permanence dans les cultures la condition $\\frac{\\gamma_y}{\\gamma_x}>\\frac{K_y}{K_x}$ ce qui implique une déflation de la somme des équilibres par rapport à la capacité totale.\n\n### Cas de l'augmentorium \n  \nDans le cas de l'augmentorium il est important de considérer l'équilibre $x^*$ seule par rapport à $K_x$ (sa valeur s'il n'y a pas de migration). En effet même si on a inflation dans le système si $x^*<K_x$ alors on considère l'augmentorium comme efficace.\n\nOn va donc tracer l'équilibre $x^*$ en fonction de $\\beta$ en considérant que soit $K_x < K_y$ soit $K_x > K_y$ :\n\n::: {.cell execution_count=12}\n\n::: {.cell-output .cell-output-display execution_count=12}\n```\n<matplotlib.legend.Legend at 0x7f20137c9330>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](modeleavecmigrationass_files/figure-html/cell-13-output-2.png){width=736 height=372}\n:::\n:::\n\n\nOn observe que quelque soit le type de culture on a efficacité de l'augmentorium. \n\n\nEnsuite, comme le taux de fuite est un paramètre clé de notre méthode. On va donc tracer la somme des équilibres et l'équilibre $x^*$ en fonction de $\\gamma_y$.  \n\nAttention, un fort taux de fuite correspond à un $\\gamma_y$ faible.\n\n::: {.cell execution_count=13}\n\n::: {.cell-output .cell-output-display execution_count=13}\n```\nText(0, 0.5, 'Densité de pop.')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](modeleavecmigrationass_files/figure-html/cell-14-output-2.png){width=739 height=372}\n:::\n:::\n\n\nOn observe que la somme des équilibres de la population de ravageurs en fonction du taux de fuite a une forme que nous n'avions pas eu.   \nIl est possible en passant par l'animation geogebra de voir ceci en modifiant le taux de fuite. \nOn a pour des fortes fuites un système déflationiste, puis une petite zone inflationiste et enfin de nouveau une zone déflationiste. Ceci est paradoxal car on est entrain de dire que un fort taux de fuite encourage une déflation du système et donc une efficacité de la technique de l'augmentorium. \n    \nIl faut donc chercher plus en détail et exprimer l'équilibre dans la culture en fonction de la fuite. En effet, c'est ce qui nous intéresse le plus car l'équilibre dans l'augmentorium n'est pas important pour la lutte biologique.  \nOn voit que l'équilibre dans la culture est d'abord inflationiste pour des forts taux de fuites et ensuite déflationiste pour des taux de fuites faibles. On a ici le résultat logique auquel on s'attendait qui est que l'augmentorium n'est pas efficace si la fuite est trop forte. \n\nDonc si le taux de fuite est très mal géré l'augmentorium peut être négatif pour la culture. \n\n\n## Conclusion\n\nCe modèle considère uniquement la population de ravageurs. Or, la méthode de l'augmentorium repose énormément sur l'action des prédateurs on va donc considérer [maintenant](modelaug.qmd) un modèle qui prend en compte ces prédateurs.\n\n",
    "supporting": [
      "modeleavecmigrationass_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}