<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Rapport de stage - Modèle avec proies structurées et prédateurs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./modelaug.html">Modèle avec proies structurées et prédateurs</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Rapport de stage</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Présentation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contexte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contexte</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelesansmigrationass.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modèle logistique structuré avec migration symétrique</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modeleavecmigrationass.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modèle logistique structuré avec migration assymétrique</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelaug.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Modèle avec proies structurées et prédateurs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Perspectives et conclusion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#définition-du-modèle" id="toc-définition-du-modèle" class="nav-link active" data-scroll-target="#définition-du-modèle">Définition du modèle</a>
  <ul>
  <li><a href="#hypothèses-propres-à-laugmentorium" id="toc-hypothèses-propres-à-laugmentorium" class="nav-link" data-scroll-target="#hypothèses-propres-à-laugmentorium">Hypothèses propres à l’augmentorium</a></li>
  </ul></li>
  <li><a href="#dynamique-des-populations" id="toc-dynamique-des-populations" class="nav-link" data-scroll-target="#dynamique-des-populations">Dynamique des populations</a></li>
  <li><a href="#espace-détat" id="toc-espace-détat" class="nav-link" data-scroll-target="#espace-détat">Espace d’état</a>
  <ul>
  <li><a href="#calcul-des-équilibres" id="toc-calcul-des-équilibres" class="nav-link" data-scroll-target="#calcul-des-équilibres">Calcul des équilibres</a>
  <ul class="collapse">
  <li><a href="#lorsque-beta-0" id="toc-lorsque-beta-0" class="nav-link" data-scroll-target="#lorsque-beta-0">Lorsque <span class="math inline">\beta = 0</span></a></li>
  <li><a href="#lorsque-beta-ne-0-et-petit" id="toc-lorsque-beta-ne-0-et-petit" class="nav-link" data-scroll-target="#lorsque-beta-ne-0-et-petit">Lorsque <span class="math inline">\beta \ne 0</span> et petit</a></li>
  <li><a href="#lorsque-beta-est-quelconque" id="toc-lorsque-beta-est-quelconque" class="nav-link" data-scroll-target="#lorsque-beta-est-quelconque">Lorsque <span class="math inline">\beta</span> est quelconque</a></li>
  </ul></li>
  <li><a href="#stabilité-des-équilibres" id="toc-stabilité-des-équilibres" class="nav-link" data-scroll-target="#stabilité-des-équilibres">Stabilité des équilibres</a>
  <ul class="collapse">
  <li><a href="#lorsque-beta0" id="toc-lorsque-beta0" class="nav-link" data-scroll-target="#lorsque-beta0">Lorsque <span class="math inline">\beta=0</span></a></li>
  <li><a href="#lorsque-beta-ne-0-et-beta-petit" id="toc-lorsque-beta-ne-0-et-beta-petit" class="nav-link" data-scroll-target="#lorsque-beta-ne-0-et-beta-petit">Lorsque <span class="math inline">\beta \ne 0</span> et <span class="math inline">\beta</span> petit</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#equilibres-en-fonction-des-paramètres-du-modèle-simplifié" id="toc-equilibres-en-fonction-des-paramètres-du-modèle-simplifié" class="nav-link" data-scroll-target="#equilibres-en-fonction-des-paramètres-du-modèle-simplifié">Equilibres en fonction des paramètres du modèle simplifié</a>
  <ul>
  <li><a href="#somme-des-équilibres-des-proies-en-fonction-de-beta" id="toc-somme-des-équilibres-des-proies-en-fonction-de-beta" class="nav-link" data-scroll-target="#somme-des-équilibres-des-proies-en-fonction-de-beta">Somme des équilibres des proies en fonction de <span class="math inline">\beta</span></a>
  <ul class="collapse">
  <li><a href="#déflation-du-système-sans-prédateurs" id="toc-déflation-du-système-sans-prédateurs" class="nav-link" data-scroll-target="#déflation-du-système-sans-prédateurs">Déflation du système sans prédateurs</a></li>
  <li><a href="#délfationinflation-du-système-sans-prédateurs" id="toc-délfationinflation-du-système-sans-prédateurs" class="nav-link" data-scroll-target="#délfationinflation-du-système-sans-prédateurs">Délfation/Inflation du système sans prédateurs</a></li>
  <li><a href="#inflation-du-système-sans-prédateurs" id="toc-inflation-du-système-sans-prédateurs" class="nav-link" data-scroll-target="#inflation-du-système-sans-prédateurs">Inflation du système sans prédateurs</a></li>
  </ul></li>
  <li><a href="#equilibre-de-la-culture-en-fonction-de-gamma_y" id="toc-equilibre-de-la-culture-en-fonction-de-gamma_y" class="nav-link" data-scroll-target="#equilibre-de-la-culture-en-fonction-de-gamma_y">Equilibre de la culture en fonction de <span class="math inline">\gamma_y</span></a></li>
  </ul></li>
  <li><a href="#equilibres-en-fonction-des-paramètres-du-modèle-complet" id="toc-equilibres-en-fonction-des-paramètres-du-modèle-complet" class="nav-link" data-scroll-target="#equilibres-en-fonction-des-paramètres-du-modèle-complet">Equilibres en fonction des paramètres du modèle complet</a>
  <ul>
  <li><a href="#somme-des-équilibres-des-proies-en-fonction-de-beta-1" id="toc-somme-des-équilibres-des-proies-en-fonction-de-beta-1" class="nav-link" data-scroll-target="#somme-des-équilibres-des-proies-en-fonction-de-beta-1">Somme des équilibres des proies en fonction de <span class="math inline">\beta</span></a>
  <ul class="collapse">
  <li><a href="#déflation-du-système-sans-prédateurs-1" id="toc-déflation-du-système-sans-prédateurs-1" class="nav-link" data-scroll-target="#déflation-du-système-sans-prédateurs-1">Déflation du système sans prédateurs</a></li>
  <li><a href="#inflationdéflation-du-système-sans-prédateurs" id="toc-inflationdéflation-du-système-sans-prédateurs" class="nav-link" data-scroll-target="#inflationdéflation-du-système-sans-prédateurs">Inflation/déflation du système sans prédateurs</a></li>
  <li><a href="#inflation-du-système-sans-prédateurs-1" id="toc-inflation-du-système-sans-prédateurs-1" class="nav-link" data-scroll-target="#inflation-du-système-sans-prédateurs-1">Inflation du système sans prédateurs</a></li>
  </ul></li>
  <li><a href="#equilibre-de-la-culture-en-fonction-de-gamma_x-et-gamma_y" id="toc-equilibre-de-la-culture-en-fonction-de-gamma_x-et-gamma_y" class="nav-link" data-scroll-target="#equilibre-de-la-culture-en-fonction-de-gamma_x-et-gamma_y">Equilibre de la culture en fonction de <span class="math inline">\gamma_x</span> et <span class="math inline">\gamma_y</span></a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Modèle avec proies structurées et prédateurs</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><em>Modules à importer :</em></p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="définition-du-modèle" class="level2">
<h2 class="anchored" data-anchor-id="définition-du-modèle">Définition du modèle</h2>
<p>Ce modèle est un modèle de prédation de Lotka-Volterra où les proies se répartissent en deux structures et les prédateurs diffusent librement entre les deux strcutures.</p>
<p>Nous partirons pour être plus général du postulat que la prédation et les naissances sont diférentielles entre les structures mais certaines analyses se baseront sur une égalité des naissances par exemple.</p>
<p>Nous considérons le modèle suivant d’après <span class="citation" data-cites="freedman1977">Freedman (<a href="#ref-freedman1977" role="doc-biblioref">1977</a>)</span>:</p>
<p><span id="eq-modelau"><span class="math display"> \left\{\begin{array}{l}
\dot x = r_xx\left(1-\frac{x}{K_x}\right)+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)-p_xxz \\
\dot y = r_yy\left(1-\frac{y}{K_y}\right)+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)-p_yyz \\
\dot z = z\left(n_xx+n_yy - m\right)
\end{array}\right.
\tag{1}</span></span></p>
<p>avec:<br>
- <span class="math inline">r_x</span> le taux de croissance de x dans la culture,<br>
- <span class="math inline">r_y</span> le taux de croissance de y dans l’augmentorium,<br>
- <span class="math inline">K_x</span> la capacité maximale de la culture,<br>
- <span class="math inline">K_y</span> la capacité maximale de l’augmentorium,<br>
- <span class="math inline">\beta</span> la force de migration,<br>
- <span class="math inline">\gamma_x</span> le taux d’assymétrie de la migration culture vers augmentorium,<br>
- <span class="math inline">\gamma_y</span> le taux d’assymétrie de la migration augmentorium vers culture,<br>
- <span class="math inline">p_x,p_y</span> la prédation de <span class="math inline">z</span> sur <span class="math inline">x</span> ou <span class="math inline">y</span>,<br>
- <span class="math inline">n_x,n_y</span> le taux de conversion proie prédateur dans la culture ou l’augmentorium (naissance due à la prédation),<br>
- <span class="math inline">m</span> la mortalité des prédateurs <span class="math inline">z</span>.</p>
<p>On a donc maintenant un espace structuré en deux zones, s’échangeant assymétriquement de la population (qui grandit logisitiquement), le tout controlé par une population de prédateurs ne chassant et ne se reproduisant pas de la même manière dans les deux zones.</p>
<section id="hypothèses-propres-à-laugmentorium" class="level3">
<h3 class="anchored" data-anchor-id="hypothèses-propres-à-laugmentorium">Hypothèses propres à l’augmentorium</h3>
<p>Si on veut simuler une condition d’augmentorium alors on posera <span class="math inline">p_y &gt; p_x</span> et <span class="math inline">n_y&gt;n_x</span>.</p>
<p>En effet l’augmentorium est un lieu propice au développement des individus que ce soit les prédateurs ou les ravageurs.<br>
Ainsi la prédation exercé sur les ravageurs est plus forte dans l’augmentorium et les naissances des prédateurs sont plus fortes dans l’augmentorium que dans la culture.</p>
<p>Dans la suite on restera général pour analyser le modèle.</p>
</section>
</section>
<section id="dynamique-des-populations" class="level2">
<h2 class="anchored" data-anchor-id="dynamique-des-populations">Dynamique des populations</h2>
<p>On va encore une fois simuler comment se comporte les trois populations en fonction du temps.<br>
Le code commenté est acessible dans la boite cachée ci dessous:</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition du modèle avec prédateurs:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> a(etat, t, param):</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    x,y,z<span class="op">=</span>etat</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,gy,b,px,py,nx,ny,m <span class="op">=</span> param</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    xdot,ydot,zdot<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx)<span class="op">-</span>px<span class="op">*</span>z<span class="op">*</span>x,ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)<span class="op">-</span>py<span class="op">*</span>y<span class="op">*</span>z,z<span class="op">*</span>(nx<span class="op">*</span>x<span class="op">+</span>ny<span class="op">*</span>y<span class="op">-</span>m)]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [xdot,ydot,zdot]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres Simulation 1 : </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>rx1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>ry1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>Kx1<span class="op">=</span><span class="dv">2</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>Ky1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>gx1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>gy1<span class="op">=</span><span class="dv">3</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>b1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>px1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>py1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>nx1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>ny1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>m1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>param_a1<span class="op">=</span>np.array([rx1,Kx1,ry1,Ky1,gx1,gy1,b1,px1,py1,nx1,ny1,m1])</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres Simulation 2: </span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>rx2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>ry2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>Kx2<span class="op">=</span><span class="dv">2</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>Ky2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>gx2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>gy2<span class="op">=</span><span class="dv">3</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>b2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>px2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>py2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>nx2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>ny2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>m2<span class="op">=</span><span class="dv">2</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>param_a2<span class="op">=</span>np.array([rx2,Kx2,ry2,Ky2,gx2,gy2,b2,px2,py2,nx2,ny2,m2])</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration 1,2:</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>t3<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">90</span>,<span class="fl">0.01</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>t4<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">50</span>,<span class="fl">0.01</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Condition initiale de 1,2:</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>x0<span class="op">=</span><span class="dv">2</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>y0<span class="op">=</span><span class="dv">0</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>z0<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>c0<span class="op">=</span>np.array([x0,y0,z0])</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulation 1,2:</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>s3<span class="op">=</span>odeint(a,c0,t3,args<span class="op">=</span>(param_a1,))</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>s4<span class="op">=</span>odeint(a,c0,t4,args<span class="op">=</span>(param_a2,))</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la figure: </span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">4</span>))</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Simulation du modèle d</span><span class="ch">\'</span><span class="st">augmentorium'</span>)</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de l'axe 1:</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(t3,s3[:,<span class="dv">0</span>],color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Ravageurs dans la culture'</span>)</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(t3,s3[:,<span class="dv">1</span>],color<span class="op">=</span><span class="st">'C1'</span>,label<span class="op">=</span><span class="st">'Ravageurs dans l</span><span class="ch">\'</span><span class="st">augmentorium'</span>)</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(t3,s3[:,<span class="dv">2</span>],color<span class="op">=</span><span class="st">'C6'</span>,label<span class="op">=</span><span class="st">'Prédateurs totaux'</span>)</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de l'axe 2:</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(t4,s4[:,<span class="dv">0</span>],color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Ravageurs dans la culture'</span>)</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(t4,s4[:,<span class="dv">1</span>],color<span class="op">=</span><span class="st">'C1'</span>,label<span class="op">=</span><span class="st">'Ravageurs dans l</span><span class="ch">\'</span><span class="st">augmentorium'</span>)</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(t4,s4[:,<span class="dv">2</span>],color<span class="op">=</span><span class="st">'C6'</span>,label<span class="op">=</span><span class="st">'Prédateurs totaux'</span>)</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes et titres:</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Population, x,y,z'</span>)</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend(fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].grid()</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'Temps, t'</span>)</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylim(top<span class="op">=</span><span class="dv">2</span>,bottom<span class="op">=-</span><span class="fl">0.05</span>)</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Coexistence des trois populations'</span>,fontsize<span class="op">=</span><span class="fl">7.5</span>)</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'Temps, t'</span>)</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">'Population, x,y,z'</span>)</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].legend(fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].grid()</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylim(top<span class="op">=</span><span class="dv">2</span>,bottom<span class="op">=-</span><span class="fl">0.05</span>)</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Disparition des prédateurs, maintien des ravageurs'</span>,fontsize<span class="op">=</span><span class="fl">7.5</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modelaug_files/figure-html/cell-3-output-1.png" width="672" height="394"></p>
</div>
</div>
<p>Les profils de dynamique se répartissent en deux grandes catégories. Ceux où la population de prédateurs survit et celle où elle disparaît. Il semble donc que le système possède un équilibre stable qui varie selon les paramètres du système.</p>
<p>Pour de faibles temps t on observe des oscillations à la Lotka-Volterra.</p>
<p>Le profil de la dynamique de la population sans prédateurs est similaire au modèle avec seulement les proies et la migration assymétrique. On verra dans la suite que ces deux modèles sont complètement confondus (sans prédateurs).</p>
</section>
<section id="espace-détat" class="level2">
<h2 class="anchored" data-anchor-id="espace-détat">Espace d’état</h2>
<p>Pour tracer l’espace d’état on pose toutes les variations égales à <span class="math inline">0</span> (situation d’équilibre) :</p>
<p><span id="eq-pdpaug"><span class="math display">
\left\{\begin{array}{l}
0 = r_xx^*\left(1-\frac{x^*}{K_x}\right)+\beta\left(\frac{y^*}{\gamma_y}-\frac{x^*}{\gamma_x}\right)-p_xx^*z^* \\
0 = r_yy^*\left(1-\frac{y^*}{K_y}\right)+\beta\left(\frac{x^*}{\gamma_x}-\frac{y^*}{\gamma_y}\right)-p_yy^*z^* \\
0 = z^*\left(n_xx^*+n_yy^* - m\right)
\end{array}\right.
\tag{2}</span></span></p>
<p>qui devient :<br>
<span id="eq-pdpaug2"><span class="math display">
\left\{\begin{array}{l}
z^* = \frac{r_x}{p_x}\left(1-\frac{x^*}{K_x}\right)+\frac{\beta}{p_xx^*}\left(\frac{y^*}{\gamma_y}-\frac{x^*}{\gamma_x}\right)\\
z^* = \frac{r_y}{p_y}\left(1-\frac{y^*}{K_y}\right)+\frac{\beta}{p_yy^*}\left(\frac{x^*}{\gamma_x}-\frac{y^*}{\gamma_y}\right)\\
z^*=0 \lor n_xx^*+n_yy^*=m
\end{array}\right.
\tag{3}</span></span></p>
<p>On se retrouve avec deux surfaces et deux plans dont les intersections seront les équilibres. Voyons ceci avec une animation :</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> IPython.display <span class="im">as</span> display</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fig01 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;iframe width="700" height="550" src="https://www.geogebra.org/classic/bw3wqnzg" style="border: 1px solid black"&gt;&lt;/iframe&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>display.HTML(fig01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">

<iframe width="700" height="550" src="https://www.geogebra.org/classic/bw3wqnzg" style="border: 1px solid black"></iframe>
</div>
</div>
<p>En vert on a l’intersection entre la surface définie par <span class="math inline">\dot x =0</span> et les plans <span class="math inline">z=0</span> et <span class="math inline">n_xx+n_yy=m</span>.<br>
En rouge on a l’intersection entre la surface définie par <span class="math inline">\dot y =0</span> et les plans <span class="math inline">z=0</span> et <span class="math inline">n_xx+n_yy=m</span>.</p>
<p>On a donc que l’intersection des courbes vertes et rouges sont les équilibres. Il est facile de voir qu’il n’en existe que trois différents dont un seul correspond à la coexistence des trois populations.</p>
<section id="calcul-des-équilibres" class="level3">
<h3 class="anchored" data-anchor-id="calcul-des-équilibres">Calcul des équilibres</h3>
<p>Si <span class="math inline">z=0</span> alors (<a href="#eq-modelau">1</a>) devient:<br>
<span id="eq-modamig"><span class="math display">
\left\{\begin{array}{l}
\dot x = r_xx(1-\frac{x}{K_x})+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)\\
\dot y = r_yy(1-\frac{y}{K_y})+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)
\end{array}\right.
\tag{4}</span></span></p>
<p>qui est exactement le système considéré précedemment. Pour l’analyse de ses équilibres se référer à <a href="./modeleavecmigrationass.html">ceci</a>.</p>
<p>On va donc s’intéresser uniquement à l’équilibre de coexistence qu’on notera <span class="math inline">(x^* , y^* , z^*)</span>.</p>
<p>Nous allons calculer pour différentes valeurs de <span class="math inline">\beta</span> les valeurs de l’équilibre et leur stabilité.</p>
<p>En effet le calcul exact de l’équilibre pour un <span class="math inline">\beta</span> quelconque est difficile, et on va donc partir de cas plus simple avant d’effectuer des simulations Python pour le cas quelconque.</p>
<section id="lorsque-beta-0" class="level4">
<h4 class="anchored" data-anchor-id="lorsque-beta-0">Lorsque <span class="math inline">\beta = 0</span></h4>
<p>On définit le système (<a href="#eq-pdpaug">2</a>) par <span class="math inline">\mathbb{F(x,y,z,\beta)}</span> : <span class="math display">
\mathbb{F(x,y,z,\beta)} = \left\{\begin{array}{l}
\dot x = r_xx\left(1-\frac{x}{K_x}\right)+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)-p_xxz \\
\dot y = r_yy\left(1-\frac{y}{K_y}\right)+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)-p_yyz \\
\dot z = z\left(n_xx+n_yy - m\right)
\end{array}\right.
</span></p>
<p>de telle sorte que si on cherche l’équilibre pour <span class="math inline">\beta =0</span> alors on a: <span class="math display">
\mathbb{F(x^*,y^*,z^*,0)} = 0
</span> <span class="math display">
\Leftrightarrow
</span> <span id="eq-pdpb0"><span class="math display">
\left\{\begin{array}{l}
0 = r_xx^*\left(1-\frac{x^*}{K_x}\right)-p_xx^*z^* \\
0 = r_yy^*\left(1-\frac{y^*}{K_y}\right)-p_yy^*z^* \\
0 = z^*\left(n_xx^*+n_yy^* - m\right)
\end{array}\right.
\tag{5}</span></span> <span class="math display">
\Leftrightarrow
</span> <span id="eq-eqpdp"><span class="math display">
\left\{\begin{array}{l}
z^* = \frac{r_x}{p_x}\left(1-\frac{x^*}{K_x}\right) \\
z^* = \frac{r_y}{p_y}\left(1-\frac{y^*}{K_y}\right) \\
y^* = \frac{1}{n_y}\left(m-n_xx^*\right)
\end{array}\right.
\tag{6}</span></span> et ainsi :<br>
<span class="math display">
\frac{r_x}{p_x}\left(1-\frac{x^*}{K_x}\right) = \frac{r_y}{p_y}\left(1-\frac{m}{n_yK_y}+\frac{n_xx^*}{n_y}\right)
</span> et donc : <span class="math display">
x^*=\frac{K_x\left(r_yp_xm+r_xn_yp_yK_y-r_yn_yp_xK_y\right)}{r_xn_yp_yK_y+r_yn_xp_xK_x}
</span></p>
<p>On déduit <span class="math inline">y^*</span> et <span class="math inline">z^*</span> avec leur définition d’après (<a href="#eq-eqpdp">6</a>): <span id="eq-egaz"><span class="math display">
\left\{\begin{array}{l}
x^* =  \frac{K_x\left(r_yp_xm+r_xn_yp_yK_y-r_yn_yp_xK_y\right)}{r_xn_yp_yK_y+r_yn_xp_xK_x} \\
y^* = \frac{K_y\left(r_yn_xp_xK_x+r_xp_ym - r_xn_xp_yK_x\right)}{r_xn_yp_yK_y+r_yn_xp_xK_x} \\
z^* = r_xr_y\left(\frac{n_xK_x+n_yK_y-m}{r_xn_yp_yK_y+r_yn_xp_xK_x}\right)
\end{array}\right.
\tag{7}</span></span></p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Le document de <span class="citation" data-cites="freedman1977">Freedman (<a href="#ref-freedman1977" role="doc-biblioref">1977</a>)</span> contient deux erreurs, un <span class="math inline">B_1</span> à la place d’un <span class="math inline">\beta_1</span> dans l’expression de <span class="math inline">y^*</span> (respectivement <span class="math inline">x_{20}</span> dans son article) et un <span class="math inline">p_y</span> à la place d’un <span class="math inline">p_x</span> dans l’expression de <span class="math inline">z^*</span> (respectivement un <span class="math inline">\beta_2</span> à la place d’un <span class="math inline">\beta_1</span> selon ses notations).</p>
</div>
</div>
<p>Pour que ces équilibres soient positifs il faut que :</p>
<p><span id="eq-app1"><span class="math display">
-\frac{mr_y}{K_yn_yp_y} &lt; \frac{r_x}{p_x} - \frac{r_y}{p_y} &lt; \frac{mr_x}{K_xn_xp_x}
\tag{8}</span></span></p>
<p>et</p>
<p><span id="eq-app2"><span class="math display">
n_xK_x+n_yK_y &gt; m
\tag{9}</span></span></p>
<p>On verra dans la suite que (<a href="#eq-app2">9</a>) est la condition permettant l’invasion des prédateurs lorsque les proies sont à leur équilibre.</p>
</section>
<section id="lorsque-beta-ne-0-et-petit" class="level4">
<h4 class="anchored" data-anchor-id="lorsque-beta-ne-0-et-petit">Lorsque <span class="math inline">\beta \ne 0</span> et petit</h4>
<p>Pour <span class="math inline">\beta</span> petit on va utiliser l’égalité de Taylor pour trouver <span class="math inline">(x_*,y^*,z^*)</span>. On a alors, si on note <span class="math inline">(x^*(\beta),y^*(\beta),z^*(\beta))</span>:</p>
<p><span class="math display">
\left\{\begin{array}{l}
x^*(0) = \frac{K_x\left(r_yp_xm+r_xn_yp_yK_y-r_yn_yp_xK_y\right)}{r_xn_yp_yK_y+r_yn_xp_xK_x}\\
y^*(0) = \frac{K_y\left(r_yn_xp_xK_x+r_xp_ym - r_xn_xp_yK_x\right)}{r_xn_yp_yK_y+r_yn_xp_xK_x}\\
z^*(0) = r_xr_y\left(\frac{n_xK_x+n_yK_y-m}{r_xn_yp_yK_y+r_yn_xp_xK_x}\right)
\end{array}\right. \\
</span></p>
<p>Soit <span class="math inline">\mathbb{F(x,y,z,\beta)}</span> tel que : <span class="math display">
\mathbb{F(x,y,z,\beta)} = \left\{\begin{array}{l}
r_xx\left(1-\frac{x}{K_x}\right)+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)-p_xxz \\
r_yy\left(1-\frac{y}{K_y}\right)+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)-p_yyz \\
z\left(n_xx+n_yy - m\right)
\end{array}\right. \\
</span> On veut ainsi résoudre : <span class="math display">
\mathbb{F\left(\mathcal{x}^*(\beta) , \mathcal{y}^*(\beta) , \mathcal{z}^*(\beta) , \beta\right)}=0
</span></p>
<p>or, d’après la formule de Taylor on a à l’ordre 1 en dimension 4 on a:</p>
<p><span id="eq-taylor"><span class="math display">
\mathbb{F\left(\mathcal{x}^*(\beta) , \mathcal{y}^*(\beta) , \mathcal{z}^*(\beta) , \beta\right)}=\mathbb{F\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) , \mathcal{0}\right)} + \\
\frac{\partial \mathbb{F}}{\partial \beta}\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) , \mathcal{0}\right)\beta + \mathbb{J}\tiny{\mathbb{F\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) ,\mathcal{0}\right)}}\small\begin{pmatrix} \mathcal{x}^*(\beta) - \mathcal{x}^*(\mathcal{0}) \\ \mathcal{y}^*(\beta) - \mathcal{y}^*(\mathcal{0}) \\ \mathcal{z}^*(\beta) - \mathcal{z}^*(\mathcal{0}) \end{pmatrix} + o(\beta)
\tag{10}</span></span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
\begin{pmatrix} \mathcal{x}^*(\beta) \\ \mathcal{y}^*(\beta) \\ \mathcal{z}^*(\beta) \end{pmatrix} =
\begin{pmatrix} \mathcal{x}^*(\mathcal{0}) \\  \mathcal{y}^*(\mathcal{0}) \\  \mathcal{z}^*(\mathcal{0}) \end{pmatrix} - \mathbb{J^{\mathcal{-1}}}\tiny{\mathbb{F\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) ,\mathcal{0}\right)}} \small\frac{\partial \mathbb{F}}{\partial \beta}\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) , \mathcal{0}\right)\beta + o(\beta)
</span></p>
<p>On a, <span class="math inline">\frac{\partial \mathbb{F}}{\partial \beta}\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) , \mathcal{0}\right)\beta = \begin{pmatrix} -\frac{\mathcal{x}^*(\mathcal{0})}{\gamma_x}+\frac{\mathcal{y}^*(\mathcal{0})}{\gamma_y}\\\frac{\mathcal{x}^*(\mathcal{0})}{\gamma_x}-\frac{\mathcal{y}^*(\mathcal{0})}{\gamma_y}\\ 0\end{pmatrix}</span> .</p>
<p>et, <span class="math display">
\mathbb{J}\small{\mathbb{F\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) ,\mathcal{0}\right)}} =
\begin{pmatrix} -\frac{r_xx^*(0)}{K_x} &amp; 0 &amp; -p_xx^*(0) \\ 0 &amp; -\frac{r_yy^*(0)}{K_y} &amp; -p_yy^*(0) \\ n_xz^*(0) &amp; n_yz^*(0) &amp; 0 \end{pmatrix}
</span></p>
<p>il est alors facile de calculer que, <span class="math display">
det(\mathbb{J}) = -x^*(0)y^*(0)z^*(0)\left(\frac{r_xn_yp_y}{K_x}+\frac{r_yn_xp_x}{K_y}\right) \ne 0
</span></p>
<p>La jacobienne est donc bien inversible et on peut la calculer (méthode des cofacteurs) ce qui donne : <span id="eq-jacinv"><span class="math display">
\mathbb{J^{\mathcal{-1}}}\tiny{\mathbb{F\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) ,\mathcal{0}\right)}} =\small \frac{1}{\frac{r_xp_yn_y}{K_x}+\frac{r_yp_xn_x}{K_y}} \begin{pmatrix} -\frac{p_yn_y}{x^*(0)} &amp; \frac{p_xn_y}{y^*(0)} &amp; \frac{r_yp_x}{z^*(0)K_y} \\ \frac{p_yn_x}{x^*(0)} &amp; -\frac{p_xn_x}{y^*(0)} &amp; \frac{r_xp_y}{z^*(0)K_x} \\ -\frac{r_yn_x}{x^*(0)K_y} &amp; -\frac{r_xn_y}{y^*(0)K_x}&amp; -\frac{r_xr_y}{z^*(0)K_xK_y} \end{pmatrix}
\tag{11}</span></span></p>
<p>En mettant en œuvre le calcul on trouve : <span id="eq-equbpetit"><span class="math display">
\left\{\begin{array}{l}
x^*(\beta) = x^*(0) - \frac{\beta n_yK_xK_y\left(\frac{y^*(0)}{\gamma_y}-\frac{x^*(0)}{\gamma_x}\right)\left(\frac{p_y}{x^*(0)}+\frac{p_x}{y^*(0)}\right)}{K_yr_xp_yn_y + K_xr_yp_xn_x} + o(\beta)\\
y^*(\beta) = y^*(0) - \frac{\beta n_xK_xK_y\left(\frac{y^*(0)}{\gamma_y}-\frac{x^*(0)}{\gamma_x}\right)\left(\frac{p_y}{x^*(0)}+\frac{p_x}{y^*(0)}\right)}{K_yr_xp_yn_y + K_xr_yp_xn_x} + o(\beta)\\
z^*(\beta) = z^*(0) - \frac{\beta K_xK_y\left(\frac{y^*(0)}{\gamma_y}-\frac{x^*(0)}{\gamma_x}\right)\left(\frac{r_xn-y}{y^*(0)K_x}-\frac{r_yn_x}{x^*(0)K_y}\right)}{K_yr_xp_yn_y + K_xr_yp_xn_x} + o(\beta)
\end{array}\right.\\
\tag{12}</span></span></p>
</section>
<section id="lorsque-beta-est-quelconque" class="level4">
<h4 class="anchored" data-anchor-id="lorsque-beta-est-quelconque">Lorsque <span class="math inline">\beta</span> est quelconque</h4>
<p>(<a href="#eq-pdpaug">2</a>) donne, en exprimant <span class="math inline">y^*</span> en fonction de <span class="math inline">x^*</span>: <span id="eq-systpdp"><span class="math display">
\left\{\begin{array}{l}
z^* =  \frac{r_x}{p_x}\left(1-\frac{x^*}{K_x}\right) + \frac{\beta}{p_x}\left(\frac{m}{n_y\gamma_y x^*}-\frac{n_x}{n_y\gamma_y}-\frac{1}{\gamma_x}\right)   \\
z^* = \frac{r_y}{p_y}\left(1-\frac{m-n_xx^*}{n_yK_y}\right) + \frac{\beta n_y}{p_y}\left(\frac{x^*}{\gamma_x\left(m-n_xx^*\right)}-\frac{1}{n_y\gamma_y}\right) \\
y^* =\frac{1}{n_y}\left(m- n_xx^*\right)
\end{array}\right.
\tag{13}</span></span></p>
<p>On trouve <span class="math inline">x^*</span> en faisant l’intersection entre les deux premières équations, on trouve <span class="math inline">y^*</span> avec la troisième équation et <span class="math inline">z^*</span> avec la première équation.</p>
<p>Pour calculer l’équilibre on utilise <code>numpy</code>:</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul de x*:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>np.polynomial.Polynomial([<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Polynome :</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>pol1<span class="op">=</span> (m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">*</span>x<span class="op">*</span>rx1<span class="op">/</span>px1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx1) <span class="op">+</span> (m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">*</span>b1<span class="op">/</span>px1<span class="op">*</span>((m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">/</span>(ny1<span class="op">*</span>gy1) <span class="op">-</span> x<span class="op">/</span>gx1) <span class="op">-</span> (m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">*</span>x<span class="op">*</span>ry1<span class="op">/</span>py1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>(m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">/</span>(ny1<span class="op">*</span>Ky1)) <span class="op">-</span> x<span class="op">*</span>b1<span class="op">*</span>ny1<span class="op">/</span>py1<span class="op">*</span>(x<span class="op">/</span>gx1 <span class="op">-</span> (m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">/</span>(ny1<span class="op">*</span>gy1))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#On utilise un masque booléen adapté à la situation --&gt; solution réelle, positive et qui vérifie la condtion imposée par la troisième équation du système:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>solx<span class="op">=</span>pol1.roots()[(np.isreal(pol1.roots())) <span class="op">*</span>(pol1.roots() <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">*</span>(pol1.roots()<span class="op">&lt;</span>m1<span class="op">/</span>ny1)]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul de y*:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>soly<span class="op">=</span><span class="dv">1</span><span class="op">/</span>ny1<span class="op">*</span>(m1<span class="op">-</span>nx1<span class="op">*</span>solx)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul de z*:</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>solz<span class="op">=</span>rx1<span class="op">/</span>px1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>solx<span class="op">/</span>Kx1) <span class="op">+</span> b1<span class="op">/</span>px1<span class="op">*</span>(m1<span class="op">/</span>(ny1<span class="op">*</span>gy1<span class="op">*</span>solx) <span class="op">-</span>nx1<span class="op">/</span>(ny1<span class="op">*</span>gy1)<span class="op">-</span> <span class="dv">1</span><span class="op">/</span>gx1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="stabilité-des-équilibres" class="level3">
<h3 class="anchored" data-anchor-id="stabilité-des-équilibres">Stabilité des équilibres</h3>
<p>Sans prédateurs (<span class="math inline">z=0</span>) on a les mêmes équilibres que dans la partie précédente, la stabilité est donc la même que dans la partie précédente.</p>
<p>On va calculer pour différentes valeurs de <span class="math inline">\beta</span> la stabilité.</p>
<section id="lorsque-beta0" class="level4">
<h4 class="anchored" data-anchor-id="lorsque-beta0">Lorsque <span class="math inline">\beta=0</span></h4>
<p>La jacobienne du système est: <span class="math display">
\mathbb{J_{\mathcal{x^*_2},\mathcal{y^*_2},\mathcal{z^*_2},\mathcal{0}}}  =  \begin{pmatrix} -\frac{r_xx_2^*(0)}{K_x} &amp; 0 &amp; -p_xx_2^*(0) \\ 0 &amp; -\frac{r_yy_2^*(0)}{K_y} &amp; -p_yy_2^*(0) \\ n_xz_2^*(0) &amp; n_yz_2^*(0) &amp; 0 \end{pmatrix}
</span></p>
<p>En calculant le polynôme caractéristique on en déduit que toutes les parties réelles des valeurs propres sont négatives et que donc l’équilibre est stable. <em>La preuve est faite par Freedman dans son <a href="https://epubs.siam.org/doi/10.1137/0132052">théorème 4.1</a>.</em></p>
</section>
<section id="lorsque-beta-ne-0-et-beta-petit" class="level4">
<h4 class="anchored" data-anchor-id="lorsque-beta-ne-0-et-beta-petit">Lorsque <span class="math inline">\beta \ne 0</span> et <span class="math inline">\beta</span> petit</h4>
<p><span class="math display">
\mathbb{J_{\mathcal{x^*},\mathcal{y^*},\mathcal{z^*},\mathcal{\beta}}}  =  \begin{pmatrix} -\frac{r_xx^*(0)}{K_x} -\frac{\beta}{\gamma_x} &amp; \frac{\beta}{\gamma_y} &amp; -p_xx^*(0) \\ \frac{\beta}{\gamma_x} &amp; -\frac{r_yy^*(0)}{K_y}-\frac{\beta}{\gamma_y} &amp; -p_yy^*(0) \\ n_xz^*(0) &amp; n_yz^*(0) &amp; 0 \end{pmatrix} = \mathbb{J_{\mathcal{x^*},\mathcal{y^*},\mathcal{z^*},\mathcal{0}}} + \beta \begin{pmatrix} -\frac{1}{\gamma_x} &amp; \frac{1}{\gamma_y} &amp; 0 \\ \frac{1}{\gamma_x} &amp; -\frac{1}{\gamma_y} &amp; 0 \\ 0 &amp; 0 &amp; 0 \end{pmatrix}
</span></p>
<p>Comme <span class="math inline">\beta</span> est petit on a la matrice qui est petite et qui n’influence pas le signe des valeurs propres. Donc l’équilibre est encore stable.</p>
</section>
</section>
</section>
<section id="equilibres-en-fonction-des-paramètres-du-modèle-simplifié" class="level2">
<h2 class="anchored" data-anchor-id="equilibres-en-fonction-des-paramètres-du-modèle-simplifié">Equilibres en fonction des paramètres du modèle simplifié</h2>
<p>Dans cette partie on va distinguer les cas où <span class="math inline">n_x = n_y</span> et <span class="math inline">p_x=p_y</span> de ceux où ils sont différents.<br>
En effet, l’un des postulats de l’augmentorium est que le développement des ravageurs et prédateurs est favorisé dans celui-ci mais on peut supposer que la prédation et les naissances dans l’augmentorium sont égales.</p>
<p>Il est intéressant de considérer la somme des équilibre des proies en fonction de la force de migration (<span class="math inline">\beta</span>) et les équilibres dans la culture en fonction du taux de fuite (<span class="math inline">\gamma_y</span>) et du taux de migration (<span class="math inline">\gamma_x</span>).</p>
<p>Dans ce cas (<a href="#eq-modelau">1</a>) devient :</p>
<p><span id="eq-modelaueg"><span class="math display">
\left\{\begin{array}{l}
\dot x = r_xx\left(1-\frac{x}{K_x}\right)+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)-pxz \\
\dot y = r_yy\left(1-\frac{y}{K_y}\right)+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)-pyz \\
\dot z = z\left(n\left(x+y\right) - m\right)
\end{array}\right.
\tag{14}</span></span></p>
<section id="somme-des-équilibres-des-proies-en-fonction-de-beta" class="level3">
<h3 class="anchored" data-anchor-id="somme-des-équilibres-des-proies-en-fonction-de-beta">Somme des équilibres des proies en fonction de <span class="math inline">\beta</span></h3>
<p>A l’équilibre, on a :</p>
<p><span id="eq-modelsat"><span class="math display">
\left\{\begin{array}{l}
0 = r_xx^*\left(1-\frac{x^*}{K_x}\right)+\beta\left(\frac{y^*}{\gamma_y}-\frac{x^*}{\gamma_x}\right)-px^*z^* \\
0 = r_yy^*\left(1-\frac{y^*}{K_y}\right)+\beta\left(\frac{x^*}{\gamma_x}-\frac{y^*}{\gamma_y}\right)-py^*z^* \\
x^*+y^* = \frac{m}{n}
\end{array}\right.
\tag{15}</span></span></p>
<p>On voit, avec la troisième équation du système, que la somme des équilibres des proies est toujours égale à <span class="math inline">\frac{m}{n}</span> quelque soit <span class="math inline">\beta</span> du moment que les prédateurs sont présents.</p>
<p>Intuitivement on considère que la présence d’un équilibre des prédateurs positifs (invasion des prédateurs) est soumise à la condition que pour une population aussi petite soit elle de prédateurs (<span class="math inline">z \to 0</span>) et pour les proies à l’équilibre on ait un taux de croissance positif pour les prédateurs.<br>
Mathématiquement cette hypothèse est équivalente à la condition, si on note <span class="math inline">(x_0^*(\beta),y^*_0(\beta))</span> l’équilibre sans prédateurs pour un taux <span class="math inline">\beta</span>, que <span class="math inline">x_0^* + y_0^* &gt; \frac{m}{n} \Leftrightarrow \exists z^* \ne 0</span>.</p>
<ul>
<li><p><strong>Pour <span class="math inline">\beta = 0</span></strong> on a que s’il existe un équilibre des prédateurs positif alors on a <span class="math inline">K_x+K_y&gt;\frac{m}{n}</span> par l’égalité (<a href="#eq-egaz">7</a>). Ceci est donc la condition d’invasion des prédateurs (<a href="#eq-app2">9</a>) mentionnée plus tôt.</p></li>
<li><p><strong>Si <span class="math inline">\beta = \infty</span></strong>on va réduire le système (<a href="#eq-modelaueg">14</a>) en équation de Lotka-Volterra avec croissance logistique. Ainsi la présence d’un équilibre des prédateurs sera équivalente à la condition d’invasion supposée .</p></li>
</ul>
<p>La démarche (d’après <span class="citation" data-cites="arditi2018">Arditi (<a href="#ref-arditi2018" role="doc-biblioref">2018</a>)</span>) à partir du système (<a href="#eq-modelaueg">14</a>) est la suivante :</p>
<p><span id="eq-beta"><span class="math display">
\frac{\dot x}{\gamma_x} - \frac{\dot y}{\gamma_y} = \frac{r_x}{\gamma_x}x\left(1-\frac{x}{K_x}\right) - \frac{r_y}{\gamma_y}y\left(1-\frac{y}{K_y}\right) + pz\left(y-x\right) -\frac{\beta}{\gamma_x} \left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right) -\frac{\beta}{\gamma_y} \left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)
\tag{16}</span></span></p>
<p>Quand <span class="math inline">\beta \to \infty</span>, <span class="math inline">\frac{\dot x}{\gamma_x} - \frac{\dot y}{\gamma_y}</span> devient après simplification : <span class="math display">
\frac{\dot x}{\gamma_x} - \frac{\dot y}{\gamma_y} = -\beta\left(\frac{1}{\gamma_x}+\frac{1}{\gamma_y}\right)\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)
</span></p>
<p>et donc on a forcément que <span class="math inline">\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right) \to 0</span> ie que <span class="math inline">\frac{x}{\gamma_x} = \frac{y}{\gamma_y}</span>.</p>
<p>On pose <span class="math inline">N = x+y</span> qui est, avec l’assertion précédente, équivalent à <span id="eq-sommeq"><span class="math display">
\frac{N}{\gamma_x+\gamma_y} = \frac{x+y}{\gamma_x+\gamma_y} = \frac{\frac{x\gamma_x}{\gamma_x}+\frac{y\gamma_y}{\gamma_y}}{\gamma_x+\gamma_y} = \frac{x}{\gamma_x} = \frac{y}{\gamma_y}
\tag{17}</span></span></p>
<p>On a ainsi : <span class="math display">
\dot N = \dot x + \dot y = \frac{r_xx\gamma_x}{\gamma_x}\left(1-\frac{x}{K_x}\right) + \frac{r_yy\gamma_y}{\gamma_y}\left(1-\frac{y}{K_y}\right)-pzN
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
\dot N = \frac{r_xN\gamma_x}{\gamma_x+\gamma_y}\left(1-\frac{x}{K_x}\right) + \frac{r_yN\gamma_y}{\gamma_x+\gamma_y}\left(1-\frac{y}{K_y}\right)-pzN
</span> <span class="math display">
\Leftrightarrow
</span> <span id="eq-ndot"><span class="math display">
\dot N = \left(\frac{r_x\gamma_x+r_y\gamma_y}{\gamma_x+\gamma_y}\right)N\left(1-\frac{\frac{r_x\gamma_x^2}{K_x}+\frac{r_y\gamma_y^2}{K_y}}{(\gamma_x+\gamma_y)^2(r_x\gamma_x+r_y\gamma_y)}N\right)-pzN
\tag{18}</span></span></p>
<p>En posant <span class="math inline">r_N = \left(\frac{r_x\gamma_x+r_y\gamma_y}{\gamma_x+\gamma_y}\right)</span> et <span class="math inline">K_N=\frac{(\gamma_x+\gamma_y)^2(r_x\gamma_x+r_y\gamma_y)}{\frac{r_x\gamma_x^2}{K_x}+\frac{r_y\gamma_y^2}{K_y}}</span> le système devient :</p>
<p><span id="eq-modelaueg2"><span class="math display"> \left\{\begin{array}{l}
\dot N = r_NN\left(1-\frac{N}{K_N}\right)-pzN \\
\dot z = z\left(nN - m\right)
\end{array}\right.
\tag{19}</span></span></p>
<p>qui est bien un système de L-V avec croissance logistique.</p>
<p>Si <span class="math inline">\exists z^* &gt; 0</span> alors on a <span class="math inline">N^*=\frac{m}{n}</span>.<br>
De plus, on a : <span class="math inline">pz^* = r_N\left(1-\frac{N^*}{K_N}\right)</span> et donc si <span class="math inline">z^*&gt;0</span> on a <span class="math inline">N^* &lt; K_N</span> qui est équivalent à <span class="math inline">\frac{m}{n} &lt; K_N</span>.</p>
<p>Si on considère le système précédent sans prédateurs on a :</p>
<p><span class="math display"> \left\{\begin{array}{l}
\dot N_0 = r_NN_0\left(1-\frac{N_0}{K_N}\right)
\end{array}\right.
</span></p>
<p>et on a donc <span class="math inline">N_0^* = K_N</span>.</p>
<p>Or, posons la condition mathématique intuitive : <span class="math display">
x^*_0(+\infty)+y^*_0(+\infty) &gt; \frac{m}{n}
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
\frac{x^*_0(+\infty)\gamma_x}{\gamma_x}+\frac{y^*_0(+\infty)\gamma_y}{\gamma_y} &gt; \frac{m}{n}
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
\frac{N_0^*(+\infty)\gamma_x}{\gamma_x+\gamma_y}+\frac{N^*_0(+\infty)\gamma_y}{\gamma_x+\gamma_y} &gt; \frac{m}{n}
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
K_N &gt; \frac{m}{n}
</span></p>
<p>L’intuition biologique est donc confirmée par des preuves mathématiques pour <span class="math inline">\beta=0</span> et <span class="math inline">\beta = +\infty</span> ceci est suffisant pour penser que c’est vrai pour un <span class="math inline">\beta \in ]0,+\infty[</span>.</p>
<p>On va donc tracer les graphes de la somme des équilibres du système (<a href="#eq-modelau">1</a>) avec et sans prédateurs et constater cette saturation à lorsque la condition <span class="math inline">x_0^* + y_0^* &gt; \frac{m}{n}</span> est validée.</p>
<p>Pour cela on s’appuiera sur 3 cas selon le comportement du système sans prédateurs. On prendra en premier le cas où le système était déja déflationiste, en deuxième le cas où le système était à la fois inflationiste et déflationiste puis le cas où le système est tout le temps inflationiste.</p>
<p>Ceci va permettre de comprendre le rôle de l’ajout de prédateurs.</p>
<p>Pour faire nos simulations on laisse tourner le modèle <a href="./modeleavecmigrationass.html">précédent</a> et le modèle <a href="@eq-modelau">actuel</a> indépendamment pour différentes valeur de <span class="math inline">\beta</span> et on trace dans les deux cas la somme des équilibres atteintes pour des temps d’intégration large.</p>
<section id="déflation-du-système-sans-prédateurs" class="level4">
<h4 class="anchored" data-anchor-id="déflation-du-système-sans-prédateurs">Déflation du système sans prédateurs</h4>
<p>Pour plot on va simuler avec <code>odeint</code> pendant un temps assez large pour atteindre l’équilibre :</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition d'une fonction qui prend en compte le changement de migration:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> a(etat,t,param,i):</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    x,y,z<span class="op">=</span>etat</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    b<span class="op">=</span>i</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,gy,p,n,m <span class="op">=</span> param</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    xdot,ydot,zdot<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx)<span class="op">-</span>p<span class="op">*</span>z<span class="op">*</span>x,ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)<span class="op">-</span>p<span class="op">*</span>y<span class="op">*</span>z,z<span class="op">*</span>(n<span class="op">*</span>(x<span class="op">+</span>y)<span class="op">-</span>m)]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [xdot,ydot,zdot]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition du modèle sans prédateurs:</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug(etat,t,param,i):</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,gy<span class="op">=</span>param</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    b<span class="op">=</span>i</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    x,y<span class="op">=</span>etat</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx),ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>p1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>m11<span class="op">=</span><span class="dv">1</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>n11<span class="op">=</span><span class="fl">0.25</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>m12<span class="op">=</span><span class="dv">3</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>n12<span class="op">=</span><span class="dv">2</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>param11<span class="op">=</span>np.array([rx1,Kx1,ry1,Ky1,gx1,gy1,p1,n11,m11])</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>param12<span class="op">=</span>np.array([rx1,Kx1,ry1,Ky1,gx1,gy1,p1,n12,m12])</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration suffisament large pour atteindre l'équilibre:</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>t<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">1000</span>,<span class="fl">0.01</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="co">#Condition initiale:</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>e0<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span>plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">5</span>))</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    s11<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param11,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s11[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s11[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    s12<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param12,i))</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s12[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s12[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    s11sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param11[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s11sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s11sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    s12sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param12[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s12sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s12sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky:    </span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>xt<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>xt2<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt,(Kx1<span class="op">+</span>Ky1)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt2,(Kx1<span class="op">+</span>Ky1)<span class="op">*</span>np.ones_like(xt2),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de m/n:</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt,m11<span class="op">/</span>n11<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt,m12<span class="op">/</span>n12<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx1<span class="op">+</span>Ky1,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle sans prédateurs'</span>)</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx1<span class="op">+</span>Ky1,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle avec prédateurs'</span>)</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx1<span class="op">+</span>Ky1,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m/n'</span>)</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx1<span class="op">+</span>Ky1,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Déflation'</span>)</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Déflation'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="modelaug_files/figure-html/fig-1-output-1.png" width="788" height="537" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Somme des équilibres du système avec prédateurs avec inflation et déflation du système sans prédateurs</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dans la légende on remarque qu’en gris on a la somme des équilibres du modèle sans prédateurs et en bleu du modèle avec prédateurs. Ceci ne veut pas dire que la courbe bleu représente la somme des équilibres d’un système avec des prédateurs en vie tout le temps puisqu’on a vu à l’instant qu’ils ne sont pas présents sur la <a href="#fig-1">Figure&nbsp;1</a> à gauche par exemple.</p>
<p>Quand on dit avec prédateurs c’est que le modèle prend en compte les prédateurs et donc il prend en compte quand leur population est nulle.</p>
<p>Quand cette population est nulle on a montré que le modèle avec prédateurs était égal au modèle sans prédateurs de la partie précédente expliquant que les deux courbes se rejoignent mais il faut bien garder en tête qu’on simule deux modèles complètement différents (l’un en 2D l’autre en 3D).</p>
</div>
</div>
<p>On a pris dans notre premier cas un système qui subissait une déflation de base et qui subit pour certaines valeurs de <span class="math inline">\beta</span> une invasion de prédateurs.</p>
<p>On retrouve bien en gris (somme des équilibres sans prédateurs) le même profil de courbe que dans la partie précédente.</p>
<p>En orange on retrouve la droite correspondant à <span class="math inline">\frac{m}{n}</span> qui va permettre de voir l’installation des prédateurs quand la courbe grise la traversera.</p>
<p>La droite en noir correspond à <span class="math inline">K_x+K_y</span> et va permettre de voir si on a inflationou déflation du système.</p>
<p>Enfin la courbe bleu décrit la somme des équilibres dans le système (<a href="#eq-modelau">1</a>) et présente à la fois la somme des équilibres si on a invasion des prédateurs (et donc mise en place de l’équilibre <span class="math inline">(x^*,y^*,z^*)</span>) et à la fois la somme des équilibres si on a disparition des ravageurs.<br>
Dans ce cas là, qui correspond à un cas où la courbe grise est en dessous de la droite orange (cf la condition d’invasion décrite plus haut), on observe bien que la courbe bleu et la courbe grise sont confondues.</p>
<p>Intuitivement on peut se dire que rajouter des prédateurs à un système subissant déjà une déflation sans prédateurs ne peut faire qu’aller dans le sens de la déflation.<br>
On peut observer sur notre figure que c’est bien le cas.<br>
A gauche on observe que comme on a <span class="math inline">\frac{m}{n}</span> tout le temps plus grand que <span class="math inline">x_0^* + x^*_0</span> alors les prédateurs ne s’installent pas et donc la courbe bleu est confondu avec la courbe grise (<span class="math inline">x_0^* + x^*_0 = x^*+y^*</span>). Comme les prédateurs ne sont pas présents on observe la même déflation que dans le modèle précédent.</p>
<p>A droite on observe que <span class="math inline">\frac{m}{n}</span> est d’abord en dessous de <span class="math inline">x_0^* + x^*_0</span> et donc les prédateurs peuvent s’installer expliquant la saturation à <span class="math inline">\frac{m}{n}</span> et dès que <span class="math inline">x_0^* + x^*_0</span> passe en dessous de <span class="math inline">\frac{m}{n}</span> on observe que la courbe bleu rejoint la courbe grise.<br>
Ainsi on voit dans ce cas que l’ajout de prédateurs permet d’avoir une forte déflation même pour des forces de migration <span class="math inline">\beta</span> basse ce qui n’est pas le cas dans le modèle précédent (comme en témoigne la courbe grise).</p>
</section>
<section id="délfationinflation-du-système-sans-prédateurs" class="level4">
<h4 class="anchored" data-anchor-id="délfationinflation-du-système-sans-prédateurs">Délfation/Inflation du système sans prédateurs</h4>
<p>On utilise le même code python en changeant les paramètres:</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>p2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>m21<span class="op">=</span><span class="dv">1</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>n21<span class="op">=</span><span class="fl">0.3278</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>m22<span class="op">=</span><span class="dv">1</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>n22<span class="op">=</span><span class="fl">0.335</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>param21<span class="op">=</span>np.array([rx2,Kx2,ry2,Ky2,gx2,gy2,p2,n21,m21])</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>param22<span class="op">=</span>np.array([rx2,Kx2,ry2,Ky2,gx2,gy2,p2,n22,m22])</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span>plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">5</span>))</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    s21<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param21,i))</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s21[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s21[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)             </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    s22<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param22,i))</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s22[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s22[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)              </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    s21sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param21[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s21sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s21sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    s22sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param22[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s22sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s22sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky:</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt,(Kx2<span class="op">+</span>Ky2)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt,(Kx2<span class="op">+</span>Ky2)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de m/n:</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt,m21<span class="op">/</span>n21<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt,m22<span class="op">/</span>n22<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx2<span class="op">+</span>Ky2,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle sans prédateurs'</span>)</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx2<span class="op">+</span>Ky2,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle avec prédateurs'</span>)</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx2<span class="op">+</span>Ky2,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m/n'</span>)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx2<span class="op">+</span>Ky2,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Les deux'</span>)</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Déflation'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="modelaug_files/figure-html/fig-2-output-1.png" width="788" height="537" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Somme des équilibres du système avec prédateurs avec inflation et déflation du système sans prédateurs</figcaption>
</figure>
</div>
</div>
</div>
<p>La légende est en tout point similaire à la simulation précédente.</p>
<p>A gauche on observe d’abord que la courbe bleu et grise sont confondues (traduisant une absence de prédateurs), puis une saturation à <span class="math inline">\frac{m}{n}</span> (traduisant une présence de prédateurs) puis de nouveau une disparition des prédateurs avec les courbes bleu et grise qui se rejoignent.</p>
<p>Ainsi, dans ce cas la présence de prédateurs permet de limiter l’inflation en saturant à <span class="math inline">\frac{m}{n}</span>.</p>
<p>A droite on observe que encore une fois pour des valeurs de <span class="math inline">\frac{m}{n} &lt; K_x+K_y</span> on a déflation en permanence. Nous verrons qu’on peut en déduire un cas général.<br>
On observe donc une déflation, grace à la saturation pour de faibles valeurs de <span class="math inline">\beta</span>, alors que le modèle précédent montrait une inflation.</p>
</section>
<section id="inflation-du-système-sans-prédateurs" class="level4">
<h4 class="anchored" data-anchor-id="inflation-du-système-sans-prédateurs">Inflation du système sans prédateurs</h4>
<p>On utilise encore le même code python en changeant les paramètres:</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#3:</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>p3<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>m31<span class="op">=</span><span class="dv">1</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>n31<span class="op">=</span><span class="fl">0.2832</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>m32<span class="op">=</span><span class="dv">1</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>n32<span class="op">=</span><span class="fl">0.289</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>param31<span class="op">=</span>np.array([rx3,Kx3,ry3,Ky3,gx3,gy3,p3,n31,m31])</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>param32<span class="op">=</span>np.array([rx3,Kx3,ry3,Ky3,gx3,gy3,p3,n32,m32])</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span>plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">5</span>))</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    s31<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param31,i))</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s31[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s31[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    s32<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param32,i))</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s32[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s32[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    s31sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param31[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s31sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s31sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    s32sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param32[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s32sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s32sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky: </span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt2,(Kx3<span class="op">+</span>Ky3)<span class="op">*</span>np.ones_like(xt2),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt,(Kx3<span class="op">+</span>Ky3)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de m/n:</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt,m31<span class="op">/</span>n31<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt,m32<span class="op">/</span>n32<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)         </span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx3<span class="op">+</span>Ky3,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle sans prédateurs'</span>)</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>, Kx3 <span class="op">+</span> Ky3, color <span class="op">=</span> <span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle avec prédateurs'</span>)</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>, Kx3<span class="op">+</span>Ky3,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m/n'</span>)</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx3<span class="op">+</span>Ky3,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Inflation'</span>)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Déflation'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="modelaug_files/figure-html/fig-3-output-1.png" width="788" height="537" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Somme des équilibres du système avec prédateurs avec inflation du système sans prédateurs</figcaption>
</figure>
</div>
</div>
</div>
<p>Encore une fois on observe des courbes qui saturent à <span class="math inline">\frac{m}{n}</span> quand la condition d’invasion des prédateurs est vérifiée.</p>
<p>On peut voir sur la courbe de droite, et nous allons le montrer, que pour les trois profils (ou quatre si on compte que l’inflation peut en présenter deux) de courbe (déflation,inflation/déflation et inflation) si <span class="math inline">\frac{m}{n} &lt; K_x + K_y</span> le système subit une déflation en permanence.</p>
<p>En effet, si <span class="math inline">\frac{m}{n} &lt; K_x + K_y</span> alors on distingue deux cas :</p>
<ul>
<li><p>Soit <span class="math inline">x^*_0+y^*_0&gt;\frac{m}{n}</span> et donc on a invasion des prédateurs et saturation de la courbe à <span class="math inline">\frac{m}{n}</span> (qui est en dessous de <span class="math inline">K_x + K_y</span> par hypothèse) et donc déflation constante.<br>
C’est le cas qu’on observe dans la <a href="#fig-3">Figure&nbsp;3</a> à droite.</p></li>
<li><p>Soit <span class="math inline">x^*_0+y^*_0&lt;\frac{m}{n}</span> et donc les prédateurs disparaissent et donc <span class="math inline">x_0^* + x^*_0 = x^*+y^*</span> ce qui montre que <span class="math inline">x^*+y^* &lt; \frac{m}{n} &lt; K_x + K_y</span> et qui explique qu’on a une déflation constante. C’est le cas qu’on observe dans la <a href="#fig-1">Figure&nbsp;1</a> à droite pour des valeurs de <span class="math inline">\beta</span> plus grande que <span class="math inline">2</span>.</p></li>
</ul>
<p>Ces graphiques traduisent bien l’effet de l’ajout des prédateurs dans un système : si celui ci est déja déflationiste il le reste, si celui ci était inflationiste et déflationiste ou complètement inflationiste alors son inflation est limitée par les prédateurs (jusqu’à même pouvoir devenir délfationiste, voir figure 3 à droite).</p>
<p>Si on reprend les <a href="./modeleavecmigrationass.html">conditions</a> d’inflations et déflations posées précédemment peut les adapter à ce modèle :</p>
<ul>
<li><p>Si le système sans prédateurs est de base déflationiste alors le système avec prédateurs est aussi déflationiste (avec survie ou pas des prédateurs).<br>
Ainsi d’après les conditions du <a href="./modeleavecmigrationass.html">modèle précédent</a> on a que si <span class="math inline">\frac{\gamma_y}{\gamma_x}&gt;\frac{K_y}{K_x}</span> (condition de déflation du modèle précédent) alors le système avec prédateurs est toujours déflationiste.</p></li>
<li><p>Si <span class="math inline">\frac{\gamma_y}{\gamma_x}&lt;\frac{K_y}{K_x}</span> (condition d’inflation et de déflation du modèle précédent) alors on a soit un système inflationiste si <span class="math inline">\frac{m}{n} &lt; K_x+K_y</span> soit un système inflationiste et déflationiste mais moins inflationiste que sans les prédateurs si <span class="math inline">\frac{m}{n} &lt; (x^*_0+y^*_0)_{max}</span> (autrement dit la courbe grise est au dessus de la droite orange).</p></li>
<li><p>Si <span class="math inline">\frac{r_xK_y}{r_yK_x} &lt; \frac{\gamma_y}{\gamma_x} &lt; \frac{K_y}{K_x}</span> (conditions d’inflation du modèle précédent) alors si on a <span class="math inline">x^*(\infty)+y^*(\infty) &gt; \frac{m}{n} &gt; K_x+K_y</span> alors le système est inflationiste mais moins que son <a href="./modeleavecmigrationass.html">pendant sans prédateurs</a>.</p></li>
</ul>
</section>
</section>
<section id="equilibre-de-la-culture-en-fonction-de-gamma_y" class="level3">
<h3 class="anchored" data-anchor-id="equilibre-de-la-culture-en-fonction-de-gamma_y">Equilibre de la culture en fonction de <span class="math inline">\gamma_y</span></h3>
<p>On va maintenant voir l’évolution de l’équilibre dans la culture en fonction de <span class="math inline">\gamma_y</span> (le taux de fuite):</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#On définit du nouveau modèle qui prend en compte le changement de gy :</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> a2(etat,t,param,h):</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x,y,z<span class="op">=</span>etat</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,b,p,n,m <span class="op">=</span> param</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    gy<span class="op">=</span>h</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    xdot,ydot,zdot<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx)<span class="op">-</span>p<span class="op">*</span>z<span class="op">*</span>x,ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)<span class="op">-</span>p<span class="op">*</span>y<span class="op">*</span>z,z<span class="op">*</span>(n<span class="op">*</span>(x<span class="op">+</span>y)<span class="op">-</span>m)]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> xdot,ydot,zdot</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition de l'ancien modèle qui prend en compte le changement de gy:</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug3(etat, t, param, h):</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, b <span class="op">=</span> param</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    gy <span class="op">=</span> h</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, b, p, n, m])</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration assez large pour atteindre l'éq :</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Conditions initiales:</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite de la somme des capacités:</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de m/n:</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, m<span class="op">/</span>n <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'C1'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, m<span class="op">/</span>n <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'m/n'</span>)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle qui calcule l'équilibre et qui plot un point en fonction des valeurs du taux de fuite:</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="fl">0.001</span>):</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(a2, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug3, e0[<span class="dv">0</span>:<span class="dv">2</span>], t, args <span class="op">=</span> (param1[<span class="dv">0</span>:<span class="dv">6</span>], i))</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, Kx1 <span class="op">+</span> Ky1, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, Kx1, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture avec prédateurs ($x^*$)'</span>)</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Somme des équilibres en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Equilibre de la culture en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)   </span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize <span class="op">=</span> <span class="dv">7</span>, loc <span class="op">=</span> <span class="st">"lower right"</span>)<span class="op">;</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>ax1.legend(fontsize <span class="op">=</span> <span class="dv">7</span>, loc <span class="op">=</span> <span class="st">"upper right"</span>)<span class="op">;</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Densité de pop."</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modelaug_files/figure-html/cell-9-output-1.png" width="747" height="372"></p>
</div>
</div>
<p>En gris on peut voir la somme des équilibres du modèle sans prédateurs et en orange on observe sur la figure gauche la droite <span class="math inline">\frac{m}{n}</span>.<br>
Ainsi, on peut voir quand est ce qu’en fonction du taux de fuite la population de prédateurs disparaît.</p>
<p>Pour représenter cette figure on a considéré que <span class="math inline">r_x&lt;r_y</span> et <span class="math inline">K_x&lt;K_y</span> sans perte de généralité.</p>
<p>A gauche, on observe que la somme des équilibres des ravageurs sans prédateurs est bien similaire à celle obtenue dans la partie précédente.</p>
<p>Quand il n’y a pas de prédateurs on observe bien comme précédemment que la courbe bleu et grise se rejoignent.<br>
En revanche quand on a des prédateurs (la courbe grise est au dessus de <span class="math inline">\frac{m}{n}</span>) alors on a bien la saturation de la somme des équilibres.</p>
<p>A droite on observe la même simulation qu’à gauche (en terme de paramètres) mais on représente uniquement l’équilibre dans la culture qui est l’équilibre qui nous intéresse le plus.<br>
On observe que pour les valeurs de taux de fuite de disparition des prédateurs à gauche on a aussi à droite la courbe bleu qui se sépare de la courbe grise.<br>
On remarque cette courbe bleu décroît plus vite vers la déflation que la courbe grise montrant l’effet bénéfique des parasites pour baisser les ravageurs dans le système.</p>
<p>Ainsi, dans ce modèle on a aussi que des forts taux de fuite engendrent une inflation dans la culture.</p>
</section>
</section>
<section id="equilibres-en-fonction-des-paramètres-du-modèle-complet" class="level2">
<h2 class="anchored" data-anchor-id="equilibres-en-fonction-des-paramètres-du-modèle-complet">Equilibres en fonction des paramètres du modèle complet</h2>
<p>Maintenant on va considérer le modèle plus complexe de naissances (<span class="math inline">n</span>) et de la prédation (<span class="math inline">p</span>) différentes entre la culture et l’augmentorium.<br>
Ce postulat n’est pas anodin car on peut vraisemblablement penser que l’augmentorium fournit une structure positive à la croissance grâce à la grande concentration de ressources qu’il renferme et à son relatif cloisonnement de l’extérieur.</p>
<section id="somme-des-équilibres-des-proies-en-fonction-de-beta-1" class="level3">
<h3 class="anchored" data-anchor-id="somme-des-équilibres-des-proies-en-fonction-de-beta-1">Somme des équilibres des proies en fonction de <span class="math inline">\beta</span></h3>
<p>Précédemment on observait une saturation de la somme des proies à <span class="math inline">\frac{m}{n}</span>. Mais cette observation résultait de la trop forte simplification du modèle considéré. En considérant notre modèle actuel et en faisant l’hypothèse que <span class="math inline">z^* \ne 0</span> alors on a la condition <span class="math inline">n_xx^*+n_yy^* = m</span> qui ne renseigne pas comme auparavant sur la taille de la population de ravageurs à l’équilibre.</p>
<p>L’intuition mathématique, via le même raisonnement biologique précédent, est que l’invasion des prédateurs ie <span class="math inline">\exists z^* &gt; 0</span> est vérifiée si seulement si <span class="math inline">n_xx_0^*(\beta) + n_yy_0^*(\beta)&gt;m</span> où <span class="math inline">x_0^*(\beta)</span> et <span class="math inline">y_0^*(\beta)</span> sont les équilibres du système sans prédateurs.</p>
<p>Montrons le mathématiquement pour <span class="math inline">\beta = 0</span> et <span class="math inline">\beta = +\infty</span> :</p>
<ul>
<li><strong>Pour <span class="math inline">\beta =0</span>,</strong> une autre manière de montrer la condition (autre que celle utilisée pour le modèle simplifié) est de considérer le système suivant donné par <span class="math inline">\beta</span> = 0:</li>
</ul>
<p><span id="eq-modelau2"><span class="math display"> \left\{\begin{array}{l}
\dot x = r_xx\left(1-\frac{x}{K_x}\right)-p_xxz \\
\dot y = r_yy\left(1-\frac{y}{K_y}\right)-p_yyz \\
\dot z = z\left(n_xx+n_yy - m\right)
\end{array}\right.
\tag{20}</span></span></p>
<p>qui pour un équilibre positif implique que : <span class="math display">
\frac{r_x}{p_x}\left(1-\frac{x^*}{K_x}\right) = \frac{r_y}{p_y}\left(1-\frac{y^*}{K_y}\right)
</span> qui donne, via la condition <span class="math inline">z &gt; 0</span>, après réarrangement: <span id="eq-eqx"><span class="math display">
x^* = \frac{K_x\left(r_xp_yn_yK_y-r_yp_xn_yK_y+r_yp_xm\right)}{r_xp_yn_yK_y+r_yp_xn_xK_x}
\tag{21}</span></span></p>
<p>Par l’expression de <span class="math inline">z^*</span> on a <span class="math inline">K_x &gt; x^*</span> autrement dit : <span class="math display">
K_x &gt; \frac{K_x\left(r_xp_yn_yK_y-r_yp_xn_yK_y+r_yp_xm\right)}{r_xp_yn_yK_y+r_yp_xn_xK_x}
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
r_xp_yn_yK_y+r_yp_xn_xK_x &gt; r_xp_yn_yK_y-r_yp_xn_yK_y+r_yp_xm
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
r_yp_x(n_xK_x+n_yK_y) &gt; r_yp_xm \Leftrightarrow n_xK_x + n_yK_y &gt; m
</span></p>
<p>Or <span class="math inline">x_0^*(0) = K_x</span> et <span class="math inline">y_0^*(0) = K_y</span> car ce ne sont que des croissances logistiques en l’absence de prédateurs.</p>
<p>Ainsi la condition <span class="math inline">n_xx_0^*(0) + n_yy_0^*(0)&gt;m</span> équivaut à <span class="math inline">n_xK_x + n_yK_y &gt; m</span> qui est la condition d’un équilibre <span class="math inline">z&gt;0</span>.</p>
<p>La condition d’un équilibre positif implique bien la condition d’invasion.</p>
<ul>
<li><strong>Pour <span class="math inline">\beta =+\infty</span>,</strong> on va simplifier le système (<a href="#eq-modelau">1</a>).</li>
</ul>
<p>On pose <span class="math inline">N = x+y</span> et en faisant tendre <span class="math inline">\beta \to +\infty</span> et en considérant <span class="math inline">\frac{\dot x}{\gamma_x} - \frac{\dot y}{\gamma_y}</span> on a forcément <span class="math inline">\frac{x}{\gamma_x} = \frac{y}{\gamma_y}</span> (similairement à la réduction du modèle simplifié).</p>
<p>Cette condition permet de dire que <span class="math inline">\frac{N}{\gamma_x+\gamma_y} = \frac{x}{\gamma_x} = \frac{y}{\gamma_y}</span>.</p>
<p><span class="math display">
\dot N = \frac{r_xx\gamma_x}{\gamma_x}\left(1-\frac{x\gamma_x}{K_x\gamma_x}\right) + \frac{r_yy\gamma_y}{\gamma_y}\left(1-\frac{y\gamma_y}{K_y\gamma_y}\right) - z\left(\frac{p_xx\gamma_x}{\gamma_x}+\frac{p_yy\gamma_y}{\gamma_y}\right)
</span></p>
<p>En réarrangeant l’expression de droite en prenant en compte la condition précédente on a: <span class="math display">
\dot N = \underbrace{\frac{r_x\gamma_x+r_y\gamma_y}{\gamma_x+\gamma_y}}_{r_N} N \left(1 - N \underbrace{\frac{\left(\frac{r_x\gamma_x^2}{K_x}+\frac{r_y\gamma_y^2}{K_y}\right)}{(\gamma_x+\gamma_y)^2(r_x\gamma_x+r_y\gamma_y)}}_{\frac{1}{K_N}} \right) - zN\underbrace{\left(\frac{p_x\gamma_x+p_y\gamma_y}{\gamma_x+\gamma_y}\right)}_{p_N}
</span></p>
<p>Pour <span class="math inline">\dot z</span> on a : <span class="math display">
\dot z = z\left(\frac{n_xx\gamma_x}{\gamma_x}+\frac{n_yy\gamma_y}{\gamma_y}-m\right)
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
\dot z = z\left( N \underbrace{\frac{n_x\gamma_x+n_y\gamma_y}{\gamma_x+\gamma_y}}_{n_N} - m\right)
</span></p>
<p>Le système (<a href="#eq-modelau">1</a>) devient donc pour <span class="math inline">\beta \to +\infty</span> :</p>
<p><span id="eq-systsimpl"><span class="math display"> \left\{\begin{array}{l}
\dot N = r_N N \left(1-\frac{N}{K_N}\right) - p_NzN \\
\dot z = z\left(n_N N - m\right)
\end{array}\right.
\tag{22}</span></span></p>
<p>qui est exactement un système proie-prédateur de Lotka-Volterra avec croissance logistique des proies.<br>
Si <span class="math inline">\exists z^* &gt; 0</span> on a à la fois <span class="math inline">N^*=\frac{m}{n_N}</span> et aussi <span class="math inline">N^* &lt; K_N</span> et donc on a la condition suivante, s’il existe un équilibre non nul, <span class="math inline">K_N n_N &gt; m</span>.</p>
<p>Or, en prenant <span class="math inline">n_xx_0^*(+\infty) + n_yy_0^*(+\infty) &gt; m</span> on a : <span class="math display">
\frac{n_xx_0^*(+\infty)\gamma_x}{\gamma_x} + \frac{n_yy_0^*(+\infty)\gamma_y}{\gamma_y} &gt; m
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
\frac{N^*_0}{\gamma_x+\gamma_y}(n_x\gamma_x+n_y\gamma_y) &gt; m
</span></p>
<p>avec <span class="math inline">N^*_0</span> qui est l’équilibre du système de L-V pour <span class="math inline">z=0</span>. Cet équilibre est trivialement égal à <span class="math inline">K_N</span> et donc on a: <span class="math display">
K_N n_N &gt; m
</span></p>
<p>Nos intuitions biologiques étant validées mathématiquement pour <span class="math inline">\beta = 0</span> et <span class="math inline">\beta = +\infty</span> on peut logiquement se dire que c’est aussi le cas pour un <span class="math inline">\beta \in ]0,+\infty[</span>.</p>
<p>On va simuler numériquement la somme des équilibres des proies du système (<a href="#eq-modelau">1</a>) par la même méthode que précédemment en faisant aussi aparaître la courbe <span class="math inline">n_xx^*_0+n_yy^*_0</span> et <span class="math inline">m</span> ainsi que la somme des équilibres des proies du système (<a href="#eq-modamig">4</a>) sans prédateurs pour pouvoir voir quand on a disparition des prédateurs et donc <span class="math inline">x^*_0 + y^*_0 = x^*+y^*</span>.</p>
<section id="déflation-du-système-sans-prédateurs-1" class="level4">
<h4 class="anchored" data-anchor-id="déflation-du-système-sans-prédateurs-1">Déflation du système sans prédateurs</h4>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition du modèle avec prédateurs:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> a(etat,t,param,i):</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x,y,z<span class="op">=</span>etat</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    b<span class="op">=</span>i</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,gy,px,py,nx,ny,m <span class="op">=</span> param</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    xdot,ydot,zdot<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx)<span class="op">-</span>px<span class="op">*</span>z<span class="op">*</span>x,ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)<span class="op">-</span>py<span class="op">*</span>y<span class="op">*</span>z,z<span class="op">*</span>(nx<span class="op">*</span>x<span class="op">+</span>ny<span class="op">*</span>y<span class="op">-</span>m)]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [xdot,ydot,zdot]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition du modèle sans prédateurs:</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug2(etat,t,param,i):</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,gy<span class="op">=</span>param</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    b<span class="op">=</span>i</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    x,y<span class="op">=</span>etat</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx),ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)]</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>px1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>py1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>nx1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>ny1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>m11<span class="op">=</span><span class="dv">1</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>m12<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>param11p<span class="op">=</span>np.array([rx1,Kx1,ry1,Ky1,gx1,gy1,px1,py1,nx1,ny1,m11])</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>param11sp<span class="op">=</span>param11p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>param12p<span class="op">=</span>np.array([rx1,Kx1,ry1,Ky1,gx1,gy1,px1,py1,nx1,ny1,m12])</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>param12sp<span class="op">=</span>param12p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration suffisament large pour atteindre l'équilibre:</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>t<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">600</span>,<span class="fl">0.01</span>)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Condition initiale:</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>e0p<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>e0sp<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>xt<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>    s1p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param11p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>    s1sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param11sp,i))</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s1p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s1p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,nx1<span class="op">*</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny1<span class="op">*</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    ax.plot(xt,m11<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>    s1p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param12p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>    s1sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param12sp,i))</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s1p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s1p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,nx1<span class="op">*</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny1<span class="op">*</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>    ax1.plot(xt,m12<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky:    </span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>ax.plot(xt,(Kx1<span class="op">+</span>Ky1)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt,(Kx1<span class="op">+</span>Ky1)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx1 <span class="op">+</span> Ky1,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres sans prédateurs'</span>)</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx1 <span class="op">+</span> Ky1,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx1 <span class="op">+</span> Ky1,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'r'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'nx*x+ny*y'</span>)</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx1 <span class="op">+</span> Ky1,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'g'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m'</span>)</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx1 <span class="op">+</span> Ky1,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">5.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Déflation'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>Text(0.5, 1.0, 'Déflation')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="modelaug_files/figure-html/cell-10-output-2.png" width="1545" height="520"></p>
</div>
</div>
</section>
<section id="inflationdéflation-du-système-sans-prédateurs" class="level4">
<h4 class="anchored" data-anchor-id="inflationdéflation-du-système-sans-prédateurs">Inflation/déflation du système sans prédateurs</h4>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>px2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>py2<span class="op">=</span><span class="dv">3</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>nx2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>ny2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>m21<span class="op">=</span><span class="dv">1</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>m22<span class="op">=</span><span class="fl">1.9</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>param21p<span class="op">=</span>np.array([rx2,Kx2,ry2,Ky2,gx2,gy2,px2,py2,nx2,ny2,m21])</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>param21sp<span class="op">=</span>param21p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>param22p<span class="op">=</span>np.array([rx2,Kx2,ry2,Ky2,gx2,gy2,px2,py2,nx2,ny2,m22])</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>param22sp<span class="op">=</span>param22p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    s2p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param21p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    s2sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param21sp,i))</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s2p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s2p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,nx2<span class="op">*</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny2<span class="op">*</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    ax.plot(xt,m21<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    s2p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param22p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    s2sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param22sp,i))</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s2p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s2p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,nx2<span class="op">*</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny2<span class="op">*</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    ax1.plot(xt,m22<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky: </span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>ax.plot(xt,(Kx2<span class="op">+</span>Ky2)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt,(Kx2<span class="op">+</span>Ky2)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx2 <span class="op">+</span> Ky2,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres sans prédateurs'</span>)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx2 <span class="op">+</span> Ky2,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx2 <span class="op">+</span> Ky2,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'r'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'nx*x+ny*y'</span>)</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx2 <span class="op">+</span> Ky2,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'g'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m'</span>)</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx2 <span class="op">+</span> Ky2,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">5.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Les deux'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Text(0.5, 1.0, 'Les deux')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="modelaug_files/figure-html/cell-11-output-2.png" width="1537" height="520"></p>
</div>
</div>
</section>
<section id="inflation-du-système-sans-prédateurs-1" class="level4">
<h4 class="anchored" data-anchor-id="inflation-du-système-sans-prédateurs-1">Inflation du système sans prédateurs</h4>
<p>On va montrer deux cas, l’un avec <span class="math inline">n_xx^*_0 + n_yy^*_0 = m</span> décroissant et l’autre avec <span class="math inline">n_xx^*_0 + n_yy^*_0 = m</span> croissant :</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#3:</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>px3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>py3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>nx3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>ny3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>m31 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>m32 <span class="op">=</span> <span class="fl">2.45</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>param31p <span class="op">=</span> np.array([rx3, Kx3, ry3, Ky3,gx3,gy3,px3,py3,nx3,ny3,m31])</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>param31sp<span class="op">=</span>param31p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>param32p<span class="op">=</span>np.array([rx3,Kx3,ry3,Ky3,gx3,gy3,px3,py3,nx3,ny3,m32])</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>param32sp<span class="op">=</span>param32p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    s3p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param31p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    s3sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param31sp,i))</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s3p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s3p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,nx3<span class="op">*</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny3<span class="op">*</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    ax.plot(xt,m31<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    s3p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param32p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    s3sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param32sp,i))</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s3p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s3p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,nx3<span class="op">*</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny3<span class="op">*</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    ax1.plot(xt,m32<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky: </span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>ax.plot(xt,(Kx3<span class="op">+</span>Ky3)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt,(Kx3<span class="op">+</span>Ky3)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx3 <span class="op">+</span> Ky3,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres sans prédateurs'</span>)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx3 <span class="op">+</span> Ky3,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx3 <span class="op">+</span> Ky3,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'r'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'nx*x+ny*y'</span>)</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx3 <span class="op">+</span> Ky3,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'g'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m'</span>)</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx3 <span class="op">+</span> Ky3,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">5.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Les deux'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Text(0.5, 1.0, 'Les deux')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="modelaug_files/figure-html/cell-12-output-2.png" width="1537" height="520"></p>
</div>
</div>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#4:</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rx4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ry4 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>Kx4 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>Ky4 <span class="op">=</span> <span class="fl">1.25</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>gx4 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>gy4 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>px4<span class="op">=</span><span class="dv">3</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>py4<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>nx4<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>ny4<span class="op">=</span><span class="dv">1</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>m41<span class="op">=</span><span class="fl">1.4</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>m42<span class="op">=</span><span class="fl">1.82</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>param41p<span class="op">=</span>np.array([rx4,Kx4,ry4,Ky4,gx4,gy4,px4,py4,nx4,ny4,m41])</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>param41sp<span class="op">=</span>param41p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>param42p<span class="op">=</span>np.array([rx4,Kx4,ry4,Ky4,gx4,gy4,px4,py4,nx4,ny4,m42])</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>param42sp<span class="op">=</span>param42p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">5</span>))</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>xt<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    s4p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param41p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    s4sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param41sp,i))</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s4p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s4p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,nx4<span class="op">*</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny4<span class="op">*</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    ax.plot(xt,m41<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    s4p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param42p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    s4sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param42sp,i))</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s4p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s4p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,nx4<span class="op">*</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny4<span class="op">*</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    ax1.plot(xt,m42<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>ax.plot(xt,(Kx4<span class="op">+</span>Ky4)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt,(Kx4<span class="op">+</span>Ky4)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx4 <span class="op">+</span> Ky4,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres sans prédateurs'</span>)</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx4 <span class="op">+</span> Ky4,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx4 <span class="op">+</span> Ky4,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'r'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'nx*x+ny*y'</span>)</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx4 <span class="op">+</span> Ky4,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'g'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m'</span>)</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx4 <span class="op">+</span> Ky4,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">5.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Les deux'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>Text(0.5, 1.0, 'Les deux')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="modelaug_files/figure-html/cell-13-output-2.png" width="1537" height="520"></p>
</div>
</div>
<p>On observe que si <span class="math inline">m</span> est toujours plus grand que <span class="math inline">n_xx_0^*+n_yy_0^*</span> alors les prédateurs disparaissent et on a que la somme des équilibres est égale à <span class="math inline">x_0^*+y_0^*</span> (la courbe bleu est tout le temps confondue avec la courbe grise).</p>
<p>Ensuite, quand <span class="math inline">m</span> est toujours plus petit que <span class="math inline">n_xx_0^*+n_yy_0^*</span> alors les prédateurs sont toujours en vie et on a que la somme des équilibres est égale à <span class="math inline">x^*+y^*</span>.</p>
<p>Enfin, quand <span class="math inline">m</span> croise <span class="math inline">n_xx_0^*+n_yy_0^*</span> on observe que la somme des équilibres est à la fois <span class="math inline">x^*+y^*</span> et <span class="math inline">x_0^*+y_0^*</span>. Si <span class="math inline">n_xx_0^*+n_yy_0^*</span> est croissant alors on a d’abord que la somme des équilibres est égale à <span class="math inline">x_0^*+y_0^*</span> puis <span class="math inline">x^*+y^*</span> et inversement si <span class="math inline">n_xx_0^*+n_yy_0^*</span> est décroissante.</p>
</section>
</section>
<section id="equilibre-de-la-culture-en-fonction-de-gamma_x-et-gamma_y" class="level3">
<h3 class="anchored" data-anchor-id="equilibre-de-la-culture-en-fonction-de-gamma_x-et-gamma_y">Equilibre de la culture en fonction de <span class="math inline">\gamma_x</span> et <span class="math inline">\gamma_y</span></h3>
<p>On va maintenant tracer l’équilibre dans la culture en fonction du taux de migration et de fuite.</p>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#On définit un nouveau modèle qui prend en compte le changement de gy</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> a2(etat,t,param,i):</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    x,y,z<span class="op">=</span>etat</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    gy<span class="op">=</span>i</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,b,px,py,nx,ny,m <span class="op">=</span> param</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    xdot,ydot,zdot<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx)<span class="op">-</span>px<span class="op">*</span>z<span class="op">*</span>x,ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)<span class="op">-</span>py<span class="op">*</span>y<span class="op">*</span>z,z<span class="op">*</span>(nx<span class="op">*</span>x<span class="op">+</span>ny<span class="op">*</span>y<span class="op">-</span>m)]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [xdot,ydot,zdot]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition de l'ancien modèle qui prend en compte le changement de gy:</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug3(etat, t, param, h):</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, b <span class="op">=</span> param</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    gy <span class="op">=</span> h</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>px <span class="op">=</span> <span class="fl">0.75</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>py <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>nx <span class="op">=</span> <span class="fl">0.75</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>ny <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, b, px, py, nx, ny, m])</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration assez large pour atteindre l'éq :</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co">#Conditions initiales:</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite de la somme des capacités:</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de m/n:</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, m <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'C1'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, m<span class="op">/</span>n <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'m/n'</span>)</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle qui calcule l'équilibre et qui plot un point en fonction des valeurs du taux de fuite:</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="fl">0.001</span>):</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(a2, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug3, e0[<span class="dv">0</span>:<span class="dv">2</span>], t, args <span class="op">=</span> (param1[<span class="dv">0</span>:<span class="dv">6</span>], i))</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, nx <span class="op">*</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> ny <span class="op">*</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'r'</span>, markersize <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, Kx1 <span class="op">+</span> Ky1, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, Kx1, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture avec prédateurs ($x^*$)'</span>)</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Somme des équilibres en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Equilibre de la culture en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)   </span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize <span class="op">=</span> <span class="dv">7</span>, loc <span class="op">=</span> <span class="st">"lower right"</span>)<span class="op">;</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>ax1.legend(fontsize <span class="op">=</span> <span class="dv">7</span>, loc <span class="op">=</span> <span class="st">"upper right"</span>)<span class="op">;</span></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Densité de pop."</span>)<span class="op">;</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modelaug_files/figure-html/cell-14-output-1.png" width="739" height="372"></p>
</div>
</div>
<p>On observe des résultats similaires au système simplifié. L’analyse qui en résulte est la même.</p>
<p>D’après les graphiques, l’effet de l’augmentorium sur l’équilibre dans la culture a l’air largement diminué dans tous les types de culture.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Ce modèle nous permet d’entrevoir mathématiquement pourquoi l’augmentorium est une technique efficace dans les cultures.</p>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-arditi2018" class="csl-entry" role="listitem">
Arditi, Lobry, R. 2018. <span>“Asymmetric Dispersal in the Multi-Patch Logistic Equation.”</span> <em>Theor. Popul. Biol.</em> 120: 11–15.
</div>
<div id="ref-freedman1977" class="csl-entry" role="listitem">
Freedman, Waltman, H. I. 1977. <span>“Mathematical Models of Population Interactions with Dispersal.”</span> <em>J. Appl. Math.</em> 32: 631–48.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb18" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Modèle avec proies structurées et prédateurs</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>*Modules à importer :*</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## Définition du modèle </span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>Ce modèle est un modèle de prédation de Lotka-Volterra où les proies se répartissent en deux structures et les prédateurs diffusent librement entre les deux strcutures.  </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>Nous partirons pour être plus général du postulat que la prédation et les naissances sont diférentielles entre les structures mais certaines analyses se baseront sur une égalité des naissances par exemple.  </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>Nous considérons le modèle suivant d'après @freedman1977: </span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>$$ \left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>\dot x = r_xx\left(1-\frac{x}{K_x}\right)+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)-p_xxz <span class="sc">\\</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>\dot y = r_yy\left(1-\frac{y}{K_y}\right)+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)-p_yyz <span class="sc">\\</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>\dot z = z\left(n_xx+n_yy - m\right)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>$$ {#eq-modelau}</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>avec:  </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$r_x$ le taux de croissance de x dans la culture,  </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$r_y$ le taux de croissance de y dans l'augmentorium,  </span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$K_x$ la capacité maximale de la culture,  </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$K_y$ la capacité maximale de l'augmentorium,  </span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta$ la force de migration,  </span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\gamma_x$ le taux d'assymétrie de la migration culture vers augmentorium,  </span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\gamma_y$ le taux d'assymétrie de la migration augmentorium vers culture,  </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$p_x,p_y$ la prédation de $z$ sur $x$ ou $y$,  </span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$n_x,n_y$ le taux de conversion proie prédateur dans la culture ou l'augmentorium (naissance due à la prédation),  </span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$m$ la mortalité des prédateurs $z$.</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>On a donc maintenant un espace structuré en deux zones, s'échangeant assymétriquement de la population (qui grandit logisitiquement), le tout controlé par une population de prédateurs ne chassant et ne se reproduisant pas de la même manière dans les deux zones. </span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hypothèses propres à l'augmentorium </span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>Si on veut simuler une condition d'augmentorium alors on posera $p_y &gt; p_x$ et $n_y&gt;n_x$.</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>En effet l'augmentorium est un lieu propice au développement des individus que ce soit les prédateurs ou les ravageurs.   </span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>Ainsi la prédation exercé sur les ravageurs est plus forte dans l'augmentorium et les naissances des prédateurs sont plus fortes dans l'augmentorium que dans la culture.</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>Dans la suite on restera général pour analyser le modèle.</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dynamique des populations</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>On va encore une fois simuler comment se comporte les trois populations en fonction du temps.  </span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>Le code commenté est acessible dans la boite cachée ci dessous:</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition du modèle avec prédateurs:</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> a(etat, t, param):</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    x,y,z<span class="op">=</span>etat</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,gy,b,px,py,nx,ny,m <span class="op">=</span> param</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>    xdot,ydot,zdot<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx)<span class="op">-</span>px<span class="op">*</span>z<span class="op">*</span>x,ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)<span class="op">-</span>py<span class="op">*</span>y<span class="op">*</span>z,z<span class="op">*</span>(nx<span class="op">*</span>x<span class="op">+</span>ny<span class="op">*</span>y<span class="op">-</span>m)]</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [xdot,ydot,zdot]</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres Simulation 1 : </span></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>rx1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>ry1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>Kx1<span class="op">=</span><span class="dv">2</span></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>Ky1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>gx1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>gy1<span class="op">=</span><span class="dv">3</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>b1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>px1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>py1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>nx1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>ny1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>m1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>param_a1<span class="op">=</span>np.array([rx1,Kx1,ry1,Ky1,gx1,gy1,b1,px1,py1,nx1,ny1,m1])</span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres Simulation 2: </span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>rx2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>ry2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>Kx2<span class="op">=</span><span class="dv">2</span></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>Ky2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>gx2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>gy2<span class="op">=</span><span class="dv">3</span></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>b2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>px2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>py2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>nx2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>ny2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>m2<span class="op">=</span><span class="dv">2</span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>param_a2<span class="op">=</span>np.array([rx2,Kx2,ry2,Ky2,gx2,gy2,b2,px2,py2,nx2,ny2,m2])</span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration 1,2:</span></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>t3<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">90</span>,<span class="fl">0.01</span>)</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>t4<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">50</span>,<span class="fl">0.01</span>)</span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a><span class="co">#Condition initiale de 1,2:</span></span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>x0<span class="op">=</span><span class="dv">2</span></span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a>y0<span class="op">=</span><span class="dv">0</span></span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>z0<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>c0<span class="op">=</span>np.array([x0,y0,z0])</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulation 1,2:</span></span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a>s3<span class="op">=</span>odeint(a,c0,t3,args<span class="op">=</span>(param_a1,))</span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>s4<span class="op">=</span>odeint(a,c0,t4,args<span class="op">=</span>(param_a2,))</span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la figure: </span></span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">4</span>))</span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Simulation du modèle d</span><span class="ch">\'</span><span class="st">augmentorium'</span>)</span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de l'axe 1:</span></span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(t3,s3[:,<span class="dv">0</span>],color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Ravageurs dans la culture'</span>)</span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(t3,s3[:,<span class="dv">1</span>],color<span class="op">=</span><span class="st">'C1'</span>,label<span class="op">=</span><span class="st">'Ravageurs dans l</span><span class="ch">\'</span><span class="st">augmentorium'</span>)</span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(t3,s3[:,<span class="dv">2</span>],color<span class="op">=</span><span class="st">'C6'</span>,label<span class="op">=</span><span class="st">'Prédateurs totaux'</span>)</span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de l'axe 2:</span></span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(t4,s4[:,<span class="dv">0</span>],color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Ravageurs dans la culture'</span>)</span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(t4,s4[:,<span class="dv">1</span>],color<span class="op">=</span><span class="st">'C1'</span>,label<span class="op">=</span><span class="st">'Ravageurs dans l</span><span class="ch">\'</span><span class="st">augmentorium'</span>)</span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(t4,s4[:,<span class="dv">2</span>],color<span class="op">=</span><span class="st">'C6'</span>,label<span class="op">=</span><span class="st">'Prédateurs totaux'</span>)</span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes et titres:</span></span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Population, x,y,z'</span>)</span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend(fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].grid()</span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'Temps, t'</span>)</span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylim(top<span class="op">=</span><span class="dv">2</span>,bottom<span class="op">=-</span><span class="fl">0.05</span>)</span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Coexistence des trois populations'</span>,fontsize<span class="op">=</span><span class="fl">7.5</span>)</span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'Temps, t'</span>)</span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">'Population, x,y,z'</span>)</span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].legend(fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].grid()</span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylim(top<span class="op">=</span><span class="dv">2</span>,bottom<span class="op">=-</span><span class="fl">0.05</span>)</span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Disparition des prédateurs, maintien des ravageurs'</span>,fontsize<span class="op">=</span><span class="fl">7.5</span>)<span class="op">;</span></span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a>Les profils de dynamique se répartissent en deux grandes catégories. Ceux où la population de prédateurs survit et celle où elle disparaît. Il semble donc que le système possède un équilibre stable qui varie selon les paramètres du système. </span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a>Pour de faibles temps t on observe des oscillations à la Lotka-Volterra.  </span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a>Le profil de la dynamique de la population sans prédateurs est similaire au modèle avec seulement les proies et la migration assymétrique. On verra dans la suite que ces deux modèles sont complètement confondus (sans prédateurs). </span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a><span class="fu">## Espace d'état</span></span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a>Pour tracer l'espace d'état on pose toutes les variations égales à $0$ (situation d'équilibre) :   </span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-161"><a href="#cb18-161" aria-hidden="true" tabindex="-1"></a>0 = r_xx^*\left(1-\frac{x^*}{K_x}\right)+\beta\left(\frac{y^*}{\gamma_y}-\frac{x^*}{\gamma_x}\right)-p_xx^*z^* <span class="sc">\\</span></span>
<span id="cb18-162"><a href="#cb18-162" aria-hidden="true" tabindex="-1"></a>0 = r_yy^*\left(1-\frac{y^*}{K_y}\right)+\beta\left(\frac{x^*}{\gamma_x}-\frac{y^*}{\gamma_y}\right)-p_yy^*z^* <span class="sc">\\</span></span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true" tabindex="-1"></a>0 = z^*\left(n_xx^*+n_yy^* - m\right)</span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true" tabindex="-1"></a>$${#eq-pdpaug}</span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true" tabindex="-1"></a>qui devient :  </span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true" tabindex="-1"></a>z^* = \frac{r_x}{p_x}\left(1-\frac{x^*}{K_x}\right)+\frac{\beta}{p_xx^*}\left(\frac{y^*}{\gamma_y}-\frac{x^*}{\gamma_x}\right)<span class="sc">\\</span></span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true" tabindex="-1"></a>z^* = \frac{r_y}{p_y}\left(1-\frac{y^*}{K_y}\right)+\frac{\beta}{p_yy^*}\left(\frac{x^*}{\gamma_x}-\frac{y^*}{\gamma_y}\right)<span class="sc">\\</span></span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true" tabindex="-1"></a>z^*=0 \lor n_xx^*+n_yy^*=m</span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true" tabindex="-1"></a>$${#eq-pdpaug2}  </span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true" tabindex="-1"></a>On se retrouve avec deux surfaces et deux plans dont les intersections seront les équilibres. Voyons ceci avec une animation :</span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-180"><a href="#cb18-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-181"><a href="#cb18-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb18-182"><a href="#cb18-182" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> IPython.display <span class="im">as</span> display</span>
<span id="cb18-183"><a href="#cb18-183" aria-hidden="true" tabindex="-1"></a>fig01 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb18-184"><a href="#cb18-184" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;iframe width="700" height="550" src="https://www.geogebra.org/classic/bw3wqnzg" style="border: 1px solid black"&gt;&lt;/iframe&gt;</span></span>
<span id="cb18-185"><a href="#cb18-185" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb18-186"><a href="#cb18-186" aria-hidden="true" tabindex="-1"></a>display.HTML(fig01)</span>
<span id="cb18-187"><a href="#cb18-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-188"><a href="#cb18-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-189"><a href="#cb18-189" aria-hidden="true" tabindex="-1"></a>En vert on a l'intersection entre la surface définie par $\dot x =0$ et les plans $z=0$ et $n_xx+n_yy=m$.  </span>
<span id="cb18-190"><a href="#cb18-190" aria-hidden="true" tabindex="-1"></a>En rouge on a l'intersection entre la surface définie par $\dot y =0$ et les plans $z=0$ et $n_xx+n_yy=m$.</span>
<span id="cb18-191"><a href="#cb18-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-192"><a href="#cb18-192" aria-hidden="true" tabindex="-1"></a>On a donc que l'intersection des courbes vertes et rouges sont les équilibres. Il est facile de voir qu'il n'en existe que trois différents dont un seul correspond à la coexistence des trois populations.  </span>
<span id="cb18-193"><a href="#cb18-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-194"><a href="#cb18-194" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calcul des équilibres </span></span>
<span id="cb18-195"><a href="#cb18-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-196"><a href="#cb18-196" aria-hidden="true" tabindex="-1"></a>Si $z=0$ alors (<span class="co">[</span><span class="ot">-@eq-modelau</span><span class="co">]</span>) devient:  </span>
<span id="cb18-197"><a href="#cb18-197" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-198"><a href="#cb18-198" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-199"><a href="#cb18-199" aria-hidden="true" tabindex="-1"></a>\dot x = r_xx(1-\frac{x}{K_x})+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)<span class="sc">\\</span></span>
<span id="cb18-200"><a href="#cb18-200" aria-hidden="true" tabindex="-1"></a>\dot y = r_yy(1-\frac{y}{K_y})+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)</span>
<span id="cb18-201"><a href="#cb18-201" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-202"><a href="#cb18-202" aria-hidden="true" tabindex="-1"></a>$$ {#eq-modamig}</span>
<span id="cb18-203"><a href="#cb18-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-204"><a href="#cb18-204" aria-hidden="true" tabindex="-1"></a>qui est exactement le système considéré précedemment. Pour l'analyse de ses équilibres se référer à <span class="co">[</span><span class="ot">ceci</span><span class="co">](modeleavecmigrationass.qmd)</span>.  </span>
<span id="cb18-205"><a href="#cb18-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-206"><a href="#cb18-206" aria-hidden="true" tabindex="-1"></a>On va donc s'intéresser uniquement à l'équilibre de coexistence qu'on notera $(x^* , y^* , z^*)$.</span>
<span id="cb18-207"><a href="#cb18-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-208"><a href="#cb18-208" aria-hidden="true" tabindex="-1"></a>Nous allons calculer pour différentes valeurs de $\beta$ les valeurs de l'équilibre et leur stabilité.  </span>
<span id="cb18-209"><a href="#cb18-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-210"><a href="#cb18-210" aria-hidden="true" tabindex="-1"></a>En effet le calcul exact de l'équilibre pour un $\beta$ quelconque est difficile, et on va donc partir de cas plus simple avant d'effectuer des simulations Python pour le cas quelconque.</span>
<span id="cb18-211"><a href="#cb18-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-212"><a href="#cb18-212" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Lorsque $\beta = 0$</span></span>
<span id="cb18-213"><a href="#cb18-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-214"><a href="#cb18-214" aria-hidden="true" tabindex="-1"></a>On définit le système (<span class="co">[</span><span class="ot">-@eq-pdpaug</span><span class="co">]</span>) par $\mathbb{F(x,y,z,\beta)}$ :</span>
<span id="cb18-215"><a href="#cb18-215" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-216"><a href="#cb18-216" aria-hidden="true" tabindex="-1"></a>\mathbb{F(x,y,z,\beta)} = \left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-217"><a href="#cb18-217" aria-hidden="true" tabindex="-1"></a>\dot x = r_xx\left(1-\frac{x}{K_x}\right)+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)-p_xxz <span class="sc">\\</span></span>
<span id="cb18-218"><a href="#cb18-218" aria-hidden="true" tabindex="-1"></a>\dot y = r_yy\left(1-\frac{y}{K_y}\right)+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)-p_yyz <span class="sc">\\</span></span>
<span id="cb18-219"><a href="#cb18-219" aria-hidden="true" tabindex="-1"></a>\dot z = z\left(n_xx+n_yy - m\right)</span>
<span id="cb18-220"><a href="#cb18-220" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-221"><a href="#cb18-221" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-222"><a href="#cb18-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-223"><a href="#cb18-223" aria-hidden="true" tabindex="-1"></a>de telle sorte que si on cherche l'équilibre pour $\beta =0$ alors on a:</span>
<span id="cb18-224"><a href="#cb18-224" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-225"><a href="#cb18-225" aria-hidden="true" tabindex="-1"></a>\mathbb{F(x^*,y^*,z^*,0)} = 0</span>
<span id="cb18-226"><a href="#cb18-226" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-227"><a href="#cb18-227" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-228"><a href="#cb18-228" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-229"><a href="#cb18-229" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-230"><a href="#cb18-230" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-231"><a href="#cb18-231" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-232"><a href="#cb18-232" aria-hidden="true" tabindex="-1"></a>0 = r_xx^*\left(1-\frac{x^*}{K_x}\right)-p_xx^*z^* <span class="sc">\\</span></span>
<span id="cb18-233"><a href="#cb18-233" aria-hidden="true" tabindex="-1"></a>0 = r_yy^*\left(1-\frac{y^*}{K_y}\right)-p_yy^*z^* <span class="sc">\\</span></span>
<span id="cb18-234"><a href="#cb18-234" aria-hidden="true" tabindex="-1"></a>0 = z^*\left(n_xx^*+n_yy^* - m\right)</span>
<span id="cb18-235"><a href="#cb18-235" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-236"><a href="#cb18-236" aria-hidden="true" tabindex="-1"></a>$${#eq-pdpb0}</span>
<span id="cb18-237"><a href="#cb18-237" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-238"><a href="#cb18-238" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-239"><a href="#cb18-239" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-240"><a href="#cb18-240" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-241"><a href="#cb18-241" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-242"><a href="#cb18-242" aria-hidden="true" tabindex="-1"></a>z^* = \frac{r_x}{p_x}\left(1-\frac{x^*}{K_x}\right) <span class="sc">\\</span></span>
<span id="cb18-243"><a href="#cb18-243" aria-hidden="true" tabindex="-1"></a>z^* = \frac{r_y}{p_y}\left(1-\frac{y^*}{K_y}\right) <span class="sc">\\</span></span>
<span id="cb18-244"><a href="#cb18-244" aria-hidden="true" tabindex="-1"></a>y^* = \frac{1}{n_y}\left(m-n_xx^*\right)</span>
<span id="cb18-245"><a href="#cb18-245" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-246"><a href="#cb18-246" aria-hidden="true" tabindex="-1"></a>$${#eq-eqpdp}</span>
<span id="cb18-247"><a href="#cb18-247" aria-hidden="true" tabindex="-1"></a>et ainsi :  </span>
<span id="cb18-248"><a href="#cb18-248" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-249"><a href="#cb18-249" aria-hidden="true" tabindex="-1"></a>\frac{r_x}{p_x}\left(1-\frac{x^*}{K_x}\right) = \frac{r_y}{p_y}\left(1-\frac{m}{n_yK_y}+\frac{n_xx^*}{n_y}\right)</span>
<span id="cb18-250"><a href="#cb18-250" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-251"><a href="#cb18-251" aria-hidden="true" tabindex="-1"></a>et donc : </span>
<span id="cb18-252"><a href="#cb18-252" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-253"><a href="#cb18-253" aria-hidden="true" tabindex="-1"></a>x^*=\frac{K_x\left(r_yp_xm+r_xn_yp_yK_y-r_yn_yp_xK_y\right)}{r_xn_yp_yK_y+r_yn_xp_xK_x}</span>
<span id="cb18-254"><a href="#cb18-254" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-255"><a href="#cb18-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-256"><a href="#cb18-256" aria-hidden="true" tabindex="-1"></a>On déduit $y^*$ et $z^*$ avec leur définition d'après (<span class="co">[</span><span class="ot">-@eq-eqpdp</span><span class="co">]</span>):</span>
<span id="cb18-257"><a href="#cb18-257" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-258"><a href="#cb18-258" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-259"><a href="#cb18-259" aria-hidden="true" tabindex="-1"></a>x^* =  \frac{K_x\left(r_yp_xm+r_xn_yp_yK_y-r_yn_yp_xK_y\right)}{r_xn_yp_yK_y+r_yn_xp_xK_x} <span class="sc">\\</span></span>
<span id="cb18-260"><a href="#cb18-260" aria-hidden="true" tabindex="-1"></a>y^* = \frac{K_y\left(r_yn_xp_xK_x+r_xp_ym - r_xn_xp_yK_x\right)}{r_xn_yp_yK_y+r_yn_xp_xK_x} <span class="sc">\\</span></span>
<span id="cb18-261"><a href="#cb18-261" aria-hidden="true" tabindex="-1"></a>z^* = r_xr_y\left(\frac{n_xK_x+n_yK_y-m}{r_xn_yp_yK_y+r_yn_xp_xK_x}\right)</span>
<span id="cb18-262"><a href="#cb18-262" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-263"><a href="#cb18-263" aria-hidden="true" tabindex="-1"></a>$${#eq-egaz}</span>
<span id="cb18-264"><a href="#cb18-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-265"><a href="#cb18-265" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb18-266"><a href="#cb18-266" aria-hidden="true" tabindex="-1"></a> Le document de @freedman1977 contient deux erreurs, un $B_1$ à la place d'un $\beta_1$ dans l'expression de $y^*$ (respectivement $x_{20}$ dans son article) et un $p_y$ à la place d'un $p_x$ dans l'expression de $z^*$ (respectivement un $\beta_2$ à la place d'un $\beta_1$</span>
<span id="cb18-267"><a href="#cb18-267" aria-hidden="true" tabindex="-1"></a> selon ses notations).</span>
<span id="cb18-268"><a href="#cb18-268" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-269"><a href="#cb18-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-270"><a href="#cb18-270" aria-hidden="true" tabindex="-1"></a>Pour que ces équilibres soient positifs il faut que :  </span>
<span id="cb18-271"><a href="#cb18-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-272"><a href="#cb18-272" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-273"><a href="#cb18-273" aria-hidden="true" tabindex="-1"></a>-\frac{mr_y}{K_yn_yp_y} &lt; \frac{r_x}{p_x} - \frac{r_y}{p_y} &lt; \frac{mr_x}{K_xn_xp_x}</span>
<span id="cb18-274"><a href="#cb18-274" aria-hidden="true" tabindex="-1"></a>$${#eq-app1}</span>
<span id="cb18-275"><a href="#cb18-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-276"><a href="#cb18-276" aria-hidden="true" tabindex="-1"></a>et</span>
<span id="cb18-277"><a href="#cb18-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-278"><a href="#cb18-278" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-279"><a href="#cb18-279" aria-hidden="true" tabindex="-1"></a>n_xK_x+n_yK_y &gt; m </span>
<span id="cb18-280"><a href="#cb18-280" aria-hidden="true" tabindex="-1"></a>$${#eq-app2}</span>
<span id="cb18-281"><a href="#cb18-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-282"><a href="#cb18-282" aria-hidden="true" tabindex="-1"></a>On verra dans la suite que (<span class="co">[</span><span class="ot">-@eq-app2</span><span class="co">]</span>) est la condition permettant l'invasion des prédateurs lorsque les proies sont à leur équilibre.</span>
<span id="cb18-283"><a href="#cb18-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-284"><a href="#cb18-284" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Lorsque $\beta \ne 0$ et petit</span></span>
<span id="cb18-285"><a href="#cb18-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-286"><a href="#cb18-286" aria-hidden="true" tabindex="-1"></a>Pour $\beta$ petit on va utiliser l'égalité de Taylor pour trouver $(x_*,y^*,z^*)$. On a alors, si on note $(x^*(\beta),y^*(\beta),z^*(\beta))$:  </span>
<span id="cb18-287"><a href="#cb18-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-288"><a href="#cb18-288" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-289"><a href="#cb18-289" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-290"><a href="#cb18-290" aria-hidden="true" tabindex="-1"></a>x^*(0) = \frac{K_x\left(r_yp_xm+r_xn_yp_yK_y-r_yn_yp_xK_y\right)}{r_xn_yp_yK_y+r_yn_xp_xK_x}<span class="sc">\\</span></span>
<span id="cb18-291"><a href="#cb18-291" aria-hidden="true" tabindex="-1"></a>y^*(0) = \frac{K_y\left(r_yn_xp_xK_x+r_xp_ym - r_xn_xp_yK_x\right)}{r_xn_yp_yK_y+r_yn_xp_xK_x}<span class="sc">\\</span></span>
<span id="cb18-292"><a href="#cb18-292" aria-hidden="true" tabindex="-1"></a>z^*(0) = r_xr_y\left(\frac{n_xK_x+n_yK_y-m}{r_xn_yp_yK_y+r_yn_xp_xK_x}\right)</span>
<span id="cb18-293"><a href="#cb18-293" aria-hidden="true" tabindex="-1"></a>\end{array}\right. <span class="sc">\\</span></span>
<span id="cb18-294"><a href="#cb18-294" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-295"><a href="#cb18-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-296"><a href="#cb18-296" aria-hidden="true" tabindex="-1"></a>Soit $\mathbb{F(x,y,z,\beta)}$ tel que :</span>
<span id="cb18-297"><a href="#cb18-297" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-298"><a href="#cb18-298" aria-hidden="true" tabindex="-1"></a>\mathbb{F(x,y,z,\beta)} = \left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-299"><a href="#cb18-299" aria-hidden="true" tabindex="-1"></a>r_xx\left(1-\frac{x}{K_x}\right)+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)-p_xxz <span class="sc">\\</span></span>
<span id="cb18-300"><a href="#cb18-300" aria-hidden="true" tabindex="-1"></a>r_yy\left(1-\frac{y}{K_y}\right)+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)-p_yyz <span class="sc">\\</span></span>
<span id="cb18-301"><a href="#cb18-301" aria-hidden="true" tabindex="-1"></a>z\left(n_xx+n_yy - m\right)</span>
<span id="cb18-302"><a href="#cb18-302" aria-hidden="true" tabindex="-1"></a>\end{array}\right. <span class="sc">\\</span></span>
<span id="cb18-303"><a href="#cb18-303" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-304"><a href="#cb18-304" aria-hidden="true" tabindex="-1"></a>On veut ainsi résoudre : </span>
<span id="cb18-305"><a href="#cb18-305" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb18-306"><a href="#cb18-306" aria-hidden="true" tabindex="-1"></a>\mathbb{F\left(\mathcal{x}^*(\beta) , \mathcal{y}^*(\beta) , \mathcal{z}^*(\beta) , \beta\right)}=0</span>
<span id="cb18-307"><a href="#cb18-307" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-308"><a href="#cb18-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-309"><a href="#cb18-309" aria-hidden="true" tabindex="-1"></a>or, d'après la formule de Taylor on a à l'ordre 1 en dimension 4 on a: </span>
<span id="cb18-310"><a href="#cb18-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-311"><a href="#cb18-311" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-312"><a href="#cb18-312" aria-hidden="true" tabindex="-1"></a>\mathbb{F\left(\mathcal{x}^*(\beta) , \mathcal{y}^*(\beta) , \mathcal{z}^*(\beta) , \beta\right)}=\mathbb{F\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) , \mathcal{0}\right)} + <span class="sc">\\</span> </span>
<span id="cb18-313"><a href="#cb18-313" aria-hidden="true" tabindex="-1"></a>\frac{\partial \mathbb{F}}{\partial \beta}\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) , \mathcal{0}\right)\beta + \mathbb{J}\tiny{\mathbb{F\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) ,\mathcal{0}\right)}}\small\begin{pmatrix} \mathcal{x}^*(\beta) - \mathcal{x}^*(\mathcal{0}) \\ \mathcal{y}^*(\beta) - \mathcal{y}^*(\mathcal{0}) \\ \mathcal{z}^*(\beta) - \mathcal{z}^*(\mathcal{0}) \end{pmatrix} + o(\beta)</span>
<span id="cb18-314"><a href="#cb18-314" aria-hidden="true" tabindex="-1"></a>$${#eq-taylor}</span>
<span id="cb18-315"><a href="#cb18-315" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-316"><a href="#cb18-316" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-317"><a href="#cb18-317" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-318"><a href="#cb18-318" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-319"><a href="#cb18-319" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix} \mathcal{x}^*(\beta) \\ \mathcal{y}^*(\beta) \\ \mathcal{z}^*(\beta) \end{pmatrix} = </span>
<span id="cb18-320"><a href="#cb18-320" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix} \mathcal{x}^*(\mathcal{0}) \\  \mathcal{y}^*(\mathcal{0}) \\  \mathcal{z}^*(\mathcal{0}) \end{pmatrix} - \mathbb{J^{\mathcal{-1}}}\tiny{\mathbb{F\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) ,\mathcal{0}\right)}} \small\frac{\partial \mathbb{F}}{\partial \beta}\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) , \mathcal{0}\right)\beta + o(\beta)</span>
<span id="cb18-321"><a href="#cb18-321" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-322"><a href="#cb18-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-323"><a href="#cb18-323" aria-hidden="true" tabindex="-1"></a>On a, $\frac{\partial \mathbb{F}}{\partial \beta}\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) , \mathcal{0}\right)\beta = \begin{pmatrix} -\frac{\mathcal{x}^*(\mathcal{0})}{\gamma_x}+\frac{\mathcal{y}^*(\mathcal{0})}{\gamma_y}\\\frac{\mathcal{x}^*(\mathcal{0})}{\gamma_x}-\frac{\mathcal{y}^*(\mathcal{0})}{\gamma_y}<span class="sc">\\</span> 0\end{pmatrix}$ .</span>
<span id="cb18-324"><a href="#cb18-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-325"><a href="#cb18-325" aria-hidden="true" tabindex="-1"></a>et,</span>
<span id="cb18-326"><a href="#cb18-326" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-327"><a href="#cb18-327" aria-hidden="true" tabindex="-1"></a>\mathbb{J}\small{\mathbb{F\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) ,\mathcal{0}\right)}} = </span>
<span id="cb18-328"><a href="#cb18-328" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix} -\frac{r_xx^*(0)}{K_x} &amp; 0 &amp; -p_xx^*(0) \\ 0 &amp; -\frac{r_yy^*(0)}{K_y} &amp; -p_yy^*(0) \\ n_xz^*(0) &amp; n_yz^*(0) &amp; 0 \end{pmatrix}</span>
<span id="cb18-329"><a href="#cb18-329" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-330"><a href="#cb18-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-331"><a href="#cb18-331" aria-hidden="true" tabindex="-1"></a>il est alors facile de calculer que,</span>
<span id="cb18-332"><a href="#cb18-332" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-333"><a href="#cb18-333" aria-hidden="true" tabindex="-1"></a>det(\mathbb{J}) = -x^*(0)y^*(0)z^*(0)\left(\frac{r_xn_yp_y}{K_x}+\frac{r_yn_xp_x}{K_y}\right) \ne 0</span>
<span id="cb18-334"><a href="#cb18-334" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-335"><a href="#cb18-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-336"><a href="#cb18-336" aria-hidden="true" tabindex="-1"></a>La jacobienne est donc bien inversible et on peut la calculer (méthode des cofacteurs) ce qui donne : </span>
<span id="cb18-337"><a href="#cb18-337" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-338"><a href="#cb18-338" aria-hidden="true" tabindex="-1"></a>\mathbb{J^{\mathcal{-1}}}\tiny{\mathbb{F\left(\mathcal{x}^*(\mathcal{0}) , \mathcal{y}^*(\mathcal{0}) , \mathcal{z}^*(\mathcal{0}) ,\mathcal{0}\right)}} =\small \frac{1}{\frac{r_xp_yn_y}{K_x}+\frac{r_yp_xn_x}{K_y}} \begin{pmatrix} -\frac{p_yn_y}{x^*(0)} &amp; \frac{p_xn_y}{y^*(0)} &amp; \frac{r_yp_x}{z^*(0)K_y} \\ \frac{p_yn_x}{x^*(0)} &amp; -\frac{p_xn_x}{y^*(0)} &amp; \frac{r_xp_y}{z^*(0)K_x} \\ -\frac{r_yn_x}{x^*(0)K_y} &amp; -\frac{r_xn_y}{y^*(0)K_x}&amp; -\frac{r_xr_y}{z^*(0)K_xK_y} \end{pmatrix}</span>
<span id="cb18-339"><a href="#cb18-339" aria-hidden="true" tabindex="-1"></a>$${#eq-jacinv}</span>
<span id="cb18-340"><a href="#cb18-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-341"><a href="#cb18-341" aria-hidden="true" tabindex="-1"></a>En mettant en œuvre le calcul on trouve :</span>
<span id="cb18-342"><a href="#cb18-342" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-343"><a href="#cb18-343" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-344"><a href="#cb18-344" aria-hidden="true" tabindex="-1"></a>x^*(\beta) = x^*(0) - \frac{\beta n_yK_xK_y\left(\frac{y^*(0)}{\gamma_y}-\frac{x^*(0)}{\gamma_x}\right)\left(\frac{p_y}{x^*(0)}+\frac{p_x}{y^*(0)}\right)}{K_yr_xp_yn_y + K_xr_yp_xn_x} + o(\beta)<span class="sc">\\</span></span>
<span id="cb18-345"><a href="#cb18-345" aria-hidden="true" tabindex="-1"></a>y^*(\beta) = y^*(0) - \frac{\beta n_xK_xK_y\left(\frac{y^*(0)}{\gamma_y}-\frac{x^*(0)}{\gamma_x}\right)\left(\frac{p_y}{x^*(0)}+\frac{p_x}{y^*(0)}\right)}{K_yr_xp_yn_y + K_xr_yp_xn_x} + o(\beta)<span class="sc">\\</span></span>
<span id="cb18-346"><a href="#cb18-346" aria-hidden="true" tabindex="-1"></a>z^*(\beta) = z^*(0) - \frac{\beta K_xK_y\left(\frac{y^*(0)}{\gamma_y}-\frac{x^*(0)}{\gamma_x}\right)\left(\frac{r_xn-y}{y^*(0)K_x}-\frac{r_yn_x}{x^*(0)K_y}\right)}{K_yr_xp_yn_y + K_xr_yp_xn_x} + o(\beta)</span>
<span id="cb18-347"><a href="#cb18-347" aria-hidden="true" tabindex="-1"></a>\end{array}\right.<span class="sc">\\</span></span>
<span id="cb18-348"><a href="#cb18-348" aria-hidden="true" tabindex="-1"></a>$${#eq-equbpetit}</span>
<span id="cb18-349"><a href="#cb18-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-350"><a href="#cb18-350" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Lorsque $\beta$ est quelconque </span></span>
<span id="cb18-351"><a href="#cb18-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-352"><a href="#cb18-352" aria-hidden="true" tabindex="-1"></a>(<span class="co">[</span><span class="ot">-@eq-pdpaug</span><span class="co">]</span>) donne, en exprimant $y^*$ en fonction de $x^*$:</span>
<span id="cb18-353"><a href="#cb18-353" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-354"><a href="#cb18-354" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-355"><a href="#cb18-355" aria-hidden="true" tabindex="-1"></a>z^* =  \frac{r_x}{p_x}\left(1-\frac{x^*}{K_x}\right) + \frac{\beta}{p_x}\left(\frac{m}{n_y\gamma_y x^*}-\frac{n_x}{n_y\gamma_y}-\frac{1}{\gamma_x}\right)   <span class="sc">\\</span></span>
<span id="cb18-356"><a href="#cb18-356" aria-hidden="true" tabindex="-1"></a>z^* = \frac{r_y}{p_y}\left(1-\frac{m-n_xx^*}{n_yK_y}\right) + \frac{\beta n_y}{p_y}\left(\frac{x^*}{\gamma_x\left(m-n_xx^*\right)}-\frac{1}{n_y\gamma_y}\right) <span class="sc">\\</span></span>
<span id="cb18-357"><a href="#cb18-357" aria-hidden="true" tabindex="-1"></a>y^* =\frac{1}{n_y}\left(m- n_xx^*\right)</span>
<span id="cb18-358"><a href="#cb18-358" aria-hidden="true" tabindex="-1"></a>\end{array}\right. </span>
<span id="cb18-359"><a href="#cb18-359" aria-hidden="true" tabindex="-1"></a>$${#eq-systpdp}</span>
<span id="cb18-360"><a href="#cb18-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-361"><a href="#cb18-361" aria-hidden="true" tabindex="-1"></a>On trouve $x^*$ en faisant l'intersection entre les deux premières équations, on trouve $y^*$ avec la troisième équation et $z^*$ avec la première équation.</span>
<span id="cb18-362"><a href="#cb18-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-363"><a href="#cb18-363" aria-hidden="true" tabindex="-1"></a>Pour calculer l'équilibre on utilise <span class="in">`numpy`</span>:</span>
<span id="cb18-364"><a href="#cb18-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-367"><a href="#cb18-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-368"><a href="#cb18-368" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb18-369"><a href="#cb18-369" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul de x*:</span></span>
<span id="cb18-370"><a href="#cb18-370" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>np.polynomial.Polynomial([<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb18-371"><a href="#cb18-371" aria-hidden="true" tabindex="-1"></a><span class="co">#Polynome :</span></span>
<span id="cb18-372"><a href="#cb18-372" aria-hidden="true" tabindex="-1"></a>pol1<span class="op">=</span> (m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">*</span>x<span class="op">*</span>rx1<span class="op">/</span>px1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx1) <span class="op">+</span> (m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">*</span>b1<span class="op">/</span>px1<span class="op">*</span>((m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">/</span>(ny1<span class="op">*</span>gy1) <span class="op">-</span> x<span class="op">/</span>gx1) <span class="op">-</span> (m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">*</span>x<span class="op">*</span>ry1<span class="op">/</span>py1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>(m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">/</span>(ny1<span class="op">*</span>Ky1)) <span class="op">-</span> x<span class="op">*</span>b1<span class="op">*</span>ny1<span class="op">/</span>py1<span class="op">*</span>(x<span class="op">/</span>gx1 <span class="op">-</span> (m1<span class="op">-</span>nx1<span class="op">*</span>x)<span class="op">/</span>(ny1<span class="op">*</span>gy1))</span>
<span id="cb18-373"><a href="#cb18-373" aria-hidden="true" tabindex="-1"></a><span class="co">#On utilise un masque booléen adapté à la situation --&gt; solution réelle, positive et qui vérifie la condtion imposée par la troisième équation du système:</span></span>
<span id="cb18-374"><a href="#cb18-374" aria-hidden="true" tabindex="-1"></a>solx<span class="op">=</span>pol1.roots()[(np.isreal(pol1.roots())) <span class="op">*</span>(pol1.roots() <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">*</span>(pol1.roots()<span class="op">&lt;</span>m1<span class="op">/</span>ny1)]</span>
<span id="cb18-375"><a href="#cb18-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-376"><a href="#cb18-376" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul de y*:</span></span>
<span id="cb18-377"><a href="#cb18-377" aria-hidden="true" tabindex="-1"></a>soly<span class="op">=</span><span class="dv">1</span><span class="op">/</span>ny1<span class="op">*</span>(m1<span class="op">-</span>nx1<span class="op">*</span>solx)</span>
<span id="cb18-378"><a href="#cb18-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-379"><a href="#cb18-379" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul de z*:</span></span>
<span id="cb18-380"><a href="#cb18-380" aria-hidden="true" tabindex="-1"></a>solz<span class="op">=</span>rx1<span class="op">/</span>px1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>solx<span class="op">/</span>Kx1) <span class="op">+</span> b1<span class="op">/</span>px1<span class="op">*</span>(m1<span class="op">/</span>(ny1<span class="op">*</span>gy1<span class="op">*</span>solx) <span class="op">-</span>nx1<span class="op">/</span>(ny1<span class="op">*</span>gy1)<span class="op">-</span> <span class="dv">1</span><span class="op">/</span>gx1)</span>
<span id="cb18-381"><a href="#cb18-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-382"><a href="#cb18-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-383"><a href="#cb18-383" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stabilité des équilibres</span></span>
<span id="cb18-384"><a href="#cb18-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-385"><a href="#cb18-385" aria-hidden="true" tabindex="-1"></a>Sans prédateurs ($z=0$) on a les mêmes équilibres que dans la partie précédente, la stabilité est donc la même que dans la partie précédente. </span>
<span id="cb18-386"><a href="#cb18-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-387"><a href="#cb18-387" aria-hidden="true" tabindex="-1"></a>On va calculer pour différentes valeurs de $\beta$ la stabilité.</span>
<span id="cb18-388"><a href="#cb18-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-389"><a href="#cb18-389" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Lorsque $\beta=0$  </span></span>
<span id="cb18-390"><a href="#cb18-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-391"><a href="#cb18-391" aria-hidden="true" tabindex="-1"></a>La jacobienne du système est:</span>
<span id="cb18-392"><a href="#cb18-392" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb18-393"><a href="#cb18-393" aria-hidden="true" tabindex="-1"></a>\mathbb{J_{\mathcal{x^*_2},\mathcal{y^*_2},\mathcal{z^*_2},\mathcal{0}}}  =  \begin{pmatrix} -\frac{r_xx_2^*(0)}{K_x} &amp; 0 &amp; -p_xx_2^*(0) \\ 0 &amp; -\frac{r_yy_2^*(0)}{K_y} &amp; -p_yy_2^*(0) \\ n_xz_2^*(0) &amp; n_yz_2^*(0) &amp; 0 \end{pmatrix}</span>
<span id="cb18-394"><a href="#cb18-394" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-395"><a href="#cb18-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-396"><a href="#cb18-396" aria-hidden="true" tabindex="-1"></a>En calculant le polynôme caractéristique on en déduit que toutes les parties réelles des valeurs propres sont négatives et que donc l'équilibre est stable. </span>
<span id="cb18-397"><a href="#cb18-397" aria-hidden="true" tabindex="-1"></a>*La preuve est faite par Freedman dans son [théorème 4.1](https://epubs.siam.org/doi/10.1137/0132052).*</span>
<span id="cb18-398"><a href="#cb18-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-399"><a href="#cb18-399" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Lorsque $\beta \ne 0$ et $\beta$ petit  </span></span>
<span id="cb18-400"><a href="#cb18-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-401"><a href="#cb18-401" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb18-402"><a href="#cb18-402" aria-hidden="true" tabindex="-1"></a>\mathbb{J_{\mathcal{x^*},\mathcal{y^*},\mathcal{z^*},\mathcal{\beta}}}  =  \begin{pmatrix} -\frac{r_xx^*(0)}{K_x} -\frac{\beta}{\gamma_x} &amp; \frac{\beta}{\gamma_y} &amp; -p_xx^*(0) \\ \frac{\beta}{\gamma_x} &amp; -\frac{r_yy^*(0)}{K_y}-\frac{\beta}{\gamma_y} &amp; -p_yy^*(0) \\ n_xz^*(0) &amp; n_yz^*(0) &amp; 0 \end{pmatrix} = \mathbb{J_{\mathcal{x^*},\mathcal{y^*},\mathcal{z^*},\mathcal{0}}} + \beta \begin{pmatrix} -\frac{1}{\gamma_x} &amp; \frac{1}{\gamma_y} &amp; 0 <span class="sc">\\</span> \frac{1}{\gamma_x} &amp; -\frac{1}{\gamma_y} &amp; 0 <span class="sc">\\</span> 0 &amp; 0 &amp; 0 \end{pmatrix}</span>
<span id="cb18-403"><a href="#cb18-403" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-404"><a href="#cb18-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-405"><a href="#cb18-405" aria-hidden="true" tabindex="-1"></a>Comme $\beta$ est petit on a la matrice qui est petite et qui n'influence pas le signe des valeurs propres. Donc l'équilibre est encore stable.</span>
<span id="cb18-406"><a href="#cb18-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-407"><a href="#cb18-407" aria-hidden="true" tabindex="-1"></a><span class="fu">## Equilibres en fonction des paramètres du modèle simplifié</span></span>
<span id="cb18-408"><a href="#cb18-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-409"><a href="#cb18-409" aria-hidden="true" tabindex="-1"></a>Dans cette partie on va distinguer les cas où $n_x = n_y$ et $p_x=p_y$ de ceux où ils sont différents.   </span>
<span id="cb18-410"><a href="#cb18-410" aria-hidden="true" tabindex="-1"></a>En effet, l'un des postulats de l'augmentorium est que le développement des ravageurs et prédateurs est favorisé dans celui-ci mais on peut supposer que la prédation et les naissances dans l'augmentorium sont égales.  </span>
<span id="cb18-411"><a href="#cb18-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-412"><a href="#cb18-412" aria-hidden="true" tabindex="-1"></a>Il est intéressant de considérer la somme des équilibre des proies en fonction de la force de migration ($\beta$) et les équilibres dans la culture en fonction du taux de fuite ($\gamma_y$) et du taux de migration ($\gamma_x$).</span>
<span id="cb18-413"><a href="#cb18-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-414"><a href="#cb18-414" aria-hidden="true" tabindex="-1"></a>Dans ce cas (<span class="co">[</span><span class="ot">-@eq-modelau</span><span class="co">]</span>) devient : </span>
<span id="cb18-415"><a href="#cb18-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-416"><a href="#cb18-416" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb18-417"><a href="#cb18-417" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-418"><a href="#cb18-418" aria-hidden="true" tabindex="-1"></a>\dot x = r_xx\left(1-\frac{x}{K_x}\right)+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)-pxz <span class="sc">\\</span></span>
<span id="cb18-419"><a href="#cb18-419" aria-hidden="true" tabindex="-1"></a>\dot y = r_yy\left(1-\frac{y}{K_y}\right)+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)-pyz <span class="sc">\\</span></span>
<span id="cb18-420"><a href="#cb18-420" aria-hidden="true" tabindex="-1"></a>\dot z = z\left(n\left(x+y\right) - m\right)</span>
<span id="cb18-421"><a href="#cb18-421" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-422"><a href="#cb18-422" aria-hidden="true" tabindex="-1"></a>$$ {#eq-modelaueg}</span>
<span id="cb18-423"><a href="#cb18-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-424"><a href="#cb18-424" aria-hidden="true" tabindex="-1"></a><span class="fu">### Somme des équilibres des proies en fonction de $\beta$</span></span>
<span id="cb18-425"><a href="#cb18-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-426"><a href="#cb18-426" aria-hidden="true" tabindex="-1"></a>A l'équilibre, on a : </span>
<span id="cb18-427"><a href="#cb18-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-428"><a href="#cb18-428" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb18-429"><a href="#cb18-429" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-430"><a href="#cb18-430" aria-hidden="true" tabindex="-1"></a>0 = r_xx^*\left(1-\frac{x^*}{K_x}\right)+\beta\left(\frac{y^*}{\gamma_y}-\frac{x^*}{\gamma_x}\right)-px^*z^* <span class="sc">\\</span></span>
<span id="cb18-431"><a href="#cb18-431" aria-hidden="true" tabindex="-1"></a>0 = r_yy^*\left(1-\frac{y^*}{K_y}\right)+\beta\left(\frac{x^*}{\gamma_x}-\frac{y^*}{\gamma_y}\right)-py^*z^* <span class="sc">\\</span></span>
<span id="cb18-432"><a href="#cb18-432" aria-hidden="true" tabindex="-1"></a>x^*+y^* = \frac{m}{n}</span>
<span id="cb18-433"><a href="#cb18-433" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-434"><a href="#cb18-434" aria-hidden="true" tabindex="-1"></a>$${#eq-modelsat}</span>
<span id="cb18-435"><a href="#cb18-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-436"><a href="#cb18-436" aria-hidden="true" tabindex="-1"></a>On voit, avec la troisième équation du système, que la somme des équilibres des proies est toujours égale à $\frac{m}{n}$ quelque soit $\beta$ du moment que les prédateurs sont présents. </span>
<span id="cb18-437"><a href="#cb18-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-438"><a href="#cb18-438" aria-hidden="true" tabindex="-1"></a>Intuitivement on considère que la présence d'un équilibre des prédateurs positifs (invasion des prédateurs) est soumise à la condition que pour une population aussi petite soit elle de prédateurs ($z \to 0$) et pour les proies à l'équilibre on ait un taux de croissance positif pour les prédateurs.   </span>
<span id="cb18-439"><a href="#cb18-439" aria-hidden="true" tabindex="-1"></a>Mathématiquement cette hypothèse est équivalente à la condition, si on note $(x_0^*(\beta),y^*_0(\beta))$ l'équilibre sans prédateurs pour un taux $\beta$, que $x_0^* + y_0^* &gt; \frac{m}{n} \Leftrightarrow \exists z^* \ne 0$.  </span>
<span id="cb18-440"><a href="#cb18-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-441"><a href="#cb18-441" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Pour $\beta = 0$** on a que s'il existe un équilibre des prédateurs positif alors on a $K_x+K_y&gt;\frac{m}{n}$ par l'égalité (<span class="co">[</span><span class="ot">-@eq-egaz</span><span class="co">]</span>). Ceci est donc la condition d'invasion des prédateurs (<span class="co">[</span><span class="ot">-@eq-app2</span><span class="co">]</span>) mentionnée plus tôt.  </span>
<span id="cb18-442"><a href="#cb18-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-443"><a href="#cb18-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-444"><a href="#cb18-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-445"><a href="#cb18-445" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Si $\beta = \infty$**on va réduire le système (<span class="co">[</span><span class="ot">-@eq-modelaueg</span><span class="co">]</span>) en équation de Lotka-Volterra avec croissance logistique. Ainsi la présence d'un équilibre des prédateurs sera équivalente à la condition d'invasion supposée .</span>
<span id="cb18-446"><a href="#cb18-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-447"><a href="#cb18-447" aria-hidden="true" tabindex="-1"></a>La démarche (d'après @arditi2018) à partir du système (<span class="co">[</span><span class="ot">-@eq-modelaueg</span><span class="co">]</span>) est la suivante :</span>
<span id="cb18-448"><a href="#cb18-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-449"><a href="#cb18-449" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-450"><a href="#cb18-450" aria-hidden="true" tabindex="-1"></a>\frac{\dot x}{\gamma_x} - \frac{\dot y}{\gamma_y} = \frac{r_x}{\gamma_x}x\left(1-\frac{x}{K_x}\right) - \frac{r_y}{\gamma_y}y\left(1-\frac{y}{K_y}\right) + pz\left(y-x\right) -\frac{\beta}{\gamma_x} \left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right) -\frac{\beta}{\gamma_y} \left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)</span>
<span id="cb18-451"><a href="#cb18-451" aria-hidden="true" tabindex="-1"></a>$${#eq-beta}</span>
<span id="cb18-452"><a href="#cb18-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-453"><a href="#cb18-453" aria-hidden="true" tabindex="-1"></a>Quand $\beta \to \infty$, $\frac{\dot x}{\gamma_x} - \frac{\dot y}{\gamma_y}$ devient après simplification :</span>
<span id="cb18-454"><a href="#cb18-454" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-455"><a href="#cb18-455" aria-hidden="true" tabindex="-1"></a>\frac{\dot x}{\gamma_x} - \frac{\dot y}{\gamma_y} = -\beta\left(\frac{1}{\gamma_x}+\frac{1}{\gamma_y}\right)\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)</span>
<span id="cb18-456"><a href="#cb18-456" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-457"><a href="#cb18-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-458"><a href="#cb18-458" aria-hidden="true" tabindex="-1"></a>et donc on a forcément que $\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right) \to 0$ ie que $\frac{x}{\gamma_x} = \frac{y}{\gamma_y}$.</span>
<span id="cb18-459"><a href="#cb18-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-460"><a href="#cb18-460" aria-hidden="true" tabindex="-1"></a>On pose $N = x+y$ qui est, avec l'assertion précédente, équivalent à </span>
<span id="cb18-461"><a href="#cb18-461" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-462"><a href="#cb18-462" aria-hidden="true" tabindex="-1"></a>\frac{N}{\gamma_x+\gamma_y} = \frac{x+y}{\gamma_x+\gamma_y} = \frac{\frac{x\gamma_x}{\gamma_x}+\frac{y\gamma_y}{\gamma_y}}{\gamma_x+\gamma_y} = \frac{x}{\gamma_x} = \frac{y}{\gamma_y}</span>
<span id="cb18-463"><a href="#cb18-463" aria-hidden="true" tabindex="-1"></a>$${#eq-sommeq}</span>
<span id="cb18-464"><a href="#cb18-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-465"><a href="#cb18-465" aria-hidden="true" tabindex="-1"></a>On a ainsi :</span>
<span id="cb18-466"><a href="#cb18-466" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-467"><a href="#cb18-467" aria-hidden="true" tabindex="-1"></a>\dot N = \dot x + \dot y = \frac{r_xx\gamma_x}{\gamma_x}\left(1-\frac{x}{K_x}\right) + \frac{r_yy\gamma_y}{\gamma_y}\left(1-\frac{y}{K_y}\right)-pzN</span>
<span id="cb18-468"><a href="#cb18-468" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-469"><a href="#cb18-469" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-470"><a href="#cb18-470" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-471"><a href="#cb18-471" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-472"><a href="#cb18-472" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-473"><a href="#cb18-473" aria-hidden="true" tabindex="-1"></a>\dot N = \frac{r_xN\gamma_x}{\gamma_x+\gamma_y}\left(1-\frac{x}{K_x}\right) + \frac{r_yN\gamma_y}{\gamma_x+\gamma_y}\left(1-\frac{y}{K_y}\right)-pzN</span>
<span id="cb18-474"><a href="#cb18-474" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-475"><a href="#cb18-475" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-476"><a href="#cb18-476" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-477"><a href="#cb18-477" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-478"><a href="#cb18-478" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-479"><a href="#cb18-479" aria-hidden="true" tabindex="-1"></a>\dot N = \left(\frac{r_x\gamma_x+r_y\gamma_y}{\gamma_x+\gamma_y}\right)N\left(1-\frac{\frac{r_x\gamma_x^2}{K_x}+\frac{r_y\gamma_y^2}{K_y}}{(\gamma_x+\gamma_y)^2(r_x\gamma_x+r_y\gamma_y)}N\right)-pzN</span>
<span id="cb18-480"><a href="#cb18-480" aria-hidden="true" tabindex="-1"></a>$${#eq-ndot}</span>
<span id="cb18-481"><a href="#cb18-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-482"><a href="#cb18-482" aria-hidden="true" tabindex="-1"></a>En posant $r_N = \left(\frac{r_x\gamma_x+r_y\gamma_y}{\gamma_x+\gamma_y}\right)$ et $K_N=\frac{(\gamma_x+\gamma_y)^2(r_x\gamma_x+r_y\gamma_y)}{\frac{r_x\gamma_x^2}{K_x}+\frac{r_y\gamma_y^2}{K_y}}$</span>
<span id="cb18-483"><a href="#cb18-483" aria-hidden="true" tabindex="-1"></a>le système devient : </span>
<span id="cb18-484"><a href="#cb18-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-485"><a href="#cb18-485" aria-hidden="true" tabindex="-1"></a>$$ \left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-486"><a href="#cb18-486" aria-hidden="true" tabindex="-1"></a>\dot N = r_NN\left(1-\frac{N}{K_N}\right)-pzN <span class="sc">\\</span></span>
<span id="cb18-487"><a href="#cb18-487" aria-hidden="true" tabindex="-1"></a>\dot z = z\left(nN - m\right)</span>
<span id="cb18-488"><a href="#cb18-488" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-489"><a href="#cb18-489" aria-hidden="true" tabindex="-1"></a>$$ {#eq-modelaueg2}</span>
<span id="cb18-490"><a href="#cb18-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-491"><a href="#cb18-491" aria-hidden="true" tabindex="-1"></a>qui est bien un système de L-V avec croissance logistique.</span>
<span id="cb18-492"><a href="#cb18-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-493"><a href="#cb18-493" aria-hidden="true" tabindex="-1"></a>Si $\exists z^* &gt; 0$ alors on a $N^*=\frac{m}{n}$.  </span>
<span id="cb18-494"><a href="#cb18-494" aria-hidden="true" tabindex="-1"></a>De plus, on a : $pz^* = r_N\left(1-\frac{N^*}{K_N}\right)$ et donc si $z^*&gt;0$ on a $N^* &lt; K_N$ qui est équivalent à $\frac{m}{n} &lt; K_N$. </span>
<span id="cb18-495"><a href="#cb18-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-496"><a href="#cb18-496" aria-hidden="true" tabindex="-1"></a>Si on considère le système précédent sans prédateurs on a : </span>
<span id="cb18-497"><a href="#cb18-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-498"><a href="#cb18-498" aria-hidden="true" tabindex="-1"></a>$$ \left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-499"><a href="#cb18-499" aria-hidden="true" tabindex="-1"></a>\dot N_0 = r_NN_0\left(1-\frac{N_0}{K_N}\right)</span>
<span id="cb18-500"><a href="#cb18-500" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-501"><a href="#cb18-501" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-502"><a href="#cb18-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-503"><a href="#cb18-503" aria-hidden="true" tabindex="-1"></a>et on a donc $N_0^* = K_N$.</span>
<span id="cb18-504"><a href="#cb18-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-505"><a href="#cb18-505" aria-hidden="true" tabindex="-1"></a>Or, posons la condition mathématique intuitive : </span>
<span id="cb18-506"><a href="#cb18-506" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-507"><a href="#cb18-507" aria-hidden="true" tabindex="-1"></a>x^*_0(+\infty)+y^*_0(+\infty) &gt; \frac{m}{n}</span>
<span id="cb18-508"><a href="#cb18-508" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-509"><a href="#cb18-509" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-510"><a href="#cb18-510" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-511"><a href="#cb18-511" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-512"><a href="#cb18-512" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-513"><a href="#cb18-513" aria-hidden="true" tabindex="-1"></a>\frac{x^*_0(+\infty)\gamma_x}{\gamma_x}+\frac{y^*_0(+\infty)\gamma_y}{\gamma_y} &gt; \frac{m}{n}</span>
<span id="cb18-514"><a href="#cb18-514" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-515"><a href="#cb18-515" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-516"><a href="#cb18-516" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-517"><a href="#cb18-517" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-518"><a href="#cb18-518" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-519"><a href="#cb18-519" aria-hidden="true" tabindex="-1"></a>\frac{N_0^*(+\infty)\gamma_x}{\gamma_x+\gamma_y}+\frac{N^*_0(+\infty)\gamma_y}{\gamma_x+\gamma_y} &gt; \frac{m}{n}</span>
<span id="cb18-520"><a href="#cb18-520" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-521"><a href="#cb18-521" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-522"><a href="#cb18-522" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-523"><a href="#cb18-523" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-524"><a href="#cb18-524" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-525"><a href="#cb18-525" aria-hidden="true" tabindex="-1"></a>K_N &gt; \frac{m}{n}</span>
<span id="cb18-526"><a href="#cb18-526" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-527"><a href="#cb18-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-528"><a href="#cb18-528" aria-hidden="true" tabindex="-1"></a>L'intuition biologique est donc confirmée par des preuves mathématiques pour $\beta=0$ et $\beta = +\infty$ ceci est suffisant pour penser que c'est vrai pour un $\beta \in ]0,+\infty[$.</span>
<span id="cb18-529"><a href="#cb18-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-530"><a href="#cb18-530" aria-hidden="true" tabindex="-1"></a>On va donc tracer les graphes de la somme des équilibres du système (<span class="co">[</span><span class="ot">-@eq-modelau</span><span class="co">]</span>) avec et sans prédateurs et constater cette saturation à \frac{m}{n} lorsque la condition $x_0^* + y_0^* &gt; \frac{m}{n}$ est validée.</span>
<span id="cb18-531"><a href="#cb18-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-532"><a href="#cb18-532" aria-hidden="true" tabindex="-1"></a>Pour cela on s'appuiera sur 3 cas selon le comportement du système sans prédateurs. On prendra en premier le cas où le système était déja déflationiste, en deuxième le cas où le système était à la fois inflationiste et déflationiste puis le cas où le système est tout le temps inflationiste.</span>
<span id="cb18-533"><a href="#cb18-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-534"><a href="#cb18-534" aria-hidden="true" tabindex="-1"></a>Ceci va permettre de comprendre le rôle de l'ajout de prédateurs.</span>
<span id="cb18-535"><a href="#cb18-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-536"><a href="#cb18-536" aria-hidden="true" tabindex="-1"></a>Pour faire nos simulations on laisse tourner le modèle <span class="co">[</span><span class="ot">précédent</span><span class="co">](modeleavecmigrationass.qmd)</span> et le modèle <span class="co">[</span><span class="ot">actuel</span><span class="co">](@eq-modelau)</span> indépendamment pour différentes valeur de $\beta$ et on trace dans les deux cas la somme des équilibres atteintes pour des temps d'intégration large.</span>
<span id="cb18-537"><a href="#cb18-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-538"><a href="#cb18-538" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Déflation du système sans prédateurs</span></span>
<span id="cb18-539"><a href="#cb18-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-540"><a href="#cb18-540" aria-hidden="true" tabindex="-1"></a>Pour plot on va simuler avec <span class="in">`odeint`</span> pendant un temps assez large pour atteindre l'équilibre :</span>
<span id="cb18-543"><a href="#cb18-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-544"><a href="#cb18-544" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True </span></span>
<span id="cb18-545"><a href="#cb18-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-1</span></span>
<span id="cb18-546"><a href="#cb18-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap : Somme des équilibres du système avec prédateurs avec inflation et déflation du système sans prédateurs</span></span>
<span id="cb18-547"><a href="#cb18-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-548"><a href="#cb18-548" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition d'une fonction qui prend en compte le changement de migration:</span></span>
<span id="cb18-549"><a href="#cb18-549" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> a(etat,t,param,i):</span>
<span id="cb18-550"><a href="#cb18-550" aria-hidden="true" tabindex="-1"></a>    x,y,z<span class="op">=</span>etat</span>
<span id="cb18-551"><a href="#cb18-551" aria-hidden="true" tabindex="-1"></a>    b<span class="op">=</span>i</span>
<span id="cb18-552"><a href="#cb18-552" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,gy,p,n,m <span class="op">=</span> param</span>
<span id="cb18-553"><a href="#cb18-553" aria-hidden="true" tabindex="-1"></a>    xdot,ydot,zdot<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx)<span class="op">-</span>p<span class="op">*</span>z<span class="op">*</span>x,ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)<span class="op">-</span>p<span class="op">*</span>y<span class="op">*</span>z,z<span class="op">*</span>(n<span class="op">*</span>(x<span class="op">+</span>y)<span class="op">-</span>m)]</span>
<span id="cb18-554"><a href="#cb18-554" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [xdot,ydot,zdot]</span>
<span id="cb18-555"><a href="#cb18-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-556"><a href="#cb18-556" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition du modèle sans prédateurs:</span></span>
<span id="cb18-557"><a href="#cb18-557" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug(etat,t,param,i):</span>
<span id="cb18-558"><a href="#cb18-558" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,gy<span class="op">=</span>param</span>
<span id="cb18-559"><a href="#cb18-559" aria-hidden="true" tabindex="-1"></a>    b<span class="op">=</span>i</span>
<span id="cb18-560"><a href="#cb18-560" aria-hidden="true" tabindex="-1"></a>    x,y<span class="op">=</span>etat</span>
<span id="cb18-561"><a href="#cb18-561" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx),ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)]</span>
<span id="cb18-562"><a href="#cb18-562" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb18-563"><a href="#cb18-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-564"><a href="#cb18-564" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb18-565"><a href="#cb18-565" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb18-566"><a href="#cb18-566" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-567"><a href="#cb18-567" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-568"><a href="#cb18-568" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-569"><a href="#cb18-569" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-570"><a href="#cb18-570" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-571"><a href="#cb18-571" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb18-572"><a href="#cb18-572" aria-hidden="true" tabindex="-1"></a>p1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-573"><a href="#cb18-573" aria-hidden="true" tabindex="-1"></a>m11<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-574"><a href="#cb18-574" aria-hidden="true" tabindex="-1"></a>n11<span class="op">=</span><span class="fl">0.25</span></span>
<span id="cb18-575"><a href="#cb18-575" aria-hidden="true" tabindex="-1"></a>m12<span class="op">=</span><span class="dv">3</span></span>
<span id="cb18-576"><a href="#cb18-576" aria-hidden="true" tabindex="-1"></a>n12<span class="op">=</span><span class="dv">2</span></span>
<span id="cb18-577"><a href="#cb18-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-578"><a href="#cb18-578" aria-hidden="true" tabindex="-1"></a>param11<span class="op">=</span>np.array([rx1,Kx1,ry1,Ky1,gx1,gy1,p1,n11,m11])</span>
<span id="cb18-579"><a href="#cb18-579" aria-hidden="true" tabindex="-1"></a>param12<span class="op">=</span>np.array([rx1,Kx1,ry1,Ky1,gx1,gy1,p1,n12,m12])</span>
<span id="cb18-580"><a href="#cb18-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-581"><a href="#cb18-581" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration suffisament large pour atteindre l'équilibre:</span></span>
<span id="cb18-582"><a href="#cb18-582" aria-hidden="true" tabindex="-1"></a>t<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">1000</span>,<span class="fl">0.01</span>)</span>
<span id="cb18-583"><a href="#cb18-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-584"><a href="#cb18-584" aria-hidden="true" tabindex="-1"></a><span class="co">#Condition initiale:</span></span>
<span id="cb18-585"><a href="#cb18-585" aria-hidden="true" tabindex="-1"></a>e0<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb18-586"><a href="#cb18-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-587"><a href="#cb18-587" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb18-588"><a href="#cb18-588" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span>plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">5</span>))</span>
<span id="cb18-589"><a href="#cb18-589" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb18-590"><a href="#cb18-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-591"><a href="#cb18-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-592"><a href="#cb18-592" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb18-593"><a href="#cb18-593" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb18-594"><a href="#cb18-594" aria-hidden="true" tabindex="-1"></a>    s11<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param11,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb18-595"><a href="#cb18-595" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s11[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s11[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb18-596"><a href="#cb18-596" aria-hidden="true" tabindex="-1"></a>    s12<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param12,i))</span>
<span id="cb18-597"><a href="#cb18-597" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s12[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s12[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb18-598"><a href="#cb18-598" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-599"><a href="#cb18-599" aria-hidden="true" tabindex="-1"></a>    s11sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param11[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb18-600"><a href="#cb18-600" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s11sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s11sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb18-601"><a href="#cb18-601" aria-hidden="true" tabindex="-1"></a>    s12sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param12[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb18-602"><a href="#cb18-602" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s12sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s12sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb18-603"><a href="#cb18-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-604"><a href="#cb18-604" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky:    </span></span>
<span id="cb18-605"><a href="#cb18-605" aria-hidden="true" tabindex="-1"></a>xt<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb18-606"><a href="#cb18-606" aria-hidden="true" tabindex="-1"></a>xt2<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb18-607"><a href="#cb18-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-608"><a href="#cb18-608" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt,(Kx1<span class="op">+</span>Ky1)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-609"><a href="#cb18-609" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt2,(Kx1<span class="op">+</span>Ky1)<span class="op">*</span>np.ones_like(xt2),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-610"><a href="#cb18-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-611"><a href="#cb18-611" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de m/n:</span></span>
<span id="cb18-612"><a href="#cb18-612" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt,m11<span class="op">/</span>n11<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-613"><a href="#cb18-613" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt,m12<span class="op">/</span>n12<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-614"><a href="#cb18-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-615"><a href="#cb18-615" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb18-616"><a href="#cb18-616" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-617"><a href="#cb18-617" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-618"><a href="#cb18-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-619"><a href="#cb18-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-620"><a href="#cb18-620" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb18-621"><a href="#cb18-621" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx1<span class="op">+</span>Ky1,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle sans prédateurs'</span>)</span>
<span id="cb18-622"><a href="#cb18-622" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx1<span class="op">+</span>Ky1,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle avec prédateurs'</span>)</span>
<span id="cb18-623"><a href="#cb18-623" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx1<span class="op">+</span>Ky1,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m/n'</span>)</span>
<span id="cb18-624"><a href="#cb18-624" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx1<span class="op">+</span>Ky1,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb18-625"><a href="#cb18-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-626"><a href="#cb18-626" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb18-627"><a href="#cb18-627" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-628"><a href="#cb18-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-629"><a href="#cb18-629" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb18-630"><a href="#cb18-630" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Déflation'</span>)</span>
<span id="cb18-631"><a href="#cb18-631" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Déflation'</span>)<span class="op">;</span></span>
<span id="cb18-632"><a href="#cb18-632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-633"><a href="#cb18-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-634"><a href="#cb18-634" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb18-635"><a href="#cb18-635" aria-hidden="true" tabindex="-1"></a>Dans la légende on remarque qu'en gris on a la somme des équilibres du modèle sans prédateurs et en bleu du modèle avec prédateurs. Ceci ne veut pas dire que la courbe bleu représente la somme des équilibres d'un système avec des prédateurs en vie tout le temps puisqu'on a vu à l'instant qu'ils ne sont pas présents sur la @fig-1 à gauche par exemple.  </span>
<span id="cb18-636"><a href="#cb18-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-637"><a href="#cb18-637" aria-hidden="true" tabindex="-1"></a>Quand on dit avec prédateurs c'est que le modèle prend en compte les prédateurs et donc il prend en compte quand leur population est nulle.</span>
<span id="cb18-638"><a href="#cb18-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-639"><a href="#cb18-639" aria-hidden="true" tabindex="-1"></a>Quand cette population est nulle on a montré que le modèle avec prédateurs était égal au modèle sans prédateurs de la partie précédente expliquant que les deux courbes se rejoignent mais il faut bien garder en tête qu'on simule deux modèles complètement différents (l'un en 2D l'autre en 3D).</span>
<span id="cb18-640"><a href="#cb18-640" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-641"><a href="#cb18-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-642"><a href="#cb18-642" aria-hidden="true" tabindex="-1"></a>On a pris dans notre premier cas un système qui subissait une déflation de base et qui subit pour certaines valeurs de $\beta$ une invasion de prédateurs.  </span>
<span id="cb18-643"><a href="#cb18-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-644"><a href="#cb18-644" aria-hidden="true" tabindex="-1"></a>On retrouve bien en gris (somme des équilibres sans prédateurs) le même profil de courbe que dans la partie précédente.  </span>
<span id="cb18-645"><a href="#cb18-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-646"><a href="#cb18-646" aria-hidden="true" tabindex="-1"></a>En orange on retrouve la droite correspondant à $\frac{m}{n}$ qui va permettre de voir l'installation des prédateurs quand la courbe grise la traversera.  </span>
<span id="cb18-647"><a href="#cb18-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-648"><a href="#cb18-648" aria-hidden="true" tabindex="-1"></a>La droite en noir correspond à $K_x+K_y$ et va permettre de voir si on a inflationou déflation du système.</span>
<span id="cb18-649"><a href="#cb18-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-650"><a href="#cb18-650" aria-hidden="true" tabindex="-1"></a>Enfin la courbe bleu décrit la somme des équilibres dans le système (<span class="co">[</span><span class="ot">-@eq-modelau</span><span class="co">]</span>) et présente à la fois la somme des équilibres si on a invasion des prédateurs (et donc mise en place de l'équilibre $(x^*,y^*,z^*)$) et à la fois la somme des équilibres si on a disparition des ravageurs.  </span>
<span id="cb18-651"><a href="#cb18-651" aria-hidden="true" tabindex="-1"></a>Dans ce cas là, qui correspond à un cas où la courbe grise est en dessous de la droite orange (cf la condition d'invasion décrite plus haut), on observe bien que la courbe bleu et la courbe grise sont confondues.  </span>
<span id="cb18-652"><a href="#cb18-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-653"><a href="#cb18-653" aria-hidden="true" tabindex="-1"></a>Intuitivement on peut se dire que rajouter des prédateurs à un système subissant déjà une déflation sans prédateurs ne peut faire qu'aller dans le sens de la déflation.  </span>
<span id="cb18-654"><a href="#cb18-654" aria-hidden="true" tabindex="-1"></a>On peut observer sur notre figure que c'est bien le cas.  </span>
<span id="cb18-655"><a href="#cb18-655" aria-hidden="true" tabindex="-1"></a>A gauche on observe que comme on a $\frac{m}{n}$ tout le temps plus grand que $x_0^* + x^*_0$ alors les prédateurs ne s'installent pas et donc la courbe bleu est confondu avec la courbe grise ($x_0^* + x^*_0 = x^*+y^*$). </span>
<span id="cb18-656"><a href="#cb18-656" aria-hidden="true" tabindex="-1"></a>Comme les prédateurs ne sont pas présents on observe la même déflation que dans le modèle précédent.  </span>
<span id="cb18-657"><a href="#cb18-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-658"><a href="#cb18-658" aria-hidden="true" tabindex="-1"></a>A droite on observe que $\frac{m}{n}$ est d'abord en dessous de $x_0^* + x^*_0$ et donc les prédateurs peuvent s'installer expliquant la saturation à $\frac{m}{n}$ et dès que $x_0^* + x^*_0$ passe en dessous de $\frac{m}{n}$ on observe que la courbe bleu rejoint la courbe grise.  </span>
<span id="cb18-659"><a href="#cb18-659" aria-hidden="true" tabindex="-1"></a>Ainsi on voit dans ce cas que l'ajout de prédateurs permet d'avoir une forte déflation même pour des forces de migration $\beta$ basse ce qui n'est pas le cas dans le modèle précédent (comme en témoigne la courbe grise).</span>
<span id="cb18-660"><a href="#cb18-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-661"><a href="#cb18-661" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Délfation/Inflation du système sans prédateurs</span></span>
<span id="cb18-662"><a href="#cb18-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-663"><a href="#cb18-663" aria-hidden="true" tabindex="-1"></a>On utilise le même code python en changeant les paramètres:</span>
<span id="cb18-664"><a href="#cb18-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-667"><a href="#cb18-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-668"><a href="#cb18-668" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb18-669"><a href="#cb18-669" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-2</span></span>
<span id="cb18-670"><a href="#cb18-670" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap : Somme des équilibres du système avec prédateurs avec inflation et déflation du système sans prédateurs</span></span>
<span id="cb18-671"><a href="#cb18-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-672"><a href="#cb18-672" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres:</span></span>
<span id="cb18-673"><a href="#cb18-673" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb18-674"><a href="#cb18-674" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-675"><a href="#cb18-675" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-676"><a href="#cb18-676" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-677"><a href="#cb18-677" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-678"><a href="#cb18-678" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb18-679"><a href="#cb18-679" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-680"><a href="#cb18-680" aria-hidden="true" tabindex="-1"></a>p2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-681"><a href="#cb18-681" aria-hidden="true" tabindex="-1"></a>m21<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-682"><a href="#cb18-682" aria-hidden="true" tabindex="-1"></a>n21<span class="op">=</span><span class="fl">0.3278</span></span>
<span id="cb18-683"><a href="#cb18-683" aria-hidden="true" tabindex="-1"></a>m22<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-684"><a href="#cb18-684" aria-hidden="true" tabindex="-1"></a>n22<span class="op">=</span><span class="fl">0.335</span></span>
<span id="cb18-685"><a href="#cb18-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-686"><a href="#cb18-686" aria-hidden="true" tabindex="-1"></a>param21<span class="op">=</span>np.array([rx2,Kx2,ry2,Ky2,gx2,gy2,p2,n21,m21])</span>
<span id="cb18-687"><a href="#cb18-687" aria-hidden="true" tabindex="-1"></a>param22<span class="op">=</span>np.array([rx2,Kx2,ry2,Ky2,gx2,gy2,p2,n22,m22])</span>
<span id="cb18-688"><a href="#cb18-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-689"><a href="#cb18-689" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb18-690"><a href="#cb18-690" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span>plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">5</span>))</span>
<span id="cb18-691"><a href="#cb18-691" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb18-692"><a href="#cb18-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-693"><a href="#cb18-693" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb18-694"><a href="#cb18-694" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb18-695"><a href="#cb18-695" aria-hidden="true" tabindex="-1"></a>    s21<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param21,i))</span>
<span id="cb18-696"><a href="#cb18-696" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s21[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s21[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)             </span>
<span id="cb18-697"><a href="#cb18-697" aria-hidden="true" tabindex="-1"></a>    s22<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param22,i))</span>
<span id="cb18-698"><a href="#cb18-698" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s22[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s22[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)              </span>
<span id="cb18-699"><a href="#cb18-699" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-700"><a href="#cb18-700" aria-hidden="true" tabindex="-1"></a>    s21sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param21[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb18-701"><a href="#cb18-701" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s21sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s21sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb18-702"><a href="#cb18-702" aria-hidden="true" tabindex="-1"></a>    s22sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param22[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb18-703"><a href="#cb18-703" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s22sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s22sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb18-704"><a href="#cb18-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-705"><a href="#cb18-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-706"><a href="#cb18-706" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky:</span></span>
<span id="cb18-707"><a href="#cb18-707" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt,(Kx2<span class="op">+</span>Ky2)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-708"><a href="#cb18-708" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt,(Kx2<span class="op">+</span>Ky2)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-709"><a href="#cb18-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-710"><a href="#cb18-710" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de m/n:</span></span>
<span id="cb18-711"><a href="#cb18-711" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt,m21<span class="op">/</span>n21<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-712"><a href="#cb18-712" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt,m22<span class="op">/</span>n22<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-713"><a href="#cb18-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-714"><a href="#cb18-714" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb18-715"><a href="#cb18-715" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-716"><a href="#cb18-716" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-717"><a href="#cb18-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-718"><a href="#cb18-718" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb18-719"><a href="#cb18-719" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx2<span class="op">+</span>Ky2,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle sans prédateurs'</span>)</span>
<span id="cb18-720"><a href="#cb18-720" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx2<span class="op">+</span>Ky2,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle avec prédateurs'</span>)</span>
<span id="cb18-721"><a href="#cb18-721" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx2<span class="op">+</span>Ky2,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m/n'</span>)</span>
<span id="cb18-722"><a href="#cb18-722" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx2<span class="op">+</span>Ky2,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb18-723"><a href="#cb18-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-724"><a href="#cb18-724" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb18-725"><a href="#cb18-725" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-726"><a href="#cb18-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-727"><a href="#cb18-727" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Les deux'</span>)</span>
<span id="cb18-728"><a href="#cb18-728" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Déflation'</span>)<span class="op">;</span></span>
<span id="cb18-729"><a href="#cb18-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-730"><a href="#cb18-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-731"><a href="#cb18-731" aria-hidden="true" tabindex="-1"></a>La légende est en tout point similaire à la simulation précédente. </span>
<span id="cb18-732"><a href="#cb18-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-733"><a href="#cb18-733" aria-hidden="true" tabindex="-1"></a>A gauche on observe d'abord que la courbe bleu et grise sont confondues (traduisant une absence de prédateurs), puis une saturation à $\frac{m}{n}$ (traduisant une présence de prédateurs) puis de nouveau une disparition des prédateurs avec les courbes bleu et grise qui se rejoignent.</span>
<span id="cb18-734"><a href="#cb18-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-735"><a href="#cb18-735" aria-hidden="true" tabindex="-1"></a>Ainsi, dans ce cas la présence de prédateurs permet de limiter l'inflation en saturant à $\frac{m}{n}$.</span>
<span id="cb18-736"><a href="#cb18-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-737"><a href="#cb18-737" aria-hidden="true" tabindex="-1"></a>A droite on observe que encore une fois pour des valeurs de $\frac{m}{n} &lt; K_x+K_y$ on a déflation en permanence. Nous verrons qu'on peut en déduire un cas général.  </span>
<span id="cb18-738"><a href="#cb18-738" aria-hidden="true" tabindex="-1"></a>On observe donc une déflation, grace à la saturation pour de faibles valeurs de $\beta$, alors que le modèle précédent montrait une inflation. </span>
<span id="cb18-739"><a href="#cb18-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-740"><a href="#cb18-740" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inflation du système sans prédateurs</span></span>
<span id="cb18-741"><a href="#cb18-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-742"><a href="#cb18-742" aria-hidden="true" tabindex="-1"></a>On utilise encore le même code python en changeant les paramètres:</span>
<span id="cb18-745"><a href="#cb18-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-746"><a href="#cb18-746" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb18-747"><a href="#cb18-747" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3</span></span>
<span id="cb18-748"><a href="#cb18-748" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap : Somme des équilibres du système avec prédateurs avec inflation du système sans prédateurs</span></span>
<span id="cb18-749"><a href="#cb18-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-750"><a href="#cb18-750" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres:</span></span>
<span id="cb18-751"><a href="#cb18-751" aria-hidden="true" tabindex="-1"></a><span class="co">#3:</span></span>
<span id="cb18-752"><a href="#cb18-752" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-753"><a href="#cb18-753" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-754"><a href="#cb18-754" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-755"><a href="#cb18-755" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb18-756"><a href="#cb18-756" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-757"><a href="#cb18-757" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-758"><a href="#cb18-758" aria-hidden="true" tabindex="-1"></a>p3<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-759"><a href="#cb18-759" aria-hidden="true" tabindex="-1"></a>m31<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-760"><a href="#cb18-760" aria-hidden="true" tabindex="-1"></a>n31<span class="op">=</span><span class="fl">0.2832</span></span>
<span id="cb18-761"><a href="#cb18-761" aria-hidden="true" tabindex="-1"></a>m32<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-762"><a href="#cb18-762" aria-hidden="true" tabindex="-1"></a>n32<span class="op">=</span><span class="fl">0.289</span></span>
<span id="cb18-763"><a href="#cb18-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-764"><a href="#cb18-764" aria-hidden="true" tabindex="-1"></a>param31<span class="op">=</span>np.array([rx3,Kx3,ry3,Ky3,gx3,gy3,p3,n31,m31])</span>
<span id="cb18-765"><a href="#cb18-765" aria-hidden="true" tabindex="-1"></a>param32<span class="op">=</span>np.array([rx3,Kx3,ry3,Ky3,gx3,gy3,p3,n32,m32])</span>
<span id="cb18-766"><a href="#cb18-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-767"><a href="#cb18-767" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb18-768"><a href="#cb18-768" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span>plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">5</span>))</span>
<span id="cb18-769"><a href="#cb18-769" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb18-770"><a href="#cb18-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-771"><a href="#cb18-771" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb18-772"><a href="#cb18-772" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb18-773"><a href="#cb18-773" aria-hidden="true" tabindex="-1"></a>    s31<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param31,i))</span>
<span id="cb18-774"><a href="#cb18-774" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s31[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s31[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb18-775"><a href="#cb18-775" aria-hidden="true" tabindex="-1"></a>    s32<span class="op">=</span>odeint(a,e0,t,args<span class="op">=</span>(param32,i))</span>
<span id="cb18-776"><a href="#cb18-776" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s32[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s32[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb18-777"><a href="#cb18-777" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-778"><a href="#cb18-778" aria-hidden="true" tabindex="-1"></a>    s31sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param31[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb18-779"><a href="#cb18-779" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(i,s31sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s31sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb18-780"><a href="#cb18-780" aria-hidden="true" tabindex="-1"></a>    s32sp<span class="op">=</span>odeint(aug,e0[<span class="dv">0</span>:<span class="dv">2</span>],t,args<span class="op">=</span>(param32[<span class="dv">0</span>:<span class="dv">6</span>],i))</span>
<span id="cb18-781"><a href="#cb18-781" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(i,s32sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s32sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.7'</span>)</span>
<span id="cb18-782"><a href="#cb18-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-783"><a href="#cb18-783" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky: </span></span>
<span id="cb18-784"><a href="#cb18-784" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt2,(Kx3<span class="op">+</span>Ky3)<span class="op">*</span>np.ones_like(xt2),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-785"><a href="#cb18-785" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt,(Kx3<span class="op">+</span>Ky3)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-786"><a href="#cb18-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-787"><a href="#cb18-787" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de m/n:</span></span>
<span id="cb18-788"><a href="#cb18-788" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(xt,m31<span class="op">/</span>n31<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-789"><a href="#cb18-789" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(xt,m32<span class="op">/</span>n32<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)         </span>
<span id="cb18-790"><a href="#cb18-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-791"><a href="#cb18-791" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb18-792"><a href="#cb18-792" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-793"><a href="#cb18-793" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-794"><a href="#cb18-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-795"><a href="#cb18-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-796"><a href="#cb18-796" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb18-797"><a href="#cb18-797" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx3<span class="op">+</span>Ky3,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle sans prédateurs'</span>)</span>
<span id="cb18-798"><a href="#cb18-798" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>, Kx3 <span class="op">+</span> Ky3, color <span class="op">=</span> <span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres du modèle avec prédateurs'</span>)</span>
<span id="cb18-799"><a href="#cb18-799" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>, Kx3<span class="op">+</span>Ky3,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'C1'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m/n'</span>)</span>
<span id="cb18-800"><a href="#cb18-800" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(<span class="dv">0</span>,Kx3<span class="op">+</span>Ky3,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb18-801"><a href="#cb18-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-802"><a href="#cb18-802" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb18-803"><a href="#cb18-803" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-804"><a href="#cb18-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-805"><a href="#cb18-805" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres</span></span>
<span id="cb18-806"><a href="#cb18-806" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Inflation'</span>)</span>
<span id="cb18-807"><a href="#cb18-807" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Déflation'</span>)<span class="op">;</span></span>
<span id="cb18-808"><a href="#cb18-808" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-809"><a href="#cb18-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-810"><a href="#cb18-810" aria-hidden="true" tabindex="-1"></a>Encore une fois on observe des courbes qui saturent à $\frac{m}{n}$ quand la condition d'invasion des prédateurs est vérifiée.  </span>
<span id="cb18-811"><a href="#cb18-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-812"><a href="#cb18-812" aria-hidden="true" tabindex="-1"></a>On peut voir sur la courbe de droite, et nous allons le montrer, que pour les trois profils (ou quatre si on compte que l'inflation peut en présenter deux) de courbe (déflation,inflation/déflation et inflation) si $\frac{m}{n} &lt; K_x + K_y$ le système subit une déflation en permanence.  </span>
<span id="cb18-813"><a href="#cb18-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-814"><a href="#cb18-814" aria-hidden="true" tabindex="-1"></a>En effet, si $\frac{m}{n} &lt; K_x + K_y$ alors on distingue deux cas : </span>
<span id="cb18-815"><a href="#cb18-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-816"><a href="#cb18-816" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Soit $x^*_0+y^*_0&gt;\frac{m}{n}$ et donc on a invasion des prédateurs et saturation de la courbe à $\frac{m}{n}$ (qui est en dessous de $K_x + K_y$ par hypothèse) et donc déflation constante.  </span>
<span id="cb18-817"><a href="#cb18-817" aria-hidden="true" tabindex="-1"></a>C'est le cas qu'on observe dans la @fig-3 à droite.</span>
<span id="cb18-818"><a href="#cb18-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-819"><a href="#cb18-819" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Soit $x^*_0+y^*_0&lt;\frac{m}{n}$ et donc les prédateurs disparaissent et donc $x_0^* + x^*_0 = x^*+y^*$ ce qui montre que $x^*+y^* &lt; \frac{m}{n} &lt; K_x + K_y$ et qui explique qu'on a une déflation constante.</span>
<span id="cb18-820"><a href="#cb18-820" aria-hidden="true" tabindex="-1"></a>C'est le cas qu'on observe dans la @fig-1 à droite pour des valeurs de $\beta$ plus grande que $2$.  </span>
<span id="cb18-821"><a href="#cb18-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-822"><a href="#cb18-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-823"><a href="#cb18-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-824"><a href="#cb18-824" aria-hidden="true" tabindex="-1"></a>Ces graphiques traduisent bien l'effet de l'ajout des prédateurs dans un système : si celui ci est déja déflationiste il le reste, si celui ci était inflationiste et déflationiste ou complètement inflationiste alors son inflation est limitée par les prédateurs (jusqu'à même pouvoir devenir délfationiste, voir figure 3 à droite).</span>
<span id="cb18-825"><a href="#cb18-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-826"><a href="#cb18-826" aria-hidden="true" tabindex="-1"></a>Si on reprend les <span class="co">[</span><span class="ot">conditions</span><span class="co">](modeleavecmigrationass.qmd)</span> d'inflations et déflations posées précédemment peut les adapter à ce modèle :</span>
<span id="cb18-827"><a href="#cb18-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-828"><a href="#cb18-828" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si le système sans prédateurs est de base déflationiste alors le système avec prédateurs est aussi déflationiste (avec survie ou pas des prédateurs).  </span>
<span id="cb18-829"><a href="#cb18-829" aria-hidden="true" tabindex="-1"></a>Ainsi d'après les conditions du <span class="co">[</span><span class="ot">modèle précédent</span><span class="co">](modeleavecmigrationass.qmd)</span> on a que si $\frac{\gamma_y}{\gamma_x}&gt;\frac{K_y}{K_x}$ (condition de déflation du modèle précédent) alors le système avec prédateurs est toujours déflationiste.  </span>
<span id="cb18-830"><a href="#cb18-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-831"><a href="#cb18-831" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si $\frac{\gamma_y}{\gamma_x}&lt;\frac{K_y}{K_x}$ (condition d'inflation et de déflation du modèle précédent) alors on a soit un système inflationiste si $\frac{m}{n} &lt; K_x+K_y$ soit un système inflationiste et déflationiste mais moins inflationiste que sans les prédateurs si $\frac{m}{n} &lt; (x^*_0+y^*_0)_{max}$ (autrement dit la courbe grise est au dessus de la droite orange).  </span>
<span id="cb18-832"><a href="#cb18-832" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-833"><a href="#cb18-833" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si $\frac{r_xK_y}{r_yK_x} &lt; \frac{\gamma_y}{\gamma_x} &lt; \frac{K_y}{K_x}$ (conditions d'inflation du modèle précédent) alors si on a $x^*(\infty)+y^*(\infty) &gt; \frac{m}{n} &gt; K_x+K_y$ alors le système est inflationiste mais moins que son <span class="co">[</span><span class="ot">pendant sans prédateurs</span><span class="co">](modeleavecmigrationass.qmd)</span>.</span>
<span id="cb18-834"><a href="#cb18-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-835"><a href="#cb18-835" aria-hidden="true" tabindex="-1"></a><span class="fu">### Equilibre de la culture en fonction de $\gamma_y$</span></span>
<span id="cb18-836"><a href="#cb18-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-837"><a href="#cb18-837" aria-hidden="true" tabindex="-1"></a>On va maintenant voir l'évolution de l'équilibre dans la culture en fonction de $\gamma_y$ (le taux de fuite):</span>
<span id="cb18-838"><a href="#cb18-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-839"><a href="#cb18-839" aria-hidden="true" tabindex="-1"></a><span class="in">``` {python}</span></span>
<span id="cb18-840"><a href="#cb18-840" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb18-841"><a href="#cb18-841" aria-hidden="true" tabindex="-1"></a><span class="co">#On définit du nouveau modèle qui prend en compte le changement de gy :</span></span>
<span id="cb18-842"><a href="#cb18-842" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> a2(etat,t,param,h):</span>
<span id="cb18-843"><a href="#cb18-843" aria-hidden="true" tabindex="-1"></a>    x,y,z<span class="op">=</span>etat</span>
<span id="cb18-844"><a href="#cb18-844" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,b,p,n,m <span class="op">=</span> param</span>
<span id="cb18-845"><a href="#cb18-845" aria-hidden="true" tabindex="-1"></a>    gy<span class="op">=</span>h</span>
<span id="cb18-846"><a href="#cb18-846" aria-hidden="true" tabindex="-1"></a>    xdot,ydot,zdot<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx)<span class="op">-</span>p<span class="op">*</span>z<span class="op">*</span>x,ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)<span class="op">-</span>p<span class="op">*</span>y<span class="op">*</span>z,z<span class="op">*</span>(n<span class="op">*</span>(x<span class="op">+</span>y)<span class="op">-</span>m)]</span>
<span id="cb18-847"><a href="#cb18-847" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> xdot,ydot,zdot</span>
<span id="cb18-848"><a href="#cb18-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-849"><a href="#cb18-849" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition de l'ancien modèle qui prend en compte le changement de gy:</span></span>
<span id="cb18-850"><a href="#cb18-850" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug3(etat, t, param, h):</span>
<span id="cb18-851"><a href="#cb18-851" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, b <span class="op">=</span> param</span>
<span id="cb18-852"><a href="#cb18-852" aria-hidden="true" tabindex="-1"></a>    gy <span class="op">=</span> h</span>
<span id="cb18-853"><a href="#cb18-853" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb18-854"><a href="#cb18-854" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb18-855"><a href="#cb18-855" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb18-856"><a href="#cb18-856" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb18-857"><a href="#cb18-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-858"><a href="#cb18-858" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb18-859"><a href="#cb18-859" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb18-860"><a href="#cb18-860" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-861"><a href="#cb18-861" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb18-862"><a href="#cb18-862" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-863"><a href="#cb18-863" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-864"><a href="#cb18-864" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-865"><a href="#cb18-865" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-866"><a href="#cb18-866" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-867"><a href="#cb18-867" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb18-868"><a href="#cb18-868" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-869"><a href="#cb18-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-870"><a href="#cb18-870" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, b, p, n, m])</span>
<span id="cb18-871"><a href="#cb18-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-872"><a href="#cb18-872" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration assez large pour atteindre l'éq :</span></span>
<span id="cb18-873"><a href="#cb18-873" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb18-874"><a href="#cb18-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-875"><a href="#cb18-875" aria-hidden="true" tabindex="-1"></a><span class="co">#Conditions initiales:</span></span>
<span id="cb18-876"><a href="#cb18-876" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb18-877"><a href="#cb18-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-878"><a href="#cb18-878" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb18-879"><a href="#cb18-879" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb18-880"><a href="#cb18-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-881"><a href="#cb18-881" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite de la somme des capacités:</span></span>
<span id="cb18-882"><a href="#cb18-882" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb18-883"><a href="#cb18-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-884"><a href="#cb18-884" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb18-885"><a href="#cb18-885" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb18-886"><a href="#cb18-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-887"><a href="#cb18-887" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb18-888"><a href="#cb18-888" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb18-889"><a href="#cb18-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-890"><a href="#cb18-890" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de m/n:</span></span>
<span id="cb18-891"><a href="#cb18-891" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, m<span class="op">/</span>n <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'C1'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb18-892"><a href="#cb18-892" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, m<span class="op">/</span>n <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'m/n'</span>)</span>
<span id="cb18-893"><a href="#cb18-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-894"><a href="#cb18-894" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle qui calcule l'équilibre et qui plot un point en fonction des valeurs du taux de fuite:</span></span>
<span id="cb18-895"><a href="#cb18-895" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="fl">0.001</span>):</span>
<span id="cb18-896"><a href="#cb18-896" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(a2, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb18-897"><a href="#cb18-897" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb18-898"><a href="#cb18-898" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb18-899"><a href="#cb18-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-900"><a href="#cb18-900" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug3, e0[<span class="dv">0</span>:<span class="dv">2</span>], t, args <span class="op">=</span> (param1[<span class="dv">0</span>:<span class="dv">6</span>], i))</span>
<span id="cb18-901"><a href="#cb18-901" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb18-902"><a href="#cb18-902" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb18-903"><a href="#cb18-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-904"><a href="#cb18-904" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb18-905"><a href="#cb18-905" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb18-906"><a href="#cb18-906" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb18-907"><a href="#cb18-907" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, Kx1 <span class="op">+</span> Ky1, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb18-908"><a href="#cb18-908" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, Kx1, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture avec prédateurs ($x^*$)'</span>)</span>
<span id="cb18-909"><a href="#cb18-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-910"><a href="#cb18-910" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Somme des équilibres en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb18-911"><a href="#cb18-911" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Equilibre de la culture en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)   </span>
<span id="cb18-912"><a href="#cb18-912" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize <span class="op">=</span> <span class="dv">7</span>, loc <span class="op">=</span> <span class="st">"lower right"</span>)<span class="op">;</span></span>
<span id="cb18-913"><a href="#cb18-913" aria-hidden="true" tabindex="-1"></a>ax1.legend(fontsize <span class="op">=</span> <span class="dv">7</span>, loc <span class="op">=</span> <span class="st">"upper right"</span>)<span class="op">;</span></span>
<span id="cb18-914"><a href="#cb18-914" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Densité de pop."</span>)<span class="op">;</span></span>
<span id="cb18-915"><a href="#cb18-915" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-916"><a href="#cb18-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-917"><a href="#cb18-917" aria-hidden="true" tabindex="-1"></a>En gris on peut voir la somme des équilibres du modèle sans prédateurs et en orange on observe sur la figure gauche la droite $\frac{m}{n}$.  </span>
<span id="cb18-918"><a href="#cb18-918" aria-hidden="true" tabindex="-1"></a>Ainsi, on peut voir quand est ce qu'en fonction du taux de fuite la population de prédateurs disparaît.  </span>
<span id="cb18-919"><a href="#cb18-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-920"><a href="#cb18-920" aria-hidden="true" tabindex="-1"></a>Pour représenter cette figure on a considéré que $r_x&lt;r_y$ et $K_x&lt;K_y$ sans perte de généralité.</span>
<span id="cb18-921"><a href="#cb18-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-922"><a href="#cb18-922" aria-hidden="true" tabindex="-1"></a>A gauche, on observe que la somme des équilibres des ravageurs sans prédateurs est bien similaire à celle obtenue dans la partie précédente.  </span>
<span id="cb18-923"><a href="#cb18-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-924"><a href="#cb18-924" aria-hidden="true" tabindex="-1"></a>Quand il n'y a pas de prédateurs on observe bien comme précédemment que la courbe bleu et grise se rejoignent.  </span>
<span id="cb18-925"><a href="#cb18-925" aria-hidden="true" tabindex="-1"></a>En revanche quand on a des prédateurs (la courbe grise est au dessus de $\frac{m}{n}$) alors on a bien la saturation de la somme des équilibres.</span>
<span id="cb18-926"><a href="#cb18-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-927"><a href="#cb18-927" aria-hidden="true" tabindex="-1"></a>A droite on observe la même simulation qu'à gauche (en terme de paramètres) mais on représente uniquement l'équilibre dans la culture qui est l'équilibre qui nous intéresse le plus.  </span>
<span id="cb18-928"><a href="#cb18-928" aria-hidden="true" tabindex="-1"></a>On observe que pour les valeurs de taux de fuite de disparition des prédateurs à gauche on a aussi à droite la courbe bleu qui se sépare de la courbe grise.  </span>
<span id="cb18-929"><a href="#cb18-929" aria-hidden="true" tabindex="-1"></a>On remarque cette courbe bleu décroît plus vite vers la déflation que la courbe grise montrant l'effet bénéfique des parasites pour baisser les ravageurs dans le système.   </span>
<span id="cb18-930"><a href="#cb18-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-931"><a href="#cb18-931" aria-hidden="true" tabindex="-1"></a>Ainsi, dans ce modèle on a aussi que des forts taux de fuite engendrent une inflation dans la culture.</span>
<span id="cb18-932"><a href="#cb18-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-933"><a href="#cb18-933" aria-hidden="true" tabindex="-1"></a><span class="fu">## Equilibres en fonction des paramètres du modèle complet</span></span>
<span id="cb18-934"><a href="#cb18-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-935"><a href="#cb18-935" aria-hidden="true" tabindex="-1"></a>Maintenant on va considérer le modèle plus complexe de naissances ($n$) et de la prédation ($p$) différentes entre la culture et l'augmentorium.   </span>
<span id="cb18-936"><a href="#cb18-936" aria-hidden="true" tabindex="-1"></a>Ce postulat n'est pas anodin car on peut vraisemblablement penser que l'augmentorium fournit une structure positive à la croissance grâce à la grande concentration de ressources qu'il renferme et à son relatif cloisonnement de l'extérieur.  </span>
<span id="cb18-937"><a href="#cb18-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-938"><a href="#cb18-938" aria-hidden="true" tabindex="-1"></a><span class="fu">### Somme des équilibres des proies en fonction de $\beta$</span></span>
<span id="cb18-939"><a href="#cb18-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-940"><a href="#cb18-940" aria-hidden="true" tabindex="-1"></a>Précédemment on observait une saturation de la somme des proies à $\frac{m}{n}$. Mais cette observation résultait de la trop forte simplification du modèle considéré. En considérant notre modèle actuel et en faisant l'hypothèse que $z^* \ne 0$ alors on a la condition $n_xx^*+n_yy^* = m$ qui ne renseigne pas comme auparavant sur la taille de la population de ravageurs à l'équilibre.  </span>
<span id="cb18-941"><a href="#cb18-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-942"><a href="#cb18-942" aria-hidden="true" tabindex="-1"></a>L'intuition mathématique, via le même raisonnement biologique précédent, est que l'invasion des prédateurs ie $\exists z^* &gt; 0$ est vérifiée si seulement si $n_xx_0^*(\beta) + n_yy_0^*(\beta)&gt;m$ où $x_0^*(\beta)$ et $y_0^*(\beta)$ sont les équilibres du système sans prédateurs. </span>
<span id="cb18-943"><a href="#cb18-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-944"><a href="#cb18-944" aria-hidden="true" tabindex="-1"></a>Montrons le mathématiquement pour $\beta = 0$ et $\beta = +\infty$ : </span>
<span id="cb18-945"><a href="#cb18-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-946"><a href="#cb18-946" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Pour $\beta =0$,** une autre manière de montrer la condition (autre que celle utilisée pour le modèle simplifié) est de considérer le système suivant donné par $\beta$ = 0: </span>
<span id="cb18-947"><a href="#cb18-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-948"><a href="#cb18-948" aria-hidden="true" tabindex="-1"></a>$$ \left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-949"><a href="#cb18-949" aria-hidden="true" tabindex="-1"></a>\dot x = r_xx\left(1-\frac{x}{K_x}\right)-p_xxz <span class="sc">\\</span></span>
<span id="cb18-950"><a href="#cb18-950" aria-hidden="true" tabindex="-1"></a>\dot y = r_yy\left(1-\frac{y}{K_y}\right)-p_yyz <span class="sc">\\</span></span>
<span id="cb18-951"><a href="#cb18-951" aria-hidden="true" tabindex="-1"></a>\dot z = z\left(n_xx+n_yy - m\right)</span>
<span id="cb18-952"><a href="#cb18-952" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-953"><a href="#cb18-953" aria-hidden="true" tabindex="-1"></a>$$ {#eq-modelau2}</span>
<span id="cb18-954"><a href="#cb18-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-955"><a href="#cb18-955" aria-hidden="true" tabindex="-1"></a>qui pour un équilibre positif implique que :</span>
<span id="cb18-956"><a href="#cb18-956" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-957"><a href="#cb18-957" aria-hidden="true" tabindex="-1"></a>\frac{r_x}{p_x}\left(1-\frac{x^*}{K_x}\right) = \frac{r_y}{p_y}\left(1-\frac{y^*}{K_y}\right)</span>
<span id="cb18-958"><a href="#cb18-958" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-959"><a href="#cb18-959" aria-hidden="true" tabindex="-1"></a>qui donne, via la condition $z &gt; 0$, après réarrangement:</span>
<span id="cb18-960"><a href="#cb18-960" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-961"><a href="#cb18-961" aria-hidden="true" tabindex="-1"></a>x^* = \frac{K_x\left(r_xp_yn_yK_y-r_yp_xn_yK_y+r_yp_xm\right)}{r_xp_yn_yK_y+r_yp_xn_xK_x}</span>
<span id="cb18-962"><a href="#cb18-962" aria-hidden="true" tabindex="-1"></a>$${#eq-eqx}</span>
<span id="cb18-963"><a href="#cb18-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-964"><a href="#cb18-964" aria-hidden="true" tabindex="-1"></a>Par l'expression de $z^*$ on a $K_x &gt; x^*$ autrement dit :</span>
<span id="cb18-965"><a href="#cb18-965" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-966"><a href="#cb18-966" aria-hidden="true" tabindex="-1"></a>K_x &gt; \frac{K_x\left(r_xp_yn_yK_y-r_yp_xn_yK_y+r_yp_xm\right)}{r_xp_yn_yK_y+r_yp_xn_xK_x}</span>
<span id="cb18-967"><a href="#cb18-967" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-968"><a href="#cb18-968" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-969"><a href="#cb18-969" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-970"><a href="#cb18-970" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-971"><a href="#cb18-971" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-972"><a href="#cb18-972" aria-hidden="true" tabindex="-1"></a>r_xp_yn_yK_y+r_yp_xn_xK_x &gt; r_xp_yn_yK_y-r_yp_xn_yK_y+r_yp_xm</span>
<span id="cb18-973"><a href="#cb18-973" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-974"><a href="#cb18-974" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-975"><a href="#cb18-975" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-976"><a href="#cb18-976" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-977"><a href="#cb18-977" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-978"><a href="#cb18-978" aria-hidden="true" tabindex="-1"></a>r_yp_x(n_xK_x+n_yK_y) &gt; r_yp_xm \Leftrightarrow n_xK_x + n_yK_y &gt; m</span>
<span id="cb18-979"><a href="#cb18-979" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-980"><a href="#cb18-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-981"><a href="#cb18-981" aria-hidden="true" tabindex="-1"></a>Or $x_0^*(0) = K_x$ et $y_0^*(0) = K_y$ car ce ne sont que des croissances logistiques en l'absence de prédateurs. </span>
<span id="cb18-982"><a href="#cb18-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-983"><a href="#cb18-983" aria-hidden="true" tabindex="-1"></a>Ainsi la condition $n_xx_0^*(0) + n_yy_0^*(0)&gt;m$ équivaut à $n_xK_x + n_yK_y &gt; m$ qui est la condition d'un équilibre $z&gt;0$.</span>
<span id="cb18-984"><a href="#cb18-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-985"><a href="#cb18-985" aria-hidden="true" tabindex="-1"></a>La condition d'un équilibre positif implique bien la condition d'invasion.</span>
<span id="cb18-986"><a href="#cb18-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-987"><a href="#cb18-987" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Pour $\beta =+\infty$,** on va simplifier le système (<span class="co">[</span><span class="ot">-@eq-modelau</span><span class="co">]</span>).</span>
<span id="cb18-988"><a href="#cb18-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-989"><a href="#cb18-989" aria-hidden="true" tabindex="-1"></a>On pose $N = x+y$ et en faisant tendre $\beta \to +\infty$ et en considérant $\frac{\dot x}{\gamma_x} - \frac{\dot y}{\gamma_y}$ on a forcément $\frac{x}{\gamma_x} = \frac{y}{\gamma_y}$ (similairement à la réduction du modèle simplifié).</span>
<span id="cb18-990"><a href="#cb18-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-991"><a href="#cb18-991" aria-hidden="true" tabindex="-1"></a>Cette condition permet de dire que $\frac{N}{\gamma_x+\gamma_y} = \frac{x}{\gamma_x} = \frac{y}{\gamma_y}$.  </span>
<span id="cb18-992"><a href="#cb18-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-993"><a href="#cb18-993" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-994"><a href="#cb18-994" aria-hidden="true" tabindex="-1"></a>\dot N = \frac{r_xx\gamma_x}{\gamma_x}\left(1-\frac{x\gamma_x}{K_x\gamma_x}\right) + \frac{r_yy\gamma_y}{\gamma_y}\left(1-\frac{y\gamma_y}{K_y\gamma_y}\right) - z\left(\frac{p_xx\gamma_x}{\gamma_x}+\frac{p_yy\gamma_y}{\gamma_y}\right)</span>
<span id="cb18-995"><a href="#cb18-995" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-996"><a href="#cb18-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-997"><a href="#cb18-997" aria-hidden="true" tabindex="-1"></a>En réarrangeant l'expression de droite en prenant en compte la condition précédente on a:</span>
<span id="cb18-998"><a href="#cb18-998" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-999"><a href="#cb18-999" aria-hidden="true" tabindex="-1"></a>\dot N = \underbrace{\frac{r_x\gamma_x+r_y\gamma_y}{\gamma_x+\gamma_y}}_{r_N} N \left(1 - N \underbrace{\frac{\left(\frac{r_x\gamma_x^2}{K_x}+\frac{r_y\gamma_y^2}{K_y}\right)}{(\gamma_x+\gamma_y)^2(r_x\gamma_x+r_y\gamma_y)}}_{\frac{1}{K_N}} \right) - zN\underbrace{\left(\frac{p_x\gamma_x+p_y\gamma_y}{\gamma_x+\gamma_y}\right)}_{p_N}</span>
<span id="cb18-1000"><a href="#cb18-1000" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1001"><a href="#cb18-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1002"><a href="#cb18-1002" aria-hidden="true" tabindex="-1"></a>Pour $\dot z$ on a :</span>
<span id="cb18-1003"><a href="#cb18-1003" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1004"><a href="#cb18-1004" aria-hidden="true" tabindex="-1"></a>\dot z = z\left(\frac{n_xx\gamma_x}{\gamma_x}+\frac{n_yy\gamma_y}{\gamma_y}-m\right)</span>
<span id="cb18-1005"><a href="#cb18-1005" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1006"><a href="#cb18-1006" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1007"><a href="#cb18-1007" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-1008"><a href="#cb18-1008" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1009"><a href="#cb18-1009" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1010"><a href="#cb18-1010" aria-hidden="true" tabindex="-1"></a>\dot z = z\left( N \underbrace{\frac{n_x\gamma_x+n_y\gamma_y}{\gamma_x+\gamma_y}}_{n_N} - m\right)</span>
<span id="cb18-1011"><a href="#cb18-1011" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1012"><a href="#cb18-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1013"><a href="#cb18-1013" aria-hidden="true" tabindex="-1"></a>Le système (<span class="co">[</span><span class="ot">-@eq-modelau</span><span class="co">]</span>) devient donc pour $\beta \to +\infty$ :</span>
<span id="cb18-1014"><a href="#cb18-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1015"><a href="#cb18-1015" aria-hidden="true" tabindex="-1"></a>$$ \left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb18-1016"><a href="#cb18-1016" aria-hidden="true" tabindex="-1"></a>\dot N = r_N N \left(1-\frac{N}{K_N}\right) - p_NzN <span class="sc">\\</span></span>
<span id="cb18-1017"><a href="#cb18-1017" aria-hidden="true" tabindex="-1"></a>\dot z = z\left(n_N N - m\right)</span>
<span id="cb18-1018"><a href="#cb18-1018" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb18-1019"><a href="#cb18-1019" aria-hidden="true" tabindex="-1"></a>$${#eq-systsimpl}</span>
<span id="cb18-1020"><a href="#cb18-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1021"><a href="#cb18-1021" aria-hidden="true" tabindex="-1"></a>qui est exactement un système proie-prédateur de Lotka-Volterra avec croissance logistique des proies.  </span>
<span id="cb18-1022"><a href="#cb18-1022" aria-hidden="true" tabindex="-1"></a>Si $\exists z^* &gt; 0$ on a à la fois $N^*=\frac{m}{n_N}$ et aussi $N^* &lt; K_N$</span>
<span id="cb18-1023"><a href="#cb18-1023" aria-hidden="true" tabindex="-1"></a>et donc on a la condition suivante, s'il existe un équilibre non nul, $K_N n_N &gt; m$.  </span>
<span id="cb18-1024"><a href="#cb18-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1025"><a href="#cb18-1025" aria-hidden="true" tabindex="-1"></a>Or, en prenant $n_xx_0^*(+\infty) + n_yy_0^*(+\infty) &gt; m$ on a :</span>
<span id="cb18-1026"><a href="#cb18-1026" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1027"><a href="#cb18-1027" aria-hidden="true" tabindex="-1"></a>\frac{n_xx_0^*(+\infty)\gamma_x}{\gamma_x} + \frac{n_yy_0^*(+\infty)\gamma_y}{\gamma_y} &gt; m</span>
<span id="cb18-1028"><a href="#cb18-1028" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1029"><a href="#cb18-1029" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1030"><a href="#cb18-1030" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb18-1031"><a href="#cb18-1031" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1032"><a href="#cb18-1032" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1033"><a href="#cb18-1033" aria-hidden="true" tabindex="-1"></a>\frac{N^*_0}{\gamma_x+\gamma_y}(n_x\gamma_x+n_y\gamma_y) &gt; m</span>
<span id="cb18-1034"><a href="#cb18-1034" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1035"><a href="#cb18-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1036"><a href="#cb18-1036" aria-hidden="true" tabindex="-1"></a>avec $N^*_0$ qui est l'équilibre du système de L-V pour $z=0$. Cet équilibre est trivialement égal à $K_N$ et donc on a:</span>
<span id="cb18-1037"><a href="#cb18-1037" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1038"><a href="#cb18-1038" aria-hidden="true" tabindex="-1"></a>K_N n_N &gt; m</span>
<span id="cb18-1039"><a href="#cb18-1039" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb18-1040"><a href="#cb18-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1041"><a href="#cb18-1041" aria-hidden="true" tabindex="-1"></a>Nos intuitions biologiques étant validées mathématiquement pour $\beta = 0$ et $\beta = +\infty$ on peut logiquement se dire que c'est aussi le cas pour un $\beta \in ]0,+\infty[$.</span>
<span id="cb18-1042"><a href="#cb18-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1043"><a href="#cb18-1043" aria-hidden="true" tabindex="-1"></a>On va simuler numériquement la somme des équilibres des proies du système (<span class="co">[</span><span class="ot">-@eq-modelau</span><span class="co">]</span>) par la même méthode que précédemment en faisant aussi aparaître la courbe $n_xx^*_0+n_yy^*_0$ et $m$ ainsi que la somme des équilibres des proies du système ([-@eq-modamig]) sans prédateurs pour pouvoir voir quand on a disparition des prédateurs et donc $x^*_0 + y^*_0 = x^*+y^*$.</span>
<span id="cb18-1044"><a href="#cb18-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1045"><a href="#cb18-1045" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Déflation du système sans prédateurs</span></span>
<span id="cb18-1046"><a href="#cb18-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1049"><a href="#cb18-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-1050"><a href="#cb18-1050" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb18-1051"><a href="#cb18-1051" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition du modèle avec prédateurs:</span></span>
<span id="cb18-1052"><a href="#cb18-1052" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> a(etat,t,param,i):</span>
<span id="cb18-1053"><a href="#cb18-1053" aria-hidden="true" tabindex="-1"></a>    x,y,z<span class="op">=</span>etat</span>
<span id="cb18-1054"><a href="#cb18-1054" aria-hidden="true" tabindex="-1"></a>    b<span class="op">=</span>i</span>
<span id="cb18-1055"><a href="#cb18-1055" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,gy,px,py,nx,ny,m <span class="op">=</span> param</span>
<span id="cb18-1056"><a href="#cb18-1056" aria-hidden="true" tabindex="-1"></a>    xdot,ydot,zdot<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx)<span class="op">-</span>px<span class="op">*</span>z<span class="op">*</span>x,ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)<span class="op">-</span>py<span class="op">*</span>y<span class="op">*</span>z,z<span class="op">*</span>(nx<span class="op">*</span>x<span class="op">+</span>ny<span class="op">*</span>y<span class="op">-</span>m)]</span>
<span id="cb18-1057"><a href="#cb18-1057" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [xdot,ydot,zdot]</span>
<span id="cb18-1058"><a href="#cb18-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1059"><a href="#cb18-1059" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition du modèle sans prédateurs:</span></span>
<span id="cb18-1060"><a href="#cb18-1060" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug2(etat,t,param,i):</span>
<span id="cb18-1061"><a href="#cb18-1061" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,gy<span class="op">=</span>param</span>
<span id="cb18-1062"><a href="#cb18-1062" aria-hidden="true" tabindex="-1"></a>    b<span class="op">=</span>i</span>
<span id="cb18-1063"><a href="#cb18-1063" aria-hidden="true" tabindex="-1"></a>    x,y<span class="op">=</span>etat</span>
<span id="cb18-1064"><a href="#cb18-1064" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx),ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)]</span>
<span id="cb18-1065"><a href="#cb18-1065" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb18-1066"><a href="#cb18-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1067"><a href="#cb18-1067" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb18-1068"><a href="#cb18-1068" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb18-1069"><a href="#cb18-1069" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-1070"><a href="#cb18-1070" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1071"><a href="#cb18-1071" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-1072"><a href="#cb18-1072" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1073"><a href="#cb18-1073" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-1074"><a href="#cb18-1074" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb18-1075"><a href="#cb18-1075" aria-hidden="true" tabindex="-1"></a>px1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-1076"><a href="#cb18-1076" aria-hidden="true" tabindex="-1"></a>py1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-1077"><a href="#cb18-1077" aria-hidden="true" tabindex="-1"></a>nx1<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-1078"><a href="#cb18-1078" aria-hidden="true" tabindex="-1"></a>ny1<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-1079"><a href="#cb18-1079" aria-hidden="true" tabindex="-1"></a>m11<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-1080"><a href="#cb18-1080" aria-hidden="true" tabindex="-1"></a>m12<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb18-1081"><a href="#cb18-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1082"><a href="#cb18-1082" aria-hidden="true" tabindex="-1"></a>param11p<span class="op">=</span>np.array([rx1,Kx1,ry1,Ky1,gx1,gy1,px1,py1,nx1,ny1,m11])</span>
<span id="cb18-1083"><a href="#cb18-1083" aria-hidden="true" tabindex="-1"></a>param11sp<span class="op">=</span>param11p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb18-1084"><a href="#cb18-1084" aria-hidden="true" tabindex="-1"></a>param12p<span class="op">=</span>np.array([rx1,Kx1,ry1,Ky1,gx1,gy1,px1,py1,nx1,ny1,m12])</span>
<span id="cb18-1085"><a href="#cb18-1085" aria-hidden="true" tabindex="-1"></a>param12sp<span class="op">=</span>param12p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb18-1086"><a href="#cb18-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1087"><a href="#cb18-1087" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration suffisament large pour atteindre l'équilibre:</span></span>
<span id="cb18-1088"><a href="#cb18-1088" aria-hidden="true" tabindex="-1"></a>t<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">600</span>,<span class="fl">0.01</span>)</span>
<span id="cb18-1089"><a href="#cb18-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1090"><a href="#cb18-1090" aria-hidden="true" tabindex="-1"></a><span class="co">#Condition initiale:</span></span>
<span id="cb18-1091"><a href="#cb18-1091" aria-hidden="true" tabindex="-1"></a>e0p<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb18-1092"><a href="#cb18-1092" aria-hidden="true" tabindex="-1"></a>e0sp<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb18-1093"><a href="#cb18-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1094"><a href="#cb18-1094" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb18-1095"><a href="#cb18-1095" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb18-1096"><a href="#cb18-1096" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb18-1097"><a href="#cb18-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1098"><a href="#cb18-1098" aria-hidden="true" tabindex="-1"></a>xt<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb18-1099"><a href="#cb18-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1100"><a href="#cb18-1100" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb18-1101"><a href="#cb18-1101" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb18-1102"><a href="#cb18-1102" aria-hidden="true" tabindex="-1"></a>    s1p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param11p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb18-1103"><a href="#cb18-1103" aria-hidden="true" tabindex="-1"></a>    s1sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param11sp,i))</span>
<span id="cb18-1104"><a href="#cb18-1104" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s1p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s1p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb18-1105"><a href="#cb18-1105" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,nx1<span class="op">*</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny1<span class="op">*</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb18-1106"><a href="#cb18-1106" aria-hidden="true" tabindex="-1"></a>    ax.plot(xt,m11<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb18-1107"><a href="#cb18-1107" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb18-1108"><a href="#cb18-1108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1109"><a href="#cb18-1109" aria-hidden="true" tabindex="-1"></a>    s1p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param12p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb18-1110"><a href="#cb18-1110" aria-hidden="true" tabindex="-1"></a>    s1sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param12sp,i))</span>
<span id="cb18-1111"><a href="#cb18-1111" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1112"><a href="#cb18-1112" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s1p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s1p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb18-1113"><a href="#cb18-1113" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,nx1<span class="op">*</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny1<span class="op">*</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb18-1114"><a href="#cb18-1114" aria-hidden="true" tabindex="-1"></a>    ax1.plot(xt,m12<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb18-1115"><a href="#cb18-1115" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s1sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb18-1116"><a href="#cb18-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1117"><a href="#cb18-1117" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1118"><a href="#cb18-1118" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1119"><a href="#cb18-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky:    </span></span>
<span id="cb18-1120"><a href="#cb18-1120" aria-hidden="true" tabindex="-1"></a>ax.plot(xt,(Kx1<span class="op">+</span>Ky1)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-1121"><a href="#cb18-1121" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt,(Kx1<span class="op">+</span>Ky1)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-1122"><a href="#cb18-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1123"><a href="#cb18-1123" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb18-1124"><a href="#cb18-1124" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-1125"><a href="#cb18-1125" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-1126"><a href="#cb18-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1127"><a href="#cb18-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1128"><a href="#cb18-1128" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb18-1129"><a href="#cb18-1129" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx1 <span class="op">+</span> Ky1,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres sans prédateurs'</span>)</span>
<span id="cb18-1130"><a href="#cb18-1130" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx1 <span class="op">+</span> Ky1,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb18-1131"><a href="#cb18-1131" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx1 <span class="op">+</span> Ky1,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'r'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'nx*x+ny*y'</span>)</span>
<span id="cb18-1132"><a href="#cb18-1132" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx1 <span class="op">+</span> Ky1,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'g'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m'</span>)</span>
<span id="cb18-1133"><a href="#cb18-1133" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx1 <span class="op">+</span> Ky1,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb18-1134"><a href="#cb18-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1135"><a href="#cb18-1135" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb18-1136"><a href="#cb18-1136" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">5.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-1137"><a href="#cb18-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1138"><a href="#cb18-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb18-1139"><a href="#cb18-1139" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)</span>
<span id="cb18-1140"><a href="#cb18-1140" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Déflation'</span>)</span>
<span id="cb18-1141"><a href="#cb18-1141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-1142"><a href="#cb18-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1143"><a href="#cb18-1143" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inflation/déflation du système sans prédateurs</span></span>
<span id="cb18-1144"><a href="#cb18-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1147"><a href="#cb18-1147" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-1148"><a href="#cb18-1148" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb18-1149"><a href="#cb18-1149" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres</span></span>
<span id="cb18-1150"><a href="#cb18-1150" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb18-1151"><a href="#cb18-1151" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-1152"><a href="#cb18-1152" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1153"><a href="#cb18-1153" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-1154"><a href="#cb18-1154" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1155"><a href="#cb18-1155" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb18-1156"><a href="#cb18-1156" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1157"><a href="#cb18-1157" aria-hidden="true" tabindex="-1"></a>px2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-1158"><a href="#cb18-1158" aria-hidden="true" tabindex="-1"></a>py2<span class="op">=</span><span class="dv">3</span></span>
<span id="cb18-1159"><a href="#cb18-1159" aria-hidden="true" tabindex="-1"></a>nx2<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-1160"><a href="#cb18-1160" aria-hidden="true" tabindex="-1"></a>ny2<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-1161"><a href="#cb18-1161" aria-hidden="true" tabindex="-1"></a>m21<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-1162"><a href="#cb18-1162" aria-hidden="true" tabindex="-1"></a>m22<span class="op">=</span><span class="fl">1.9</span></span>
<span id="cb18-1163"><a href="#cb18-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1164"><a href="#cb18-1164" aria-hidden="true" tabindex="-1"></a>param21p<span class="op">=</span>np.array([rx2,Kx2,ry2,Ky2,gx2,gy2,px2,py2,nx2,ny2,m21])</span>
<span id="cb18-1165"><a href="#cb18-1165" aria-hidden="true" tabindex="-1"></a>param21sp<span class="op">=</span>param21p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb18-1166"><a href="#cb18-1166" aria-hidden="true" tabindex="-1"></a>param22p<span class="op">=</span>np.array([rx2,Kx2,ry2,Ky2,gx2,gy2,px2,py2,nx2,ny2,m22])</span>
<span id="cb18-1167"><a href="#cb18-1167" aria-hidden="true" tabindex="-1"></a>param22sp<span class="op">=</span>param22p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb18-1168"><a href="#cb18-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1169"><a href="#cb18-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb18-1170"><a href="#cb18-1170" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb18-1171"><a href="#cb18-1171" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb18-1172"><a href="#cb18-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1173"><a href="#cb18-1173" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb18-1174"><a href="#cb18-1174" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb18-1175"><a href="#cb18-1175" aria-hidden="true" tabindex="-1"></a>    s2p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param21p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb18-1176"><a href="#cb18-1176" aria-hidden="true" tabindex="-1"></a>    s2sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param21sp,i))</span>
<span id="cb18-1177"><a href="#cb18-1177" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1178"><a href="#cb18-1178" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s2p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s2p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb18-1179"><a href="#cb18-1179" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,nx2<span class="op">*</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny2<span class="op">*</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb18-1180"><a href="#cb18-1180" aria-hidden="true" tabindex="-1"></a>    ax.plot(xt,m21<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb18-1181"><a href="#cb18-1181" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb18-1182"><a href="#cb18-1182" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1183"><a href="#cb18-1183" aria-hidden="true" tabindex="-1"></a>    s2p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param22p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb18-1184"><a href="#cb18-1184" aria-hidden="true" tabindex="-1"></a>    s2sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param22sp,i))</span>
<span id="cb18-1185"><a href="#cb18-1185" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1186"><a href="#cb18-1186" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s2p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s2p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb18-1187"><a href="#cb18-1187" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,nx2<span class="op">*</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny2<span class="op">*</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb18-1188"><a href="#cb18-1188" aria-hidden="true" tabindex="-1"></a>    ax1.plot(xt,m22<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb18-1189"><a href="#cb18-1189" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s2sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb18-1190"><a href="#cb18-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1191"><a href="#cb18-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1192"><a href="#cb18-1192" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky: </span></span>
<span id="cb18-1193"><a href="#cb18-1193" aria-hidden="true" tabindex="-1"></a>ax.plot(xt,(Kx2<span class="op">+</span>Ky2)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-1194"><a href="#cb18-1194" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt,(Kx2<span class="op">+</span>Ky2)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-1195"><a href="#cb18-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1196"><a href="#cb18-1196" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb18-1197"><a href="#cb18-1197" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-1198"><a href="#cb18-1198" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-1199"><a href="#cb18-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1200"><a href="#cb18-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1201"><a href="#cb18-1201" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb18-1202"><a href="#cb18-1202" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx2 <span class="op">+</span> Ky2,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres sans prédateurs'</span>)</span>
<span id="cb18-1203"><a href="#cb18-1203" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx2 <span class="op">+</span> Ky2,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb18-1204"><a href="#cb18-1204" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx2 <span class="op">+</span> Ky2,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'r'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'nx*x+ny*y'</span>)</span>
<span id="cb18-1205"><a href="#cb18-1205" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx2 <span class="op">+</span> Ky2,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'g'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m'</span>)</span>
<span id="cb18-1206"><a href="#cb18-1206" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx2 <span class="op">+</span> Ky2,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb18-1207"><a href="#cb18-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1208"><a href="#cb18-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb18-1209"><a href="#cb18-1209" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">5.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-1210"><a href="#cb18-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1211"><a href="#cb18-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb18-1212"><a href="#cb18-1212" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)</span>
<span id="cb18-1213"><a href="#cb18-1213" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Les deux'</span>)</span>
<span id="cb18-1214"><a href="#cb18-1214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-1215"><a href="#cb18-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1216"><a href="#cb18-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1217"><a href="#cb18-1217" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inflation du système sans prédateurs</span></span>
<span id="cb18-1218"><a href="#cb18-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1219"><a href="#cb18-1219" aria-hidden="true" tabindex="-1"></a>On va montrer deux cas, l'un avec $n_xx^*_0 + n_yy^*_0 = m$ décroissant et l'autre avec $n_xx^*_0 + n_yy^*_0 = m$ croissant :</span>
<span id="cb18-1222"><a href="#cb18-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-1223"><a href="#cb18-1223" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb18-1224"><a href="#cb18-1224" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres</span></span>
<span id="cb18-1225"><a href="#cb18-1225" aria-hidden="true" tabindex="-1"></a><span class="co">#3:</span></span>
<span id="cb18-1226"><a href="#cb18-1226" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1227"><a href="#cb18-1227" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-1228"><a href="#cb18-1228" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-1229"><a href="#cb18-1229" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb18-1230"><a href="#cb18-1230" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-1231"><a href="#cb18-1231" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1232"><a href="#cb18-1232" aria-hidden="true" tabindex="-1"></a>px3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1233"><a href="#cb18-1233" aria-hidden="true" tabindex="-1"></a>py3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-1234"><a href="#cb18-1234" aria-hidden="true" tabindex="-1"></a>nx3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-1235"><a href="#cb18-1235" aria-hidden="true" tabindex="-1"></a>ny3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1236"><a href="#cb18-1236" aria-hidden="true" tabindex="-1"></a>m31 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb18-1237"><a href="#cb18-1237" aria-hidden="true" tabindex="-1"></a>m32 <span class="op">=</span> <span class="fl">2.45</span></span>
<span id="cb18-1238"><a href="#cb18-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1239"><a href="#cb18-1239" aria-hidden="true" tabindex="-1"></a>param31p <span class="op">=</span> np.array([rx3, Kx3, ry3, Ky3,gx3,gy3,px3,py3,nx3,ny3,m31])</span>
<span id="cb18-1240"><a href="#cb18-1240" aria-hidden="true" tabindex="-1"></a>param31sp<span class="op">=</span>param31p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb18-1241"><a href="#cb18-1241" aria-hidden="true" tabindex="-1"></a>param32p<span class="op">=</span>np.array([rx3,Kx3,ry3,Ky3,gx3,gy3,px3,py3,nx3,ny3,m32])</span>
<span id="cb18-1242"><a href="#cb18-1242" aria-hidden="true" tabindex="-1"></a>param32sp<span class="op">=</span>param32p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb18-1243"><a href="#cb18-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1244"><a href="#cb18-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1245"><a href="#cb18-1245" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb18-1246"><a href="#cb18-1246" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb18-1247"><a href="#cb18-1247" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb18-1248"><a href="#cb18-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1249"><a href="#cb18-1249" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb18-1250"><a href="#cb18-1250" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb18-1251"><a href="#cb18-1251" aria-hidden="true" tabindex="-1"></a>    s3p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param31p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb18-1252"><a href="#cb18-1252" aria-hidden="true" tabindex="-1"></a>    s3sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param31sp,i))</span>
<span id="cb18-1253"><a href="#cb18-1253" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1254"><a href="#cb18-1254" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s3p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s3p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb18-1255"><a href="#cb18-1255" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,nx3<span class="op">*</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny3<span class="op">*</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb18-1256"><a href="#cb18-1256" aria-hidden="true" tabindex="-1"></a>    ax.plot(xt,m31<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb18-1257"><a href="#cb18-1257" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb18-1258"><a href="#cb18-1258" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1259"><a href="#cb18-1259" aria-hidden="true" tabindex="-1"></a>    s3p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param32p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb18-1260"><a href="#cb18-1260" aria-hidden="true" tabindex="-1"></a>    s3sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param32sp,i))</span>
<span id="cb18-1261"><a href="#cb18-1261" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1262"><a href="#cb18-1262" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s3p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s3p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb18-1263"><a href="#cb18-1263" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,nx3<span class="op">*</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny3<span class="op">*</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb18-1264"><a href="#cb18-1264" aria-hidden="true" tabindex="-1"></a>    ax1.plot(xt,m32<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb18-1265"><a href="#cb18-1265" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s3sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb18-1266"><a href="#cb18-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1267"><a href="#cb18-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1268"><a href="#cb18-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky: </span></span>
<span id="cb18-1269"><a href="#cb18-1269" aria-hidden="true" tabindex="-1"></a>ax.plot(xt,(Kx3<span class="op">+</span>Ky3)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-1270"><a href="#cb18-1270" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt,(Kx3<span class="op">+</span>Ky3)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-1271"><a href="#cb18-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1272"><a href="#cb18-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1273"><a href="#cb18-1273" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb18-1274"><a href="#cb18-1274" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-1275"><a href="#cb18-1275" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-1276"><a href="#cb18-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1277"><a href="#cb18-1277" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb18-1278"><a href="#cb18-1278" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx3 <span class="op">+</span> Ky3,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres sans prédateurs'</span>)</span>
<span id="cb18-1279"><a href="#cb18-1279" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx3 <span class="op">+</span> Ky3,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb18-1280"><a href="#cb18-1280" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx3 <span class="op">+</span> Ky3,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'r'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'nx*x+ny*y'</span>)</span>
<span id="cb18-1281"><a href="#cb18-1281" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx3 <span class="op">+</span> Ky3,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'g'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m'</span>)</span>
<span id="cb18-1282"><a href="#cb18-1282" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx3 <span class="op">+</span> Ky3,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb18-1283"><a href="#cb18-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1284"><a href="#cb18-1284" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb18-1285"><a href="#cb18-1285" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">5.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-1286"><a href="#cb18-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1287"><a href="#cb18-1287" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb18-1288"><a href="#cb18-1288" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)</span>
<span id="cb18-1289"><a href="#cb18-1289" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Les deux'</span>)</span>
<span id="cb18-1290"><a href="#cb18-1290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-1291"><a href="#cb18-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1292"><a href="#cb18-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1295"><a href="#cb18-1295" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-1296"><a href="#cb18-1296" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb18-1297"><a href="#cb18-1297" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres</span></span>
<span id="cb18-1298"><a href="#cb18-1298" aria-hidden="true" tabindex="-1"></a><span class="co">#4:</span></span>
<span id="cb18-1299"><a href="#cb18-1299" aria-hidden="true" tabindex="-1"></a>rx4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-1300"><a href="#cb18-1300" aria-hidden="true" tabindex="-1"></a>ry4 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1301"><a href="#cb18-1301" aria-hidden="true" tabindex="-1"></a>Kx4 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1302"><a href="#cb18-1302" aria-hidden="true" tabindex="-1"></a>Ky4 <span class="op">=</span> <span class="fl">1.25</span></span>
<span id="cb18-1303"><a href="#cb18-1303" aria-hidden="true" tabindex="-1"></a>gx4 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-1304"><a href="#cb18-1304" aria-hidden="true" tabindex="-1"></a>gy4 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1305"><a href="#cb18-1305" aria-hidden="true" tabindex="-1"></a>px4<span class="op">=</span><span class="dv">3</span></span>
<span id="cb18-1306"><a href="#cb18-1306" aria-hidden="true" tabindex="-1"></a>py4<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-1307"><a href="#cb18-1307" aria-hidden="true" tabindex="-1"></a>nx4<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb18-1308"><a href="#cb18-1308" aria-hidden="true" tabindex="-1"></a>ny4<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-1309"><a href="#cb18-1309" aria-hidden="true" tabindex="-1"></a>m41<span class="op">=</span><span class="fl">1.4</span></span>
<span id="cb18-1310"><a href="#cb18-1310" aria-hidden="true" tabindex="-1"></a>m42<span class="op">=</span><span class="fl">1.82</span></span>
<span id="cb18-1311"><a href="#cb18-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1312"><a href="#cb18-1312" aria-hidden="true" tabindex="-1"></a>param41p<span class="op">=</span>np.array([rx4,Kx4,ry4,Ky4,gx4,gy4,px4,py4,nx4,ny4,m41])</span>
<span id="cb18-1313"><a href="#cb18-1313" aria-hidden="true" tabindex="-1"></a>param41sp<span class="op">=</span>param41p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb18-1314"><a href="#cb18-1314" aria-hidden="true" tabindex="-1"></a>param42p<span class="op">=</span>np.array([rx4,Kx4,ry4,Ky4,gx4,gy4,px4,py4,nx4,ny4,m42])</span>
<span id="cb18-1315"><a href="#cb18-1315" aria-hidden="true" tabindex="-1"></a>param42sp<span class="op">=</span>param42p[<span class="dv">0</span>:<span class="dv">6</span>]</span>
<span id="cb18-1316"><a href="#cb18-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1317"><a href="#cb18-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1318"><a href="#cb18-1318" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb18-1319"><a href="#cb18-1319" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">5</span>))</span>
<span id="cb18-1320"><a href="#cb18-1320" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb18-1321"><a href="#cb18-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1322"><a href="#cb18-1322" aria-hidden="true" tabindex="-1"></a>xt<span class="op">=</span>np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb18-1323"><a href="#cb18-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1324"><a href="#cb18-1324" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb18-1325"><a href="#cb18-1325" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>):</span>
<span id="cb18-1326"><a href="#cb18-1326" aria-hidden="true" tabindex="-1"></a>    s4p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param41p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb18-1327"><a href="#cb18-1327" aria-hidden="true" tabindex="-1"></a>    s4sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param41sp,i))</span>
<span id="cb18-1328"><a href="#cb18-1328" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb18-1329"><a href="#cb18-1329" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s4p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s4p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb18-1330"><a href="#cb18-1330" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,nx4<span class="op">*</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny4<span class="op">*</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb18-1331"><a href="#cb18-1331" aria-hidden="true" tabindex="-1"></a>    ax.plot(xt,m41<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb18-1332"><a href="#cb18-1332" aria-hidden="true" tabindex="-1"></a>    ax.plot(i,s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb18-1333"><a href="#cb18-1333" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1334"><a href="#cb18-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1335"><a href="#cb18-1335" aria-hidden="true" tabindex="-1"></a>    s4p<span class="op">=</span>odeint(a,e0p,t,args<span class="op">=</span>(param42p,i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb18-1336"><a href="#cb18-1336" aria-hidden="true" tabindex="-1"></a>    s4sp<span class="op">=</span>odeint(aug2,e0sp,t,args<span class="op">=</span>(param42sp,i))</span>
<span id="cb18-1337"><a href="#cb18-1337" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-1338"><a href="#cb18-1338" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s4p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s4p[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span><span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb18-1339"><a href="#cb18-1339" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,nx4<span class="op">*</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>ny4<span class="op">*</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb18-1340"><a href="#cb18-1340" aria-hidden="true" tabindex="-1"></a>    ax1.plot(xt,m42<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">"dashed"</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb18-1341"><a href="#cb18-1341" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i,s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]<span class="op">+</span>s4sp[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>],marker<span class="op">=</span><span class="st">'.'</span>,markersize<span class="op">=</span><span class="dv">1</span>,color<span class="op">=</span><span class="st">'0.8'</span>)</span>
<span id="cb18-1342"><a href="#cb18-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1343"><a href="#cb18-1343" aria-hidden="true" tabindex="-1"></a>ax.plot(xt,(Kx4<span class="op">+</span>Ky4)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-1344"><a href="#cb18-1344" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt,(Kx4<span class="op">+</span>Ky4)<span class="op">*</span>np.ones_like(xt),linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>)</span>
<span id="cb18-1345"><a href="#cb18-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1346"><a href="#cb18-1346" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb18-1347"><a href="#cb18-1347" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-1348"><a href="#cb18-1348" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb18-1349"><a href="#cb18-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1350"><a href="#cb18-1350" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb18-1351"><a href="#cb18-1351" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx4 <span class="op">+</span> Ky4,color<span class="op">=</span><span class="st">'0.8'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres sans prédateurs'</span>)</span>
<span id="cb18-1352"><a href="#cb18-1352" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx4 <span class="op">+</span> Ky4,color<span class="op">=</span><span class="st">'C0'</span>,label<span class="op">=</span><span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb18-1353"><a href="#cb18-1353" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx4 <span class="op">+</span> Ky4,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'r'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'nx*x+ny*y'</span>)</span>
<span id="cb18-1354"><a href="#cb18-1354" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx4 <span class="op">+</span> Ky4,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'g'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'m'</span>)</span>
<span id="cb18-1355"><a href="#cb18-1355" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>,Kx4 <span class="op">+</span> Ky4,linestyle<span class="op">=</span><span class="st">'dashed'</span>,color<span class="op">=</span><span class="st">'k'</span>,markersize<span class="op">=</span><span class="st">'6'</span>,label<span class="op">=</span><span class="st">'Kx+Ky'</span>)</span>
<span id="cb18-1356"><a href="#cb18-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1357"><a href="#cb18-1357" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb18-1358"><a href="#cb18-1358" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">5.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-1359"><a href="#cb18-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1360"><a href="#cb18-1360" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb18-1361"><a href="#cb18-1361" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)</span>
<span id="cb18-1362"><a href="#cb18-1362" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Les deux'</span>)</span>
<span id="cb18-1363"><a href="#cb18-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-1364"><a href="#cb18-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1365"><a href="#cb18-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1366"><a href="#cb18-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1367"><a href="#cb18-1367" aria-hidden="true" tabindex="-1"></a>On observe que si $m$ est toujours plus grand que $n_xx_0^*+n_yy_0^*$ alors les prédateurs disparaissent et on a que la somme des équilibres est égale à $x_0^*+y_0^*$ (la courbe bleu est tout le temps confondue avec la courbe grise).  </span>
<span id="cb18-1368"><a href="#cb18-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1369"><a href="#cb18-1369" aria-hidden="true" tabindex="-1"></a>Ensuite, quand $m$ est toujours plus petit que $n_xx_0^*+n_yy_0^*$ alors les prédateurs sont toujours en vie et on a que la somme des équilibres est égale à $x^*+y^*$.  </span>
<span id="cb18-1370"><a href="#cb18-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1371"><a href="#cb18-1371" aria-hidden="true" tabindex="-1"></a>Enfin, quand $m$ croise $n_xx_0^*+n_yy_0^*$ on observe que la somme des équilibres est à la fois $x^*+y^*$ et $x_0^*+y_0^*$. Si $n_xx_0^*+n_yy_0^*$ est croissant alors on a d'abord que la somme des équilibres est égale à $x_0^*+y_0^*$ puis $x^*+y^*$ et inversement si $n_xx_0^*+n_yy_0^*$ est décroissante.  </span>
<span id="cb18-1372"><a href="#cb18-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1373"><a href="#cb18-1373" aria-hidden="true" tabindex="-1"></a><span class="fu">### Equilibre de la culture en fonction de $\gamma_x$ et $\gamma_y$</span></span>
<span id="cb18-1374"><a href="#cb18-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1375"><a href="#cb18-1375" aria-hidden="true" tabindex="-1"></a>On va maintenant tracer l'équilibre dans la culture en fonction du taux de migration et de fuite.  </span>
<span id="cb18-1376"><a href="#cb18-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1379"><a href="#cb18-1379" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-1380"><a href="#cb18-1380" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb18-1381"><a href="#cb18-1381" aria-hidden="true" tabindex="-1"></a><span class="co">#On définit un nouveau modèle qui prend en compte le changement de gy</span></span>
<span id="cb18-1382"><a href="#cb18-1382" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> a2(etat,t,param,i):</span>
<span id="cb18-1383"><a href="#cb18-1383" aria-hidden="true" tabindex="-1"></a>    x,y,z<span class="op">=</span>etat</span>
<span id="cb18-1384"><a href="#cb18-1384" aria-hidden="true" tabindex="-1"></a>    gy<span class="op">=</span>i</span>
<span id="cb18-1385"><a href="#cb18-1385" aria-hidden="true" tabindex="-1"></a>    rx,Kx,ry,Ky,gx,b,px,py,nx,ny,m <span class="op">=</span> param</span>
<span id="cb18-1386"><a href="#cb18-1386" aria-hidden="true" tabindex="-1"></a>    xdot,ydot,zdot<span class="op">=</span>[rx<span class="op">*</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">/</span>Kx)<span class="op">+</span>b<span class="op">*</span>(y<span class="op">/</span>gy<span class="op">-</span>x<span class="op">/</span>gx)<span class="op">-</span>px<span class="op">*</span>z<span class="op">*</span>x,ry<span class="op">*</span>y<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">/</span>Ky)<span class="op">+</span>b<span class="op">*</span>(x<span class="op">/</span>gx<span class="op">-</span>y<span class="op">/</span>gy)<span class="op">-</span>py<span class="op">*</span>y<span class="op">*</span>z,z<span class="op">*</span>(nx<span class="op">*</span>x<span class="op">+</span>ny<span class="op">*</span>y<span class="op">-</span>m)]</span>
<span id="cb18-1387"><a href="#cb18-1387" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [xdot,ydot,zdot]</span>
<span id="cb18-1388"><a href="#cb18-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1389"><a href="#cb18-1389" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition de l'ancien modèle qui prend en compte le changement de gy:</span></span>
<span id="cb18-1390"><a href="#cb18-1390" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug3(etat, t, param, h):</span>
<span id="cb18-1391"><a href="#cb18-1391" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, b <span class="op">=</span> param</span>
<span id="cb18-1392"><a href="#cb18-1392" aria-hidden="true" tabindex="-1"></a>    gy <span class="op">=</span> h</span>
<span id="cb18-1393"><a href="#cb18-1393" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb18-1394"><a href="#cb18-1394" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb18-1395"><a href="#cb18-1395" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb18-1396"><a href="#cb18-1396" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb18-1397"><a href="#cb18-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1398"><a href="#cb18-1398" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb18-1399"><a href="#cb18-1399" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb18-1400"><a href="#cb18-1400" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-1401"><a href="#cb18-1401" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb18-1402"><a href="#cb18-1402" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1403"><a href="#cb18-1403" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-1404"><a href="#cb18-1404" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-1405"><a href="#cb18-1405" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1406"><a href="#cb18-1406" aria-hidden="true" tabindex="-1"></a>px <span class="op">=</span> <span class="fl">0.75</span></span>
<span id="cb18-1407"><a href="#cb18-1407" aria-hidden="true" tabindex="-1"></a>py <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1408"><a href="#cb18-1408" aria-hidden="true" tabindex="-1"></a>nx <span class="op">=</span> <span class="fl">0.75</span></span>
<span id="cb18-1409"><a href="#cb18-1409" aria-hidden="true" tabindex="-1"></a>ny <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-1410"><a href="#cb18-1410" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb18-1411"><a href="#cb18-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1412"><a href="#cb18-1412" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, b, px, py, nx, ny, m])</span>
<span id="cb18-1413"><a href="#cb18-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1414"><a href="#cb18-1414" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration assez large pour atteindre l'éq :</span></span>
<span id="cb18-1415"><a href="#cb18-1415" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb18-1416"><a href="#cb18-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1417"><a href="#cb18-1417" aria-hidden="true" tabindex="-1"></a><span class="co">#Conditions initiales:</span></span>
<span id="cb18-1418"><a href="#cb18-1418" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb18-1419"><a href="#cb18-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1420"><a href="#cb18-1420" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb18-1421"><a href="#cb18-1421" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb18-1422"><a href="#cb18-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1423"><a href="#cb18-1423" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite de la somme des capacités:</span></span>
<span id="cb18-1424"><a href="#cb18-1424" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb18-1425"><a href="#cb18-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1426"><a href="#cb18-1426" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb18-1427"><a href="#cb18-1427" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb18-1428"><a href="#cb18-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1429"><a href="#cb18-1429" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb18-1430"><a href="#cb18-1430" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb18-1431"><a href="#cb18-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1432"><a href="#cb18-1432" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de m/n:</span></span>
<span id="cb18-1433"><a href="#cb18-1433" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, m <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'C1'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb18-1434"><a href="#cb18-1434" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, m<span class="op">/</span>n <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'m/n'</span>)</span>
<span id="cb18-1435"><a href="#cb18-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1436"><a href="#cb18-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1437"><a href="#cb18-1437" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle qui calcule l'équilibre et qui plot un point en fonction des valeurs du taux de fuite:</span></span>
<span id="cb18-1438"><a href="#cb18-1438" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="fl">0.001</span>):</span>
<span id="cb18-1439"><a href="#cb18-1439" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(a2, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb18-1440"><a href="#cb18-1440" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb18-1441"><a href="#cb18-1441" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb18-1442"><a href="#cb18-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1443"><a href="#cb18-1443" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug3, e0[<span class="dv">0</span>:<span class="dv">2</span>], t, args <span class="op">=</span> (param1[<span class="dv">0</span>:<span class="dv">6</span>], i))</span>
<span id="cb18-1444"><a href="#cb18-1444" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb18-1445"><a href="#cb18-1445" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, nx <span class="op">*</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> ny <span class="op">*</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'r'</span>, markersize <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb18-1446"><a href="#cb18-1446" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb18-1447"><a href="#cb18-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1448"><a href="#cb18-1448" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb18-1449"><a href="#cb18-1449" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb18-1450"><a href="#cb18-1450" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb18-1451"><a href="#cb18-1451" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, Kx1 <span class="op">+</span> Ky1, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres avec prédateurs'</span>)</span>
<span id="cb18-1452"><a href="#cb18-1452" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, Kx1, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture avec prédateurs ($x^*$)'</span>)</span>
<span id="cb18-1453"><a href="#cb18-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1454"><a href="#cb18-1454" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Somme des équilibres en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb18-1455"><a href="#cb18-1455" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Equilibre de la culture en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)   </span>
<span id="cb18-1456"><a href="#cb18-1456" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize <span class="op">=</span> <span class="dv">7</span>, loc <span class="op">=</span> <span class="st">"lower right"</span>)<span class="op">;</span></span>
<span id="cb18-1457"><a href="#cb18-1457" aria-hidden="true" tabindex="-1"></a>ax1.legend(fontsize <span class="op">=</span> <span class="dv">7</span>, loc <span class="op">=</span> <span class="st">"upper right"</span>)<span class="op">;</span></span>
<span id="cb18-1458"><a href="#cb18-1458" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Densité de pop."</span>)<span class="op">;</span> </span>
<span id="cb18-1459"><a href="#cb18-1459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-1460"><a href="#cb18-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1461"><a href="#cb18-1461" aria-hidden="true" tabindex="-1"></a>On observe des résultats similaires au système simplifié. L'analyse qui en résulte est la même.  </span>
<span id="cb18-1462"><a href="#cb18-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1463"><a href="#cb18-1463" aria-hidden="true" tabindex="-1"></a>D'après les graphiques, l'effet de l'augmentorium sur l'équilibre dans la culture a l'air largement diminué dans tous les types de culture.</span>
<span id="cb18-1464"><a href="#cb18-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1465"><a href="#cb18-1465" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb18-1466"><a href="#cb18-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-1467"><a href="#cb18-1467" aria-hidden="true" tabindex="-1"></a>Ce modèle nous permet d'entrevoir mathématiquement pourquoi l'augmentorium est une technique efficace dans les cultures.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Pour plus d’informations, voyez <a href="./about.html">ici</a>.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>