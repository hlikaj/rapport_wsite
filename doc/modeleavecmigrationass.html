<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Rapport de stage - Modèle logistique structuré avec migration asymétrique</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./modeleavecmigrationass.html">Modèle logistique structuré avec migration asymétrique</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Rapport de stage</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Présentation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contexte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contexte</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelesansmigrationass.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modèle logistique structuré sans migration asymétrique</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modeleavecmigrationass.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Modèle logistique structuré avec migration asymétrique</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelaug.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modèle avec proies structurées et prédateurs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Perspectives et conclusion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#définition-du-modèle" id="toc-définition-du-modèle" class="nav-link active" data-scroll-target="#définition-du-modèle">Définition du modèle</a>
  <ul>
  <li><a href="#nouvelles-hypothèses-propres-à-laugmentorium" id="toc-nouvelles-hypothèses-propres-à-laugmentorium" class="nav-link" data-scroll-target="#nouvelles-hypothèses-propres-à-laugmentorium">Nouvelles hypothèses propres à l’augmentorium</a></li>
  </ul></li>
  <li><a href="#dynamique-du-modèle" id="toc-dynamique-du-modèle" class="nav-link" data-scroll-target="#dynamique-du-modèle">Dynamique du modèle</a></li>
  <li><a href="#plan-de-phase" id="toc-plan-de-phase" class="nav-link" data-scroll-target="#plan-de-phase">Plan de phase</a>
  <ul>
  <li><a href="#equilibres-et-leur-stabilité" id="toc-equilibres-et-leur-stabilité" class="nav-link" data-scroll-target="#equilibres-et-leur-stabilité">Equilibres et leur stabilité</a></li>
  <li><a href="#analyse-du-plan-de-phase" id="toc-analyse-du-plan-de-phase" class="nav-link" data-scroll-target="#analyse-du-plan-de-phase">Analyse du plan de phase</a>
  <ul class="collapse">
  <li><a href="#première-condition-de-déflation" id="toc-première-condition-de-déflation" class="nav-link" data-scroll-target="#première-condition-de-déflation">Première condition de déflation</a></li>
  <li><a href="#deuxième-condition-de-déflation" id="toc-deuxième-condition-de-déflation" class="nav-link" data-scroll-target="#deuxième-condition-de-déflation">Deuxième condition de déflation</a></li>
  <li><a href="#conditions-dinflation-etou-de-déflation" id="toc-conditions-dinflation-etou-de-déflation" class="nav-link" data-scroll-target="#conditions-dinflation-etou-de-déflation">Conditions d’inflation et/ou de déflation</a></li>
  </ul></li>
  <li><a href="#animation" id="toc-animation" class="nav-link" data-scroll-target="#animation">Animation</a></li>
  </ul></li>
  <li><a href="#somme-des-équilibres-en-fonction-de-la-migration" id="toc-somme-des-équilibres-en-fonction-de-la-migration" class="nav-link" data-scroll-target="#somme-des-équilibres-en-fonction-de-la-migration">Somme des équilibres en fonction de la migration</a>
  <ul>
  <li><a href="#illustration-des-propositions-précédentes" id="toc-illustration-des-propositions-précédentes" class="nav-link" data-scroll-target="#illustration-des-propositions-précédentes">Illustration des propositions précédentes</a></li>
  <li><a href="#cas-de-laugmentorium" id="toc-cas-de-laugmentorium" class="nav-link" data-scroll-target="#cas-de-laugmentorium">Cas de l’augmentorium</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Modèle logistique structuré avec migration asymétrique</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><em>Modules à importer :</em></p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="définition-du-modèle" class="level2">
<h2 class="anchored" data-anchor-id="définition-du-modèle">Définition du modèle</h2>
<p>Le but d’un augmentorium est de confiner les ravageurs dans un espace clos qui ne laisse pas (ou peu) s’échapper ceux-ci.<br>
Ainsi, il s’établit une migration asymétrique entre les deux structures que nous pouvons modéliser en établissant le modèle suivant d’après <span class="citation" data-cites="arditi2018">Arditi R. (<a href="#ref-arditi2018" role="doc-biblioref">2018</a>)</span> :</p>
<p><span id="eq-modamig"><span class="math display">
\left\{\begin{array}{l}
\dot x = r_xx(1-\frac{x}{K_x})+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)\\
\dot y = r_yy(1-\frac{y}{K_y})+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)
\end{array}\right.
\tag{1}</span></span></p>
<p>avec :<br>
- <span class="math inline">x</span> la population de ravageurs dans la culture,<br>
- <span class="math inline">y</span> la population de ravageurs dans l’augmentorium,<br>
- <span class="math inline">r_x</span> et <span class="math inline">r_y</span> le taux de croissance dans la culture et dans l’augmentorium,<br>
- <span class="math inline">K_x</span> et <span class="math inline">K_y</span> les capacités de charges de la culture de de l’augmentorium,<br>
- <span class="math inline">\beta</span> la force de migration entre les structures,<br>
- <span class="math inline">\gamma_x</span> et <span class="math inline">\gamma_y</span> caractérisant l’asymétrie de migration.</p>
<section id="nouvelles-hypothèses-propres-à-laugmentorium" class="level3">
<h3 class="anchored" data-anchor-id="nouvelles-hypothèses-propres-à-laugmentorium">Nouvelles hypothèses propres à l’augmentorium</h3>
<p>Ce modèle est plus proche de celui d’un augmentorium.<br>
Comme les ravageurs se reproduisent mieux dans l’augmentorium que dans la culture nous pouvons dire que <span class="math inline">r_x&lt;r_y</span>.<br>
Nous pouvons aussi dire que le taux de fuite des ravageurs (<span class="math inline">\frac{1}{\gamma_y}</span>) se doit d’être beaucoup plus petit que le taux de migration (<span class="math inline">\frac{1}{\gamma_x}</span>).<br>
Nous avons donc <span class="math inline">\gamma_x &lt;&lt; \gamma_y</span>.</p>
</section>
</section>
<section id="dynamique-du-modèle" class="level2">
<h2 class="anchored" data-anchor-id="dynamique-du-modèle">Dynamique du modèle</h2>
<p>Encore une fois nous simulons la dynamique des deux populations en fonction du temps en codant comme dans la première partie</p>
<p>Nous définissons le système sous <a href="https://www.python.org/">Python</a>:</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug(etat, t, param):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, b, gx, gy <span class="op">=</span> param</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span>[rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Et nous définissons les paramètres, le temps d’intégration etc. :</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Temps d'intégration:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ti <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Etats initiaux:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [x0, y0]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres: </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>rx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>ry <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>gx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>gy <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>param_aug <span class="op">=</span> np.array([rx, ry, Kx, Ky, b, gx, gy])</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation:</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> odeint(aug, e0, ti, args <span class="op">=</span> (param_aug, ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Nous traçons la figure :</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Dynamique des ravageurs dans le temps avec augmentorium'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[ :, <span class="dv">0</span>], color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'culture'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[ :, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'augmentorium'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout d'élements:</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor <span class="op">=</span> (<span class="fl">0.7</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Temps, t'</span>)<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Densité de pop.'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-dyn" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="modeleavecmigrationass_files/figure-html/fig-dyn-output-1.png" width="696" height="542" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Simulation de la dynamique du modèle</figcaption>
</figure>
</div>
</div>
</div>
<p>Cette dynamique, comme en première partie, présente un équilibre de maintien de la population.<br>
Néanmoins nous observons que, pour les mêmes paramètres que dans la première partie, la population dans la culture est bien plus faible.<br>
La migration asymétrique vers l’augmentorium semble être bénéfique à la culture.</p>
</section>
<section id="plan-de-phase" class="level2">
<h2 class="anchored" data-anchor-id="plan-de-phase">Plan de phase</h2>
<section id="equilibres-et-leur-stabilité" class="level3">
<h3 class="anchored" data-anchor-id="equilibres-et-leur-stabilité">Equilibres et leur stabilité</h3>
<p>A l’équilibre nous avons le système suivant :</p>
<p><span id="eq-pdpamig0"><span class="math display">
\left\{\begin{array}{l}
\dot x = 0 \Leftrightarrow 0 = r_xx(1-\frac{x}{K_x})+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)\\
\dot y = 0 \Leftrightarrow 0 = r_yy(1-\frac{y}{K_y})+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)
\end{array}\right.
\tag{2}</span></span> <span class="math display">
\Leftrightarrow
</span> <span id="eq-pdpamig"><span class="math display">
\left\{\begin{array}{l}
y^*=\gamma_y\left(\frac{x}{\gamma_x}-\frac{r_xx}{\beta}\left(1-\frac{x}{K_x}\right)\right)\\
x^*=\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)
\end{array}\right.
\tag{3}</span></span></p>
<p>Nous voyons tout de suite que nous avons deux paraboles qui se croisent en <span class="math inline">(0,0)</span> et en <span class="math inline">(x^*,y^*)</span>.<br>
Nous allons donc avoir deux équilibres, ceux-ci vivent sur une ellipse de même équation qu’en première partie.</p>
<p>En fonction des racines des paraboles nous allons avoir des plans de phases différents que nous allons tracer via les mêmes techniques qu’en première partie :</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous créons la figure avec les 3 sous figures:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fig2, (ax2, ax3, ax4) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">'Plan de phase de la population'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'β=1'</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'β=10'</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'β=0.1'</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 1:#</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres: </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>param_aug1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, b1, gx1, gy1])</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Isocline nulles:</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>yt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, gy1 <span class="op">*</span> (xt<span class="op">/</span>gx1 <span class="op">-</span> rx1 <span class="op">*</span> xt<span class="op">/</span>b1 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx1)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>ax2.plot(gx1 <span class="op">*</span> (yt<span class="op">/</span>gy1 <span class="op">-</span> ry1 <span class="op">*</span> yt<span class="op">/</span>b1 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky1)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration de la figure:</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.03</span>, right <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(top <span class="op">=</span> <span class="fl">1.5</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Ravageur dans l</span><span class="ch">\'</span><span class="st">augmentorium'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Ajout du champ de vecteur</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous utilisons quiver:</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug1)</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>ax2.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">15</span>, width <span class="op">=</span> <span class="fl">0.0035</span>)<span class="op">;</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 2:#</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres: </span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>param_aug2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, b2, gx2, gy2])  </span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="co">#Isocline nulles:</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt, gy2 <span class="op">*</span> (xt<span class="op">/</span>gx2 <span class="op">-</span> rx2 <span class="op">*</span> xt<span class="op">/</span>b2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx2)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>ax3.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>ax3.plot(gx2 <span class="op">*</span> (yt<span class="op">/</span>gy2 <span class="op">-</span> ry2 <span class="op">*</span> yt<span class="op">/</span>b2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky2)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration de la figure:</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>ax3.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.02</span>, right <span class="op">=</span> <span class="fl">0.35</span>)</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(top <span class="op">=</span> <span class="fl">1.4</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a><span class="co">#Ajout du champ de vecteur</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous utilisons quiver:</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug2)</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>ax3.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">40</span>, width <span class="op">=</span> <span class="fl">0.003</span>)<span class="op">;</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 3:</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres: </span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>b3 <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>param_aug3<span class="op">=</span>np.array([rx3, ry3, Kx3, Ky3, b3, gx3, gy3])</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a><span class="co">#Isocline nulles:</span></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>ax4.plot(xt, gy3 <span class="op">*</span> (xt<span class="op">/</span>gx3 <span class="op">-</span> rx3 <span class="op">*</span> xt<span class="op">/</span>b3 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx3)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>ax4.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0 </span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>ax4.plot(gx3 <span class="op">*</span> (yt<span class="op">/</span>gy3 <span class="op">-</span> ry3 <span class="op">*</span> yt<span class="op">/</span>b3 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky3)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>ax4.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration:</span></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>ax4.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.08</span>, right <span class="op">=</span> <span class="fl">1.9</span>)</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>ax4.set_ylim(top<span class="op">=</span><span class="fl">1.5</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout du champ de vecteur</span></span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.18</span>)</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.18</span>)</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug3)</span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>ax4.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">10</span>, width <span class="op">=</span> <span class="fl">0.0035</span>)<span class="op">;</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous légendons:</span></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>ax4.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-pdp0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="modeleavecmigrationass_files/figure-html/fig-pdp0-output-1.png" width="740" height="396" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: 3 profils de plan de phase</figcaption>
</figure>
</div>
</div>
</div>
<p>En fonction des valeurs de <span class="math inline">\beta</span> nous observons des profils différents de plan de phase. Pour mieux le visualiser nous pourrons utiliser l’animation Geogebra mise à disposition à la fin de l’analyse.</p>
<p>D’après le champ de vecteurs nous voyons clairement que l’équilibre en <span class="math inline">(0,0)</span> est instable et l’équilibre <span class="math inline">(x^*,y^*)</span> est stable.</p>
<p>Pour calculer l’équilibre nous procédons de la même manière que dans la première partie, c’est à dire en croisant les deux paraboles <span class="math inline">\dot x=0</span> et <span class="math inline">\dot y =0</span> :</p>
<p>Nous avons <span class="math inline">x^*=\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)</span></p>
<p>Donc : <span class="math display">\small
y^*=\gamma_y\left(\frac{\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{\gamma_x}-\frac{r_x\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{\beta}\left[1-\frac{\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{K_x}\right]\right)
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
-\frac{r_y\gamma_yy^*}{\beta} + \frac{r_y \gamma_y {y^*}^2}{\beta K_y} - \frac{r_x\gamma_xy^*}{\beta} + \frac{r_xr_y\gamma_x \gamma_y y^*}{\beta^2} \\
- \frac{r_xr_y\gamma_x\gamma_y{y^*}^2}{\beta^2K_y} + \frac{r_x\gamma_x^2{y^*}^2}{\beta K_x\gamma_y} - \frac{r_xr_y\gamma_x^2{y^*}^2}{\beta^2K_x} \\
+ 2\frac{r_xr_y\gamma_x^2{y^*}^3}{\beta^2K_xK_y} + \frac{r_xr_y^2\gamma_x^2 \gamma_y {y^*}^2}{\beta^3K_x} - 2\frac{r_xr_y^2\gamma_x^2\gamma_y{y^*}^3}{\beta^3K_xK_y} \\
+ \frac{r_xr_y^2\gamma_x^2\gamma_y{y^*}^4}{\beta^3K_xK_y^2} = 0
</span></p>
<p>Ce qui donne, en mettant les monomes <span class="math inline">y^*</span> en facteur et en simplifiant ensuite par <span class="math inline">\frac{y^*}{\beta}</span> :<br>
<span id="eq-pol"><span class="math display">
\frac{r_xr_y\gamma_x\gamma_y}{\beta}-\gamma_yr_y-\gamma_xr_x +\\ y^*\left[\frac{r_y\gamma_y}{K_y}-\frac{r_xr_y\gamma_x\gamma_y}{\beta K_y}+ \frac{r_xr_y^2\gamma_x^2\gamma_y}{\beta^2K_x}+\frac{r_x\gamma_x^2}{\gamma_yK_x}-\frac{2r_xr_y\gamma_x^2}{\beta K_x}   \right] +\\[.2cm]
\frac{2r_yr_x\gamma_x^2{y^*}^2}{\beta K_xK_y}\left(1-\frac{r_y\gamma_y}{\beta}\right) + \frac{r_xr_y^2\gamma_x^2\gamma_y {y^*}^3}{\beta^2K_xK_y^2} = 0
\tag{4}</span></span></p>
<p>Ce polynôme est résoluble par <code>numpy</code> similairement à la première partie :</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres pour calculer le polynôme</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>rx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ry <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>gx <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>gy <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Points d'équilibres, utilisation de numpy : monome, polynome et racines:</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Monome y</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.polynomial.Polynomial([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Polynome :</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>pol <span class="op">=</span> <span class="op">-</span>gy <span class="op">*</span> ry <span class="op">-</span> gx <span class="op">*</span> rx <span class="op">+</span> (rx <span class="op">*</span> ry <span class="op">*</span> gx <span class="op">*</span> gy)<span class="op">/</span>b <span class="op">+</span> x <span class="op">*</span> ((ry <span class="op">*</span> gy)<span class="op">/</span>(Ky) <span class="op">-</span> (ry <span class="op">*</span> rx <span class="op">*</span> gy <span class="op">*</span> gx)<span class="op">/</span>(b <span class="op">*</span> Ky) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a> rx <span class="op">*</span> ry<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> gy<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> Kx) <span class="op">+</span> rx <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(gy <span class="op">*</span> Kx) <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> rx <span class="op">*</span> ry <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(b <span class="op">*</span> Kx)) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a> (x<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> (ry <span class="op">*</span> rx <span class="op">*</span>gx<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(b <span class="op">*</span> Kx <span class="op">*</span> Ky) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> ry <span class="op">*</span> gy<span class="op">/</span>b) <span class="op">+</span> (x<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> gy <span class="op">*</span> rx <span class="op">*</span> ((ry <span class="op">*</span> gx)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> Kx <span class="op">*</span> Ky<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Solution</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> pol.roots()[ (np.isreal( pol.roots() )) <span class="op">*</span> (pol.roots() <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>yeq <span class="op">=</span> sol[<span class="dv">0</span>].real</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul de x avec sa définition:</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>xeq <span class="op">=</span> gx <span class="op">*</span> (yeq<span class="op">/</span>gy <span class="op">-</span> ry <span class="op">*</span> yeq<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yeq<span class="op">/</span>Ky))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="analyse-du-plan-de-phase" class="level3">
<h3 class="anchored" data-anchor-id="analyse-du-plan-de-phase">Analyse du plan de phase</h3>
<p>Nous allons tracer le plan de phase complet et l’analyser d’après la méthode d’<span class="citation" data-cites="arditi2018">Arditi R. (<a href="#ref-arditi2018" role="doc-biblioref">2018</a>)</span> :</p>
<p>Dans cette analyse nous allons considérer, sans perte de généralité, que <span class="math inline">r_x &lt; r_y</span> (nous prenons l’ellipse dans un seul sens, voir l’animation).</p>
<p>Pour cela nous traçons l’ellipse de la même manière que dans la première figure.</p>
<p>Ensuite nous allons tracer la droite <span class="math inline">d</span> correspondant à <span class="math inline">K_x+K_y=x^*+y^*</span> car ceci va permettre de voir si le système subit une <a href="./contexte.html">inflation</a> ou une déflation.</p>
<p>Enfin, similairement à la partie prédédente nous allons tracer les droites données par <span class="math inline">\beta = 0</span> et <span class="math inline">\beta \to +\infty</span> dans la parabole définie par <span class="math inline">\dot x =0</span> (parabole verte sur le plan de phase).<br>
Les droites sont différentes du modèle précédent donc nous allons les recalculer :</p>
<p>Lorsque <span class="math inline">\beta = 0</span> nous avons exactement les mêmes deux droites que dans le modèle précédent en <span class="math inline">x^* =0</span> et en <span class="math inline">x^*=K_x</span> car le fait que le nouveau modèle ajoute de l’asymétrie dans les migrations est effacé par une migration nulle. Nous les appellerons respectivement <span class="math inline">P_{10}</span> et <span class="math inline">P_{20}</span>.</p>
<p>Lorsque <span class="math inline">\beta \to +\infty</span> nous avons d’après (<a href="#eq-pdpamig">3</a>) : <span class="math display">
y^* = \frac{\gamma_y}{\gamma_x}x^*
</span></p>
<p>Nous appellerons cette droite <span class="math inline">P_{\infty}</span>.</p>
<p>Introduisons les mêmes points que précédemment c’est à dire :</p>
<ul>
<li><p><span class="math inline">A</span>, l’intersection entre <span class="math inline">P_{20}</span> et l’ellipse, c’est à dire la valeur de l’équilibre quand <span class="math inline">\beta = 0</span>.</p></li>
<li><p><span class="math inline">B</span>, l’intersection entre <span class="math inline">P_{\infty}</span> et l’ellipse, c’est à dire la valeur de l’équilibre quand <span class="math inline">\beta \to +\infty</span>.</p></li>
<li><p><span class="math inline">C</span>, l’intersection entre <span class="math inline">P_{20}</span> et <span class="math inline">P_{\infty}</span>.</p></li>
<li><p><span class="math inline">D</span>, l’intersection entre la droite <span class="math inline">d</span> et l’ellipse qui n’est pas le point <span class="math inline">A</span>.</p></li>
</ul>
<p>Représentons le plan de phase avec ces éléments :</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous créons la figure:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">'Plan de phase de la population'</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres égaux à ceux utilisés pour calculer les équilibres:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>param_aug <span class="op">=</span> np.array([rx, ry, Kx, Ky, b, gx, gy])</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Isocline nulles:</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>yt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, gy <span class="op">*</span> (xt<span class="op">/</span>gx <span class="op">-</span> rx <span class="op">*</span> xt<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x = 0$'</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>ax2.plot(gx <span class="op">*</span> (yt<span class="op">/</span>gy <span class="op">-</span> ry <span class="op">*</span> yt<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y = 0$'</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Cadrage:</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.30</span>, right <span class="op">=</span> <span class="fl">4.5</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(top <span class="op">=</span> <span class="dv">6</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.70</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'$x^*$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'$y^*$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Axe x et y:</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, linestyle <span class="op">=</span> <span class="st">'dashed'</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(yt), yt, color <span class="op">=</span> <span class="st">'k'</span>, linestyle <span class="op">=</span> <span class="st">'dashed'</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite capacité:</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>ax2.plot(x, <span class="op">-</span>x <span class="op">+</span> Kx <span class="op">+</span> Ky, label <span class="op">=</span> <span class="st">'$K_x+K_y$'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot des équilibres:</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>ax2.plot(xeq, yeq, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">12</span>, color <span class="op">=</span> <span class="st">'C5'</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Ellipse:</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>xg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>yg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>X2, Y2 <span class="op">=</span> np.meshgrid(xg2, yg2)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> rx <span class="op">*</span> X2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> X2<span class="op">/</span>Kx)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> ry <span class="op">*</span> Y2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> Y2<span class="op">/</span>Ky)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>ax2.contour(X2, Y2, (X <span class="op">+</span> Y), [<span class="dv">0</span>], colors <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'Ellipse des solutions'</span>)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="co">#Parabole xdot=0 b=0:</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx <span class="op">*</span> np.ones_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>, label <span class="op">=</span> <span class="st">'Parabole β = 0'</span>)</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>)</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="co">#Parabole xdot=0 b=+inf:</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, xt <span class="op">*</span> gy<span class="op">/</span>gx, color <span class="op">=</span> <span class="st">'C6'</span>, label <span class="op">=</span> <span class="st">'Parabole β = $+\infty$'</span>)</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co">#A:</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, Ky, color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx <span class="op">-</span> <span class="fl">0.1</span>, Ky <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$A$'</span>)</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="co">#C:</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, gy <span class="op">*</span> Kx<span class="op">/</span>gx, color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx, gy <span class="op">*</span> Kx<span class="op">/</span>gx <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'C'</span>)</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a><span class="co">#B:</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>ax2.plot(((gx<span class="op">/</span>gy) <span class="op">*</span> rx <span class="op">+</span> ry)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky),((gy<span class="op">/</span>gx) <span class="op">*</span> ry <span class="op">+</span> rx)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">\</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>                                        , color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>ax2.text(((gx<span class="op">/</span>gy) <span class="op">*</span> rx <span class="op">+</span> ry)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">-</span> <span class="fl">0.1</span>, ((gy<span class="op">/</span>gx) <span class="op">*</span> ry <span class="op">+</span> rx)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">+</span> <span class="fl">0.1</span> <span class="op">\</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>                                        , <span class="st">'$B$'</span>)</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a><span class="co">#D:</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>ax2.plot(ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>ax2.text(ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx) <span class="op">-</span> <span class="fl">0.1</span>, rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx) <span class="op">+</span> <span class="fl">0.1</span>, <span class="st">'$D$'</span>)</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a><span class="co">## Nous plaçons des textes indiquant les trois droites:</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">0.1</span>, yeq, <span class="st">"$P_</span><span class="sc">{10}</span><span class="st">$"</span>)</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx <span class="op">+</span> <span class="fl">0.05</span>, <span class="dv">4</span>, <span class="st">"$P_</span><span class="sc">{20}</span><span class="st">$"</span>)</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="dv">3</span>, <span class="fl">5.5</span>, <span class="st">"$P_\infty$"</span>)</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a><span class="co">#Légende:</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-pdp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="modeleavecmigrationass_files/figure-html/fig-pdp-output-1.png" width="658" height="482" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Plan de phase complet du modèle</figcaption>
</figure>
</div>
</div>
</div>
<section id="première-condition-de-déflation" class="level4">
<h4 class="anchored" data-anchor-id="première-condition-de-déflation">Première condition de déflation</h4>
<p>La première condition d’inflation est exactement la même que dans le modèle précédent et la preuve est en tout point égale (elle repose sur une analyse de l’équation de l’ellipse qui est la même dans les deux modèles). Nous ne détaillerons pas ici cette preuve mais nous savons donc que :</p>
<p><strong>Si <span class="math inline">r_x = r_y</span> alors le système est tout le temps déflationniste.</strong></p>
</section>
<section id="deuxième-condition-de-déflation" class="level4">
<h4 class="anchored" data-anchor-id="deuxième-condition-de-déflation">Deuxième condition de déflation</h4>
<p>Nous allons faire une preuve graphique de cette condition similaire à l’ancien modèle.</p>
<p>L’équilibre vit sur l’ellipse et parcourt l’arc orange entre <span class="math inline">A</span> et <span class="math inline">B</span> au fur et à mesure que <span class="math inline">\beta</span> augmente.<br>
Ainsi pour avoir déflation nous allons vouloir avoir cet arc entièrement sous la droite <span class="math inline">d</span> en gris.<br>
Il est alors facile de voir que pour cela nous voulons que la coordonnée en <span class="math inline">y</span> de <span class="math inline">C</span> soit plus grande que celle de <span class="math inline">A</span> (<span class="math inline">C</span> est plus haut sur la droite cyan que <span class="math inline">A</span>), entraînant que la coordonnée en <span class="math inline">x</span> de <span class="math inline">B</span> est plus petite que celle de <span class="math inline">A</span> (<span class="math inline">B</span> se trouve plus à gauche sur l’ellipse que <span class="math inline">A</span>).</p>
<p>Pour cela nous avons besoin de connaître les coordonnées de <span class="math inline">A</span> et <span class="math inline">C</span>.</p>
<p>Le point <span class="math inline">A</span> est défini comme la valeur de l’équilibre sans migration. Il est alors facile de constater que dans ce cas nous sommes face à un système avec une croissance logistique seulement et donc l’équilibre est atteint pour les capacités de charge.<br>
Nous avons donc <span class="math inline">A = (K_x,K_y)</span>.</p>
<p>Pour <span class="math inline">C</span> nous savons que c’est l’intersection entre <span class="math inline">P_{20}</span> et <span class="math inline">P_{\infty}</span>, ainsi comme <span class="math inline">P_{20}</span> est défini par <span class="math inline">x^* = K_x</span> et <span class="math inline">P_{\infty}</span> par <span class="math inline">y^* =\frac{\gamma_y}{\gamma_x}x^*</span> nous avons :</p>
<p><span class="math inline">C = (K_x,\frac{\gamma_yK_x}{\gamma_x})</span>.</p>
<p>La condition mathématique qui en découle est donc que le système est déflationniste si <span class="math inline">\frac{\gamma_yK_x}{\gamma_x} &gt; K_y</span>.</p>
<p><strong>Si <span class="math inline">\frac{\gamma_y}{\gamma_x} &gt; \frac{K_y}{K_x}</span> alors le système (<a href="#eq-modamig">1</a>) est toujours déflationniste.</strong></p>
</section>
<section id="conditions-dinflation-etou-de-déflation" class="level4">
<h4 class="anchored" data-anchor-id="conditions-dinflation-etou-de-déflation">Conditions d’inflation et/ou de déflation</h4>
<p>Similairement à la première partie nous allons avoir des conditions sur l’inflation.<br>
En effet, nous voyons bien sur le plan de phase que si <span class="math inline">B</span> est entre <span class="math inline">A</span> et <span class="math inline">D</span> alors l’arc d’ellipse que parcourent les équilibres en fonction de <span class="math inline">\beta</span> est constamment inflationniste.</p>
<p>Ainsi nous voulons que <span class="math inline">B</span> soit à droite de <span class="math inline">A</span> ce qui revient à prendre la condition inverse de celle énoncée plus haut (c’est à dire la coordonnées <span class="math inline">y</span> de <span class="math inline">C</span> plus petite que celle de <span class="math inline">A</span>), c’est à dire <span class="math inline">\frac{\gamma_y}{\gamma_x} &lt; \frac{K_y}{K_x}</span>.</p>
<p>Ensuite pour avoir <span class="math inline">B</span> entre <span class="math inline">A</span> et <span class="math inline">D</span> nous allons vouloir que la pente de <span class="math inline">P_{\infty}</span> soit plus haute que celle de la droite passant par <span class="math inline">(0,0)</span> et <span class="math inline">D</span> que nous appellerons <span class="math inline">\aleph</span>.<br>
Pour voir ceci nous allons ajouter la droite <span class="math inline">\aleph</span> au plan de phase précédent :</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Ajout de la droite :</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (rx <span class="op">*</span> Ky)<span class="op">/</span>(ry <span class="op">*</span> Kx) <span class="op">*</span> xt, color <span class="op">=</span> <span class="st">'C5'</span>, label <span class="op">=</span> <span class="st">"Droite א"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>display(fig2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-pdp2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="modeleavecmigrationass_files/figure-html/fig-pdp2-output-1.png" width="658" height="482" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Plan de phase complet du modèle</figcaption>
</figure>
</div>
</div>
</div>
<p>Nous avons calculé dans la partie précédente que <span class="math inline">D = (\frac{r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x} , \frac{r_xK_y(K_x+K_y)}{r_xK_y+r_yK_x} )</span> ce qui ne change pas dans cette partie car nous considérons des quantités indépendantes des taux de migration.</p>
<p>La pente de la droite passant par <span class="math inline">D</span> et <span class="math inline">(0,0)</span> est donc égale à <span class="math inline">\frac{r_xK_y}{r_yK_x}</span> ce qui donne la condition suivante <span class="math inline">\frac{\gamma_y}{\gamma_x} &gt; \frac{r_xK_y}{r_yK_x}</span>.</p>
<p><strong>Si <span class="math inline">\frac{r_xK_y}{r_yK_x} &lt; \frac{\gamma_y}{\gamma_x} &lt; \frac{K_y}{K_x}</span> nous avons un système inflationniste pour tout <span class="math inline">\beta</span>.</strong></p>
<p>Il est alors aisé de voir que si la pente de <span class="math inline">P_{\infty}</span> est plus petite que celle de <span class="math inline">\aleph</span> nous avons les équilibres qui parcourent d’abord des valeurs au dessus de <span class="math inline">d</span> puis en dessous (pour aller de <span class="math inline">A</span> à <span class="math inline">C</span>).</p>
<p>La condition mathématique est donc la suivante :</p>
<p><strong>Si <span class="math inline">\frac{\gamma_y}{\gamma_x} &lt; \frac{r_xK_y}{r_yK_x}</span> alors le système est d’abord inflationniste puis déflationniste lorsque <span class="math inline">\beta</span> augmente.</strong></p>
</section>
</section>
<section id="animation" class="level3">
<h3 class="anchored" data-anchor-id="animation">Animation</h3>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> IPython.display <span class="im">as</span> display</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fig01 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;iframe width = "700" height = "550" src = "https://www.geogebra.org/classic/bhhpgtqv" style = "border: 1px solid black"&gt;&lt;/iframe&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>display.HTML(fig01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-anim" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<iframe width="700" height="550" src="https://www.geogebra.org/classic/bhhpgtqv" style="border: 1px solid black"></iframe>
<figcaption class="figure-caption">Figure&nbsp;5: Animation Geogebra du plan de phase complet</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="somme-des-équilibres-en-fonction-de-la-migration" class="level2">
<h2 class="anchored" data-anchor-id="somme-des-équilibres-en-fonction-de-la-migration">Somme des équilibres en fonction de la migration</h2>
<section id="illustration-des-propositions-précédentes" class="level3">
<h3 class="anchored" data-anchor-id="illustration-des-propositions-précédentes">Illustration des propositions précédentes</h3>
<p>Nous allons illustrer les propositions précédentes en traçant la somme des équilibres en fonction de <span class="math inline">\beta</span>. Pour cela nous allons simuler avec <code>odeint</code> (pendant un temps assez large pour atteindre l’équilibre) pour chaque valeur de <span class="math inline">\beta</span>.</p>
<p>Nous définissons une fonction qui dépend de <span class="math inline">\beta</span> :</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug2(etat, t, param, h):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, gy <span class="op">=</span> param</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> h</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>et nous posons le temps d’intégration, les paramètres et les conditions initiales :</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, gy1])</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, gx2, gy2])</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#3:</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3, gx3, gy3])</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co">#4:</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>rx4 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>ry4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>Kx4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>Ky4 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>gx4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>gy4 <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>param4 <span class="op">=</span> np.array([rx4, ry4, Kx4, Ky4, gx4, gy4])</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration suffisament large pour atteindre l'équilibre:</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Condition initiale:</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Et enfin nous traçons les quatre figures :</p>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1, ax2, ax3) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param1, i)) <span class="co">#Nous calculons pour chaque beta l'équilibre</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>) <span class="co">#Nous représentons un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param3, i))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>):</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param2, i))</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    s3 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param4, i))</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    ax3.plot(i, s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky:    </span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>xt2 <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.001</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt2, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt2), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.10</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.12</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt2, (Kx4 <span class="op">+</span> Ky4) <span class="op">*</span> np.ones_like(xt2), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>ax3.text(<span class="fl">3.12</span>, Kx4 <span class="op">+</span> Ky4 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous déplaçons la légende hors de la figure:</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor <span class="op">=</span> (<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)<span class="op">;</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Les deux'</span>)<span class="op">;</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Inflation'</span>)<span class="op">;</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Inflation'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-eq" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="modeleavecmigrationass_files/figure-html/fig-eq-output-1.png" width="741" height="411" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6: 4 profils de population totale en fonction du taux de migration β</figcaption>
</figure>
</div>
</div>
</div>
<p>Nous obtenons 4 profils de courbe. Le premier profil montre une déflation du système et a été obtenu pour la condition décrite plus haut de <span class="math inline">\frac{\gamma_y}{\gamma_x} &gt; \frac{K_y}{K_x}</span>.</p>
<p>Le deuxième profil correspond à une inflation du système puis une déflation quand <span class="math inline">\beta</span> augmente, cette courbe a bien été obtenue en respectant la condition de <span class="math inline">\frac{\gamma_y}{\gamma_x} &lt; \frac{r_xK_y}{r_yK_x}</span>.</p>
<p>Les deux derniers profils, correspondant à une inflation permanente du système, sont obtenus en respectant les conditions décrites plus haut. Nous obtenons deux profils différents, un avec une inflation croissante quand <span class="math inline">\beta</span> augmente et l’autre avec une inflation croissante puis décroissante (et qui atteint un plateau).<br>
Ce phénomène se voit graphiquement sur l’animation ou le plan de phase. En effet, nous avons dans le premier cas <span class="math inline">P_{\infty}</span> qui coupe l’ellipse dans sa phase montante (l’écart entre l’ellipse et la droite <span class="math inline">d</span> augmente) alors que dans le second cas <span class="math inline">P_{\infty}</span> coupe l’ellipse alors que l’écart entre celle-ci et <span class="math inline">d</span> diminue.</p>
</section>
<section id="cas-de-laugmentorium" class="level3">
<h3 class="anchored" data-anchor-id="cas-de-laugmentorium">Cas de l’augmentorium</h3>
<p>Dans le cas de l’augmentorium il est important de considérer l’équilibre <span class="math inline">x^*</span> seul par rapport à <span class="math inline">K_x</span> (sa valeur s’il n’y a pas de migration).<br>
En effet même si nous avons inflation dans le système, si <span class="math inline">x^*&lt;K_x</span> alors nous considérons l’augmentorium comme efficace.</p>
<p>Avec les hypothèses énoncées plus haut sur la situation de l’augmentorium il n’est pas possible d’obtenir un système inflationniste (indépendamment de si <span class="math inline">K_x&gt;K_y</span> ou l’inverse). Il est facile de voir ceci grâce à notre animation.</p>
<p>Néanmoins avec des hypothèses plus souples (mais en gardant que <span class="math inline">r_x&lt;r_y</span>), par exemple que les taux de fuites sont plus forts que les taux de migration vers l’augmentorium (dus à une fuite du dispositif par exemple) nous allons voir que l’augmentorium n’est pas forcément bénéfique.<br>
En effet, nous pouvons, sur le plan de phase tracé plus haut, voir que dès que nous sommes dans un cas où nous avons de l’inflation (et même si nous revenons sur de la déflation après) alors nous avons <span class="math inline">x^* &gt; K_x</span> ce qui est mauvais pour la culture.</p>
<p>Nous allons tracer l’équilibre <span class="math inline">x^*</span> en fonction de <span class="math inline">\beta</span> en considérant un cas où le système était déflationniste et un cas où le système était inflationniste (pour la somme des équilibres) :</p>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, gy1])</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, gx2, gy2])</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3, gx3, gy3])</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'$x^*$ avec déflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'$x^*$ avec déflation et inflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'$x^*$ avec inflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle en fonction de beta</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param2, i))</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param3, i))</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite Kx:</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.5</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, Kx2 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx2 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, Kx3 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.5</span>, Kx3 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.5</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Nous limitons le cadre :</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(bottom<span class="op">=</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(bottom<span class="op">=</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous déplaçons la légende hors de la figure:</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor <span class="op">=</span> (<span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-eqx" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="modeleavecmigrationass_files/figure-html/fig-eqx-output-1.png" width="737" height="434" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;7: Simulation de l’équilibre dans la culture en fonction de β pour différentes conditions d’inflation de la population totale</figcaption>
</figure>
</div>
</div>
</div>
<p>En bleu nous observons le comportement de l’équilibre dans la culture seulement et en gris nous retrouvons les courbes tracées juste au dessus. Nous voyons bien que dès que le système subit une inflation des équilibres totaux la situation devient mauvaise pour la culture.<br>
En revanche quand nous avons déflation des équilibres totaux alors la situtaion est bénéfique à la culture.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>On voit très bien ceci sur notre <a href="#fig-pdp">Figure&nbsp;3</a> en regardant où se place l’ellipse orange par rapport à la droite cyan représentant <span class="math inline">K_x</span></p>
</div>
</div>
<p>Il faut garder en tête que ceci n’est vrai que pour <span class="math inline">r_x&lt;r_y</span>.</p>
<p>Ensuite, le taux de fuite est un paramètre clé de notre méthode. Nous allons donc tracer la somme des équilibres et l’équilibre <span class="math inline">x^*</span> en fonction de <span class="math inline">\gamma_y</span>.</p>
<p>Attention ! Un fort taux de fuite correspond à un <span class="math inline">\gamma_y</span> faible.</p>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition d'un nouveau modèle qui prend en compte le changement de gy:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug3(etat, t, param, h):</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, b <span class="op">=</span> param</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    gy <span class="op">=</span> h</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, b])</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration assez large pour atteindre l'éq :</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Conditions initiales:</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite de la somme des capacités:</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Nous plaçons une droite gx en pointillé:</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>ax.plot(gx1 <span class="op">*</span> np.ones_like(xt), xt, linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>)</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>ax.text(gx1, <span class="fl">0.2</span>, <span class="st">"Ɣx"</span>)</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle qui calcule l'équilibre et qui plot un point en fonction des valeurs du taux de fuite:</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug3, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>)</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, Kx1 <span class="op">+</span> Ky1, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres ($x^*+y^*$)'</span>)</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, Kx1, color <span class="op">=</span> <span class="st">'0.8'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'$x^* + y^*$ et $x^*$ en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize <span class="op">=</span> <span class="st">'7'</span>)<span class="op">;</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Densité de pop."</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-fuite" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="modeleavecmigrationass_files/figure-html/fig-fuite-output-1.png" width="664" height="373" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;8: Population totale et dans la culture en fonction du taux de fuite</figcaption>
</figure>
</div>
</div>
</div>
<p>Dans la figure gauche nous avons représenté la somme des équilibres (<span class="math inline">x^*+y^*</span>) de la même manière que précédemment mais cette fois en faisant varier le taux de fuite.<br>
Nous observons alors un nouveau profil qui correspond à une déflation, puis une inflation puis enfin une déflation au fur et à mesure que <span class="math inline">\gamma_y</span> augmente.</p>
<p>Dans la figure droite nous avons cette fois uniquement l’équilibre dans la culture (<span class="math inline">x^*</span>). Nous observons que pour des <span class="math inline">\gamma_y</span> petits nous avons inflation puis nous retournons à une déflation.</p>
<p>Pour représenter cette figure nous avons considéré que <span class="math inline">r_x&lt;r_y</span> et <span class="math inline">K_x&lt;K_y</span> sans perte de généralité.</p>
<p>Pour interpréter ceci il faut comprendre que les des petites valeurs de <span class="math inline">\gamma_y</span> correspondent à de grandes valeurs de taux de fuite.<br>
Ainsi quand <span class="math inline">\gamma_y \to 0</span> l’augmentorium se vide en ravageurs et nous avons ainsi toute la population dans la culture et l’équilibre dans la culture tend vers sa capacité de charge car nous sommes seulement face à une croissance logistique.</p>
<p>Nous sommes face à une situation un peu paradoxale. La population globale à l’équilibre subit une déflation pour des taux de fuite élevés alors qu’on observe une inflation de la population dans la culture par rapport à sa capacité de charge.</p>
<p>En effet, lorsque les taux de fuite sont grands nous observons une inflation de la culture car nous avons des populations de ravageurs qui viennent de l’augmentorium qui s’ajoutent aux ravageurs déjà présents dans la culture.<br>
La somme des équilibres est donc trompeuse dans ce cas là, en effet le système subit une déflation car l’augmentorium n’est presque plus occupé pour de forts taux de fuite mais il ne faut pas croire que c’en est bénéfique pour la culture.</p>
<p>Ce modèle considère uniquement la population de ravageurs. Or, la méthode de l’augmentorium repose énormément sur l’action des prédateurs nous allons donc considérer <a href="./modelaug.html">maintenant</a> un modèle qui prend en compte ces prédateurs.</p>


<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-arditi2018" class="csl-entry" role="listitem">
Arditi R., Sari T., Lobry C. 2018. <span>“Asymmetric Dispersal in the Multi-Patch Logistic Equation.”</span> <em>Theor. Popul. Biol.</em> 120: 11–15.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb15" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Modèle logistique structuré avec migration asymétrique</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>*Modules à importer :*</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## Définition du modèle</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>Le but d'un augmentorium est de confiner les ravageurs dans un espace clos qui ne laisse pas (ou peu) s'échapper ceux-ci.  </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>Ainsi, il s'établit une migration asymétrique entre les deux structures que nous pouvons modéliser en établissant le modèle suivant d'après @arditi2018 : </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>\dot x = r_xx(1-\frac{x}{K_x})+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)<span class="sc">\\</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>\dot y = r_yy(1-\frac{y}{K_y})+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>$$ {#eq-modamig}</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>avec :  </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$x$ la population de ravageurs dans la culture,  </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$y$ la population de ravageurs dans l'augmentorium,  </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$r_x$ et $r_y$ le taux de croissance dans la culture et dans l'augmentorium,  </span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$K_x$ et $K_y$ les capacités de charges de la culture de de l'augmentorium,  </span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta$ la force de migration entre les structures,  </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\gamma_x$ et $\gamma_y$ caractérisant l'asymétrie de migration.</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nouvelles hypothèses propres à l'augmentorium</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>Ce modèle est plus proche de celui d'un augmentorium.  </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>Comme les ravageurs se reproduisent mieux dans l'augmentorium que dans la culture nous pouvons dire que $r_x&lt;r_y$.  </span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>Nous pouvons aussi dire que le taux de fuite des ravageurs ($\frac{1}{\gamma_y}$) se doit d'être beaucoup plus petit que le taux de migration ($\frac{1}{\gamma_x}$).  </span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>Nous avons donc $\gamma_x &lt;&lt; \gamma_y$.</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dynamique du modèle</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>Encore une fois nous simulons la dynamique des deux populations en fonction du temps en codant comme dans la première partie</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>Nous définissons le système sous <span class="co">[</span><span class="ot">Python</span><span class="co">](https://www.python.org/)</span>:</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug(etat, t, param):</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, b, gx, gy <span class="op">=</span> param</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span>[rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx),</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>Et nous définissons les paramètres, le temps d'intégration etc. :</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Temps d'intégration:</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>ti <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Etats initiaux:</span></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [x0, y0]</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres: </span></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>rx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>ry <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>gx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>gy <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>param_aug <span class="op">=</span> np.array([rx, ry, Kx, Ky, b, gx, gy])</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation:</span></span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> odeint(aug, e0, ti, args <span class="op">=</span> (param_aug, ))</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>Nous traçons la figure :</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-dyn</span></span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Simulation de la dynamique du modèle"</span></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Dynamique des ravageurs dans le temps avec augmentorium'</span>)</span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[ :, <span class="dv">0</span>], color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'culture'</span>)</span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[ :, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'augmentorium'</span>)</span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout d'élements:</span></span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor <span class="op">=</span> (<span class="fl">0.7</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Temps, t'</span>)<span class="op">;</span></span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Densité de pop.'</span>)<span class="op">;</span></span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>Cette dynamique, comme en première partie, présente un équilibre de maintien de la population.  </span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>Néanmoins nous observons que, pour les mêmes paramètres que dans la première partie, la population dans la culture est bien plus faible.    </span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>La migration asymétrique vers l'augmentorium semble être bénéfique à la culture.</span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plan de phase </span></span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a><span class="fu">### Equilibres et leur stabilité </span></span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>A l'équilibre nous avons le système suivant :</span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a>\dot x = 0 \Leftrightarrow 0 = r_xx(1-\frac{x}{K_x})+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)<span class="sc">\\</span></span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a>\dot y = 0 \Leftrightarrow 0 = r_yy(1-\frac{y}{K_y})+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)</span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a>$${#eq-pdpamig0}</span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a>y^*=\gamma_y\left(\frac{x}{\gamma_x}-\frac{r_xx}{\beta}\left(1-\frac{x}{K_x}\right)\right)<span class="sc">\\</span></span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>x^*=\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)</span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>$${#eq-pdpamig}</span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a>Nous voyons tout de suite que nous avons deux paraboles qui se croisent en $(0,0)$ et en $(x^*,y^*)$.  </span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a>Nous allons donc avoir deux équilibres, ceux-ci vivent sur une ellipse de même équation qu'en première partie.   </span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a>En fonction des racines des paraboles nous allons avoir des plans de phases différents que nous allons tracer via les mêmes techniques qu'en première partie :</span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pdp0</span></span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "3 profils de plan de phase"</span></span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous créons la figure avec les 3 sous figures:</span></span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a>fig2, (ax2, ax3, ax4) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">'Plan de phase de la population'</span>)</span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'β=1'</span>)</span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'β=10'</span>)</span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'β=0.1'</span>)</span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 1:#</span></span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres: </span></span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-163"><a href="#cb15-163" aria-hidden="true" tabindex="-1"></a>param_aug1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, b1, gx1, gy1])</span>
<span id="cb15-164"><a href="#cb15-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-165"><a href="#cb15-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Isocline nulles:</span></span>
<span id="cb15-166"><a href="#cb15-166" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-167"><a href="#cb15-167" aria-hidden="true" tabindex="-1"></a>yt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-168"><a href="#cb15-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-169"><a href="#cb15-169" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb15-170"><a href="#cb15-170" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, gy1 <span class="op">*</span> (xt<span class="op">/</span>gx1 <span class="op">-</span> rx1 <span class="op">*</span> xt<span class="op">/</span>b1 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx1)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb15-171"><a href="#cb15-171" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb15-172"><a href="#cb15-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-173"><a href="#cb15-173" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb15-174"><a href="#cb15-174" aria-hidden="true" tabindex="-1"></a>ax2.plot(gx1 <span class="op">*</span> (yt<span class="op">/</span>gy1 <span class="op">-</span> ry1 <span class="op">*</span> yt<span class="op">/</span>b1 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky1)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb15-175"><a href="#cb15-175" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb15-176"><a href="#cb15-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-177"><a href="#cb15-177" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration de la figure:</span></span>
<span id="cb15-178"><a href="#cb15-178" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.03</span>, right <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb15-179"><a href="#cb15-179" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(top <span class="op">=</span> <span class="fl">1.5</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb15-180"><a href="#cb15-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-181"><a href="#cb15-181" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb15-182"><a href="#cb15-182" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Ravageur dans l</span><span class="ch">\'</span><span class="st">augmentorium'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb15-183"><a href="#cb15-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-184"><a href="#cb15-184" aria-hidden="true" tabindex="-1"></a><span class="co">#Ajout du champ de vecteur</span></span>
<span id="cb15-185"><a href="#cb15-185" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb15-186"><a href="#cb15-186" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb15-187"><a href="#cb15-187" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb15-188"><a href="#cb15-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-189"><a href="#cb15-189" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous utilisons quiver:</span></span>
<span id="cb15-190"><a href="#cb15-190" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug1)</span>
<span id="cb15-191"><a href="#cb15-191" aria-hidden="true" tabindex="-1"></a>ax2.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">15</span>, width <span class="op">=</span> <span class="fl">0.0035</span>)<span class="op">;</span></span>
<span id="cb15-192"><a href="#cb15-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-193"><a href="#cb15-193" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 2:#</span></span>
<span id="cb15-194"><a href="#cb15-194" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres: </span></span>
<span id="cb15-195"><a href="#cb15-195" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-196"><a href="#cb15-196" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-197"><a href="#cb15-197" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-198"><a href="#cb15-198" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-199"><a href="#cb15-199" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb15-200"><a href="#cb15-200" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-201"><a href="#cb15-201" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-202"><a href="#cb15-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-203"><a href="#cb15-203" aria-hidden="true" tabindex="-1"></a>param_aug2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, b2, gx2, gy2])  </span>
<span id="cb15-204"><a href="#cb15-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-205"><a href="#cb15-205" aria-hidden="true" tabindex="-1"></a><span class="co">#Isocline nulles:</span></span>
<span id="cb15-206"><a href="#cb15-206" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0</span></span>
<span id="cb15-207"><a href="#cb15-207" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt, gy2 <span class="op">*</span> (xt<span class="op">/</span>gx2 <span class="op">-</span> rx2 <span class="op">*</span> xt<span class="op">/</span>b2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx2)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb15-208"><a href="#cb15-208" aria-hidden="true" tabindex="-1"></a>ax3.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb15-209"><a href="#cb15-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-210"><a href="#cb15-210" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb15-211"><a href="#cb15-211" aria-hidden="true" tabindex="-1"></a>ax3.plot(gx2 <span class="op">*</span> (yt<span class="op">/</span>gy2 <span class="op">-</span> ry2 <span class="op">*</span> yt<span class="op">/</span>b2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky2)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb15-212"><a href="#cb15-212" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb15-213"><a href="#cb15-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-214"><a href="#cb15-214" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration de la figure:</span></span>
<span id="cb15-215"><a href="#cb15-215" aria-hidden="true" tabindex="-1"></a>ax3.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.02</span>, right <span class="op">=</span> <span class="fl">0.35</span>)</span>
<span id="cb15-216"><a href="#cb15-216" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(top <span class="op">=</span> <span class="fl">1.4</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb15-217"><a href="#cb15-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-218"><a href="#cb15-218" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb15-219"><a href="#cb15-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-220"><a href="#cb15-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-221"><a href="#cb15-221" aria-hidden="true" tabindex="-1"></a><span class="co">#Ajout du champ de vecteur</span></span>
<span id="cb15-222"><a href="#cb15-222" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb15-223"><a href="#cb15-223" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb15-224"><a href="#cb15-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-225"><a href="#cb15-225" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb15-226"><a href="#cb15-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-227"><a href="#cb15-227" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous utilisons quiver:</span></span>
<span id="cb15-228"><a href="#cb15-228" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug2)</span>
<span id="cb15-229"><a href="#cb15-229" aria-hidden="true" tabindex="-1"></a>ax3.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">40</span>, width <span class="op">=</span> <span class="fl">0.003</span>)<span class="op">;</span></span>
<span id="cb15-230"><a href="#cb15-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-231"><a href="#cb15-231" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 3:</span></span>
<span id="cb15-232"><a href="#cb15-232" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres: </span></span>
<span id="cb15-233"><a href="#cb15-233" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-234"><a href="#cb15-234" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-235"><a href="#cb15-235" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-236"><a href="#cb15-236" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-237"><a href="#cb15-237" aria-hidden="true" tabindex="-1"></a>b3 <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb15-238"><a href="#cb15-238" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-239"><a href="#cb15-239" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-240"><a href="#cb15-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-241"><a href="#cb15-241" aria-hidden="true" tabindex="-1"></a>param_aug3<span class="op">=</span>np.array([rx3, ry3, Kx3, Ky3, b3, gx3, gy3])</span>
<span id="cb15-242"><a href="#cb15-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-243"><a href="#cb15-243" aria-hidden="true" tabindex="-1"></a><span class="co">#Isocline nulles:</span></span>
<span id="cb15-244"><a href="#cb15-244" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb15-245"><a href="#cb15-245" aria-hidden="true" tabindex="-1"></a>ax4.plot(xt, gy3 <span class="op">*</span> (xt<span class="op">/</span>gx3 <span class="op">-</span> rx3 <span class="op">*</span> xt<span class="op">/</span>b3 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx3)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb15-246"><a href="#cb15-246" aria-hidden="true" tabindex="-1"></a>ax4.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb15-247"><a href="#cb15-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-248"><a href="#cb15-248" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0 </span></span>
<span id="cb15-249"><a href="#cb15-249" aria-hidden="true" tabindex="-1"></a>ax4.plot(gx3 <span class="op">*</span> (yt<span class="op">/</span>gy3 <span class="op">-</span> ry3 <span class="op">*</span> yt<span class="op">/</span>b3 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky3)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb15-250"><a href="#cb15-250" aria-hidden="true" tabindex="-1"></a>ax4.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb15-251"><a href="#cb15-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-252"><a href="#cb15-252" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration:</span></span>
<span id="cb15-253"><a href="#cb15-253" aria-hidden="true" tabindex="-1"></a>ax4.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.08</span>, right <span class="op">=</span> <span class="fl">1.9</span>)</span>
<span id="cb15-254"><a href="#cb15-254" aria-hidden="true" tabindex="-1"></a>ax4.set_ylim(top<span class="op">=</span><span class="fl">1.5</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb15-255"><a href="#cb15-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-256"><a href="#cb15-256" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb15-257"><a href="#cb15-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-258"><a href="#cb15-258" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout du champ de vecteur</span></span>
<span id="cb15-259"><a href="#cb15-259" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.18</span>)</span>
<span id="cb15-260"><a href="#cb15-260" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.18</span>)</span>
<span id="cb15-261"><a href="#cb15-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-262"><a href="#cb15-262" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb15-263"><a href="#cb15-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-264"><a href="#cb15-264" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug3)</span>
<span id="cb15-265"><a href="#cb15-265" aria-hidden="true" tabindex="-1"></a>ax4.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">10</span>, width <span class="op">=</span> <span class="fl">0.0035</span>)<span class="op">;</span></span>
<span id="cb15-266"><a href="#cb15-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-267"><a href="#cb15-267" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous légendons:</span></span>
<span id="cb15-268"><a href="#cb15-268" aria-hidden="true" tabindex="-1"></a>ax4.legend()<span class="op">;</span></span>
<span id="cb15-269"><a href="#cb15-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-270"><a href="#cb15-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-271"><a href="#cb15-271" aria-hidden="true" tabindex="-1"></a>En fonction des valeurs de $\beta$ nous observons des profils différents de plan de phase. Pour mieux le visualiser nous pourrons utiliser l'animation Geogebra mise à disposition à la fin de l'analyse.</span>
<span id="cb15-272"><a href="#cb15-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-273"><a href="#cb15-273" aria-hidden="true" tabindex="-1"></a>D'après le champ de vecteurs nous voyons clairement que l'équilibre en $(0,0)$ est instable et l'équilibre $(x^*,y^*)$ est stable.  </span>
<span id="cb15-274"><a href="#cb15-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-275"><a href="#cb15-275" aria-hidden="true" tabindex="-1"></a>Pour calculer l'équilibre nous procédons de la même manière que dans la première partie, c'est à dire en croisant les deux paraboles $\dot x=0$ et $\dot y =0$ :  </span>
<span id="cb15-276"><a href="#cb15-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-277"><a href="#cb15-277" aria-hidden="true" tabindex="-1"></a>Nous avons $x^*=\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)$  </span>
<span id="cb15-278"><a href="#cb15-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-279"><a href="#cb15-279" aria-hidden="true" tabindex="-1"></a>Donc :</span>
<span id="cb15-280"><a href="#cb15-280" aria-hidden="true" tabindex="-1"></a>$$\small</span>
<span id="cb15-281"><a href="#cb15-281" aria-hidden="true" tabindex="-1"></a>y^*=\gamma_y\left(\frac{\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{\gamma_x}-\frac{r_x\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{\beta}\left<span class="co">[</span><span class="ot">1-\frac{\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{K_x}\right</span><span class="co">]</span>\right)</span>
<span id="cb15-282"><a href="#cb15-282" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-283"><a href="#cb15-283" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-284"><a href="#cb15-284" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb15-285"><a href="#cb15-285" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-286"><a href="#cb15-286" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-287"><a href="#cb15-287" aria-hidden="true" tabindex="-1"></a>-\frac{r_y\gamma_yy^*}{\beta} + \frac{r_y \gamma_y {y^*}^2}{\beta K_y} - \frac{r_x\gamma_xy^*}{\beta} + \frac{r_xr_y\gamma_x \gamma_y y^*}{\beta^2} <span class="sc">\\</span></span>
<span id="cb15-288"><a href="#cb15-288" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>\frac{r_xr_y\gamma_x\gamma_y{y^*}^2}{\beta^2K_y} + \frac{r_x\gamma_x^2{y^*}^2}{\beta K_x\gamma_y} - \frac{r_xr_y\gamma_x^2{y^*}^2}{\beta^2K_x} <span class="sc">\\</span></span>
<span id="cb15-289"><a href="#cb15-289" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>2\frac{r_xr_y\gamma_x^2{y^*}^3}{\beta^2K_xK_y} + \frac{r_xr_y^2\gamma_x^2 \gamma_y {y^*}^2}{\beta^3K_x} - 2\frac{r_xr_y^2\gamma_x^2\gamma_y{y^*}^3}{\beta^3K_xK_y} <span class="sc">\\</span></span>
<span id="cb15-290"><a href="#cb15-290" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>\frac{r_xr_y^2\gamma_x^2\gamma_y{y^*}^4}{\beta^3K_xK_y^2} = 0</span>
<span id="cb15-291"><a href="#cb15-291" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-292"><a href="#cb15-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-293"><a href="#cb15-293" aria-hidden="true" tabindex="-1"></a>Ce qui donne, en mettant les monomes $y^*$ en facteur et en simplifiant ensuite par $\frac{y^*}{\beta}$ :  </span>
<span id="cb15-294"><a href="#cb15-294" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-295"><a href="#cb15-295" aria-hidden="true" tabindex="-1"></a>\frac{r_xr_y\gamma_x\gamma_y}{\beta}-\gamma_yr_y-\gamma_xr_x +<span class="sc">\\</span> y^*\left<span class="co">[</span><span class="ot">\frac{r_y\gamma_y}{K_y}-\frac{r_xr_y\gamma_x\gamma_y}{\beta K_y}+ \frac{r_xr_y^2\gamma_x^2\gamma_y}{\beta^2K_x}+\frac{r_x\gamma_x^2}{\gamma_yK_x}-\frac{2r_xr_y\gamma_x^2}{\beta K_x}   \right</span><span class="co">]</span> +<span class="sc">\\</span><span class="co">[</span><span class="ot">.2cm</span><span class="co">]</span></span>
<span id="cb15-296"><a href="#cb15-296" aria-hidden="true" tabindex="-1"></a>\frac{2r_yr_x\gamma_x^2{y^*}^2}{\beta K_xK_y}\left(1-\frac{r_y\gamma_y}{\beta}\right) + \frac{r_xr_y^2\gamma_x^2\gamma_y {y^*}^3}{\beta^2K_xK_y^2} = 0</span>
<span id="cb15-297"><a href="#cb15-297" aria-hidden="true" tabindex="-1"></a>$${#eq-pol}</span>
<span id="cb15-298"><a href="#cb15-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-299"><a href="#cb15-299" aria-hidden="true" tabindex="-1"></a>Ce polynôme est résoluble par <span class="in">`numpy`</span> similairement à la première partie :</span>
<span id="cb15-300"><a href="#cb15-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-303"><a href="#cb15-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-304"><a href="#cb15-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb15-305"><a href="#cb15-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres pour calculer le polynôme</span></span>
<span id="cb15-306"><a href="#cb15-306" aria-hidden="true" tabindex="-1"></a>rx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-307"><a href="#cb15-307" aria-hidden="true" tabindex="-1"></a>ry <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-308"><a href="#cb15-308" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb15-309"><a href="#cb15-309" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-310"><a href="#cb15-310" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-311"><a href="#cb15-311" aria-hidden="true" tabindex="-1"></a>gx <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb15-312"><a href="#cb15-312" aria-hidden="true" tabindex="-1"></a>gy <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-313"><a href="#cb15-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-314"><a href="#cb15-314" aria-hidden="true" tabindex="-1"></a><span class="co">#Points d'équilibres, utilisation de numpy : monome, polynome et racines:</span></span>
<span id="cb15-315"><a href="#cb15-315" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul:</span></span>
<span id="cb15-316"><a href="#cb15-316" aria-hidden="true" tabindex="-1"></a><span class="co">#Monome y</span></span>
<span id="cb15-317"><a href="#cb15-317" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.polynomial.Polynomial([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb15-318"><a href="#cb15-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-319"><a href="#cb15-319" aria-hidden="true" tabindex="-1"></a><span class="co">#Polynome :</span></span>
<span id="cb15-320"><a href="#cb15-320" aria-hidden="true" tabindex="-1"></a>pol <span class="op">=</span> <span class="op">-</span>gy <span class="op">*</span> ry <span class="op">-</span> gx <span class="op">*</span> rx <span class="op">+</span> (rx <span class="op">*</span> ry <span class="op">*</span> gx <span class="op">*</span> gy)<span class="op">/</span>b <span class="op">+</span> x <span class="op">*</span> ((ry <span class="op">*</span> gy)<span class="op">/</span>(Ky) <span class="op">-</span> (ry <span class="op">*</span> rx <span class="op">*</span> gy <span class="op">*</span> gx)<span class="op">/</span>(b <span class="op">*</span> Ky) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb15-321"><a href="#cb15-321" aria-hidden="true" tabindex="-1"></a> rx <span class="op">*</span> ry<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> gy<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> Kx) <span class="op">+</span> rx <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(gy <span class="op">*</span> Kx) <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> rx <span class="op">*</span> ry <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(b <span class="op">*</span> Kx)) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb15-322"><a href="#cb15-322" aria-hidden="true" tabindex="-1"></a> (x<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> (ry <span class="op">*</span> rx <span class="op">*</span>gx<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(b <span class="op">*</span> Kx <span class="op">*</span> Ky) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> ry <span class="op">*</span> gy<span class="op">/</span>b) <span class="op">+</span> (x<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> gy <span class="op">*</span> rx <span class="op">*</span> ((ry <span class="op">*</span> gx)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> Kx <span class="op">*</span> Ky<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb15-323"><a href="#cb15-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-324"><a href="#cb15-324" aria-hidden="true" tabindex="-1"></a><span class="co">#Solution</span></span>
<span id="cb15-325"><a href="#cb15-325" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> pol.roots()[ (np.isreal( pol.roots() )) <span class="op">*</span> (pol.roots() <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb15-326"><a href="#cb15-326" aria-hidden="true" tabindex="-1"></a>yeq <span class="op">=</span> sol[<span class="dv">0</span>].real</span>
<span id="cb15-327"><a href="#cb15-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-328"><a href="#cb15-328" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul de x avec sa définition:</span></span>
<span id="cb15-329"><a href="#cb15-329" aria-hidden="true" tabindex="-1"></a>xeq <span class="op">=</span> gx <span class="op">*</span> (yeq<span class="op">/</span>gy <span class="op">-</span> ry <span class="op">*</span> yeq<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yeq<span class="op">/</span>Ky))</span>
<span id="cb15-330"><a href="#cb15-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-331"><a href="#cb15-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-332"><a href="#cb15-332" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analyse du plan de phase</span></span>
<span id="cb15-333"><a href="#cb15-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-334"><a href="#cb15-334" aria-hidden="true" tabindex="-1"></a>Nous allons tracer le plan de phase complet et l'analyser d'après la méthode d'@arditi2018 :  </span>
<span id="cb15-335"><a href="#cb15-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-336"><a href="#cb15-336" aria-hidden="true" tabindex="-1"></a>Dans cette analyse nous allons considérer, sans perte de généralité, que $r_x &lt; r_y$ (nous prenons l'ellipse dans un seul sens, voir l'animation).</span>
<span id="cb15-337"><a href="#cb15-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-338"><a href="#cb15-338" aria-hidden="true" tabindex="-1"></a>Pour cela nous traçons l'ellipse de la même manière que dans la première figure.</span>
<span id="cb15-339"><a href="#cb15-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-340"><a href="#cb15-340" aria-hidden="true" tabindex="-1"></a>Ensuite nous allons tracer la droite $d$ correspondant à $K_x+K_y=x^*+y^*$ car ceci va permettre de voir si le système subit une <span class="co">[</span><span class="ot">inflation</span><span class="co">](contexte.qmd)</span> ou une déflation.  </span>
<span id="cb15-341"><a href="#cb15-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-342"><a href="#cb15-342" aria-hidden="true" tabindex="-1"></a>Enfin, similairement à la partie prédédente nous allons tracer les droites données par $\beta = 0$ et $\beta \to +\infty$ dans la parabole définie par $\dot x =0$ (parabole verte sur le plan de phase).  </span>
<span id="cb15-343"><a href="#cb15-343" aria-hidden="true" tabindex="-1"></a>Les droites sont différentes du modèle précédent donc nous allons les recalculer :</span>
<span id="cb15-344"><a href="#cb15-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-345"><a href="#cb15-345" aria-hidden="true" tabindex="-1"></a>Lorsque $\beta = 0$ nous avons exactement les mêmes deux droites que dans le modèle précédent en $x^* =0$ et en $x^*=K_x$ car le fait que le nouveau modèle ajoute de l'asymétrie dans les migrations est effacé par une migration nulle. Nous les appellerons respectivement $P_{10}$ et $P_{20}$.</span>
<span id="cb15-346"><a href="#cb15-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-347"><a href="#cb15-347" aria-hidden="true" tabindex="-1"></a>Lorsque $\beta \to +\infty$ nous avons d'après (<span class="co">[</span><span class="ot">-@eq-pdpamig</span><span class="co">]</span>) : </span>
<span id="cb15-348"><a href="#cb15-348" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-349"><a href="#cb15-349" aria-hidden="true" tabindex="-1"></a>y^* = \frac{\gamma_y}{\gamma_x}x^*</span>
<span id="cb15-350"><a href="#cb15-350" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-351"><a href="#cb15-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-352"><a href="#cb15-352" aria-hidden="true" tabindex="-1"></a>Nous appellerons cette droite $P_{\infty}$.  </span>
<span id="cb15-353"><a href="#cb15-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-354"><a href="#cb15-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-355"><a href="#cb15-355" aria-hidden="true" tabindex="-1"></a>Introduisons les mêmes points que précédemment c'est à dire : </span>
<span id="cb15-356"><a href="#cb15-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-357"><a href="#cb15-357" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$A$, l'intersection entre $P_{20}$  et l'ellipse, c'est à dire la valeur de l'équilibre quand $\beta = 0$.</span>
<span id="cb15-358"><a href="#cb15-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-359"><a href="#cb15-359" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$B$, l'intersection entre $P_{\infty}$ et l'ellipse, c'est à dire la valeur de l'équilibre quand $\beta \to +\infty$.</span>
<span id="cb15-360"><a href="#cb15-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-361"><a href="#cb15-361" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$C$, l'intersection entre $P_{20}$ et $P_{\infty}$.</span>
<span id="cb15-362"><a href="#cb15-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-363"><a href="#cb15-363" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$D$, l'intersection entre la droite $d$ et l'ellipse qui n'est pas le point $A$.</span>
<span id="cb15-364"><a href="#cb15-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-365"><a href="#cb15-365" aria-hidden="true" tabindex="-1"></a>Représentons le plan de phase avec ces éléments :</span>
<span id="cb15-366"><a href="#cb15-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-369"><a href="#cb15-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-370"><a href="#cb15-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb15-371"><a href="#cb15-371" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pdp</span></span>
<span id="cb15-372"><a href="#cb15-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plan de phase complet du modèle" </span></span>
<span id="cb15-373"><a href="#cb15-373" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous créons la figure:</span></span>
<span id="cb15-374"><a href="#cb15-374" aria-hidden="true" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb15-375"><a href="#cb15-375" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">'Plan de phase de la population'</span>)</span>
<span id="cb15-376"><a href="#cb15-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-377"><a href="#cb15-377" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase:</span></span>
<span id="cb15-378"><a href="#cb15-378" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres égaux à ceux utilisés pour calculer les équilibres:</span></span>
<span id="cb15-379"><a href="#cb15-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-380"><a href="#cb15-380" aria-hidden="true" tabindex="-1"></a>param_aug <span class="op">=</span> np.array([rx, ry, Kx, Ky, b, gx, gy])</span>
<span id="cb15-381"><a href="#cb15-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-382"><a href="#cb15-382" aria-hidden="true" tabindex="-1"></a><span class="co"># Isocline nulles:</span></span>
<span id="cb15-383"><a href="#cb15-383" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-384"><a href="#cb15-384" aria-hidden="true" tabindex="-1"></a>yt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-385"><a href="#cb15-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-386"><a href="#cb15-386" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb15-387"><a href="#cb15-387" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, gy <span class="op">*</span> (xt<span class="op">/</span>gx <span class="op">-</span> rx <span class="op">*</span> xt<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x = 0$'</span>)</span>
<span id="cb15-388"><a href="#cb15-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-389"><a href="#cb15-389" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb15-390"><a href="#cb15-390" aria-hidden="true" tabindex="-1"></a>ax2.plot(gx <span class="op">*</span> (yt<span class="op">/</span>gy <span class="op">-</span> ry <span class="op">*</span> yt<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y = 0$'</span>)</span>
<span id="cb15-391"><a href="#cb15-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-392"><a href="#cb15-392" aria-hidden="true" tabindex="-1"></a><span class="co">#Cadrage:</span></span>
<span id="cb15-393"><a href="#cb15-393" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.30</span>, right <span class="op">=</span> <span class="fl">4.5</span>)</span>
<span id="cb15-394"><a href="#cb15-394" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(top <span class="op">=</span> <span class="dv">6</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.70</span>)</span>
<span id="cb15-395"><a href="#cb15-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-396"><a href="#cb15-396" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'$x^*$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)</span>
<span id="cb15-397"><a href="#cb15-397" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'$y^*$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)</span>
<span id="cb15-398"><a href="#cb15-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-399"><a href="#cb15-399" aria-hidden="true" tabindex="-1"></a><span class="co">#Axe x et y:</span></span>
<span id="cb15-400"><a href="#cb15-400" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, linestyle <span class="op">=</span> <span class="st">'dashed'</span>)</span>
<span id="cb15-401"><a href="#cb15-401" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(yt), yt, color <span class="op">=</span> <span class="st">'k'</span>, linestyle <span class="op">=</span> <span class="st">'dashed'</span>)</span>
<span id="cb15-402"><a href="#cb15-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-403"><a href="#cb15-403" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite capacité:</span></span>
<span id="cb15-404"><a href="#cb15-404" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-405"><a href="#cb15-405" aria-hidden="true" tabindex="-1"></a>ax2.plot(x, <span class="op">-</span>x <span class="op">+</span> Kx <span class="op">+</span> Ky, label <span class="op">=</span> <span class="st">'$K_x+K_y$'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>)</span>
<span id="cb15-406"><a href="#cb15-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-407"><a href="#cb15-407" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot des équilibres:</span></span>
<span id="cb15-408"><a href="#cb15-408" aria-hidden="true" tabindex="-1"></a>ax2.plot(xeq, yeq, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb15-409"><a href="#cb15-409" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">12</span>, color <span class="op">=</span> <span class="st">'C5'</span>)</span>
<span id="cb15-410"><a href="#cb15-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-411"><a href="#cb15-411" aria-hidden="true" tabindex="-1"></a><span class="co">#Ellipse:</span></span>
<span id="cb15-412"><a href="#cb15-412" aria-hidden="true" tabindex="-1"></a>xg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-413"><a href="#cb15-413" aria-hidden="true" tabindex="-1"></a>yg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-414"><a href="#cb15-414" aria-hidden="true" tabindex="-1"></a>X2, Y2 <span class="op">=</span> np.meshgrid(xg2, yg2)</span>
<span id="cb15-415"><a href="#cb15-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-416"><a href="#cb15-416" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> rx <span class="op">*</span> X2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> X2<span class="op">/</span>Kx)</span>
<span id="cb15-417"><a href="#cb15-417" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> ry <span class="op">*</span> Y2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> Y2<span class="op">/</span>Ky)</span>
<span id="cb15-418"><a href="#cb15-418" aria-hidden="true" tabindex="-1"></a>ax2.contour(X2, Y2, (X <span class="op">+</span> Y), [<span class="dv">0</span>], colors <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb15-419"><a href="#cb15-419" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'Ellipse des solutions'</span>)</span>
<span id="cb15-420"><a href="#cb15-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-421"><a href="#cb15-421" aria-hidden="true" tabindex="-1"></a><span class="co">#Parabole xdot=0 b=0:</span></span>
<span id="cb15-422"><a href="#cb15-422" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx <span class="op">*</span> np.ones_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>, label <span class="op">=</span> <span class="st">'Parabole β = 0'</span>)</span>
<span id="cb15-423"><a href="#cb15-423" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>)</span>
<span id="cb15-424"><a href="#cb15-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-425"><a href="#cb15-425" aria-hidden="true" tabindex="-1"></a><span class="co">#Parabole xdot=0 b=+inf:</span></span>
<span id="cb15-426"><a href="#cb15-426" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, xt <span class="op">*</span> gy<span class="op">/</span>gx, color <span class="op">=</span> <span class="st">'C6'</span>, label <span class="op">=</span> <span class="st">'Parabole β = $+\infty$'</span>)</span>
<span id="cb15-427"><a href="#cb15-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-428"><a href="#cb15-428" aria-hidden="true" tabindex="-1"></a><span class="co">#A:</span></span>
<span id="cb15-429"><a href="#cb15-429" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, Ky, color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb15-430"><a href="#cb15-430" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx <span class="op">-</span> <span class="fl">0.1</span>, Ky <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$A$'</span>)</span>
<span id="cb15-431"><a href="#cb15-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-432"><a href="#cb15-432" aria-hidden="true" tabindex="-1"></a><span class="co">#C:</span></span>
<span id="cb15-433"><a href="#cb15-433" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, gy <span class="op">*</span> Kx<span class="op">/</span>gx, color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb15-434"><a href="#cb15-434" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx, gy <span class="op">*</span> Kx<span class="op">/</span>gx <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'C'</span>)</span>
<span id="cb15-435"><a href="#cb15-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-436"><a href="#cb15-436" aria-hidden="true" tabindex="-1"></a><span class="co">#B:</span></span>
<span id="cb15-437"><a href="#cb15-437" aria-hidden="true" tabindex="-1"></a>ax2.plot(((gx<span class="op">/</span>gy) <span class="op">*</span> rx <span class="op">+</span> ry)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky),((gy<span class="op">/</span>gx) <span class="op">*</span> ry <span class="op">+</span> rx)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">\</span></span>
<span id="cb15-438"><a href="#cb15-438" aria-hidden="true" tabindex="-1"></a>                                        , color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb15-439"><a href="#cb15-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-440"><a href="#cb15-440" aria-hidden="true" tabindex="-1"></a>ax2.text(((gx<span class="op">/</span>gy) <span class="op">*</span> rx <span class="op">+</span> ry)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">-</span> <span class="fl">0.1</span>, ((gy<span class="op">/</span>gx) <span class="op">*</span> ry <span class="op">+</span> rx)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">+</span> <span class="fl">0.1</span> <span class="op">\</span></span>
<span id="cb15-441"><a href="#cb15-441" aria-hidden="true" tabindex="-1"></a>                                        , <span class="st">'$B$'</span>)</span>
<span id="cb15-442"><a href="#cb15-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-443"><a href="#cb15-443" aria-hidden="true" tabindex="-1"></a><span class="co">#D:</span></span>
<span id="cb15-444"><a href="#cb15-444" aria-hidden="true" tabindex="-1"></a>ax2.plot(ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb15-445"><a href="#cb15-445" aria-hidden="true" tabindex="-1"></a>ax2.text(ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx) <span class="op">-</span> <span class="fl">0.1</span>, rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx) <span class="op">+</span> <span class="fl">0.1</span>, <span class="st">'$D$'</span>)</span>
<span id="cb15-446"><a href="#cb15-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-447"><a href="#cb15-447" aria-hidden="true" tabindex="-1"></a><span class="co">## Nous plaçons des textes indiquant les trois droites:</span></span>
<span id="cb15-448"><a href="#cb15-448" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">0.1</span>, yeq, <span class="st">"$P_</span><span class="sc">{10}</span><span class="st">$"</span>)</span>
<span id="cb15-449"><a href="#cb15-449" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx <span class="op">+</span> <span class="fl">0.05</span>, <span class="dv">4</span>, <span class="st">"$P_</span><span class="sc">{20}</span><span class="st">$"</span>)</span>
<span id="cb15-450"><a href="#cb15-450" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="dv">3</span>, <span class="fl">5.5</span>, <span class="st">"$P_\infty$"</span>)</span>
<span id="cb15-451"><a href="#cb15-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-452"><a href="#cb15-452" aria-hidden="true" tabindex="-1"></a><span class="co">#Légende:</span></span>
<span id="cb15-453"><a href="#cb15-453" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)<span class="op">;</span></span>
<span id="cb15-454"><a href="#cb15-454" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-455"><a href="#cb15-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-456"><a href="#cb15-456" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Première condition de déflation</span></span>
<span id="cb15-457"><a href="#cb15-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-458"><a href="#cb15-458" aria-hidden="true" tabindex="-1"></a>La première condition d'inflation est exactement la même que dans le modèle précédent et la preuve est en tout point égale (elle repose sur une analyse de l'équation de l'ellipse qui est la même dans les deux modèles). Nous ne détaillerons pas ici cette preuve mais nous savons donc que :</span>
<span id="cb15-459"><a href="#cb15-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-460"><a href="#cb15-460" aria-hidden="true" tabindex="-1"></a>**Si $r_x = r_y$ alors le système est tout le temps déflationniste.**</span>
<span id="cb15-461"><a href="#cb15-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-462"><a href="#cb15-462" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Deuxième condition de déflation</span></span>
<span id="cb15-463"><a href="#cb15-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-464"><a href="#cb15-464" aria-hidden="true" tabindex="-1"></a>Nous allons faire une preuve graphique de cette condition similaire à l'ancien modèle.  </span>
<span id="cb15-465"><a href="#cb15-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-466"><a href="#cb15-466" aria-hidden="true" tabindex="-1"></a>L'équilibre vit sur l'ellipse et parcourt l'arc orange entre $A$ et $B$ au fur et à mesure que $\beta$ augmente.   </span>
<span id="cb15-467"><a href="#cb15-467" aria-hidden="true" tabindex="-1"></a>Ainsi pour avoir déflation nous allons vouloir avoir cet arc entièrement sous la droite $d$ en gris.  </span>
<span id="cb15-468"><a href="#cb15-468" aria-hidden="true" tabindex="-1"></a>Il est alors facile de voir que pour cela nous voulons que la coordonnée en $y$ de $C$ soit plus grande que celle de $A$ ($C$ est plus haut sur la droite cyan que $A$), entraînant que la coordonnée en $x$ de $B$ est plus petite que celle de $A$ ($B$ se trouve plus à gauche sur l'ellipse que $A$).  </span>
<span id="cb15-469"><a href="#cb15-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-470"><a href="#cb15-470" aria-hidden="true" tabindex="-1"></a>Pour cela nous avons besoin de connaître les coordonnées de $A$ et $C$.  </span>
<span id="cb15-471"><a href="#cb15-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-472"><a href="#cb15-472" aria-hidden="true" tabindex="-1"></a>Le point $A$ est défini comme la valeur de l'équilibre sans migration. Il est alors facile de constater que dans ce cas nous sommes face à un système avec une croissance logistique seulement et donc l'équilibre est atteint pour les capacités de charge.  </span>
<span id="cb15-473"><a href="#cb15-473" aria-hidden="true" tabindex="-1"></a>Nous avons donc $A = (K_x,K_y)$.</span>
<span id="cb15-474"><a href="#cb15-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-475"><a href="#cb15-475" aria-hidden="true" tabindex="-1"></a>Pour $C$ nous savons que c'est l'intersection entre $P_{20}$ et $P_{\infty}$, ainsi comme $P_{20}$ est défini par $x^* = K_x$ et $P_{\infty}$ par $y^* =\frac{\gamma_y}{\gamma_x}x^*$ nous avons :</span>
<span id="cb15-476"><a href="#cb15-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-477"><a href="#cb15-477" aria-hidden="true" tabindex="-1"></a>$C = (K_x,\frac{\gamma_yK_x}{\gamma_x})$.</span>
<span id="cb15-478"><a href="#cb15-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-479"><a href="#cb15-479" aria-hidden="true" tabindex="-1"></a>La condition mathématique qui en découle est donc que le système est déflationniste si $\frac{\gamma_yK_x}{\gamma_x} &gt; K_y$.</span>
<span id="cb15-480"><a href="#cb15-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-481"><a href="#cb15-481" aria-hidden="true" tabindex="-1"></a>**Si $\frac{\gamma_y}{\gamma_x} &gt; \frac{K_y}{K_x}$ alors le système ([-@eq-modamig]) est toujours déflationniste.**</span>
<span id="cb15-482"><a href="#cb15-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-483"><a href="#cb15-483" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Conditions d'inflation et/ou de déflation</span></span>
<span id="cb15-484"><a href="#cb15-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-485"><a href="#cb15-485" aria-hidden="true" tabindex="-1"></a>Similairement à la première partie nous allons avoir des conditions sur l'inflation.  </span>
<span id="cb15-486"><a href="#cb15-486" aria-hidden="true" tabindex="-1"></a>En effet, nous voyons bien sur le plan de phase que si $B$ est entre $A$ et $D$ alors l'arc d'ellipse que parcourent les équilibres en fonction de $\beta$ est constamment inflationniste.  </span>
<span id="cb15-487"><a href="#cb15-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-488"><a href="#cb15-488" aria-hidden="true" tabindex="-1"></a>Ainsi nous voulons que $B$ soit à droite de $A$ ce qui revient à prendre la condition inverse de celle énoncée plus haut (c'est à dire la coordonnées $y$ de $C$ plus petite que celle de $A$), c'est à dire $\frac{\gamma_y}{\gamma_x} &lt; \frac{K_y}{K_x}$.  </span>
<span id="cb15-489"><a href="#cb15-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-490"><a href="#cb15-490" aria-hidden="true" tabindex="-1"></a>Ensuite pour avoir $B$ entre $A$ et $D$ nous allons vouloir que la pente de $P_{\infty}$ soit plus haute que celle de la droite passant par $(0,0)$ et $D$ que nous appellerons $\aleph$.  </span>
<span id="cb15-491"><a href="#cb15-491" aria-hidden="true" tabindex="-1"></a>Pour voir ceci nous allons ajouter la droite $\aleph$ au plan de phase précédent :</span>
<span id="cb15-492"><a href="#cb15-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-495"><a href="#cb15-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-496"><a href="#cb15-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb15-497"><a href="#cb15-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pdp2</span></span>
<span id="cb15-498"><a href="#cb15-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plan de phase complet du modèle" </span></span>
<span id="cb15-499"><a href="#cb15-499" aria-hidden="true" tabindex="-1"></a><span class="co">## Ajout de la droite :</span></span>
<span id="cb15-500"><a href="#cb15-500" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (rx <span class="op">*</span> Ky)<span class="op">/</span>(ry <span class="op">*</span> Kx) <span class="op">*</span> xt, color <span class="op">=</span> <span class="st">'C5'</span>, label <span class="op">=</span> <span class="st">"Droite א"</span>)</span>
<span id="cb15-501"><a href="#cb15-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-502"><a href="#cb15-502" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb15-503"><a href="#cb15-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-504"><a href="#cb15-504" aria-hidden="true" tabindex="-1"></a>display(fig2)</span>
<span id="cb15-505"><a href="#cb15-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-506"><a href="#cb15-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-507"><a href="#cb15-507" aria-hidden="true" tabindex="-1"></a>Nous avons calculé dans la partie précédente que $D = (\frac{r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x} , \frac{r_xK_y(K_x+K_y)}{r_xK_y+r_yK_x} )$ ce qui ne change pas dans cette partie car nous considérons des quantités indépendantes des taux de migration.  </span>
<span id="cb15-508"><a href="#cb15-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-509"><a href="#cb15-509" aria-hidden="true" tabindex="-1"></a>La pente de la droite passant par $D$ et $(0,0)$ est donc égale à $\frac{r_xK_y}{r_yK_x}$ ce qui donne la condition suivante $\frac{\gamma_y}{\gamma_x} &gt; \frac{r_xK_y}{r_yK_x}$.</span>
<span id="cb15-510"><a href="#cb15-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-511"><a href="#cb15-511" aria-hidden="true" tabindex="-1"></a>**Si $\frac{r_xK_y}{r_yK_x} &lt; \frac{\gamma_y}{\gamma_x} &lt; \frac{K_y}{K_x}$ nous avons un système inflationniste pour tout $\beta$.**</span>
<span id="cb15-512"><a href="#cb15-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-513"><a href="#cb15-513" aria-hidden="true" tabindex="-1"></a>Il est alors aisé de voir que si la pente de $P_{\infty}$ est plus petite que celle de $\aleph$ nous avons les équilibres qui parcourent d'abord des valeurs au dessus de $d$ puis en dessous (pour aller de $A$ à $C$). </span>
<span id="cb15-514"><a href="#cb15-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-515"><a href="#cb15-515" aria-hidden="true" tabindex="-1"></a>La condition mathématique est donc la suivante :</span>
<span id="cb15-516"><a href="#cb15-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-517"><a href="#cb15-517" aria-hidden="true" tabindex="-1"></a>**Si $\frac{\gamma_y}{\gamma_x} &lt; \frac{r_xK_y}{r_yK_x}$ alors le système est d'abord inflationniste puis déflationniste lorsque $\beta$ augmente.**  </span>
<span id="cb15-518"><a href="#cb15-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-519"><a href="#cb15-519" aria-hidden="true" tabindex="-1"></a><span class="fu">### Animation</span></span>
<span id="cb15-522"><a href="#cb15-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-523"><a href="#cb15-523" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb15-524"><a href="#cb15-524" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-anim</span></span>
<span id="cb15-525"><a href="#cb15-525" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Animation Geogebra du plan de phase complet"</span></span>
<span id="cb15-526"><a href="#cb15-526" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> IPython.display <span class="im">as</span> display</span>
<span id="cb15-527"><a href="#cb15-527" aria-hidden="true" tabindex="-1"></a>fig01 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb15-528"><a href="#cb15-528" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;iframe width = "700" height = "550" src = "https://www.geogebra.org/classic/bhhpgtqv" style = "border: 1px solid black"&gt;&lt;/iframe&gt;</span></span>
<span id="cb15-529"><a href="#cb15-529" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb15-530"><a href="#cb15-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-531"><a href="#cb15-531" aria-hidden="true" tabindex="-1"></a>display.HTML(fig01)</span>
<span id="cb15-532"><a href="#cb15-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-533"><a href="#cb15-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-534"><a href="#cb15-534" aria-hidden="true" tabindex="-1"></a><span class="fu">## Somme des équilibres en fonction de la migration</span></span>
<span id="cb15-535"><a href="#cb15-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-536"><a href="#cb15-536" aria-hidden="true" tabindex="-1"></a><span class="fu">### Illustration des propositions précédentes</span></span>
<span id="cb15-537"><a href="#cb15-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-538"><a href="#cb15-538" aria-hidden="true" tabindex="-1"></a>Nous allons illustrer les propositions précédentes en traçant la somme des équilibres en fonction de $\beta$.</span>
<span id="cb15-539"><a href="#cb15-539" aria-hidden="true" tabindex="-1"></a>Pour cela nous allons simuler avec <span class="in">`odeint`</span> (pendant un temps assez large pour atteindre l'équilibre) pour chaque valeur de $\beta$. </span>
<span id="cb15-540"><a href="#cb15-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-541"><a href="#cb15-541" aria-hidden="true" tabindex="-1"></a>Nous définissons une fonction qui dépend de $\beta$ : </span>
<span id="cb15-544"><a href="#cb15-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-545"><a href="#cb15-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb15-546"><a href="#cb15-546" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug2(etat, t, param, h):</span>
<span id="cb15-547"><a href="#cb15-547" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, gy <span class="op">=</span> param</span>
<span id="cb15-548"><a href="#cb15-548" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> h</span>
<span id="cb15-549"><a href="#cb15-549" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb15-550"><a href="#cb15-550" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb15-551"><a href="#cb15-551" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb15-552"><a href="#cb15-552" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb15-553"><a href="#cb15-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-554"><a href="#cb15-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-555"><a href="#cb15-555" aria-hidden="true" tabindex="-1"></a>et nous posons le temps d'intégration, les paramètres et les conditions initiales :</span>
<span id="cb15-556"><a href="#cb15-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-559"><a href="#cb15-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-560"><a href="#cb15-560" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb15-561"><a href="#cb15-561" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb15-562"><a href="#cb15-562" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-563"><a href="#cb15-563" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-564"><a href="#cb15-564" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-565"><a href="#cb15-565" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-566"><a href="#cb15-566" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-567"><a href="#cb15-567" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-568"><a href="#cb15-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-569"><a href="#cb15-569" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, gy1])</span>
<span id="cb15-570"><a href="#cb15-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-571"><a href="#cb15-571" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb15-572"><a href="#cb15-572" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-573"><a href="#cb15-573" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-574"><a href="#cb15-574" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-575"><a href="#cb15-575" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-576"><a href="#cb15-576" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb15-577"><a href="#cb15-577" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-578"><a href="#cb15-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-579"><a href="#cb15-579" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, gx2, gy2])</span>
<span id="cb15-580"><a href="#cb15-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-581"><a href="#cb15-581" aria-hidden="true" tabindex="-1"></a><span class="co">#3:</span></span>
<span id="cb15-582"><a href="#cb15-582" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-583"><a href="#cb15-583" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-584"><a href="#cb15-584" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-585"><a href="#cb15-585" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb15-586"><a href="#cb15-586" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-587"><a href="#cb15-587" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-588"><a href="#cb15-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-589"><a href="#cb15-589" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3, gx3, gy3])</span>
<span id="cb15-590"><a href="#cb15-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-591"><a href="#cb15-591" aria-hidden="true" tabindex="-1"></a><span class="co">#4:</span></span>
<span id="cb15-592"><a href="#cb15-592" aria-hidden="true" tabindex="-1"></a>rx4 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-593"><a href="#cb15-593" aria-hidden="true" tabindex="-1"></a>ry4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-594"><a href="#cb15-594" aria-hidden="true" tabindex="-1"></a>Kx4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-595"><a href="#cb15-595" aria-hidden="true" tabindex="-1"></a>Ky4 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb15-596"><a href="#cb15-596" aria-hidden="true" tabindex="-1"></a>gx4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-597"><a href="#cb15-597" aria-hidden="true" tabindex="-1"></a>gy4 <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb15-598"><a href="#cb15-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-599"><a href="#cb15-599" aria-hidden="true" tabindex="-1"></a>param4 <span class="op">=</span> np.array([rx4, ry4, Kx4, Ky4, gx4, gy4])</span>
<span id="cb15-600"><a href="#cb15-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-601"><a href="#cb15-601" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration suffisament large pour atteindre l'équilibre:</span></span>
<span id="cb15-602"><a href="#cb15-602" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-603"><a href="#cb15-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-604"><a href="#cb15-604" aria-hidden="true" tabindex="-1"></a><span class="co">#Condition initiale:</span></span>
<span id="cb15-605"><a href="#cb15-605" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb15-606"><a href="#cb15-606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-607"><a href="#cb15-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-608"><a href="#cb15-608" aria-hidden="true" tabindex="-1"></a>Et enfin nous traçons les quatre figures :</span>
<span id="cb15-609"><a href="#cb15-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-612"><a href="#cb15-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-613"><a href="#cb15-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb15-614"><a href="#cb15-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eq</span></span>
<span id="cb15-615"><a href="#cb15-615" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "4 profils de population totale en fonction du taux de migration β"</span></span>
<span id="cb15-616"><a href="#cb15-616" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1, ax2, ax3) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb15-617"><a href="#cb15-617" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb15-618"><a href="#cb15-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-619"><a href="#cb15-619" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb15-620"><a href="#cb15-620" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb15-621"><a href="#cb15-621" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param1, i)) <span class="co">#Nous calculons pour chaque beta l'équilibre</span></span>
<span id="cb15-622"><a href="#cb15-622" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>) <span class="co">#Nous représentons un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb15-623"><a href="#cb15-623" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param3, i))</span>
<span id="cb15-624"><a href="#cb15-624" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb15-625"><a href="#cb15-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-626"><a href="#cb15-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-627"><a href="#cb15-627" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>):</span>
<span id="cb15-628"><a href="#cb15-628" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param2, i))</span>
<span id="cb15-629"><a href="#cb15-629" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb15-630"><a href="#cb15-630" aria-hidden="true" tabindex="-1"></a>    s3 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param4, i))</span>
<span id="cb15-631"><a href="#cb15-631" aria-hidden="true" tabindex="-1"></a>    ax3.plot(i, s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb15-632"><a href="#cb15-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-633"><a href="#cb15-633" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky:    </span></span>
<span id="cb15-634"><a href="#cb15-634" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-635"><a href="#cb15-635" aria-hidden="true" tabindex="-1"></a>xt2 <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.001</span>)</span>
<span id="cb15-636"><a href="#cb15-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-637"><a href="#cb15-637" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-638"><a href="#cb15-638" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb15-639"><a href="#cb15-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-640"><a href="#cb15-640" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt2, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt2), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-641"><a href="#cb15-641" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.10</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb15-642"><a href="#cb15-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-643"><a href="#cb15-643" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-644"><a href="#cb15-644" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.12</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb15-645"><a href="#cb15-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-646"><a href="#cb15-646" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt2, (Kx4 <span class="op">+</span> Ky4) <span class="op">*</span> np.ones_like(xt2), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-647"><a href="#cb15-647" aria-hidden="true" tabindex="-1"></a>ax3.text(<span class="fl">3.12</span>, Kx4 <span class="op">+</span> Ky4 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb15-648"><a href="#cb15-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-649"><a href="#cb15-649" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb15-650"><a href="#cb15-650" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb15-651"><a href="#cb15-651" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb15-652"><a href="#cb15-652" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb15-653"><a href="#cb15-653" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb15-654"><a href="#cb15-654" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb15-655"><a href="#cb15-655" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>)</span>
<span id="cb15-656"><a href="#cb15-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-657"><a href="#cb15-657" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous déplaçons la légende hors de la figure:</span></span>
<span id="cb15-658"><a href="#cb15-658" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor <span class="op">=</span> (<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb15-659"><a href="#cb15-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-660"><a href="#cb15-660" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb15-661"><a href="#cb15-661" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)<span class="op">;</span></span>
<span id="cb15-662"><a href="#cb15-662" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Les deux'</span>)<span class="op">;</span></span>
<span id="cb15-663"><a href="#cb15-663" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Inflation'</span>)<span class="op">;</span></span>
<span id="cb15-664"><a href="#cb15-664" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Inflation'</span>)<span class="op">;</span></span>
<span id="cb15-665"><a href="#cb15-665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-666"><a href="#cb15-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-667"><a href="#cb15-667" aria-hidden="true" tabindex="-1"></a>Nous obtenons 4 profils de courbe. Le premier profil montre une déflation du système et a été obtenu pour la condition décrite plus haut de $\frac{\gamma_y}{\gamma_x} &gt; \frac{K_y}{K_x}$.  </span>
<span id="cb15-668"><a href="#cb15-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-669"><a href="#cb15-669" aria-hidden="true" tabindex="-1"></a>Le deuxième profil correspond à une inflation du système puis une déflation quand $\beta$ augmente, cette courbe a bien été obtenue en respectant la condition de $\frac{\gamma_y}{\gamma_x} &lt; \frac{r_xK_y}{r_yK_x}$.  </span>
<span id="cb15-670"><a href="#cb15-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-671"><a href="#cb15-671" aria-hidden="true" tabindex="-1"></a>Les deux derniers profils, correspondant à une inflation permanente du système, sont obtenus en respectant les conditions décrites plus haut. Nous obtenons deux profils différents, un avec une inflation croissante quand $\beta$ augmente et l'autre avec une inflation croissante puis décroissante (et qui atteint un plateau).  </span>
<span id="cb15-672"><a href="#cb15-672" aria-hidden="true" tabindex="-1"></a>Ce phénomène se voit graphiquement sur l'animation ou le plan de phase. En effet, nous avons dans le premier cas </span>
<span id="cb15-673"><a href="#cb15-673" aria-hidden="true" tabindex="-1"></a>$P_{\infty}$ qui coupe l'ellipse dans sa phase montante (l'écart entre l'ellipse et la droite $d$ augmente) alors que dans le second cas $P_{\infty}$ coupe l'ellipse alors que l'écart entre celle-ci et $d$ diminue.</span>
<span id="cb15-674"><a href="#cb15-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-675"><a href="#cb15-675" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cas de l'augmentorium </span></span>
<span id="cb15-676"><a href="#cb15-676" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-677"><a href="#cb15-677" aria-hidden="true" tabindex="-1"></a>Dans le cas de l'augmentorium il est important de considérer l'équilibre $x^*$ seul par rapport à $K_x$ (sa valeur s'il n'y a pas de migration).  </span>
<span id="cb15-678"><a href="#cb15-678" aria-hidden="true" tabindex="-1"></a>En effet même si nous avons inflation dans le système, si $x^*&lt;K_x$ alors nous considérons l'augmentorium comme efficace.</span>
<span id="cb15-679"><a href="#cb15-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-680"><a href="#cb15-680" aria-hidden="true" tabindex="-1"></a>Avec les hypothèses énoncées plus haut sur la situation de l'augmentorium il n'est pas possible d'obtenir un système inflationniste (indépendamment de si $K_x&gt;K_y$ ou l'inverse). Il est facile de voir ceci grâce à notre animation.</span>
<span id="cb15-681"><a href="#cb15-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-682"><a href="#cb15-682" aria-hidden="true" tabindex="-1"></a>Néanmoins avec des hypothèses plus souples (mais en gardant que $r_x&lt;r_y$), par exemple que les taux de fuites sont plus forts que les taux de migration vers l'augmentorium (dus à une fuite du dispositif par exemple) nous allons voir que l'augmentorium n'est pas forcément bénéfique.  </span>
<span id="cb15-683"><a href="#cb15-683" aria-hidden="true" tabindex="-1"></a>En effet, nous pouvons, sur le plan de phase tracé plus haut, voir que dès que nous sommes dans un cas où nous avons de l'inflation (et même si nous revenons sur de la déflation après) alors nous avons $x^* &gt; K_x$ ce qui est mauvais pour la culture. </span>
<span id="cb15-684"><a href="#cb15-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-685"><a href="#cb15-685" aria-hidden="true" tabindex="-1"></a>Nous allons tracer l'équilibre $x^*$ en fonction de $\beta$ en considérant un cas où le système était déflationniste et un cas où le système était inflationniste (pour la somme des équilibres) :</span>
<span id="cb15-686"><a href="#cb15-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-689"><a href="#cb15-689" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-690"><a href="#cb15-690" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb15-691"><a href="#cb15-691" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eqx</span></span>
<span id="cb15-692"><a href="#cb15-692" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Simulation de l'équilibre dans la culture en fonction de β pour différentes conditions d'inflation de la population totale"</span></span>
<span id="cb15-693"><a href="#cb15-693" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb15-694"><a href="#cb15-694" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb15-695"><a href="#cb15-695" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-696"><a href="#cb15-696" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-697"><a href="#cb15-697" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-698"><a href="#cb15-698" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-699"><a href="#cb15-699" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-700"><a href="#cb15-700" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-701"><a href="#cb15-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-702"><a href="#cb15-702" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, gy1])</span>
<span id="cb15-703"><a href="#cb15-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-704"><a href="#cb15-704" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb15-705"><a href="#cb15-705" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-706"><a href="#cb15-706" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-707"><a href="#cb15-707" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-708"><a href="#cb15-708" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-709"><a href="#cb15-709" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb15-710"><a href="#cb15-710" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-711"><a href="#cb15-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-712"><a href="#cb15-712" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, gx2, gy2])</span>
<span id="cb15-713"><a href="#cb15-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-714"><a href="#cb15-714" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb15-715"><a href="#cb15-715" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-716"><a href="#cb15-716" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-717"><a href="#cb15-717" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-718"><a href="#cb15-718" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb15-719"><a href="#cb15-719" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-720"><a href="#cb15-720" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-721"><a href="#cb15-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-722"><a href="#cb15-722" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3, gx3, gy3])</span>
<span id="cb15-723"><a href="#cb15-723" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb15-724"><a href="#cb15-724" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb15-725"><a href="#cb15-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-726"><a href="#cb15-726" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'$x^*$ avec déflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb15-727"><a href="#cb15-727" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'$x^*$ avec déflation et inflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb15-728"><a href="#cb15-728" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'$x^*$ avec inflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb15-729"><a href="#cb15-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-730"><a href="#cb15-730" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle en fonction de beta</span></span>
<span id="cb15-731"><a href="#cb15-731" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb15-732"><a href="#cb15-732" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb15-733"><a href="#cb15-733" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb15-734"><a href="#cb15-734" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb15-735"><a href="#cb15-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-736"><a href="#cb15-736" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param2, i))</span>
<span id="cb15-737"><a href="#cb15-737" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb15-738"><a href="#cb15-738" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb15-739"><a href="#cb15-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-740"><a href="#cb15-740" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param3, i))</span>
<span id="cb15-741"><a href="#cb15-741" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb15-742"><a href="#cb15-742" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb15-743"><a href="#cb15-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-744"><a href="#cb15-744" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite Kx:</span></span>
<span id="cb15-745"><a href="#cb15-745" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-746"><a href="#cb15-746" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-747"><a href="#cb15-747" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb15-748"><a href="#cb15-748" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-749"><a href="#cb15-749" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.5</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb15-750"><a href="#cb15-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-751"><a href="#cb15-751" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, Kx2 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-752"><a href="#cb15-752" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx2 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb15-753"><a href="#cb15-753" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-754"><a href="#cb15-754" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb15-755"><a href="#cb15-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-756"><a href="#cb15-756" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, Kx3 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-757"><a href="#cb15-757" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.5</span>, Kx3 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb15-758"><a href="#cb15-758" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-759"><a href="#cb15-759" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.5</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb15-760"><a href="#cb15-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-761"><a href="#cb15-761" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb15-762"><a href="#cb15-762" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb15-763"><a href="#cb15-763" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb15-764"><a href="#cb15-764" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb15-765"><a href="#cb15-765" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb15-766"><a href="#cb15-766" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb15-767"><a href="#cb15-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-768"><a href="#cb15-768" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb15-769"><a href="#cb15-769" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb15-770"><a href="#cb15-770" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb15-771"><a href="#cb15-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-772"><a href="#cb15-772" aria-hidden="true" tabindex="-1"></a><span class="co"># Nous limitons le cadre :</span></span>
<span id="cb15-773"><a href="#cb15-773" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(bottom<span class="op">=</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb15-774"><a href="#cb15-774" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(bottom<span class="op">=</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb15-775"><a href="#cb15-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-776"><a href="#cb15-776" aria-hidden="true" tabindex="-1"></a><span class="co">#Nous déplaçons la légende hors de la figure:</span></span>
<span id="cb15-777"><a href="#cb15-777" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor <span class="op">=</span> (<span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))<span class="op">;</span></span>
<span id="cb15-778"><a href="#cb15-778" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-779"><a href="#cb15-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-780"><a href="#cb15-780" aria-hidden="true" tabindex="-1"></a>En bleu nous observons le comportement de l'équilibre dans la culture seulement et en gris nous retrouvons les courbes tracées juste au dessus. Nous voyons bien que dès que le système subit une inflation des équilibres totaux la situation devient mauvaise pour la culture.  </span>
<span id="cb15-781"><a href="#cb15-781" aria-hidden="true" tabindex="-1"></a>En revanche quand nous avons déflation des équilibres totaux alors la situtaion est bénéfique à la culture.  </span>
<span id="cb15-782"><a href="#cb15-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-783"><a href="#cb15-783" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb15-784"><a href="#cb15-784" aria-hidden="true" tabindex="-1"></a>On voit très bien ceci sur notre @fig-pdp en regardant où se place l'ellipse orange par rapport à la droite cyan représentant $K_x$</span>
<span id="cb15-785"><a href="#cb15-785" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-786"><a href="#cb15-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-787"><a href="#cb15-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-788"><a href="#cb15-788" aria-hidden="true" tabindex="-1"></a>Il faut garder en tête que ceci n'est vrai que pour $r_x&lt;r_y$.  </span>
<span id="cb15-789"><a href="#cb15-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-790"><a href="#cb15-790" aria-hidden="true" tabindex="-1"></a>Ensuite, le taux de fuite est un paramètre clé de notre méthode. Nous allons donc tracer la somme des équilibres et l'équilibre $x^*$ en fonction de $\gamma_y$.</span>
<span id="cb15-791"><a href="#cb15-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-792"><a href="#cb15-792" aria-hidden="true" tabindex="-1"></a>Attention ! Un fort taux de fuite correspond à un $\gamma_y$ faible.</span>
<span id="cb15-793"><a href="#cb15-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-796"><a href="#cb15-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb15-797"><a href="#cb15-797" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb15-798"><a href="#cb15-798" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-fuite</span></span>
<span id="cb15-799"><a href="#cb15-799" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Population totale et dans la culture en fonction du taux de fuite"</span></span>
<span id="cb15-800"><a href="#cb15-800" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition d'un nouveau modèle qui prend en compte le changement de gy:</span></span>
<span id="cb15-801"><a href="#cb15-801" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug3(etat, t, param, h):</span>
<span id="cb15-802"><a href="#cb15-802" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, b <span class="op">=</span> param</span>
<span id="cb15-803"><a href="#cb15-803" aria-hidden="true" tabindex="-1"></a>    gy <span class="op">=</span> h</span>
<span id="cb15-804"><a href="#cb15-804" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb15-805"><a href="#cb15-805" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb15-806"><a href="#cb15-806" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb15-807"><a href="#cb15-807" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb15-808"><a href="#cb15-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-809"><a href="#cb15-809" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb15-810"><a href="#cb15-810" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb15-811"><a href="#cb15-811" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-812"><a href="#cb15-812" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb15-813"><a href="#cb15-813" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-814"><a href="#cb15-814" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-815"><a href="#cb15-815" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-816"><a href="#cb15-816" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-817"><a href="#cb15-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-818"><a href="#cb15-818" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, b])</span>
<span id="cb15-819"><a href="#cb15-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-820"><a href="#cb15-820" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration assez large pour atteindre l'éq :</span></span>
<span id="cb15-821"><a href="#cb15-821" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-822"><a href="#cb15-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-823"><a href="#cb15-823" aria-hidden="true" tabindex="-1"></a><span class="co">#Conditions initiales:</span></span>
<span id="cb15-824"><a href="#cb15-824" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb15-825"><a href="#cb15-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-826"><a href="#cb15-826" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb15-827"><a href="#cb15-827" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb15-828"><a href="#cb15-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-829"><a href="#cb15-829" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite de la somme des capacités:</span></span>
<span id="cb15-830"><a href="#cb15-830" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-831"><a href="#cb15-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-832"><a href="#cb15-832" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-833"><a href="#cb15-833" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb15-834"><a href="#cb15-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-835"><a href="#cb15-835" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-836"><a href="#cb15-836" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb15-837"><a href="#cb15-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-838"><a href="#cb15-838" aria-hidden="true" tabindex="-1"></a><span class="co"># Nous plaçons une droite gx en pointillé:</span></span>
<span id="cb15-839"><a href="#cb15-839" aria-hidden="true" tabindex="-1"></a>ax.plot(gx1 <span class="op">*</span> np.ones_like(xt), xt, linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>)</span>
<span id="cb15-840"><a href="#cb15-840" aria-hidden="true" tabindex="-1"></a>ax.text(gx1, <span class="fl">0.2</span>, <span class="st">"Ɣx"</span>)</span>
<span id="cb15-841"><a href="#cb15-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-842"><a href="#cb15-842" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle qui calcule l'équilibre et qui plot un point en fonction des valeurs du taux de fuite:</span></span>
<span id="cb15-843"><a href="#cb15-843" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb15-844"><a href="#cb15-844" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug3, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb15-845"><a href="#cb15-845" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb15-846"><a href="#cb15-846" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>)</span>
<span id="cb15-847"><a href="#cb15-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-848"><a href="#cb15-848" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb15-849"><a href="#cb15-849" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb15-850"><a href="#cb15-850" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, Kx1 <span class="op">+</span> Ky1, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres ($x^*+y^*$)'</span>)</span>
<span id="cb15-851"><a href="#cb15-851" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, Kx1, color <span class="op">=</span> <span class="st">'0.8'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb15-852"><a href="#cb15-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-853"><a href="#cb15-853" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'$x^* + y^*$ et $x^*$ en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb15-854"><a href="#cb15-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-855"><a href="#cb15-855" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize <span class="op">=</span> <span class="st">'7'</span>)<span class="op">;</span></span>
<span id="cb15-856"><a href="#cb15-856" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Densité de pop."</span>)<span class="op">;</span></span>
<span id="cb15-857"><a href="#cb15-857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-858"><a href="#cb15-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-859"><a href="#cb15-859" aria-hidden="true" tabindex="-1"></a>Dans la figure gauche nous avons représenté la somme des équilibres ($x^*+y^*$) de la même manière que précédemment mais cette fois en faisant varier le taux de fuite.  </span>
<span id="cb15-860"><a href="#cb15-860" aria-hidden="true" tabindex="-1"></a>Nous observons alors un nouveau profil qui correspond à une déflation, puis une inflation puis enfin une déflation au fur et à mesure que $\gamma_y$ augmente.</span>
<span id="cb15-861"><a href="#cb15-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-862"><a href="#cb15-862" aria-hidden="true" tabindex="-1"></a>Dans la figure droite nous avons cette fois uniquement l'équilibre dans la culture ($x^*$). Nous observons que pour des $\gamma_y$ petits nous avons inflation puis nous retournons à une déflation.  </span>
<span id="cb15-863"><a href="#cb15-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-864"><a href="#cb15-864" aria-hidden="true" tabindex="-1"></a>Pour représenter cette figure nous avons considéré que $r_x&lt;r_y$ et $K_x&lt;K_y$ sans perte de généralité.</span>
<span id="cb15-865"><a href="#cb15-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-866"><a href="#cb15-866" aria-hidden="true" tabindex="-1"></a>Pour interpréter ceci il faut comprendre que les des petites valeurs de $\gamma_y$ correspondent à de grandes valeurs de taux de fuite.  </span>
<span id="cb15-867"><a href="#cb15-867" aria-hidden="true" tabindex="-1"></a>Ainsi quand $\gamma_y \to 0$ l'augmentorium se vide en ravageurs et nous avons ainsi toute la population dans la culture et l'équilibre dans la culture tend vers sa capacité de charge car nous sommes seulement face à une croissance logistique.  </span>
<span id="cb15-868"><a href="#cb15-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-869"><a href="#cb15-869" aria-hidden="true" tabindex="-1"></a>Nous sommes face à une situation un peu paradoxale. La population globale à l'équilibre subit une déflation pour des taux de fuite élevés alors qu'on observe une inflation de la population dans la culture par rapport à sa capacité de charge.  </span>
<span id="cb15-870"><a href="#cb15-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-871"><a href="#cb15-871" aria-hidden="true" tabindex="-1"></a>En effet, lorsque les taux de fuite sont grands nous observons une inflation de la culture car nous avons des populations de ravageurs qui viennent de l'augmentorium qui s'ajoutent aux ravageurs déjà présents dans la culture.  </span>
<span id="cb15-872"><a href="#cb15-872" aria-hidden="true" tabindex="-1"></a>La somme des équilibres est donc trompeuse dans ce cas là, en effet le système subit une déflation car l'augmentorium n'est presque plus occupé pour de forts taux de fuite mais il ne faut pas croire que c'en est bénéfique pour la culture.</span>
<span id="cb15-873"><a href="#cb15-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-874"><a href="#cb15-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-875"><a href="#cb15-875" aria-hidden="true" tabindex="-1"></a>Ce modèle considère uniquement la population de ravageurs. Or, la méthode de l'augmentorium repose énormément sur l'action des prédateurs nous allons donc considérer <span class="co">[</span><span class="ot">maintenant</span><span class="co">](modelaug.qmd)</span> un modèle qui prend en compte ces prédateurs.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Pour plus d’informations, voyez <a href="./about.html">ici</a>.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>