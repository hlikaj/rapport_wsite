<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Rapport de stage - Modèle logistique structuré avec migration assymétrique</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./modeleavecmigrationass.html">Modèle logistique structuré avec migration assymétrique</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Rapport de stage</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Présentation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contexte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contexte</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelesansmigrationass.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modèle logistique structuré avec migration symétrique</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modeleavecmigrationass.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Modèle logistique structuré avec migration assymétrique</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelaug.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modèle avec proies structurées et prédateurs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modfinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modèle proies-prédateurs structuré</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conclusion et perspectives</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#définition-du-modèle" id="toc-définition-du-modèle" class="nav-link active" data-scroll-target="#définition-du-modèle">Définition du modèle</a>
  <ul class="collapse">
  <li><a href="#nouvelles-hypothèses-propres-à-laugmentorium" id="toc-nouvelles-hypothèses-propres-à-laugmentorium" class="nav-link" data-scroll-target="#nouvelles-hypothèses-propres-à-laugmentorium">Nouvelles hypothèses propres à l’augmentorium</a></li>
  </ul></li>
  <li><a href="#dynamique-du-modèle" id="toc-dynamique-du-modèle" class="nav-link" data-scroll-target="#dynamique-du-modèle">Dynamique du modèle</a></li>
  <li><a href="#plan-de-phase" id="toc-plan-de-phase" class="nav-link" data-scroll-target="#plan-de-phase">Plan de phase</a>
  <ul class="collapse">
  <li><a href="#equilibres-et-leur-stabilité" id="toc-equilibres-et-leur-stabilité" class="nav-link" data-scroll-target="#equilibres-et-leur-stabilité">Equilibres et leur stabilité</a></li>
  <li><a href="#analyse-du-plan-de-phase" id="toc-analyse-du-plan-de-phase" class="nav-link" data-scroll-target="#analyse-du-plan-de-phase">Analyse du plan de phase</a></li>
  <li><a href="#animation" id="toc-animation" class="nav-link" data-scroll-target="#animation">Animation</a></li>
  </ul></li>
  <li><a href="#somme-des-équilibres-en-fonction-de-la-migration" id="toc-somme-des-équilibres-en-fonction-de-la-migration" class="nav-link" data-scroll-target="#somme-des-équilibres-en-fonction-de-la-migration">Somme des équilibres en fonction de la migration</a>
  <ul class="collapse">
  <li><a href="#illustration-des-propositions-précédentes" id="toc-illustration-des-propositions-précédentes" class="nav-link" data-scroll-target="#illustration-des-propositions-précédentes">Illustration des propositions précédentes</a></li>
  <li><a href="#cas-de-laugmentorium" id="toc-cas-de-laugmentorium" class="nav-link" data-scroll-target="#cas-de-laugmentorium">Cas de l’augmentorium</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Modèle logistique structuré avec migration assymétrique</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><em>Modules à importer :</em></p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="définition-du-modèle" class="level2">
<h2 class="anchored" data-anchor-id="définition-du-modèle">Définition du modèle</h2>
<p>Le but d’un augmentorium est de confiner les ravageurs dans un espace clos qui ne laisse pas (ou peu) s’échapper ceux-ci.<br>
Ainsi, il s’établit une migration assymétrique entre les deux structures qu’on peut modéliser en établissant le modèle suivant d’après <span class="citation" data-cites="arditi2018">Arditi (<a href="#ref-arditi2018" role="doc-biblioref">2018</a>)</span> :</p>
<p><span id="eq-modamig"><span class="math display">
\left\{\begin{array}{l}
\dot x = r_xx(1-\frac{x}{K_x})+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)\\
\dot y = r_yy(1-\frac{y}{K_y})+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)
\end{array}\right.
\tag{1}</span></span></p>
<p>avec :<br>
- <span class="math inline">x</span> la population de ravageurs dans la culture,<br>
- <span class="math inline">y</span> la population de ravageurs dans l’augmentorium,<br>
- <span class="math inline">r_x</span> et <span class="math inline">r_y</span> le taux de croissance dans la culture et dans l’augmentorium,<br>
- <span class="math inline">K_x</span> et <span class="math inline">K_y</span> les capacités de charges de la culture de de l’augmentorium,<br>
- <span class="math inline">\beta</span> la force de migration entre les structures,<br>
- <span class="math inline">\gamma_x</span> et <span class="math inline">\gamma_y</span> caractérisant l’assymétrie de migration.</p>
<section id="nouvelles-hypothèses-propres-à-laugmentorium" class="level3">
<h3 class="anchored" data-anchor-id="nouvelles-hypothèses-propres-à-laugmentorium">Nouvelles hypothèses propres à l’augmentorium</h3>
<p>Ce modèle est plus proche de celui d’un augmentorium.<br>
Comme les ravageurs se reproduisent mieux dans l’augmentorium que dans la culture on peut dire que <span class="math inline">r_x&lt;r_y</span>.<br>
On peut aussi dire que le taux de fuite des ravageurs (<span class="math inline">\frac{1}{\gamma_y}</span>) se doit d’être beaucoup plus petit que le taux de migration (<span class="math inline">\frac{1}{\gamma_x}</span>).<br>
On a donc <span class="math inline">\gamma_x &lt;&lt; \gamma_y</span>.</p>
</section>
</section>
<section id="dynamique-du-modèle" class="level2">
<h2 class="anchored" data-anchor-id="dynamique-du-modèle">Dynamique du modèle</h2>
<p>Encore une fois on simule la dynamique des deux populations en fonction du temps en codant comme dans la première partie</p>
<p>On définit le système sous <a href="https://www.python.org/">Python</a>:</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug(etat, t, param):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, b, gx, gy <span class="op">=</span> param</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span>[rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Et on définit les paramètres, le temps d’intégration etc. :</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Temps d'intégration:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ti <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Etats initiaux:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [x0, y0]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres: </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>rx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>ry <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>gx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>gy <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>param_aug <span class="op">=</span> np.array([rx, ry, Kx, Ky, b, gx, gy])</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation:</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> odeint(aug, e0, ti, args <span class="op">=</span> (param_aug, ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>On trace la figure :</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Dynamique des ravageurs dans le temps avec augmentorium'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[ :, <span class="dv">0</span>], color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'culture'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[ :, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'augmentorium'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout d'élements:</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Temps, t'</span>)<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Densité de pop.'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modeleavecmigrationass_files/figure-html/cell-5-output-1.png" width="598" height="477"></p>
</div>
</div>
<p>Cette dynamique, comme en première partie, présente un équilibre de maintien de la population.<br>
Néanmoins on observe que, pour les mêmes paramètres que dans la première partie, la population dans la culture est bien plus faible.<br>
La migration assymétrique vers l’augmentorium semble être bénéfique à la culture.</p>
</section>
<section id="plan-de-phase" class="level2">
<h2 class="anchored" data-anchor-id="plan-de-phase">Plan de phase</h2>
<section id="equilibres-et-leur-stabilité" class="level3">
<h3 class="anchored" data-anchor-id="equilibres-et-leur-stabilité">Equilibres et leur stabilité</h3>
<p>A l’équilibre on a le système suivant :</p>
<p><span id="eq-pdpamig0"><span class="math display">
\left\{\begin{array}{l}
\dot x = 0 \Leftrightarrow 0 = r_xx(1-\frac{x}{K_x})+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)\\
\dot y = 0 \Leftrightarrow 0 = r_yy(1-\frac{y}{K_y})+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)
\end{array}\right.
\tag{2}</span></span> <span class="math display">
\Leftrightarrow
</span> <span id="eq-pdpamig"><span class="math display">
\left\{\begin{array}{l}
y^*=\gamma_y\left(\frac{x}{\gamma_x}-\frac{r_xx}{\beta}\left(1-\frac{x}{K_x}\right)\right)\\
x^*=\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)
\end{array}\right.
\tag{3}</span></span></p>
<p>On voit tout de suite qu’on a deux paraboles qui se croisent en <span class="math inline">(0,0)</span> et en <span class="math inline">(x^*,y^*)</span>.<br>
On va donc avoir deux équilibres, ceux-ci vivent sur une ellipse de même équation qu’en première partie.</p>
<p>En fonction des racines des paraboles on va avoir des plans de phases différents qu’on va tracer via les mêmes techniques qu’en première partie :</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#On crée la figure avec les 3 sous figures:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fig2, (ax2, ax3, ax4) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">'Plan de phase de la population'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'β=1'</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'β=10'</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'β=0.1'</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 1:#</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres: </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>param_aug1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, b1, gx1, gy1])</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Isocline nulles:</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>yt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, gy1 <span class="op">*</span> (xt<span class="op">/</span>gx1 <span class="op">-</span> rx1 <span class="op">*</span> xt<span class="op">/</span>b1 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx1)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>ax2.plot(gx1 <span class="op">*</span> (yt<span class="op">/</span>gy1 <span class="op">-</span> ry1 <span class="op">*</span> yt<span class="op">/</span>b1 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky1)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration de la figure:</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.03</span>, right <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(top <span class="op">=</span> <span class="fl">1.5</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Ravageur dans l</span><span class="ch">\'</span><span class="st">augmentorium'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Ajout du champ de vecteur</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="co">#On utilise quiver:</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug1)</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>ax2.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">15</span>, width <span class="op">=</span> <span class="fl">0.0035</span>)<span class="op">;</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 2:#</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres: </span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>param_aug2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, b2, gx2, gy2])  </span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="co">#Isocline nulles:</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt, gy2 <span class="op">*</span> (xt<span class="op">/</span>gx2 <span class="op">-</span> rx2 <span class="op">*</span> xt<span class="op">/</span>b2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx2)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>ax3.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>ax3.plot(gx2 <span class="op">*</span> (yt<span class="op">/</span>gy2 <span class="op">-</span> ry2 <span class="op">*</span> yt<span class="op">/</span>b2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky2)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration de la figure:</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>ax3.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.02</span>, right <span class="op">=</span> <span class="fl">0.35</span>)</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(top <span class="op">=</span> <span class="fl">1.4</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a><span class="co">#Ajout du champ de vecteur</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a><span class="co">#On utilise quiver:</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug2)</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>ax3.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">40</span>, width <span class="op">=</span> <span class="fl">0.003</span>)<span class="op">;</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 3:</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres: </span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>b3 <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>param_aug3<span class="op">=</span>np.array([rx3, ry3, Kx3, Ky3, b3, gx3, gy3])</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a><span class="co">#Isocline nulles:</span></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>ax4.plot(xt, gy3 <span class="op">*</span> (xt<span class="op">/</span>gx3 <span class="op">-</span> rx3 <span class="op">*</span> xt<span class="op">/</span>b3 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx3)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>ax4.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0 </span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>ax4.plot(gx3 <span class="op">*</span> (yt<span class="op">/</span>gy3 <span class="op">-</span> ry3 <span class="op">*</span> yt<span class="op">/</span>b3 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky3)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>ax4.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration:</span></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>ax4.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.08</span>, right <span class="op">=</span> <span class="fl">1.9</span>)</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>ax4.set_ylim(top<span class="op">=</span><span class="fl">1.5</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout du champ de vecteur</span></span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.18</span>)</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.18</span>)</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug3)</span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>ax4.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">10</span>, width <span class="op">=</span> <span class="fl">0.0035</span>)<span class="op">;</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a><span class="co">#On légende:</span></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>ax4.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modeleavecmigrationass_files/figure-html/cell-6-output-1.png" width="740" height="396"></p>
</div>
</div>
<p>En fonction des valeurs de <span class="math inline">\beta</span> on observe des profils différents de plan de phase. Pour mieux le visualiser on pourra utiliser l’animation <a href="@fig-anim">Geogebra</a> mise à disposition à la fin de l’analyse.</p>
<p>D’après le champ de vecteurs on voit clairement que l’équilibre en <span class="math inline">(0,0)</span> est instable et l’équilibre <span class="math inline">(x^*,y^*)</span> est stable.</p>
<p>Pour calculer l’équilibre on procède de la même manière que dans la première partie, c’est à dire en croisant les deux paraboles $ $ et <span class="math inline">\dot y =0</span> : On a <span class="math inline">x^*=\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)</span>.<br>
Donc : <span class="math display">\small
y^*=\gamma_y\left(\frac{\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{\gamma_x}-\frac{r_x\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{\beta}\left[1-\frac{\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{K_x}\right]\right)
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
-\frac{r_y\gamma_yy^*}{\beta} + \frac{r_y \gamma_y {y^*}^2}{\beta K_y} - \frac{r_x\gamma_xy^*}{\beta} + \frac{r_xr_y\gamma_x \gamma_y y^*}{\beta^2} \\
- \frac{r_xr_y\gamma_x\gamma_y{y^*}^2}{\beta^2K_y} + \frac{r_x\gamma_x^2{y^*}^2}{\beta K_x\gamma_y} - \frac{r_xr_y\gamma_x^2{y^*}^2}{\beta^2K_x} \\
+ 2\frac{r_xr_y\gamma_x^2{y^*}^3}{\beta^2K_xK_y} + \frac{r_xr_y^2\gamma_x^2 \gamma_y {y^*}^2}{\beta^3K_x} - 2\frac{r_xr_y^2\gamma_x^2\gamma_y{y^*}^3}{\beta^3K_xK_y} \\
+ \frac{r_xr_y^2\gamma_x^2\gamma_y{y^*}^4}{\beta^3K_xK_y^2}
</span></p>
<p>Ce qui donne, en mettant les monomes <span class="math inline">y^*</span> en facteur et en simplifiant ensuite par <span class="math inline">\frac{y^*}{\beta}</span> :<br>
<span id="eq-pol"><span class="math display">
\frac{r_xr_y\gamma_x\gamma_y}{\beta}-\gamma_yr_y-\gamma_xr_x +\\ y\left[\frac{r_y\gamma_y}{K_y}-\frac{r_xr_y\gamma_x\gamma_y}{\beta K_y}+ \frac{r_xr_y^2\gamma_x^2\gamma_y}{\beta^2K_x}+\frac{r_x\gamma_x^2}{\gamma_yK_x}-\frac{2r_xr_y\gamma_x^2}{\beta K_x}   \right] +\\[.2cm]
\frac{2r_yr_x\gamma_x^2y^2}{\beta K_xK_y}\left(1-\frac{r_y\gamma_y}{\beta}\right) + \frac{r_xr_y^2\gamma_x^2\gamma_yy^3}{\beta^2K_xK_y^2} = 0
\tag{4}</span></span></p>
<p>Ce polynôme est résoluble par <code>numpy</code> similairement à la première partie :</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres pour calculer le polynôme</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>rx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ry <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>gx <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>gy <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Points d'équilibres, utilisation de numpy : monome, polynome et racines:</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Monome y</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.polynomial.Polynomial([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Polynome :</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>pol <span class="op">=</span> <span class="op">-</span>gy <span class="op">*</span> ry <span class="op">-</span> gx <span class="op">*</span> rx <span class="op">+</span> (rx <span class="op">*</span> ry <span class="op">*</span> gx <span class="op">*</span> gy)<span class="op">/</span>b <span class="op">+</span> x <span class="op">*</span> ((ry <span class="op">*</span> gy)<span class="op">/</span>(Ky) <span class="op">-</span> (ry <span class="op">*</span> rx <span class="op">*</span> gy <span class="op">*</span> gx)<span class="op">/</span>(b <span class="op">*</span> Ky) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a> rx <span class="op">*</span> ry<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> gy<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> Kx) <span class="op">+</span> rx <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(gy <span class="op">*</span> Kx) <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> rx <span class="op">*</span> ry <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(b <span class="op">*</span> Kx)) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a> (x<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> (ry <span class="op">*</span> rx <span class="op">*</span>gx<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(b <span class="op">*</span> Kx <span class="op">*</span> Ky) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> ry <span class="op">*</span> gy<span class="op">/</span>b) <span class="op">+</span> (x<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> gy <span class="op">*</span> rx <span class="op">*</span> ((ry <span class="op">*</span> gx)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> Kx <span class="op">*</span> Ky<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Solution</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> pol.roots()[ (np.isreal( pol.roots() )) <span class="op">*</span> (pol.roots() <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>yeq <span class="op">=</span> sol[<span class="dv">0</span>].real</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul de x avec sa définition:</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>xeq <span class="op">=</span> gx <span class="op">*</span> (yeq<span class="op">/</span>gy <span class="op">-</span> ry <span class="op">*</span> yeq<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yeq<span class="op">/</span>Ky))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="analyse-du-plan-de-phase" class="level3">
<h3 class="anchored" data-anchor-id="analyse-du-plan-de-phase">Analyse du plan de phase</h3>
<p>On va tracer le plan de phase complet et l’analyser d’après la méthode d’<span class="citation" data-cites="arditi2018">Arditi (<a href="#ref-arditi2018" role="doc-biblioref">2018</a>)</span> :</p>
<p>Dans cette analyse on va considérer, sans perte de généralité, que <span class="math inline">r_x &lt; r_y</span> (on prend l’ellipse dans un seul sens, voir l’<a href="@fig-anim">animation</a>).</p>
<p>Pour cela on trace l’ellipse de la même manière que dans la première figure, l’équation de cette ellipse n’ayant pas de terme de migration dans le premier modèle elle est la même dans celui-ci aussi.</p>
<p>Ensuite on va tracer la droite <span class="math inline">d</span> correspondant à <span class="math inline">K_x+K_y=x^*+y^*</span> car ceci va permettre de voir si le système subit une <a href="./contexte.html">inflation</a> ou une déflation.</p>
<p>Enfin, similairement à la partie prédédente on va tracer les droites données par <span class="math inline">\beta = 0</span> et <span class="math inline">\beta = +\infty</span> dans la parabole définie par <span class="math inline">\dot x =0</span> (parabole verte sur le plan de phase).<br>
Les droites sont différentes du modèle précédent donc on va les recalculer :</p>
<p>Lorsque <span class="math inline">\beta = 0</span> on a exactement les mêmes deux droites que dans le modèle précédent en <span class="math inline">x^* =0</span> et en <span class="math inline">x^*=K_x</span> car le fait que le nouveau modèle ajoute de l’assymétrie dans les migrations est effacé par une migration nulle. On les appelle respectivement <span class="math inline">P_{10}</span> et <span class="math inline">P_{20}</span>.</p>
<p>Lorsque <span class="math inline">\beta = +\infty</span> on a d’après (<a href="#eq-pdpamig">3</a>) : <span class="math display">
y^* = \frac{\gamma_y}{\gamma_x}x^*
</span></p>
<p>On appellera cette droite <span class="math inline">P_{\infty}</span>.</p>
<p>Introduisons les mêmes points que précédemment c’est à dire :</p>
<ul>
<li><p><span class="math inline">A</span>, l’intersection entre <span class="math inline">P_{20}</span> et l’ellipse, c’est à dire la valeur de l’équilibre quand <span class="math inline">\beta = 0</span>.</p></li>
<li><p><span class="math inline">B</span>, l’intersection entre <span class="math inline">P_{\infty}</span> et l’ellipse, c’est à dire la valeur de l’équilibre quand <span class="math inline">\beta = +\infty</span>.</p></li>
<li><p><span class="math inline">C</span>, l’intersection entre <span class="math inline">P_{20}</span> et <span class="math inline">P_{\infty}</span>.</p></li>
<li><p><span class="math inline">D</span>, l’intersection entre la droite <span class="math inline">d</span> et l’ellipse qui n’est pas le point <span class="math inline">A</span>.</p></li>
</ul>
<p>Représentons le plan de phase avec ces éléments :</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#On crée la figure:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">'Plan de phase de la population'</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres égaux à ceux utilisés pour calculer les équilibres:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>param_aug <span class="op">=</span> np.array([rx, ry, Kx, Ky, b, gx, gy])</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Isocline nulles:</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>yt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, gy <span class="op">*</span> (xt<span class="op">/</span>gx <span class="op">-</span> rx <span class="op">*</span> xt<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x = 0$'</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>ax2.plot(gx <span class="op">*</span> (yt<span class="op">/</span>gy <span class="op">-</span> ry <span class="op">*</span> yt<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y = 0$'</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Cadrage:</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.30</span>, right <span class="op">=</span> <span class="fl">4.5</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(top <span class="op">=</span> <span class="dv">6</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.70</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'$x^*$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'$y^*$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Axe x et y:</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, linestyle <span class="op">=</span> <span class="st">'dashed'</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(yt), yt, color <span class="op">=</span> <span class="st">'k'</span>, linestyle <span class="op">=</span> <span class="st">'dashed'</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite capacité:</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>ax2.plot(x, <span class="op">-</span>x <span class="op">+</span> Kx <span class="op">+</span> Ky, label <span class="op">=</span> <span class="st">'$K_x+K_y$'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot des équilibres:</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>ax2.plot(xeq, yeq, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">12</span>, color <span class="op">=</span> <span class="st">'C5'</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Ellipse:</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>xg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>yg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>X2, Y2 <span class="op">=</span> np.meshgrid(xg2, yg2)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> rx <span class="op">*</span> X2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> X2<span class="op">/</span>Kx)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> ry <span class="op">*</span> Y2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> Y2<span class="op">/</span>Ky)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>ax2.contour(X2, Y2, (X <span class="op">+</span> Y), [<span class="dv">0</span>], colors <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'Ellipse des solutions'</span>)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="co">#Parabole xdot=0 b=0:</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx <span class="op">*</span> np.ones_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>, label <span class="op">=</span> <span class="st">'Parabole β = 0'</span>)</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>)</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="co">#Parabole xdot=0 b=+inf:</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, xt <span class="op">*</span> gy<span class="op">/</span>gx, color <span class="op">=</span> <span class="st">'C6'</span>, label <span class="op">=</span> <span class="st">'Parabole β = $+\infty$'</span>)</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co">#A:</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, Ky, color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx <span class="op">-</span> <span class="fl">0.1</span>, Ky <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$A$'</span>)</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="co">#C:</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, gy <span class="op">*</span> Kx<span class="op">/</span>gx, color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx, gy <span class="op">*</span> Kx<span class="op">/</span>gx <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'C'</span>)</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a><span class="co">#B:</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>ax2.plot(((gx<span class="op">/</span>gy) <span class="op">*</span> rx <span class="op">+</span> ry)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky),((gy<span class="op">/</span>gx) <span class="op">*</span> ry <span class="op">+</span> rx)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">\</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>                                        , color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>ax2.text(((gx<span class="op">/</span>gy) <span class="op">*</span> rx <span class="op">+</span> ry)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">-</span> <span class="fl">0.1</span>, ((gy<span class="op">/</span>gx) <span class="op">*</span> ry <span class="op">+</span> rx)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">+</span> <span class="fl">0.1</span> <span class="op">\</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>                                        , <span class="st">'$B$'</span>)</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a><span class="co">#D:</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>ax2.plot(ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>ax2.text(ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx) <span class="op">-</span> <span class="fl">0.1</span>, rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx) <span class="op">+</span> <span class="fl">0.1</span>, <span class="st">'$D$'</span>)</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a><span class="co">## On place des textes indiquant les trois droites:</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">0.1</span>, yeq, <span class="st">"$P_</span><span class="sc">{10}</span><span class="st">$"</span>)</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx <span class="op">+</span> <span class="fl">0.05</span>, <span class="dv">4</span>, <span class="st">"$P_</span><span class="sc">{20}</span><span class="st">$"</span>)</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="dv">3</span>, <span class="fl">5.5</span>, <span class="st">"$P_\infty$"</span>)</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a><span class="co">#Légende:</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modeleavecmigrationass_files/figure-html/cell-8-output-1.png" width="658" height="482"></p>
</div>
</div>
<section id="a-première-condition-de-déflation" class="level4">
<h4 class="anchored" data-anchor-id="a-première-condition-de-déflation">a) Première condition de déflation</h4>
<p>La première condition d’inflation est exactement la même que dans le modèle précédent et la preuve est en tout point égale (elle repose sur une analyse de l’équation de l’ellipse qui est la même dans les deux modèles). On ne détaillera pas ici cette preuve mais on sait donc que :</p>
<p><strong>Si <span class="math inline">r_x = r_y</span> alors le système est tout le temps déflationiste.</strong></p>
</section>
<section id="b-deuxième-condition-de-déflation" class="level4">
<h4 class="anchored" data-anchor-id="b-deuxième-condition-de-déflation">b) Deuxième condition de déflation</h4>
<p>Nous allons faire une preuve graphique de cette condition similaire à l’ancien modèle.</p>
<p>L’équilibre vit sur l’ellipse et parcourt l’arc orange entre <span class="math inline">A</span> et <span class="math inline">B</span> au fur et à mesure que <span class="math inline">\beta</span> augmente.<br>
Ainsi pour avoir déflation on va vouloir avoir cet arc entièrement sous la droite <span class="math inline">d</span> en gris.<br>
Il est alors facile de voir que pour cela on veut que la coordonnée en <span class="math inline">y</span> de <span class="math inline">C</span> soit plus grande que celle de <span class="math inline">A</span> (<span class="math inline">C</span> est plus haut sur la droite cyan que <span class="math inline">A</span>), entraînant que la coordonnée en <span class="math inline">x</span> de <span class="math inline">B</span> est plus petite que celle de <span class="math inline">A</span> (<span class="math inline">B</span> se trouve plus à gauche sur l’ellipse que <span class="math inline">A</span>).</p>
<p>Pour cela on a besoin de connaître les coordonnées de <span class="math inline">A</span> et <span class="math inline">C</span>.</p>
<p>Le point <span class="math inline">A</span> est défini comme la valeur de l’équilibre sans migration. Il est alors facile de constater que dans ce cas nous sommes face à un système avec une croissance logistique seulement et donc l’équilibre est atteint pour les capacités de charge.<br>
On a donc <span class="math inline">A = (K_x,K_y)</span>.</p>
<p>Pour <span class="math inline">C</span> on sait que c’est l’intersection entre <span class="math inline">P_{20}</span> et <span class="math inline">P_{\infty}</span>, ainsi comme <span class="math inline">P_{20}</span> est défini par <span class="math inline">x^* = K_x</span> et <span class="math inline">P_{\infty}</span> par <span class="math inline">y^* =\frac{\gamma_y}{\gamma_x}x^*</span> on a :</p>
<p><span class="math inline">C = (K_x,\frac{\gamma_yK_x}{\gamma_x})</span>.</p>
<p>La condition mathématique qui en découle est donc que le système est déflationiste si <span class="math inline">\frac{\gamma_yK_x}{\gamma_x} &gt; K_y</span>.</p>
<p><strong>Si <span class="math inline">\frac{\gamma_y}{\gamma_x} &gt; \frac{K_y}{K_x}</span> alors le système (<a href="#eq-modamig">1</a>) est toujours déflationiste.</strong></p>
</section>
<section id="c-conditions-dinflation-etou-de-déflation" class="level4">
<h4 class="anchored" data-anchor-id="c-conditions-dinflation-etou-de-déflation">c) Conditions d’inflation et/ou de déflation</h4>
<p>Similairement à la première partie on va avoir des conditions sur l’inflation.<br>
En effet, on voit bien sur le plan de phase que si <span class="math inline">B</span> est entre <span class="math inline">A</span> et <span class="math inline">D</span> alors l’arc d’ellipse que parcourt les équilibres en fonction de <span class="math inline">\beta</span> est constamment inflationiste.</p>
<p>Ainsi on veut que <span class="math inline">B</span> soit à droite de <span class="math inline">A</span> ce qui revient à prendre la condition inverse de celle énoncée plus haut (c’est à dire la coordonées <span class="math inline">y</span> de <span class="math inline">C</span> plus petite que celle de <span class="math inline">A</span>), c’est à dire <span class="math inline">\frac{\gamma_y}{\gamma_x} &lt; \frac{K_y}{K_x}</span>.</p>
<p>Ensuite pour avoir <span class="math inline">B</span> entre <span class="math inline">A</span> et <span class="math inline">D</span> on va vouloir que la pente de <span class="math inline">P_{\infty}</span> soit plus haute que celle de la droite passant par <span class="math inline">(0,0)</span> et <span class="math inline">D</span> qu’on appellera <span class="math inline">\aleph</span>.<br>
Pour voir ceci on va ajouter la droite <span class="math inline">\aleph</span> au plan de phase précédent :</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Ajout de la droite :</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (rx <span class="op">*</span> Ky)<span class="op">/</span>(ry <span class="op">*</span> Kx) <span class="op">*</span> xt, color <span class="op">=</span> <span class="st">'C5'</span>, label <span class="op">=</span> <span class="st">"Droite א"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>display(fig2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modeleavecmigrationass_files/figure-html/cell-9-output-1.png" width="658" height="482"></p>
</div>
</div>
<p>Nous avons calculé dans la partie précédente que <span class="math inline">D = (\frac{r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x} , \frac{r_xK_y(K_x+K_y)}{r_xK_y+r_yK_x} )</span> ce qui ne change pas dans cette partie car on considère des quantités indépendantes des taux de migration.</p>
<p>La pente de la droite passant par <span class="math inline">D</span> et <span class="math inline">(0,0)</span> est donc égale à <span class="math inline">\frac{r_xK_y}{r_yK_x}</span> ce qui donne la condition suivante <span class="math inline">\frac{\gamma_y}{\gamma_x} &gt; \frac{r_xK_y}{r_yK_x}</span>.</p>
<p><strong>Si <span class="math inline">\frac{r_xK_y}{r_yK_x} &lt; \frac{\gamma_y}{\gamma_x} &lt; \frac{K_y}{K_x}</span> on a un système inflationiste.</strong></p>
<p>Il est alors aisé de voir que si la pente de <span class="math inline">P_{\infty}</span> est plus petite que celle de <span class="math inline">\aleph</span> on a les équilibres qui parcourent d’abord des valeurs au dessus de <span class="math inline">d</span> puis en dessous (pour aller de <span class="math inline">A</span> à <span class="math inline">C</span>).</p>
<p>La condition mathématique est donc la suivante :</p>
<p><strong>Si <span class="math inline">\frac{\gamma_y}{\gamma_x} &lt; \frac{r_xK_y}{r_yK_x}</span> alors le système est d’abord inflationiste puis déflationiste.</strong></p>
</section>
</section>
<section id="animation" class="level3">
<h3 class="anchored" data-anchor-id="animation">Animation</h3>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> IPython.display <span class="im">as</span> display</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fig01 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;iframe width = "700" height = "550" src = "https://www.geogebra.org/classic/bhhpgtqv" style = " style="border: 1px solid black"&gt;&lt;/iframe&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>display.HTML(fig01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-anim" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<iframe width="700" height="550" src="https://www.geogebra.org/classic/bhhpgtqv" style=" style=" border:="" 1px="" solid="" black"=""></iframe>
<figcaption class="figure-caption">Figure&nbsp;1: Animation Geogebra permettant de voir quels paramètres influencent le système.</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="somme-des-équilibres-en-fonction-de-la-migration" class="level2">
<h2 class="anchored" data-anchor-id="somme-des-équilibres-en-fonction-de-la-migration">Somme des équilibres en fonction de la migration</h2>
<section id="illustration-des-propositions-précédentes" class="level3">
<h3 class="anchored" data-anchor-id="illustration-des-propositions-précédentes">Illustration des propositions précédentes</h3>
<p>On va illustrer les propositions précédentes en traçant la somme des équilibres en fonction de <span class="math inline">\beta</span>. Pour cela on va simuler avec <code>odeint</code> (pendant un temps assez large pour atteindre l’équilibre) pour chaque valeur de <span class="math inline">\beta</span>.</p>
<p>On définit une fonction qui dépend de <span class="math inline">\beta</span> :</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug2(etat, t, param, h):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, gy <span class="op">=</span> param</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> h</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>et on pose le temps d’intégration, les paramètres et les conditions initiales :</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, gy1])</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, gx2, gy2])</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#3:</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3, gx3, gy3])</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co">#4:</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>rx4 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>ry4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>Kx4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>Ky4 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>gx4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>gy4 <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>param4 <span class="op">=</span> np.array([rx4, ry4, Kx4, Ky4, gx4, gy4])</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration suffisament large pour atteindre l'équilibre:</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Condition initiale:</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Et enfin on trace les quatre figures :</p>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1, ax2, ax3) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param1, i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param3, i))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>):</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param2, i))</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    s3 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param4, i))</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    ax3.plot(i, s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky:    </span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>xt2 <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.001</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt2, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt2), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.10</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.12</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt2, (Kx4 <span class="op">+</span> Ky4) <span class="op">*</span> np.ones_like(xt2), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>ax3.text(<span class="fl">3.12</span>, Kx4 <span class="op">+</span> Ky4 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor <span class="op">=</span> (<span class="fl">1.75</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)<span class="op">;</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Les deux'</span>)<span class="op">;</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Inflation'</span>)<span class="op">;</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Inflation'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modeleavecmigrationass_files/figure-html/cell-13-output-1.png" width="741" height="411"></p>
</div>
</div>
<p>On obtient 4 profils de courbe. Le premier profil montre une déflation du système et a été obtenu pour la condition décrite plus haut de <span class="math inline">\frac{\gamma_y}{\gamma_x} &gt; \frac{K_y}{K_x}</span>.</p>
<p>Le deuxième profil correspond à une inflation du système puis une déflation quand <span class="math inline">\beta</span> augmente, cette courbe a bien été obtenue en respectant la condition de <span class="math inline">\frac{\gamma_y}{\gamma_x} &lt; \frac{r_xK_y}{r_yK_x}</span>.</p>
<p>Les deux derniers profils, correspondant à une inflation permanente du système, sont obtenus en respectant les conditions décrites plus haut. On obtient deux profils différents, un avec une inflation croissante quand <span class="math inline">\beta</span> augmente et l’autre avec une inflation croissante puis décroissante (et qui atteint un plateau).<br>
Ce phénomène se voit graphiquement sur l’animation ou le plan de phase. En effet, on a dans le premier cas <span class="math inline">P_{\infty}</span> qui coupe l’ellipse dans sa phase montante (l’écart entre l’ellipse et la droite <span class="math inline">d</span> augmente) alors que dans le second cas <span class="math inline">P_{\infty}</span> coupe l’ellipse alors que l’écart entre celle-ci et <span class="math inline">d</span> diminue.</p>
</section>
<section id="cas-de-laugmentorium" class="level3">
<h3 class="anchored" data-anchor-id="cas-de-laugmentorium">Cas de l’augmentorium</h3>
<p>Dans le cas de l’augmentorium il est important de considérer l’équilibre <span class="math inline">x^*</span> seule par rapport à <span class="math inline">K_x</span> (sa valeur s’il n’y a pas de migration).<br>
En effet même si on a inflation dans le système, si <span class="math inline">x^*&lt;K_x</span> alors on considère l’augmentorium comme efficace.</p>
<p>Avec les hyptohèses énoncées plus haut sur la situation de l’augmentorium il n’est pas possible d’obtenir un système inflationiste (indépendamment de si <span class="math inline">K_x&gt;K_y</span> ou l’inverse). Il est facile de voir ceci grâce à notre animation.</p>
<p>Néanmoins avec des hypothèses plus souples (mais en gardant que <span class="math inline">r_x&lt;r_y</span>), par exemple que les taux de fuites sont plus forts que les taux de migration vers l’augmentorium (dus à une fuite du dispositif par exemple) on va voir que l’augmentorium n’est pas forcément bénéfique.<br>
En effet, on peut, sur le plan de phase tracé plus haut voir que dès que nous sommes dans un cas où on a de l’inflation (et même si on revient sur de la déflaton après) alors on a <span class="math inline">x^* &gt; K_x</span> ce qui est mauvais pour la culture.</p>
<p>On va tracer l’équilibre <span class="math inline">x^*</span> en fonction de <span class="math inline">\beta</span> en considérant un cas où le système était déflationiste et un cas où le système était inflationiste (pour la somme des équilibres) :</p>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, gy1])</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, gx2, gy2])</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3, gx3, gy3])</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span> <span class="fl">0.4</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Equilibre de la culture ($x^*$) avec déflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Equilibre de la culture ($x^*$) avec déflation et inflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Equilibre de la culture ($x^*$)  avec inflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle en fonction de beta</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param2, i))</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param3, i))</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite Kx:</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.5</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, Kx2 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx2 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, Kx3 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.5</span>, Kx3 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.5</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a><span class="co"># On limite le cadre :</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(bottom<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(bottom<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor <span class="op">=</span> (<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>&lt;matplotlib.legend.Legend at 0x7f3d60fbb040&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="modeleavecmigrationass_files/figure-html/cell-14-output-2.png" width="805" height="434"></p>
</div>
</div>
<p>En bleu on observe le comportement de l’équilibre dans la culture seulement et en gris on retrouve les courbes tracées juste au dessus. On voit bien que dès que le système subit une inflation des équilibres totaux la situation devient mauvaise pour la culture.<br>
En revanche quand on a déflation des équilibres totaux alors la situtaion est bénéfique à la culture.</p>
<p>Il faut garder en tête que ceci n’est vrai que pour <span class="math inline">r_x&lt;r_y</span>.</p>
<p>Ensuite, le taux de fuite est un paramètre clé de notre méthode. On va donc tracer la somme des équilibres et l’équilibre <span class="math inline">x^*</span> en fonction de <span class="math inline">\gamma_y</span>.</p>
<p>Attention ! Un fort taux de fuite correspond à un <span class="math inline">\gamma_y</span> faible.</p>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition d'un nouveau modèle qui prend en compte le changement de gy:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug3(etat, t, param, h):</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, b <span class="op">=</span> param</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    gy <span class="op">=</span> h</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, b])</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration assez large pour atteindre l'éq :</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Conditions initiales:</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite de la somme des capacités:</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle qui calcule l'équilibre et qui plot un point en fonction des valeurs du taux de fuite:</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug3, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>)</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture'</span>)</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Somme des équilibres en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Equilibre de la culture en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)   </span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>ax.legend()<span class="op">;</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>ax1.legend()<span class="op">;</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Densité de pop."</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modeleavecmigrationass_files/figure-html/cell-15-output-1.png" width="739" height="372"></p>
</div>
</div>
<p>Dans la figure gauche on a représenté la somme des équilibres (<span class="math inline">x^*+y^*</span>) de la même manière que précédemment mais cette fois en faisant varier le taux de fuite.<br>
On observe alors un nouveau profil qui correspond à une déflation, puis une inflation puis enfin une déflation au fur et à mesure que <span class="math inline">\gamma_y</span> augmente.</p>
<p>Dans la figure droite on a cette fois uniquement l’équilibre dans la culture (<span class="math inline">x^*</span>). On observe que pour des <span class="math inline">\gamma_y</span> petits on a inflation puis on retourne à une déflation.</p>
<p>Pour interpréter ceci il faut comprendre que les des petites valeurs de <span class="math inline">\gamma_y</span> correspondent à de grandes valeurs de taux de fuite.<br>
Ainsi quand <span class="math inline">\gamma_y \to 0</span> l’augmentorium se vide en ravageurs et on a ainsi toute la population dans la culture et l’équilibre dans culture tend vers sa capacité de charge car on est seulement face à une croissance logistique.<br>
C’est pourquoi, lorsque les taux de fuite sont grands on observe une inflation de la culture car on a, des populations de ravageurs qui viennent de l’augmentorium qui s’ajoutent aux ravageurs déjà présents dans la culture.<br>
La somme des équilibres est donc trompeuse dans ce cas là, en effet le système subit une déflation car l’augmentorium n’est presque plus occupé pour de forts taux de fuite mais il ne faut pas croire que c’en est bénéfique pour la culture.</p>
<p>Ce modèle considère uniquement la population de ravageurs. Or, la méthode de l’augmentorium repose énormément sur l’action des prédateurs on va donc considérer <a href="./modelaug.html">maintenant</a> un modèle qui prend en compte ces prédateurs.</p>


<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-arditi2018" class="csl-entry" role="listitem">
Arditi, Lobry, R. 2018. <span>“Asymmetric Dispersal in the Multi-Patch Logistic Equation.”</span> <em>Theor. Popul. Biol.</em> 120: 11–15.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb16" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Modèle logistique structuré avec migration assymétrique</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>*Modules à importer :*</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## Définition du modèle</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>Le but d'un augmentorium est de confiner les ravageurs dans un espace clos qui ne laisse pas (ou peu) s'échapper ceux-ci.  </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>Ainsi, il s'établit une migration assymétrique entre les deux structures qu'on peut modéliser en établissant le modèle suivant d'après @arditi2018 : </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>\dot x = r_xx(1-\frac{x}{K_x})+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)<span class="sc">\\</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>\dot y = r_yy(1-\frac{y}{K_y})+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>$$ {#eq-modamig}</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>avec :  </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$x$ la population de ravageurs dans la culture,  </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$y$ la population de ravageurs dans l'augmentorium,  </span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$r_x$ et $r_y$ le taux de croissance dans la culture et dans l'augmentorium,  </span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$K_x$ et $K_y$ les capacités de charges de la culture de de l'augmentorium,  </span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta$ la force de migration entre les structures,  </span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\gamma_x$ et $\gamma_y$ caractérisant l'assymétrie de migration.</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nouvelles hypothèses propres à l'augmentorium</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>Ce modèle est plus proche de celui d'un augmentorium.  </span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>Comme les ravageurs se reproduisent mieux dans l'augmentorium que dans la culture on peut dire que $r_x&lt;r_y$.  </span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>On peut aussi dire que le taux de fuite des ravageurs ($\frac{1}{\gamma_y}$) se doit d'être beaucoup plus petit que le taux de migration ($\frac{1}{\gamma_x}$).  </span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>On a donc $\gamma_x &lt;&lt; \gamma_y$.</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dynamique du modèle</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>Encore une fois on simule la dynamique des deux populations en fonction du temps en codant comme dans la première partie</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>On définit le système sous <span class="co">[</span><span class="ot">Python</span><span class="co">](https://www.python.org/)</span>:</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug(etat, t, param):</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, b, gx, gy <span class="op">=</span> param</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span>[rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx),</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>Et on définit les paramètres, le temps d'intégration etc. :</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Temps d'intégration:</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>ti <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Etats initiaux:</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [x0, y0]</span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres: </span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>rx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>ry <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>gx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>gy <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a>param_aug <span class="op">=</span> np.array([rx, ry, Kx, Ky, b, gx, gy])</span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation:</span></span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> odeint(aug, e0, ti, args <span class="op">=</span> (param_aug, ))</span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a>On trace la figure :</span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Dynamique des ravageurs dans le temps avec augmentorium'</span>)</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[ :, <span class="dv">0</span>], color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'culture'</span>)</span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[ :, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'augmentorium'</span>)</span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout d'élements:</span></span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Temps, t'</span>)<span class="op">;</span></span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Densité de pop.'</span>)<span class="op">;</span></span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true" tabindex="-1"></a>Cette dynamique, comme en première partie, présente un équilibre de maintien de la population.  </span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true" tabindex="-1"></a>Néanmoins on observe que, pour les mêmes paramètres que dans la première partie, la population dans la culture est bien plus faible.    </span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true" tabindex="-1"></a>La migration assymétrique vers l'augmentorium semble être bénéfique à la culture.</span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plan de phase </span></span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true" tabindex="-1"></a><span class="fu">### Equilibres et leur stabilité </span></span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true" tabindex="-1"></a>A l'équilibre on a le système suivant :</span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb16-118"><a href="#cb16-118" aria-hidden="true" tabindex="-1"></a>\dot x = 0 \Leftrightarrow 0 = r_xx(1-\frac{x}{K_x})+\beta\left(\frac{y}{\gamma_y}-\frac{x}{\gamma_x}\right)<span class="sc">\\</span></span>
<span id="cb16-119"><a href="#cb16-119" aria-hidden="true" tabindex="-1"></a>\dot y = 0 \Leftrightarrow 0 = r_yy(1-\frac{y}{K_y})+\beta\left(\frac{x}{\gamma_x}-\frac{y}{\gamma_y}\right)</span>
<span id="cb16-120"><a href="#cb16-120" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb16-121"><a href="#cb16-121" aria-hidden="true" tabindex="-1"></a>$${#eq-pdpamig0}</span>
<span id="cb16-122"><a href="#cb16-122" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-123"><a href="#cb16-123" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb16-124"><a href="#cb16-124" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-125"><a href="#cb16-125" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb16-126"><a href="#cb16-126" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb16-127"><a href="#cb16-127" aria-hidden="true" tabindex="-1"></a>y^*=\gamma_y\left(\frac{x}{\gamma_x}-\frac{r_xx}{\beta}\left(1-\frac{x}{K_x}\right)\right)<span class="sc">\\</span></span>
<span id="cb16-128"><a href="#cb16-128" aria-hidden="true" tabindex="-1"></a>x^*=\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)</span>
<span id="cb16-129"><a href="#cb16-129" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb16-130"><a href="#cb16-130" aria-hidden="true" tabindex="-1"></a>$${#eq-pdpamig}</span>
<span id="cb16-131"><a href="#cb16-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-132"><a href="#cb16-132" aria-hidden="true" tabindex="-1"></a>On voit tout de suite qu'on a deux paraboles qui se croisent en $(0,0)$ et en $(x^*,y^*)$.  </span>
<span id="cb16-133"><a href="#cb16-133" aria-hidden="true" tabindex="-1"></a>On va donc avoir deux équilibres, ceux-ci vivent sur une ellipse de même équation qu'en première partie.   </span>
<span id="cb16-134"><a href="#cb16-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-135"><a href="#cb16-135" aria-hidden="true" tabindex="-1"></a>En fonction des racines des paraboles on va avoir des plans de phases différents qu'on va tracer via les mêmes techniques qu'en première partie :</span>
<span id="cb16-136"><a href="#cb16-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-139"><a href="#cb16-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-140"><a href="#cb16-140" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb16-141"><a href="#cb16-141" aria-hidden="true" tabindex="-1"></a><span class="co">#On crée la figure avec les 3 sous figures:</span></span>
<span id="cb16-142"><a href="#cb16-142" aria-hidden="true" tabindex="-1"></a>fig2, (ax2, ax3, ax4) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb16-143"><a href="#cb16-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-144"><a href="#cb16-144" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">'Plan de phase de la population'</span>)</span>
<span id="cb16-145"><a href="#cb16-145" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'β=1'</span>)</span>
<span id="cb16-146"><a href="#cb16-146" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'β=10'</span>)</span>
<span id="cb16-147"><a href="#cb16-147" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'β=0.1'</span>)</span>
<span id="cb16-148"><a href="#cb16-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-149"><a href="#cb16-149" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 1:#</span></span>
<span id="cb16-150"><a href="#cb16-150" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres: </span></span>
<span id="cb16-151"><a href="#cb16-151" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-152"><a href="#cb16-152" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-153"><a href="#cb16-153" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-154"><a href="#cb16-154" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-155"><a href="#cb16-155" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-156"><a href="#cb16-156" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-157"><a href="#cb16-157" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb16-158"><a href="#cb16-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-159"><a href="#cb16-159" aria-hidden="true" tabindex="-1"></a>param_aug1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, b1, gx1, gy1])</span>
<span id="cb16-160"><a href="#cb16-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-161"><a href="#cb16-161" aria-hidden="true" tabindex="-1"></a><span class="co"># Isocline nulles:</span></span>
<span id="cb16-162"><a href="#cb16-162" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-163"><a href="#cb16-163" aria-hidden="true" tabindex="-1"></a>yt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-164"><a href="#cb16-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-165"><a href="#cb16-165" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb16-166"><a href="#cb16-166" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, gy1 <span class="op">*</span> (xt<span class="op">/</span>gx1 <span class="op">-</span> rx1 <span class="op">*</span> xt<span class="op">/</span>b1 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx1)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb16-167"><a href="#cb16-167" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb16-168"><a href="#cb16-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-169"><a href="#cb16-169" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb16-170"><a href="#cb16-170" aria-hidden="true" tabindex="-1"></a>ax2.plot(gx1 <span class="op">*</span> (yt<span class="op">/</span>gy1 <span class="op">-</span> ry1 <span class="op">*</span> yt<span class="op">/</span>b1 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky1)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb16-171"><a href="#cb16-171" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb16-172"><a href="#cb16-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-173"><a href="#cb16-173" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration de la figure:</span></span>
<span id="cb16-174"><a href="#cb16-174" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.03</span>, right <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb16-175"><a href="#cb16-175" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(top <span class="op">=</span> <span class="fl">1.5</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb16-176"><a href="#cb16-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-177"><a href="#cb16-177" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb16-178"><a href="#cb16-178" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Ravageur dans l</span><span class="ch">\'</span><span class="st">augmentorium'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb16-179"><a href="#cb16-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-180"><a href="#cb16-180" aria-hidden="true" tabindex="-1"></a><span class="co">#Ajout du champ de vecteur</span></span>
<span id="cb16-181"><a href="#cb16-181" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb16-182"><a href="#cb16-182" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb16-183"><a href="#cb16-183" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb16-184"><a href="#cb16-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-185"><a href="#cb16-185" aria-hidden="true" tabindex="-1"></a><span class="co">#On utilise quiver:</span></span>
<span id="cb16-186"><a href="#cb16-186" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug1)</span>
<span id="cb16-187"><a href="#cb16-187" aria-hidden="true" tabindex="-1"></a>ax2.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">15</span>, width <span class="op">=</span> <span class="fl">0.0035</span>)<span class="op">;</span></span>
<span id="cb16-188"><a href="#cb16-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-189"><a href="#cb16-189" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 2:#</span></span>
<span id="cb16-190"><a href="#cb16-190" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres: </span></span>
<span id="cb16-191"><a href="#cb16-191" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-192"><a href="#cb16-192" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-193"><a href="#cb16-193" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-194"><a href="#cb16-194" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-195"><a href="#cb16-195" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb16-196"><a href="#cb16-196" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-197"><a href="#cb16-197" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb16-198"><a href="#cb16-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-199"><a href="#cb16-199" aria-hidden="true" tabindex="-1"></a>param_aug2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, b2, gx2, gy2])  </span>
<span id="cb16-200"><a href="#cb16-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-201"><a href="#cb16-201" aria-hidden="true" tabindex="-1"></a><span class="co">#Isocline nulles:</span></span>
<span id="cb16-202"><a href="#cb16-202" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0</span></span>
<span id="cb16-203"><a href="#cb16-203" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt, gy2 <span class="op">*</span> (xt<span class="op">/</span>gx2 <span class="op">-</span> rx2 <span class="op">*</span> xt<span class="op">/</span>b2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx2)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb16-204"><a href="#cb16-204" aria-hidden="true" tabindex="-1"></a>ax3.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb16-205"><a href="#cb16-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-206"><a href="#cb16-206" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb16-207"><a href="#cb16-207" aria-hidden="true" tabindex="-1"></a>ax3.plot(gx2 <span class="op">*</span> (yt<span class="op">/</span>gy2 <span class="op">-</span> ry2 <span class="op">*</span> yt<span class="op">/</span>b2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky2)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb16-208"><a href="#cb16-208" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb16-209"><a href="#cb16-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-210"><a href="#cb16-210" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration de la figure:</span></span>
<span id="cb16-211"><a href="#cb16-211" aria-hidden="true" tabindex="-1"></a>ax3.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.02</span>, right <span class="op">=</span> <span class="fl">0.35</span>)</span>
<span id="cb16-212"><a href="#cb16-212" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(top <span class="op">=</span> <span class="fl">1.4</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb16-213"><a href="#cb16-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-214"><a href="#cb16-214" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb16-215"><a href="#cb16-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-216"><a href="#cb16-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-217"><a href="#cb16-217" aria-hidden="true" tabindex="-1"></a><span class="co">#Ajout du champ de vecteur</span></span>
<span id="cb16-218"><a href="#cb16-218" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb16-219"><a href="#cb16-219" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.08</span>)</span>
<span id="cb16-220"><a href="#cb16-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-221"><a href="#cb16-221" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb16-222"><a href="#cb16-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-223"><a href="#cb16-223" aria-hidden="true" tabindex="-1"></a><span class="co">#On utilise quiver:</span></span>
<span id="cb16-224"><a href="#cb16-224" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug2)</span>
<span id="cb16-225"><a href="#cb16-225" aria-hidden="true" tabindex="-1"></a>ax3.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">40</span>, width <span class="op">=</span> <span class="fl">0.003</span>)<span class="op">;</span></span>
<span id="cb16-226"><a href="#cb16-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-227"><a href="#cb16-227" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase 3:</span></span>
<span id="cb16-228"><a href="#cb16-228" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres: </span></span>
<span id="cb16-229"><a href="#cb16-229" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-230"><a href="#cb16-230" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-231"><a href="#cb16-231" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-232"><a href="#cb16-232" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-233"><a href="#cb16-233" aria-hidden="true" tabindex="-1"></a>b3 <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb16-234"><a href="#cb16-234" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-235"><a href="#cb16-235" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb16-236"><a href="#cb16-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-237"><a href="#cb16-237" aria-hidden="true" tabindex="-1"></a>param_aug3<span class="op">=</span>np.array([rx3, ry3, Kx3, Ky3, b3, gx3, gy3])</span>
<span id="cb16-238"><a href="#cb16-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-239"><a href="#cb16-239" aria-hidden="true" tabindex="-1"></a><span class="co">#Isocline nulles:</span></span>
<span id="cb16-240"><a href="#cb16-240" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb16-241"><a href="#cb16-241" aria-hidden="true" tabindex="-1"></a>ax4.plot(xt, gy3 <span class="op">*</span> (xt<span class="op">/</span>gx3 <span class="op">-</span> rx3 <span class="op">*</span> xt<span class="op">/</span>b3 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx3)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb16-242"><a href="#cb16-242" aria-hidden="true" tabindex="-1"></a>ax4.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb16-243"><a href="#cb16-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-244"><a href="#cb16-244" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0 </span></span>
<span id="cb16-245"><a href="#cb16-245" aria-hidden="true" tabindex="-1"></a>ax4.plot(gx3 <span class="op">*</span> (yt<span class="op">/</span>gy3 <span class="op">-</span> ry3 <span class="op">*</span> yt<span class="op">/</span>b3 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky3)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb16-246"><a href="#cb16-246" aria-hidden="true" tabindex="-1"></a>ax4.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb16-247"><a href="#cb16-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-248"><a href="#cb16-248" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustration:</span></span>
<span id="cb16-249"><a href="#cb16-249" aria-hidden="true" tabindex="-1"></a>ax4.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.08</span>, right <span class="op">=</span> <span class="fl">1.9</span>)</span>
<span id="cb16-250"><a href="#cb16-250" aria-hidden="true" tabindex="-1"></a>ax4.set_ylim(top<span class="op">=</span><span class="fl">1.5</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>)</span>
<span id="cb16-251"><a href="#cb16-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-252"><a href="#cb16-252" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Ravageur dans la culture'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)<span class="op">;</span></span>
<span id="cb16-253"><a href="#cb16-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-254"><a href="#cb16-254" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout du champ de vecteur</span></span>
<span id="cb16-255"><a href="#cb16-255" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.18</span>)</span>
<span id="cb16-256"><a href="#cb16-256" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="fl">0.18</span>)</span>
<span id="cb16-257"><a href="#cb16-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-258"><a href="#cb16-258" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb16-259"><a href="#cb16-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-260"><a href="#cb16-260" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug3)</span>
<span id="cb16-261"><a href="#cb16-261" aria-hidden="true" tabindex="-1"></a>ax4.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">10</span>, width <span class="op">=</span> <span class="fl">0.0035</span>)<span class="op">;</span></span>
<span id="cb16-262"><a href="#cb16-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-263"><a href="#cb16-263" aria-hidden="true" tabindex="-1"></a><span class="co">#On légende:</span></span>
<span id="cb16-264"><a href="#cb16-264" aria-hidden="true" tabindex="-1"></a>ax4.legend()<span class="op">;</span></span>
<span id="cb16-265"><a href="#cb16-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-266"><a href="#cb16-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-267"><a href="#cb16-267" aria-hidden="true" tabindex="-1"></a>En fonction des valeurs de $\beta$ on observe des profils différents de plan de phase. Pour mieux le visualiser on pourra utiliser l'animation <span class="co">[</span><span class="ot">Geogebra</span><span class="co">](@fig-anim)</span> mise à disposition à la fin de l'analyse.</span>
<span id="cb16-268"><a href="#cb16-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-269"><a href="#cb16-269" aria-hidden="true" tabindex="-1"></a>D'après le champ de vecteurs on voit clairement que l'équilibre en $(0,0)$ est instable et l'équilibre $(x^*,y^*)$ est stable.  </span>
<span id="cb16-270"><a href="#cb16-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-271"><a href="#cb16-271" aria-hidden="true" tabindex="-1"></a>Pour calculer l'équilibre on procède de la même manière que dans la première partie, c'est à dire en croisant les deux paraboles $\dot =0 $ et $\dot y =0$ :</span>
<span id="cb16-272"><a href="#cb16-272" aria-hidden="true" tabindex="-1"></a>On a $x^*=\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)$.  </span>
<span id="cb16-273"><a href="#cb16-273" aria-hidden="true" tabindex="-1"></a>Donc :</span>
<span id="cb16-274"><a href="#cb16-274" aria-hidden="true" tabindex="-1"></a>$$\small</span>
<span id="cb16-275"><a href="#cb16-275" aria-hidden="true" tabindex="-1"></a>y^*=\gamma_y\left(\frac{\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{\gamma_x}-\frac{r_x\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{\beta}\left<span class="co">[</span><span class="ot">1-\frac{\gamma_x\left(\frac{y}{\gamma_y}-\frac{r_yy}{\beta}\left(1-\frac{y}{K_y}\right)\right)}{K_x}\right</span><span class="co">]</span>\right)</span>
<span id="cb16-276"><a href="#cb16-276" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-277"><a href="#cb16-277" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-278"><a href="#cb16-278" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb16-279"><a href="#cb16-279" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-280"><a href="#cb16-280" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-281"><a href="#cb16-281" aria-hidden="true" tabindex="-1"></a>-\frac{r_y\gamma_yy^*}{\beta} + \frac{r_y \gamma_y {y^*}^2}{\beta K_y} - \frac{r_x\gamma_xy^*}{\beta} + \frac{r_xr_y\gamma_x \gamma_y y^*}{\beta^2} <span class="sc">\\</span></span>
<span id="cb16-282"><a href="#cb16-282" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>\frac{r_xr_y\gamma_x\gamma_y{y^*}^2}{\beta^2K_y} + \frac{r_x\gamma_x^2{y^*}^2}{\beta K_x\gamma_y} - \frac{r_xr_y\gamma_x^2{y^*}^2}{\beta^2K_x} <span class="sc">\\</span></span>
<span id="cb16-283"><a href="#cb16-283" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>2\frac{r_xr_y\gamma_x^2{y^*}^3}{\beta^2K_xK_y} + \frac{r_xr_y^2\gamma_x^2 \gamma_y {y^*}^2}{\beta^3K_x} - 2\frac{r_xr_y^2\gamma_x^2\gamma_y{y^*}^3}{\beta^3K_xK_y} <span class="sc">\\</span></span>
<span id="cb16-284"><a href="#cb16-284" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>\frac{r_xr_y^2\gamma_x^2\gamma_y{y^*}^4}{\beta^3K_xK_y^2}</span>
<span id="cb16-285"><a href="#cb16-285" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-286"><a href="#cb16-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-287"><a href="#cb16-287" aria-hidden="true" tabindex="-1"></a>Ce qui donne, en mettant les monomes $y^*$ en facteur et en simplifiant ensuite par $\frac{y^*}{\beta}$ :  </span>
<span id="cb16-288"><a href="#cb16-288" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-289"><a href="#cb16-289" aria-hidden="true" tabindex="-1"></a>\frac{r_xr_y\gamma_x\gamma_y}{\beta}-\gamma_yr_y-\gamma_xr_x +<span class="sc">\\</span> y\left<span class="co">[</span><span class="ot">\frac{r_y\gamma_y}{K_y}-\frac{r_xr_y\gamma_x\gamma_y}{\beta K_y}+ \frac{r_xr_y^2\gamma_x^2\gamma_y}{\beta^2K_x}+\frac{r_x\gamma_x^2}{\gamma_yK_x}-\frac{2r_xr_y\gamma_x^2}{\beta K_x}   \right</span><span class="co">]</span> +<span class="sc">\\</span><span class="co">[</span><span class="ot">.2cm</span><span class="co">]</span></span>
<span id="cb16-290"><a href="#cb16-290" aria-hidden="true" tabindex="-1"></a>\frac{2r_yr_x\gamma_x^2y^2}{\beta K_xK_y}\left(1-\frac{r_y\gamma_y}{\beta}\right) + \frac{r_xr_y^2\gamma_x^2\gamma_yy^3}{\beta^2K_xK_y^2} = 0</span>
<span id="cb16-291"><a href="#cb16-291" aria-hidden="true" tabindex="-1"></a>$${#eq-pol}</span>
<span id="cb16-292"><a href="#cb16-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-293"><a href="#cb16-293" aria-hidden="true" tabindex="-1"></a>Ce polynôme est résoluble par <span class="in">`numpy`</span> similairement à la première partie :</span>
<span id="cb16-294"><a href="#cb16-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-297"><a href="#cb16-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-298"><a href="#cb16-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb16-299"><a href="#cb16-299" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres pour calculer le polynôme</span></span>
<span id="cb16-300"><a href="#cb16-300" aria-hidden="true" tabindex="-1"></a>rx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-301"><a href="#cb16-301" aria-hidden="true" tabindex="-1"></a>ry <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-302"><a href="#cb16-302" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb16-303"><a href="#cb16-303" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-304"><a href="#cb16-304" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-305"><a href="#cb16-305" aria-hidden="true" tabindex="-1"></a>gx <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb16-306"><a href="#cb16-306" aria-hidden="true" tabindex="-1"></a>gy <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb16-307"><a href="#cb16-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-308"><a href="#cb16-308" aria-hidden="true" tabindex="-1"></a><span class="co">#Points d'équilibres, utilisation de numpy : monome, polynome et racines:</span></span>
<span id="cb16-309"><a href="#cb16-309" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul:</span></span>
<span id="cb16-310"><a href="#cb16-310" aria-hidden="true" tabindex="-1"></a><span class="co">#Monome y</span></span>
<span id="cb16-311"><a href="#cb16-311" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.polynomial.Polynomial([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb16-312"><a href="#cb16-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-313"><a href="#cb16-313" aria-hidden="true" tabindex="-1"></a><span class="co">#Polynome :</span></span>
<span id="cb16-314"><a href="#cb16-314" aria-hidden="true" tabindex="-1"></a>pol <span class="op">=</span> <span class="op">-</span>gy <span class="op">*</span> ry <span class="op">-</span> gx <span class="op">*</span> rx <span class="op">+</span> (rx <span class="op">*</span> ry <span class="op">*</span> gx <span class="op">*</span> gy)<span class="op">/</span>b <span class="op">+</span> x <span class="op">*</span> ((ry <span class="op">*</span> gy)<span class="op">/</span>(Ky) <span class="op">-</span> (ry <span class="op">*</span> rx <span class="op">*</span> gy <span class="op">*</span> gx)<span class="op">/</span>(b <span class="op">*</span> Ky) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb16-315"><a href="#cb16-315" aria-hidden="true" tabindex="-1"></a> rx <span class="op">*</span> ry<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> gy<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> Kx) <span class="op">+</span> rx <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(gy <span class="op">*</span> Kx) <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> rx <span class="op">*</span> ry <span class="op">*</span> gx<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(b <span class="op">*</span> Kx)) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb16-316"><a href="#cb16-316" aria-hidden="true" tabindex="-1"></a> (x<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> (ry <span class="op">*</span> rx <span class="op">*</span>gx<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(b <span class="op">*</span> Kx <span class="op">*</span> Ky) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> ry <span class="op">*</span> gy<span class="op">/</span>b) <span class="op">+</span> (x<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> gy <span class="op">*</span> rx <span class="op">*</span> ((ry <span class="op">*</span> gx)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> Kx <span class="op">*</span> Ky<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb16-317"><a href="#cb16-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-318"><a href="#cb16-318" aria-hidden="true" tabindex="-1"></a><span class="co">#Solution</span></span>
<span id="cb16-319"><a href="#cb16-319" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> pol.roots()[ (np.isreal( pol.roots() )) <span class="op">*</span> (pol.roots() <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb16-320"><a href="#cb16-320" aria-hidden="true" tabindex="-1"></a>yeq <span class="op">=</span> sol[<span class="dv">0</span>].real</span>
<span id="cb16-321"><a href="#cb16-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-322"><a href="#cb16-322" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcul de x avec sa définition:</span></span>
<span id="cb16-323"><a href="#cb16-323" aria-hidden="true" tabindex="-1"></a>xeq <span class="op">=</span> gx <span class="op">*</span> (yeq<span class="op">/</span>gy <span class="op">-</span> ry <span class="op">*</span> yeq<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yeq<span class="op">/</span>Ky))</span>
<span id="cb16-324"><a href="#cb16-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-325"><a href="#cb16-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-326"><a href="#cb16-326" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analyse du plan de phase</span></span>
<span id="cb16-327"><a href="#cb16-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-328"><a href="#cb16-328" aria-hidden="true" tabindex="-1"></a>On va tracer le plan de phase complet et l'analyser d'après la méthode d'@arditi2018 :  </span>
<span id="cb16-329"><a href="#cb16-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-330"><a href="#cb16-330" aria-hidden="true" tabindex="-1"></a>Dans cette analyse on va considérer, sans perte de généralité, que $r_x &lt; r_y$ (on prend l'ellipse dans un seul sens, voir l'<span class="co">[</span><span class="ot">animation</span><span class="co">](@fig-anim)</span>).</span>
<span id="cb16-331"><a href="#cb16-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-332"><a href="#cb16-332" aria-hidden="true" tabindex="-1"></a>Pour cela on trace l'ellipse de la même manière que dans la première figure, l'équation de cette ellipse n'ayant pas de terme de migration dans le premier modèle elle est la même dans celui-ci aussi.  </span>
<span id="cb16-333"><a href="#cb16-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-334"><a href="#cb16-334" aria-hidden="true" tabindex="-1"></a>Ensuite on va tracer la droite $d$ correspondant à $K_x+K_y=x^*+y^*$ car ceci va permettre de voir si le système subit une <span class="co">[</span><span class="ot">inflation</span><span class="co">](contexte.qmd)</span> ou une déflation.  </span>
<span id="cb16-335"><a href="#cb16-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-336"><a href="#cb16-336" aria-hidden="true" tabindex="-1"></a>Enfin, similairement à la partie prédédente on va tracer les droites données par $\beta = 0$ et $\beta = +\infty$ dans la parabole définie par $\dot x =0$ (parabole verte sur le plan de phase).  </span>
<span id="cb16-337"><a href="#cb16-337" aria-hidden="true" tabindex="-1"></a>Les droites sont différentes du modèle précédent donc on va les recalculer :</span>
<span id="cb16-338"><a href="#cb16-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-339"><a href="#cb16-339" aria-hidden="true" tabindex="-1"></a>Lorsque $\beta = 0$ on a exactement les mêmes deux droites que dans le modèle précédent en $x^* =0$ et en $x^*=K_x$ car le fait que le nouveau modèle ajoute de l'assymétrie dans les migrations est effacé par une migration nulle. On les appelle respectivement $P_{10}$ et $P_{20}$.</span>
<span id="cb16-340"><a href="#cb16-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-341"><a href="#cb16-341" aria-hidden="true" tabindex="-1"></a>Lorsque $\beta = +\infty$ on a d'après (<span class="co">[</span><span class="ot">-@eq-pdpamig</span><span class="co">]</span>) : </span>
<span id="cb16-342"><a href="#cb16-342" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-343"><a href="#cb16-343" aria-hidden="true" tabindex="-1"></a>y^* = \frac{\gamma_y}{\gamma_x}x^*</span>
<span id="cb16-344"><a href="#cb16-344" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-345"><a href="#cb16-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-346"><a href="#cb16-346" aria-hidden="true" tabindex="-1"></a>On appellera cette droite $P_{\infty}$.  </span>
<span id="cb16-347"><a href="#cb16-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-348"><a href="#cb16-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-349"><a href="#cb16-349" aria-hidden="true" tabindex="-1"></a>Introduisons les mêmes points que précédemment c'est à dire : </span>
<span id="cb16-350"><a href="#cb16-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-351"><a href="#cb16-351" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$A$, l'intersection entre $P_{20}$  et l'ellipse, c'est à dire la valeur de l'équilibre quand $\beta = 0$.</span>
<span id="cb16-352"><a href="#cb16-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-353"><a href="#cb16-353" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$B$, l'intersection entre $P_{\infty}$ et l'ellipse, c'est à dire la valeur de l'équilibre quand $\beta = +\infty$.</span>
<span id="cb16-354"><a href="#cb16-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-355"><a href="#cb16-355" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$C$, l'intersection entre $P_{20}$ et $P_{\infty}$.</span>
<span id="cb16-356"><a href="#cb16-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-357"><a href="#cb16-357" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$D$, l'intersection entre la droite $d$ et l'ellipse qui n'est pas le point $A$.</span>
<span id="cb16-358"><a href="#cb16-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-359"><a href="#cb16-359" aria-hidden="true" tabindex="-1"></a>Représentons le plan de phase avec ces éléments :</span>
<span id="cb16-360"><a href="#cb16-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-363"><a href="#cb16-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-364"><a href="#cb16-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb16-365"><a href="#cb16-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-366"><a href="#cb16-366" aria-hidden="true" tabindex="-1"></a><span class="co">#On crée la figure:</span></span>
<span id="cb16-367"><a href="#cb16-367" aria-hidden="true" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb16-368"><a href="#cb16-368" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">'Plan de phase de la population'</span>)</span>
<span id="cb16-369"><a href="#cb16-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-370"><a href="#cb16-370" aria-hidden="true" tabindex="-1"></a><span class="co">#Plan de phase:</span></span>
<span id="cb16-371"><a href="#cb16-371" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres égaux à ceux utilisés pour calculer les équilibres:</span></span>
<span id="cb16-372"><a href="#cb16-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-373"><a href="#cb16-373" aria-hidden="true" tabindex="-1"></a>param_aug <span class="op">=</span> np.array([rx, ry, Kx, Ky, b, gx, gy])</span>
<span id="cb16-374"><a href="#cb16-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-375"><a href="#cb16-375" aria-hidden="true" tabindex="-1"></a><span class="co"># Isocline nulles:</span></span>
<span id="cb16-376"><a href="#cb16-376" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-377"><a href="#cb16-377" aria-hidden="true" tabindex="-1"></a>yt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-378"><a href="#cb16-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-379"><a href="#cb16-379" aria-hidden="true" tabindex="-1"></a><span class="co">#xdot = 0 </span></span>
<span id="cb16-380"><a href="#cb16-380" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, gy <span class="op">*</span> (xt<span class="op">/</span>gx <span class="op">-</span> rx <span class="op">*</span> xt<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> xt<span class="op">/</span>Kx)), color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x = 0$'</span>)</span>
<span id="cb16-381"><a href="#cb16-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-382"><a href="#cb16-382" aria-hidden="true" tabindex="-1"></a><span class="co">#ydot = 0</span></span>
<span id="cb16-383"><a href="#cb16-383" aria-hidden="true" tabindex="-1"></a>ax2.plot(gx <span class="op">*</span> (yt<span class="op">/</span>gy <span class="op">-</span> ry <span class="op">*</span> yt<span class="op">/</span>b <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> yt<span class="op">/</span>Ky)), yt, color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y = 0$'</span>)</span>
<span id="cb16-384"><a href="#cb16-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-385"><a href="#cb16-385" aria-hidden="true" tabindex="-1"></a><span class="co">#Cadrage:</span></span>
<span id="cb16-386"><a href="#cb16-386" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">0.30</span>, right <span class="op">=</span> <span class="fl">4.5</span>)</span>
<span id="cb16-387"><a href="#cb16-387" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(top <span class="op">=</span> <span class="dv">6</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">0.70</span>)</span>
<span id="cb16-388"><a href="#cb16-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-389"><a href="#cb16-389" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'$x^*$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)</span>
<span id="cb16-390"><a href="#cb16-390" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'$y^*$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>)</span>
<span id="cb16-391"><a href="#cb16-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-392"><a href="#cb16-392" aria-hidden="true" tabindex="-1"></a><span class="co">#Axe x et y:</span></span>
<span id="cb16-393"><a href="#cb16-393" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'k'</span>, linestyle <span class="op">=</span> <span class="st">'dashed'</span>)</span>
<span id="cb16-394"><a href="#cb16-394" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(yt), yt, color <span class="op">=</span> <span class="st">'k'</span>, linestyle <span class="op">=</span> <span class="st">'dashed'</span>)</span>
<span id="cb16-395"><a href="#cb16-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-396"><a href="#cb16-396" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite capacité:</span></span>
<span id="cb16-397"><a href="#cb16-397" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-398"><a href="#cb16-398" aria-hidden="true" tabindex="-1"></a>ax2.plot(x, <span class="op">-</span>x <span class="op">+</span> Kx <span class="op">+</span> Ky, label <span class="op">=</span> <span class="st">'$K_x+K_y$'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>)</span>
<span id="cb16-399"><a href="#cb16-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-400"><a href="#cb16-400" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot des équilibres:</span></span>
<span id="cb16-401"><a href="#cb16-401" aria-hidden="true" tabindex="-1"></a>ax2.plot(xeq, yeq, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb16-402"><a href="#cb16-402" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">12</span>, color <span class="op">=</span> <span class="st">'C5'</span>)</span>
<span id="cb16-403"><a href="#cb16-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-404"><a href="#cb16-404" aria-hidden="true" tabindex="-1"></a><span class="co">#Ellipse:</span></span>
<span id="cb16-405"><a href="#cb16-405" aria-hidden="true" tabindex="-1"></a>xg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-406"><a href="#cb16-406" aria-hidden="true" tabindex="-1"></a>yg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-407"><a href="#cb16-407" aria-hidden="true" tabindex="-1"></a>X2, Y2 <span class="op">=</span> np.meshgrid(xg2, yg2)</span>
<span id="cb16-408"><a href="#cb16-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-409"><a href="#cb16-409" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> rx <span class="op">*</span> X2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> X2<span class="op">/</span>Kx)</span>
<span id="cb16-410"><a href="#cb16-410" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> ry <span class="op">*</span> Y2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> Y2<span class="op">/</span>Ky)</span>
<span id="cb16-411"><a href="#cb16-411" aria-hidden="true" tabindex="-1"></a>ax2.contour(X2, Y2, (X <span class="op">+</span> Y), [<span class="dv">0</span>], colors <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb16-412"><a href="#cb16-412" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'Ellipse des solutions'</span>)</span>
<span id="cb16-413"><a href="#cb16-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-414"><a href="#cb16-414" aria-hidden="true" tabindex="-1"></a><span class="co">#Parabole xdot=0 b=0:</span></span>
<span id="cb16-415"><a href="#cb16-415" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx <span class="op">*</span> np.ones_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>, label <span class="op">=</span> <span class="st">'Parabole β = 0'</span>)</span>
<span id="cb16-416"><a href="#cb16-416" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>)</span>
<span id="cb16-417"><a href="#cb16-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-418"><a href="#cb16-418" aria-hidden="true" tabindex="-1"></a><span class="co">#Parabole xdot=0 b=+inf:</span></span>
<span id="cb16-419"><a href="#cb16-419" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, xt <span class="op">*</span> gy<span class="op">/</span>gx, color <span class="op">=</span> <span class="st">'C6'</span>, label <span class="op">=</span> <span class="st">'Parabole β = $+\infty$'</span>)</span>
<span id="cb16-420"><a href="#cb16-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-421"><a href="#cb16-421" aria-hidden="true" tabindex="-1"></a><span class="co">#A:</span></span>
<span id="cb16-422"><a href="#cb16-422" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, Ky, color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb16-423"><a href="#cb16-423" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx <span class="op">-</span> <span class="fl">0.1</span>, Ky <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$A$'</span>)</span>
<span id="cb16-424"><a href="#cb16-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-425"><a href="#cb16-425" aria-hidden="true" tabindex="-1"></a><span class="co">#C:</span></span>
<span id="cb16-426"><a href="#cb16-426" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, gy <span class="op">*</span> Kx<span class="op">/</span>gx, color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb16-427"><a href="#cb16-427" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx, gy <span class="op">*</span> Kx<span class="op">/</span>gx <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'C'</span>)</span>
<span id="cb16-428"><a href="#cb16-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-429"><a href="#cb16-429" aria-hidden="true" tabindex="-1"></a><span class="co">#B:</span></span>
<span id="cb16-430"><a href="#cb16-430" aria-hidden="true" tabindex="-1"></a>ax2.plot(((gx<span class="op">/</span>gy) <span class="op">*</span> rx <span class="op">+</span> ry)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky),((gy<span class="op">/</span>gx) <span class="op">*</span> ry <span class="op">+</span> rx)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">\</span></span>
<span id="cb16-431"><a href="#cb16-431" aria-hidden="true" tabindex="-1"></a>                                        , color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb16-432"><a href="#cb16-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-433"><a href="#cb16-433" aria-hidden="true" tabindex="-1"></a>ax2.text(((gx<span class="op">/</span>gy) <span class="op">*</span> rx <span class="op">+</span> ry)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">-</span> <span class="fl">0.1</span>, ((gy<span class="op">/</span>gx) <span class="op">*</span> ry <span class="op">+</span> rx)<span class="op">/</span>((gx<span class="op">/</span>gy) <span class="op">*</span> rx<span class="op">/</span>Kx <span class="op">+</span> (gy<span class="op">/</span>gx) <span class="op">*</span> ry<span class="op">/</span>Ky) <span class="op">+</span> <span class="fl">0.1</span> <span class="op">\</span></span>
<span id="cb16-434"><a href="#cb16-434" aria-hidden="true" tabindex="-1"></a>                                        , <span class="st">'$B$'</span>)</span>
<span id="cb16-435"><a href="#cb16-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-436"><a href="#cb16-436" aria-hidden="true" tabindex="-1"></a><span class="co">#D:</span></span>
<span id="cb16-437"><a href="#cb16-437" aria-hidden="true" tabindex="-1"></a>ax2.plot(ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), color <span class="op">=</span> <span class="st">'black'</span>, marker <span class="op">=</span> <span class="st">'.'</span>)</span>
<span id="cb16-438"><a href="#cb16-438" aria-hidden="true" tabindex="-1"></a>ax2.text(ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx) <span class="op">-</span> <span class="fl">0.1</span>, rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky)<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx) <span class="op">+</span> <span class="fl">0.1</span>, <span class="st">'$D$'</span>)</span>
<span id="cb16-439"><a href="#cb16-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-440"><a href="#cb16-440" aria-hidden="true" tabindex="-1"></a><span class="co">## On place des textes indiquant les trois droites:</span></span>
<span id="cb16-441"><a href="#cb16-441" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">0.1</span>, yeq, <span class="st">"$P_</span><span class="sc">{10}</span><span class="st">$"</span>)</span>
<span id="cb16-442"><a href="#cb16-442" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx <span class="op">+</span> <span class="fl">0.05</span>, <span class="dv">4</span>, <span class="st">"$P_</span><span class="sc">{20}</span><span class="st">$"</span>)</span>
<span id="cb16-443"><a href="#cb16-443" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="dv">3</span>, <span class="fl">5.5</span>, <span class="st">"$P_\infty$"</span>)</span>
<span id="cb16-444"><a href="#cb16-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-445"><a href="#cb16-445" aria-hidden="true" tabindex="-1"></a><span class="co">#Légende:</span></span>
<span id="cb16-446"><a href="#cb16-446" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)<span class="op">;</span></span>
<span id="cb16-447"><a href="#cb16-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-448"><a href="#cb16-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-449"><a href="#cb16-449" aria-hidden="true" tabindex="-1"></a><span class="fu">#### a) Première condition de déflation</span></span>
<span id="cb16-450"><a href="#cb16-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-451"><a href="#cb16-451" aria-hidden="true" tabindex="-1"></a>La première condition d'inflation est exactement la même que dans le modèle précédent et la preuve est en tout point égale (elle repose sur une analyse de l'équation de l'ellipse qui est la même dans les deux modèles). On ne détaillera pas ici cette preuve mais on sait donc que :</span>
<span id="cb16-452"><a href="#cb16-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-453"><a href="#cb16-453" aria-hidden="true" tabindex="-1"></a>**Si $r_x = r_y$ alors le système est tout le temps déflationiste.**</span>
<span id="cb16-454"><a href="#cb16-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-455"><a href="#cb16-455" aria-hidden="true" tabindex="-1"></a><span class="fu">#### b) Deuxième condition de déflation</span></span>
<span id="cb16-456"><a href="#cb16-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-457"><a href="#cb16-457" aria-hidden="true" tabindex="-1"></a>Nous allons faire une preuve graphique de cette condition similaire à l'ancien modèle.  </span>
<span id="cb16-458"><a href="#cb16-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-459"><a href="#cb16-459" aria-hidden="true" tabindex="-1"></a>L'équilibre vit sur l'ellipse et parcourt l'arc orange entre $A$ et $B$ au fur et à mesure que $\beta$ augmente.   </span>
<span id="cb16-460"><a href="#cb16-460" aria-hidden="true" tabindex="-1"></a>Ainsi pour avoir déflation on va vouloir avoir cet arc entièrement sous la droite $d$ en gris.  </span>
<span id="cb16-461"><a href="#cb16-461" aria-hidden="true" tabindex="-1"></a>Il est alors facile de voir que pour cela on veut que la coordonnée en $y$ de $C$ soit plus grande que celle de $A$ ($C$ est plus haut sur la droite cyan que $A$), entraînant que la coordonnée en $x$ de $B$ est plus petite que celle de $A$ ($B$ se trouve plus à gauche sur l'ellipse que $A$).  </span>
<span id="cb16-462"><a href="#cb16-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-463"><a href="#cb16-463" aria-hidden="true" tabindex="-1"></a>Pour cela on a besoin de connaître les coordonnées de $A$ et $C$.  </span>
<span id="cb16-464"><a href="#cb16-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-465"><a href="#cb16-465" aria-hidden="true" tabindex="-1"></a>Le point $A$ est défini comme la valeur de l'équilibre sans migration. Il est alors facile de constater que dans ce cas nous sommes face à un système avec une croissance logistique seulement et donc l'équilibre est atteint pour les capacités de charge.  </span>
<span id="cb16-466"><a href="#cb16-466" aria-hidden="true" tabindex="-1"></a>On a donc $A = (K_x,K_y)$.</span>
<span id="cb16-467"><a href="#cb16-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-468"><a href="#cb16-468" aria-hidden="true" tabindex="-1"></a>Pour $C$ on sait que c'est l'intersection entre $P_{20}$ et $P_{\infty}$, ainsi comme $P_{20}$ est défini par $x^* = K_x$ et $P_{\infty}$ par $y^* =\frac{\gamma_y}{\gamma_x}x^*$ on a :</span>
<span id="cb16-469"><a href="#cb16-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-470"><a href="#cb16-470" aria-hidden="true" tabindex="-1"></a>$C = (K_x,\frac{\gamma_yK_x}{\gamma_x})$.</span>
<span id="cb16-471"><a href="#cb16-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-472"><a href="#cb16-472" aria-hidden="true" tabindex="-1"></a>La condition mathématique qui en découle est donc que le système est déflationiste si $\frac{\gamma_yK_x}{\gamma_x} &gt; K_y$.</span>
<span id="cb16-473"><a href="#cb16-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-474"><a href="#cb16-474" aria-hidden="true" tabindex="-1"></a>**Si $\frac{\gamma_y}{\gamma_x} &gt; \frac{K_y}{K_x}$ alors le système ([-@eq-modamig]) est toujours déflationiste.**</span>
<span id="cb16-475"><a href="#cb16-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-476"><a href="#cb16-476" aria-hidden="true" tabindex="-1"></a><span class="fu">#### c) Conditions d'inflation et/ou de déflation</span></span>
<span id="cb16-477"><a href="#cb16-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-478"><a href="#cb16-478" aria-hidden="true" tabindex="-1"></a>Similairement à la première partie on va avoir des conditions sur l'inflation.  </span>
<span id="cb16-479"><a href="#cb16-479" aria-hidden="true" tabindex="-1"></a>En effet, on voit bien sur le plan de phase que si $B$ est entre $A$ et $D$ alors l'arc d'ellipse que parcourt les équilibres en fonction de $\beta$ est constamment inflationiste.  </span>
<span id="cb16-480"><a href="#cb16-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-481"><a href="#cb16-481" aria-hidden="true" tabindex="-1"></a>Ainsi on veut que $B$ soit à droite de $A$ ce qui revient à prendre la condition inverse de celle énoncée plus haut (c'est à dire la coordonées $y$ de $C$ plus petite que celle de $A$), c'est à dire $\frac{\gamma_y}{\gamma_x} &lt; \frac{K_y}{K_x}$.  </span>
<span id="cb16-482"><a href="#cb16-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-483"><a href="#cb16-483" aria-hidden="true" tabindex="-1"></a>Ensuite pour avoir $B$ entre $A$ et $D$ on va vouloir que la pente de $P_{\infty}$ soit plus haute que celle de la droite passant par $(0,0)$ et $D$ qu'on appellera $\aleph$.  </span>
<span id="cb16-484"><a href="#cb16-484" aria-hidden="true" tabindex="-1"></a>Pour voir ceci on va ajouter la droite $\aleph$ au plan de phase précédent :</span>
<span id="cb16-485"><a href="#cb16-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-488"><a href="#cb16-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-489"><a href="#cb16-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb16-490"><a href="#cb16-490" aria-hidden="true" tabindex="-1"></a><span class="co">## Ajout de la droite :</span></span>
<span id="cb16-491"><a href="#cb16-491" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (rx <span class="op">*</span> Ky)<span class="op">/</span>(ry <span class="op">*</span> Kx) <span class="op">*</span> xt, color <span class="op">=</span> <span class="st">'C5'</span>, label <span class="op">=</span> <span class="st">"Droite א"</span>)</span>
<span id="cb16-492"><a href="#cb16-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-493"><a href="#cb16-493" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb16-494"><a href="#cb16-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-495"><a href="#cb16-495" aria-hidden="true" tabindex="-1"></a>display(fig2)</span>
<span id="cb16-496"><a href="#cb16-496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-497"><a href="#cb16-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-498"><a href="#cb16-498" aria-hidden="true" tabindex="-1"></a>Nous avons calculé dans la partie précédente que $D = (\frac{r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x} , \frac{r_xK_y(K_x+K_y)}{r_xK_y+r_yK_x} )$ ce qui ne change pas dans cette partie car on considère des quantités indépendantes des taux de migration.  </span>
<span id="cb16-499"><a href="#cb16-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-500"><a href="#cb16-500" aria-hidden="true" tabindex="-1"></a>La pente de la droite passant par $D$ et $(0,0)$ est donc égale à $\frac{r_xK_y}{r_yK_x}$ ce qui donne la condition suivante $\frac{\gamma_y}{\gamma_x} &gt; \frac{r_xK_y}{r_yK_x}$.</span>
<span id="cb16-501"><a href="#cb16-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-502"><a href="#cb16-502" aria-hidden="true" tabindex="-1"></a>**Si $\frac{r_xK_y}{r_yK_x} &lt; \frac{\gamma_y}{\gamma_x} &lt; \frac{K_y}{K_x}$ on a un système inflationiste.**</span>
<span id="cb16-503"><a href="#cb16-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-504"><a href="#cb16-504" aria-hidden="true" tabindex="-1"></a>Il est alors aisé de voir que si la pente de $P_{\infty}$ est plus petite que celle de $\aleph$ on a les équilibres qui parcourent d'abord des valeurs au dessus de $d$ puis en dessous (pour aller de $A$ à $C$). </span>
<span id="cb16-505"><a href="#cb16-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-506"><a href="#cb16-506" aria-hidden="true" tabindex="-1"></a>La condition mathématique est donc la suivante :</span>
<span id="cb16-507"><a href="#cb16-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-508"><a href="#cb16-508" aria-hidden="true" tabindex="-1"></a>**Si $\frac{\gamma_y}{\gamma_x} &lt; \frac{r_xK_y}{r_yK_x}$ alors le système est d'abord inflationiste puis déflationiste.**  </span>
<span id="cb16-509"><a href="#cb16-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-510"><a href="#cb16-510" aria-hidden="true" tabindex="-1"></a><span class="fu">### Animation</span></span>
<span id="cb16-513"><a href="#cb16-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-514"><a href="#cb16-514" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb16-515"><a href="#cb16-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-anim</span></span>
<span id="cb16-516"><a href="#cb16-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Animation Geogebra permettant de voir quels paramètres influencent le système.</span></span>
<span id="cb16-517"><a href="#cb16-517" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> IPython.display <span class="im">as</span> display</span>
<span id="cb16-518"><a href="#cb16-518" aria-hidden="true" tabindex="-1"></a>fig01 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb16-519"><a href="#cb16-519" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;iframe width = "700" height = "550" src = "https://www.geogebra.org/classic/bhhpgtqv" style = " style="border: 1px solid black"&gt;&lt;/iframe&gt;</span></span>
<span id="cb16-520"><a href="#cb16-520" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb16-521"><a href="#cb16-521" aria-hidden="true" tabindex="-1"></a>display.HTML(fig01)</span>
<span id="cb16-522"><a href="#cb16-522" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-523"><a href="#cb16-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-524"><a href="#cb16-524" aria-hidden="true" tabindex="-1"></a><span class="fu">## Somme des équilibres en fonction de la migration</span></span>
<span id="cb16-525"><a href="#cb16-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-526"><a href="#cb16-526" aria-hidden="true" tabindex="-1"></a><span class="fu">### Illustration des propositions précédentes</span></span>
<span id="cb16-527"><a href="#cb16-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-528"><a href="#cb16-528" aria-hidden="true" tabindex="-1"></a>On va illustrer les propositions précédentes en traçant la somme des équilibres en fonction de $\beta$.</span>
<span id="cb16-529"><a href="#cb16-529" aria-hidden="true" tabindex="-1"></a>Pour cela on va simuler avec <span class="in">`odeint`</span> (pendant un temps assez large pour atteindre l'équilibre) pour chaque valeur de $\beta$. </span>
<span id="cb16-530"><a href="#cb16-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-531"><a href="#cb16-531" aria-hidden="true" tabindex="-1"></a>On définit une fonction qui dépend de $\beta$ : </span>
<span id="cb16-534"><a href="#cb16-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-535"><a href="#cb16-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb16-536"><a href="#cb16-536" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug2(etat, t, param, h):</span>
<span id="cb16-537"><a href="#cb16-537" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, gy <span class="op">=</span> param</span>
<span id="cb16-538"><a href="#cb16-538" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> h</span>
<span id="cb16-539"><a href="#cb16-539" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb16-540"><a href="#cb16-540" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb16-541"><a href="#cb16-541" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb16-542"><a href="#cb16-542" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb16-543"><a href="#cb16-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-544"><a href="#cb16-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-545"><a href="#cb16-545" aria-hidden="true" tabindex="-1"></a>et on pose le temps d'intégration, les paramètres et les conditions initiales :</span>
<span id="cb16-546"><a href="#cb16-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-549"><a href="#cb16-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-550"><a href="#cb16-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb16-551"><a href="#cb16-551" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb16-552"><a href="#cb16-552" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-553"><a href="#cb16-553" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-554"><a href="#cb16-554" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-555"><a href="#cb16-555" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-556"><a href="#cb16-556" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-557"><a href="#cb16-557" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb16-558"><a href="#cb16-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-559"><a href="#cb16-559" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, gy1])</span>
<span id="cb16-560"><a href="#cb16-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-561"><a href="#cb16-561" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb16-562"><a href="#cb16-562" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-563"><a href="#cb16-563" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-564"><a href="#cb16-564" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-565"><a href="#cb16-565" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-566"><a href="#cb16-566" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb16-567"><a href="#cb16-567" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-568"><a href="#cb16-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-569"><a href="#cb16-569" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, gx2, gy2])</span>
<span id="cb16-570"><a href="#cb16-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-571"><a href="#cb16-571" aria-hidden="true" tabindex="-1"></a><span class="co">#3:</span></span>
<span id="cb16-572"><a href="#cb16-572" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-573"><a href="#cb16-573" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-574"><a href="#cb16-574" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-575"><a href="#cb16-575" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb16-576"><a href="#cb16-576" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-577"><a href="#cb16-577" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-578"><a href="#cb16-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-579"><a href="#cb16-579" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3, gx3, gy3])</span>
<span id="cb16-580"><a href="#cb16-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-581"><a href="#cb16-581" aria-hidden="true" tabindex="-1"></a><span class="co">#4:</span></span>
<span id="cb16-582"><a href="#cb16-582" aria-hidden="true" tabindex="-1"></a>rx4 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-583"><a href="#cb16-583" aria-hidden="true" tabindex="-1"></a>ry4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-584"><a href="#cb16-584" aria-hidden="true" tabindex="-1"></a>Kx4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-585"><a href="#cb16-585" aria-hidden="true" tabindex="-1"></a>Ky4 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb16-586"><a href="#cb16-586" aria-hidden="true" tabindex="-1"></a>gx4 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-587"><a href="#cb16-587" aria-hidden="true" tabindex="-1"></a>gy4 <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb16-588"><a href="#cb16-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-589"><a href="#cb16-589" aria-hidden="true" tabindex="-1"></a>param4 <span class="op">=</span> np.array([rx4, ry4, Kx4, Ky4, gx4, gy4])</span>
<span id="cb16-590"><a href="#cb16-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-591"><a href="#cb16-591" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration suffisament large pour atteindre l'équilibre:</span></span>
<span id="cb16-592"><a href="#cb16-592" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-593"><a href="#cb16-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-594"><a href="#cb16-594" aria-hidden="true" tabindex="-1"></a><span class="co">#Condition initiale:</span></span>
<span id="cb16-595"><a href="#cb16-595" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb16-596"><a href="#cb16-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-597"><a href="#cb16-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-598"><a href="#cb16-598" aria-hidden="true" tabindex="-1"></a>Et enfin on trace les quatre figures :</span>
<span id="cb16-599"><a href="#cb16-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-602"><a href="#cb16-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-603"><a href="#cb16-603" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb16-604"><a href="#cb16-604" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1, ax2, ax3) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb16-605"><a href="#cb16-605" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb16-606"><a href="#cb16-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-607"><a href="#cb16-607" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle pour plot en fonction de beta:</span></span>
<span id="cb16-608"><a href="#cb16-608" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb16-609"><a href="#cb16-609" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param1, i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb16-610"><a href="#cb16-610" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb16-611"><a href="#cb16-611" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param3, i))</span>
<span id="cb16-612"><a href="#cb16-612" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb16-613"><a href="#cb16-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-614"><a href="#cb16-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-615"><a href="#cb16-615" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>):</span>
<span id="cb16-616"><a href="#cb16-616" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param2, i))</span>
<span id="cb16-617"><a href="#cb16-617" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb16-618"><a href="#cb16-618" aria-hidden="true" tabindex="-1"></a>    s3 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param4, i))</span>
<span id="cb16-619"><a href="#cb16-619" aria-hidden="true" tabindex="-1"></a>    ax3.plot(i, s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb16-620"><a href="#cb16-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-621"><a href="#cb16-621" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot de la droite Kx+Ky:    </span></span>
<span id="cb16-622"><a href="#cb16-622" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-623"><a href="#cb16-623" aria-hidden="true" tabindex="-1"></a>xt2 <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.001</span>)</span>
<span id="cb16-624"><a href="#cb16-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-625"><a href="#cb16-625" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-626"><a href="#cb16-626" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb16-627"><a href="#cb16-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-628"><a href="#cb16-628" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt2, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt2), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-629"><a href="#cb16-629" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.10</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb16-630"><a href="#cb16-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-631"><a href="#cb16-631" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-632"><a href="#cb16-632" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.12</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb16-633"><a href="#cb16-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-634"><a href="#cb16-634" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt2, (Kx4 <span class="op">+</span> Ky4) <span class="op">*</span> np.ones_like(xt2), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-635"><a href="#cb16-635" aria-hidden="true" tabindex="-1"></a>ax3.text(<span class="fl">3.12</span>, Kx4 <span class="op">+</span> Ky4 <span class="op">+</span> <span class="fl">0.006</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb16-636"><a href="#cb16-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-637"><a href="#cb16-637" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb16-638"><a href="#cb16-638" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb16-639"><a href="#cb16-639" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb16-640"><a href="#cb16-640" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb16-641"><a href="#cb16-641" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb16-642"><a href="#cb16-642" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb16-643"><a href="#cb16-643" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>)</span>
<span id="cb16-644"><a href="#cb16-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-645"><a href="#cb16-645" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb16-646"><a href="#cb16-646" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor <span class="op">=</span> (<span class="fl">1.75</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb16-647"><a href="#cb16-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-648"><a href="#cb16-648" aria-hidden="true" tabindex="-1"></a><span class="co">#Titres:</span></span>
<span id="cb16-649"><a href="#cb16-649" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Déflation'</span>)<span class="op">;</span></span>
<span id="cb16-650"><a href="#cb16-650" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Les deux'</span>)<span class="op">;</span></span>
<span id="cb16-651"><a href="#cb16-651" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Inflation'</span>)<span class="op">;</span></span>
<span id="cb16-652"><a href="#cb16-652" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Inflation'</span>)<span class="op">;</span></span>
<span id="cb16-653"><a href="#cb16-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-654"><a href="#cb16-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-655"><a href="#cb16-655" aria-hidden="true" tabindex="-1"></a>On obtient 4 profils de courbe. Le premier profil montre une déflation du système et a été obtenu pour la condition décrite plus haut de $\frac{\gamma_y}{\gamma_x} &gt; \frac{K_y}{K_x}$.  </span>
<span id="cb16-656"><a href="#cb16-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-657"><a href="#cb16-657" aria-hidden="true" tabindex="-1"></a>Le deuxième profil correspond à une inflation du système puis une déflation quand $\beta$ augmente, cette courbe a bien été obtenue en respectant la condition de $\frac{\gamma_y}{\gamma_x} &lt; \frac{r_xK_y}{r_yK_x}$.  </span>
<span id="cb16-658"><a href="#cb16-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-659"><a href="#cb16-659" aria-hidden="true" tabindex="-1"></a>Les deux derniers profils, correspondant à une inflation permanente du système, sont obtenus en respectant les conditions décrites plus haut. On obtient deux profils différents, un avec une inflation croissante quand $\beta$ augmente et l'autre avec une inflation croissante puis décroissante (et qui atteint un plateau).  </span>
<span id="cb16-660"><a href="#cb16-660" aria-hidden="true" tabindex="-1"></a>Ce phénomène se voit graphiquement sur l'animation ou le plan de phase. En effet, on a dans le premier cas </span>
<span id="cb16-661"><a href="#cb16-661" aria-hidden="true" tabindex="-1"></a>$P_{\infty}$ qui coupe l'ellipse dans sa phase montante (l'écart entre l'ellipse et la droite $d$ augmente) alors que dans le second cas $P_{\infty}$ coupe l'ellipse alors que l'écart entre celle-ci et $d$ diminue.</span>
<span id="cb16-662"><a href="#cb16-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-663"><a href="#cb16-663" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cas de l'augmentorium </span></span>
<span id="cb16-664"><a href="#cb16-664" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-665"><a href="#cb16-665" aria-hidden="true" tabindex="-1"></a>Dans le cas de l'augmentorium il est important de considérer l'équilibre $x^*$ seule par rapport à $K_x$ (sa valeur s'il n'y a pas de migration).  </span>
<span id="cb16-666"><a href="#cb16-666" aria-hidden="true" tabindex="-1"></a>En effet même si on a inflation dans le système, si $x^*&lt;K_x$ alors on considère l'augmentorium comme efficace.</span>
<span id="cb16-667"><a href="#cb16-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-668"><a href="#cb16-668" aria-hidden="true" tabindex="-1"></a>Avec les hyptohèses énoncées plus haut sur la situation de l'augmentorium il n'est pas possible d'obtenir un système inflationiste (indépendamment de si $K_x&gt;K_y$ ou l'inverse). Il est facile de voir ceci grâce à notre animation.</span>
<span id="cb16-669"><a href="#cb16-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-670"><a href="#cb16-670" aria-hidden="true" tabindex="-1"></a>Néanmoins avec des hypothèses plus souples (mais en gardant que $r_x&lt;r_y$), par exemple que les taux de fuites sont plus forts que les taux de migration vers l'augmentorium (dus à une fuite du dispositif par exemple) on va voir que l'augmentorium n'est pas forcément bénéfique.  </span>
<span id="cb16-671"><a href="#cb16-671" aria-hidden="true" tabindex="-1"></a>En effet, on peut, sur le plan de phase tracé plus haut voir que dès que nous sommes dans un cas où on a de l'inflation (et même si on revient sur de la déflaton après) alors on a $x^* &gt; K_x$ ce qui est mauvais pour la culture. </span>
<span id="cb16-672"><a href="#cb16-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-673"><a href="#cb16-673" aria-hidden="true" tabindex="-1"></a>On va tracer l'équilibre $x^*$ en fonction de $\beta$ en considérant un cas où le système était déflationiste et un cas où le système était inflationiste (pour la somme des équilibres) :</span>
<span id="cb16-674"><a href="#cb16-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-677"><a href="#cb16-677" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-678"><a href="#cb16-678" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb16-679"><a href="#cb16-679" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb16-680"><a href="#cb16-680" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb16-681"><a href="#cb16-681" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-682"><a href="#cb16-682" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-683"><a href="#cb16-683" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-684"><a href="#cb16-684" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-685"><a href="#cb16-685" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-686"><a href="#cb16-686" aria-hidden="true" tabindex="-1"></a>gy1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb16-687"><a href="#cb16-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-688"><a href="#cb16-688" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, gy1])</span>
<span id="cb16-689"><a href="#cb16-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-690"><a href="#cb16-690" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb16-691"><a href="#cb16-691" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-692"><a href="#cb16-692" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-693"><a href="#cb16-693" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-694"><a href="#cb16-694" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-695"><a href="#cb16-695" aria-hidden="true" tabindex="-1"></a>gx2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb16-696"><a href="#cb16-696" aria-hidden="true" tabindex="-1"></a>gy2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-697"><a href="#cb16-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-698"><a href="#cb16-698" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2, gx2, gy2])</span>
<span id="cb16-699"><a href="#cb16-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-700"><a href="#cb16-700" aria-hidden="true" tabindex="-1"></a><span class="co">#2:</span></span>
<span id="cb16-701"><a href="#cb16-701" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-702"><a href="#cb16-702" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-703"><a href="#cb16-703" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-704"><a href="#cb16-704" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb16-705"><a href="#cb16-705" aria-hidden="true" tabindex="-1"></a>gx3 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-706"><a href="#cb16-706" aria-hidden="true" tabindex="-1"></a>gy3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-707"><a href="#cb16-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-708"><a href="#cb16-708" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3, gx3, gy3])</span>
<span id="cb16-709"><a href="#cb16-709" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb16-710"><a href="#cb16-710" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span> <span class="fl">0.4</span>)</span>
<span id="cb16-711"><a href="#cb16-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-712"><a href="#cb16-712" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Equilibre de la culture ($x^*$) avec déflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb16-713"><a href="#cb16-713" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Equilibre de la culture ($x^*$) avec déflation et inflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb16-714"><a href="#cb16-714" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Equilibre de la culture ($x^*$)  avec inflation des équilibres totaux ($x^* + y^*$)'</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb16-715"><a href="#cb16-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-716"><a href="#cb16-716" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle en fonction de beta</span></span>
<span id="cb16-717"><a href="#cb16-717" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb16-718"><a href="#cb16-718" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb16-719"><a href="#cb16-719" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb16-720"><a href="#cb16-720" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb16-721"><a href="#cb16-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-722"><a href="#cb16-722" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param2, i))</span>
<span id="cb16-723"><a href="#cb16-723" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb16-724"><a href="#cb16-724" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb16-725"><a href="#cb16-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-726"><a href="#cb16-726" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, e0, t, args <span class="op">=</span> (param3, i))</span>
<span id="cb16-727"><a href="#cb16-727" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb16-728"><a href="#cb16-728" aria-hidden="true" tabindex="-1"></a>    ax2.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, markersize <span class="op">=</span> <span class="st">'4'</span>)</span>
<span id="cb16-729"><a href="#cb16-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-730"><a href="#cb16-730" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite Kx:</span></span>
<span id="cb16-731"><a href="#cb16-731" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-732"><a href="#cb16-732" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-733"><a href="#cb16-733" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb16-734"><a href="#cb16-734" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-735"><a href="#cb16-735" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.5</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb16-736"><a href="#cb16-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-737"><a href="#cb16-737" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, Kx2 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-738"><a href="#cb16-738" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx2 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb16-739"><a href="#cb16-739" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-740"><a href="#cb16-740" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb16-741"><a href="#cb16-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-742"><a href="#cb16-742" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, Kx3 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-743"><a href="#cb16-743" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.5</span>, Kx3 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb16-744"><a href="#cb16-744" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-745"><a href="#cb16-745" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">3.5</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">-</span> <span class="fl">0.15</span>, <span class="st">'$K_x + K_y$'</span>)</span>
<span id="cb16-746"><a href="#cb16-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-747"><a href="#cb16-747" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb16-748"><a href="#cb16-748" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb16-749"><a href="#cb16-749" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb16-750"><a href="#cb16-750" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb16-751"><a href="#cb16-751" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb16-752"><a href="#cb16-752" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture ($x^*$)'</span>)</span>
<span id="cb16-753"><a href="#cb16-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-754"><a href="#cb16-754" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb16-755"><a href="#cb16-755" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb16-756"><a href="#cb16-756" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">"0.8"</span>, label <span class="op">=</span> <span class="st">'Eq. total ($x^* + y^*$)'</span>)</span>
<span id="cb16-757"><a href="#cb16-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-758"><a href="#cb16-758" aria-hidden="true" tabindex="-1"></a><span class="co"># On limite le cadre :</span></span>
<span id="cb16-759"><a href="#cb16-759" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(bottom<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-760"><a href="#cb16-760" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(bottom<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-761"><a href="#cb16-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-762"><a href="#cb16-762" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb16-763"><a href="#cb16-763" aria-hidden="true" tabindex="-1"></a>ax.legend(bbox_to_anchor <span class="op">=</span> (<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb16-764"><a href="#cb16-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-765"><a href="#cb16-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-766"><a href="#cb16-766" aria-hidden="true" tabindex="-1"></a>En bleu on observe le comportement de l'équilibre dans la culture seulement et en gris on retrouve les courbes tracées juste au dessus. On voit bien que dès que le système subit une inflation des équilibres totaux la situation devient mauvaise pour la culture.  </span>
<span id="cb16-767"><a href="#cb16-767" aria-hidden="true" tabindex="-1"></a>En revanche quand on a déflation des équilibres totaux alors la situtaion est bénéfique à la culture.  </span>
<span id="cb16-768"><a href="#cb16-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-769"><a href="#cb16-769" aria-hidden="true" tabindex="-1"></a>Il faut garder en tête que ceci n'est vrai que pour $r_x&lt;r_y$.  </span>
<span id="cb16-770"><a href="#cb16-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-771"><a href="#cb16-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-772"><a href="#cb16-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-773"><a href="#cb16-773" aria-hidden="true" tabindex="-1"></a>Ensuite, le taux de fuite est un paramètre clé de notre méthode. On va donc tracer la somme des équilibres et l'équilibre $x^*$ en fonction de $\gamma_y$.</span>
<span id="cb16-774"><a href="#cb16-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-775"><a href="#cb16-775" aria-hidden="true" tabindex="-1"></a>Attention ! Un fort taux de fuite correspond à un $\gamma_y$ faible.</span>
<span id="cb16-776"><a href="#cb16-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-779"><a href="#cb16-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-780"><a href="#cb16-780" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb16-781"><a href="#cb16-781" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition d'un nouveau modèle qui prend en compte le changement de gy:</span></span>
<span id="cb16-782"><a href="#cb16-782" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug3(etat, t, param, h):</span>
<span id="cb16-783"><a href="#cb16-783" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, gx, b <span class="op">=</span> param</span>
<span id="cb16-784"><a href="#cb16-784" aria-hidden="true" tabindex="-1"></a>    gy <span class="op">=</span> h</span>
<span id="cb16-785"><a href="#cb16-785" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb16-786"><a href="#cb16-786" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y<span class="op">/</span>gy <span class="op">-</span> x<span class="op">/</span>gx), </span>
<span id="cb16-787"><a href="#cb16-787" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x<span class="op">/</span>gx <span class="op">-</span> y<span class="op">/</span>gy)]</span>
<span id="cb16-788"><a href="#cb16-788" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb16-789"><a href="#cb16-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-790"><a href="#cb16-790" aria-hidden="true" tabindex="-1"></a><span class="co">#Définition des paramètres:</span></span>
<span id="cb16-791"><a href="#cb16-791" aria-hidden="true" tabindex="-1"></a><span class="co">#1:</span></span>
<span id="cb16-792"><a href="#cb16-792" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-793"><a href="#cb16-793" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-794"><a href="#cb16-794" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb16-795"><a href="#cb16-795" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-796"><a href="#cb16-796" aria-hidden="true" tabindex="-1"></a>gx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb16-797"><a href="#cb16-797" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-798"><a href="#cb16-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-799"><a href="#cb16-799" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1, gx1, b])</span>
<span id="cb16-800"><a href="#cb16-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-801"><a href="#cb16-801" aria-hidden="true" tabindex="-1"></a><span class="co">#Temps d'intégration assez large pour atteindre l'éq :</span></span>
<span id="cb16-802"><a href="#cb16-802" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-803"><a href="#cb16-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-804"><a href="#cb16-804" aria-hidden="true" tabindex="-1"></a><span class="co">#Conditions initiales:</span></span>
<span id="cb16-805"><a href="#cb16-805" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb16-806"><a href="#cb16-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-807"><a href="#cb16-807" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure:</span></span>
<span id="cb16-808"><a href="#cb16-808" aria-hidden="true" tabindex="-1"></a>fig, (ax, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">4</span>))</span>
<span id="cb16-809"><a href="#cb16-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-810"><a href="#cb16-810" aria-hidden="true" tabindex="-1"></a><span class="co">#Droite de la somme des capacités:</span></span>
<span id="cb16-811"><a href="#cb16-811" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-812"><a href="#cb16-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-813"><a href="#cb16-813" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-814"><a href="#cb16-814" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">3.15</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb16-815"><a href="#cb16-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-816"><a href="#cb16-816" aria-hidden="true" tabindex="-1"></a>ax1.plot(xt, Kx1 <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-817"><a href="#cb16-817" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">3.5</span>, Kx1 <span class="op">-</span> <span class="fl">0.1</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb16-818"><a href="#cb16-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-819"><a href="#cb16-819" aria-hidden="true" tabindex="-1"></a><span class="co">#Boucle qui calcule l'équilibre et qui plot un point en fonction des valeurs du taux de fuite:</span></span>
<span id="cb16-820"><a href="#cb16-820" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="fl">0.01</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb16-821"><a href="#cb16-821" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug3, e0, t, args <span class="op">=</span> (param1, i))</span>
<span id="cb16-822"><a href="#cb16-822" aria-hidden="true" tabindex="-1"></a>    ax.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb16-823"><a href="#cb16-823" aria-hidden="true" tabindex="-1"></a>    ax1.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb16-824"><a href="#cb16-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-825"><a href="#cb16-825" aria-hidden="true" tabindex="-1"></a><span class="co">#Légendes:</span></span>
<span id="cb16-826"><a href="#cb16-826" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb16-827"><a href="#cb16-827" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Ɣy, Fuite'</span>)</span>
<span id="cb16-828"><a href="#cb16-828" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>)</span>
<span id="cb16-829"><a href="#cb16-829" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Eq. culture'</span>)</span>
<span id="cb16-830"><a href="#cb16-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-831"><a href="#cb16-831" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Somme des équilibres en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb16-832"><a href="#cb16-832" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Equilibre de la culture en fonction du taux de fuite'</span>, fontsize <span class="op">=</span> <span class="dv">7</span>)   </span>
<span id="cb16-833"><a href="#cb16-833" aria-hidden="true" tabindex="-1"></a>ax.legend()<span class="op">;</span></span>
<span id="cb16-834"><a href="#cb16-834" aria-hidden="true" tabindex="-1"></a>ax1.legend()<span class="op">;</span></span>
<span id="cb16-835"><a href="#cb16-835" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Densité de pop."</span>)<span class="op">;</span></span>
<span id="cb16-836"><a href="#cb16-836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-837"><a href="#cb16-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-838"><a href="#cb16-838" aria-hidden="true" tabindex="-1"></a>Dans la figure gauche on a représenté la somme des équilibres ($x^*+y^*$) de la même manière que précédemment mais cette fois en faisant varier le taux de fuite.  </span>
<span id="cb16-839"><a href="#cb16-839" aria-hidden="true" tabindex="-1"></a>On observe alors un nouveau profil qui correspond à une déflation, puis une inflation puis enfin une déflation au fur et à mesure que $\gamma_y$ augmente.</span>
<span id="cb16-840"><a href="#cb16-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-841"><a href="#cb16-841" aria-hidden="true" tabindex="-1"></a>Dans la figure droite on a cette fois uniquement l'équilibre dans la culture ($x^*$). On observe que pour des $\gamma_y$ petits on a inflation puis on retourne à une déflation.  </span>
<span id="cb16-842"><a href="#cb16-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-843"><a href="#cb16-843" aria-hidden="true" tabindex="-1"></a>Pour interpréter ceci il faut comprendre que les des petites valeurs de $\gamma_y$ correspondent à de grandes valeurs de taux de fuite.  </span>
<span id="cb16-844"><a href="#cb16-844" aria-hidden="true" tabindex="-1"></a>Ainsi quand $\gamma_y \to 0$ l'augmentorium se vide en ravageurs et on a ainsi toute la population dans la culture et l'équilibre dans culture tend vers sa capacité de charge car on est seulement face à une croissance logistique.  </span>
<span id="cb16-845"><a href="#cb16-845" aria-hidden="true" tabindex="-1"></a>C'est pourquoi, lorsque les taux de fuite sont grands on observe une inflation de la culture car on a, des populations de ravageurs qui viennent de l'augmentorium qui s'ajoutent aux ravageurs déjà présents dans la culture.  </span>
<span id="cb16-846"><a href="#cb16-846" aria-hidden="true" tabindex="-1"></a>La somme des équilibres est donc trompeuse dans ce cas là, en effet le système subit une déflation car l'augmentorium n'est presque plus occupé pour de forts taux de fuite mais il ne faut pas croire que c'en est bénéfique pour la culture.</span>
<span id="cb16-847"><a href="#cb16-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-848"><a href="#cb16-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-849"><a href="#cb16-849" aria-hidden="true" tabindex="-1"></a>Ce modèle considère uniquement la population de ravageurs. Or, la méthode de l'augmentorium repose énormément sur l'action des prédateurs on va donc considérer <span class="co">[</span><span class="ot">maintenant</span><span class="co">](modelaug.qmd)</span> un modèle qui prend en compte ces prédateurs.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Pour plus d’informations, voyez <a href="./about.html">ici</a>.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>