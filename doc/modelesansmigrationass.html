<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Rapport de stage - Modèle logistique structuré avec migration symétrique</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./modelesansmigrationass.html">Modèle logistique structuré avec migration symétrique</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Rapport de stage</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Présentation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contexte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contexte</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelesansmigrationass.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Modèle logistique structuré avec migration symétrique</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modeleavecmigrationass.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modèle logistique structuré avec migration assymétrique</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelaug.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modèle avec proies structurées et prédateurs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modfinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modèle proies-prédateurs structuré</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conclusion et perspectives</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#définition-du-modèle" id="toc-définition-du-modèle" class="nav-link active" data-scroll-target="#définition-du-modèle">Définition du modèle</a></li>
  <li><a href="#dynamique-du-modèle" id="toc-dynamique-du-modèle" class="nav-link" data-scroll-target="#dynamique-du-modèle">Dynamique du modèle</a></li>
  <li><a href="#plan-de-phase" id="toc-plan-de-phase" class="nav-link" data-scroll-target="#plan-de-phase">Plan de phase</a>
  <ul class="collapse">
  <li><a href="#equilibres-et-stabilités" id="toc-equilibres-et-stabilités" class="nav-link" data-scroll-target="#equilibres-et-stabilités">Equilibres et stabilités</a></li>
  <li><a href="#analyse-du-plan-de-phase" id="toc-analyse-du-plan-de-phase" class="nav-link" data-scroll-target="#analyse-du-plan-de-phase">Analyse du plan de phase</a></li>
  </ul></li>
  <li><a href="#animation" id="toc-animation" class="nav-link" data-scroll-target="#animation">Animation</a></li>
  <li><a href="#inflation-et-déflation-du-système-en-fonction-de-la-migration" id="toc-inflation-et-déflation-du-système-en-fonction-de-la-migration" class="nav-link" data-scroll-target="#inflation-et-déflation-du-système-en-fonction-de-la-migration">Inflation et déflation du système en fonction de la migration</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Modèle logistique structuré avec migration symétrique</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<hr>
<p><em>Modules à importer :</em></p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="définition-du-modèle" class="level2">
<h2 class="anchored" data-anchor-id="définition-du-modèle">Définition du modèle</h2>
<p>On pose le modèle suivant d’après <span class="citation" data-cites="arditi2015">Arditi (<a href="#ref-arditi2015" role="doc-biblioref">2015</a>)</span> : <span id="eq-modsmig"><span class="math display">
\left\{\begin{array}{l}
\dot x = r_xx\left(1-\frac{x}{K_x}\right)+\beta(y-x)\\
\dot y = r_yy\left(1-\frac{y}{K_y}\right)+\beta(x-y).
\end{array}\right.
\tag{1}</span></span></p>
<p>avec :<br>
- <span class="math inline">x</span> la population dans la première structure,<br>
- <span class="math inline">y</span> la population dans la seconde structure,<br>
- <span class="math inline">r_x</span> et <span class="math inline">r_y</span> le taux de croissance dans les deux structures,<br>
- <span class="math inline">K_x</span> et <span class="math inline">K_y</span> les capacités de charge des deux structures,<br>
- <span class="math inline">\beta</span> la force de migration entre les structures.</p>
<p>Ce modèle est un modèle ressemblant peu à notre situation d’augmentorium car celui-ci est caractérisé par une migration assymétrique, il permet néanmoins de situer la démarche et les outils que nous allons utiliser pour étudier des modèles plus complexes.</p>
</section>
<section id="dynamique-du-modèle" class="level2">
<h2 class="anchored" data-anchor-id="dynamique-du-modèle">Dynamique du modèle</h2>
<p>On va tracer la dynamique de la population en fonction du temps pour se faire une première idée de comment se comporte la population.</p>
<p>On définit le modèle sous <a href="https://www.python.org/"><code>Python</code></a> :</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug(etat, t, param):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, b <span class="op">=</span> param</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [ rx <span class="op">*</span> x <span class="op">*</span> ( <span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx ) <span class="op">+</span> b <span class="op">*</span> ( y <span class="op">-</span> x ), </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> ( <span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky ) <span class="op">+</span> b <span class="op">*</span> ( x <span class="op">-</span> y )]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On va utiliser <code>odeint</code> de <a href="https://scipy.org/"><code>Scipy</code></a> afin de simuler une solution en fonction du temps. Il faut donc définir un temps d’intégration, des conditions initiales et les paramètres du modèle :</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Temps d'intégration:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ti <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Etats initiaux:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [x0 ,y0]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres: </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>rx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>ry <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>param_aug <span class="op">=</span> np.array([rx, ry, Kx, Ky, b])</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">## Simulation:</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> odeint(aug, e0, ti, args <span class="op">=</span> (param_aug, ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Maintenant qu’on a la simulation on peut réprésenter la figure avec <a href="https://matplotlib.org/"><code>matplotlib</code></a> :</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize <span class="op">=</span> (<span class="dv">7</span>, <span class="dv">4</span> ))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Dynamique des ravageurs dans le temps'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[:, <span class="dv">0</span>], color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'culture'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[:, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'augmentorium'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>ax.grid() <span class="co">#on ajoute la grille</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>ax.legend() <span class="co">#on ajoute la légende</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Temps, t'</span>)<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Densité de pop.'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="modelesansmigrationass_files/figure-html/cell-5-output-1.png" width="598" height="394"></p>
</div>
</div>
<p>Cette simulation nous montre une hausse de la population dans l’augmentorium et une baisse de la population dans la culture.<br>
Les deux populations atteignent un équilibre qui semble stable (il se maintient dans le temps).</p>
<p>Dans le cas d’un augmentorium, on voit que le simple fait de débarasser les fruits et de les mettre dans un espace séparé de la culture ammène à une baisse de la population de ravageurs dans la culture.</p>
</section>
<section id="plan-de-phase" class="level2">
<h2 class="anchored" data-anchor-id="plan-de-phase">Plan de phase</h2>
<section id="equilibres-et-stabilités" class="level3">
<h3 class="anchored" data-anchor-id="equilibres-et-stabilités">Equilibres et stabilités</h3>
<p>Nous allons tracer le plan de phase associé à ce système pour voir les équilibres et leurs stabilités.</p>
<p>A l’équilibre on a par définition <span class="math inline">\dot x = 0</span> et <span class="math inline">\dot y =0</span> ce qui donne :</p>
<p><span id="eq-pdpsmig"><span class="math display">
\left\{\begin{array}{l}
0 = r_xx^*\left(1-\frac{x^*}{K_x}\right)+\beta(y^*-x^*) \Leftrightarrow  y^*=r_xx^*\left(\frac{1}{r_x}-\frac{1}{\beta}+\frac{x^*}{\beta K_x}\right)\\
0 = r_yy^*\left(1-\frac{y^*}{K_y}\right)+\beta(x^*-y^*) \Leftrightarrow  x^*=r_yy^*\left(\frac{1}{r_y}-\frac{1}{\beta}+\frac{y^*}{\beta K_y}\right)
\end{array}\right.
\tag{2}</span></span></p>
<p>avec <span class="math inline">x^*</span> et <span class="math inline">y^*</span> la valeur des équilibres.</p>
<p>Ainsi, les deux isoclines correspondent à des paraboles. Celles-ci se croisent trivialement en <span class="math inline">(0,0)</span> et dans le quadrant positif en <span class="math inline">(x^*,y^*)</span>.</p>
<p>Pour calculer <span class="math inline">(x^*,y^*)</span> on va utiliser l’expression de <span class="math inline">x^*</span> trouvée en (<a href="#eq-pdpsmig">2</a>) qu’on va rentrer dans l’équation de <span class="math inline">y^*</span> :</p>
<p>Comme <span class="math inline">x^* = r_yy^*\left(\frac{1}{r_y}-\frac{1}{\beta}+\frac{y^*}{\beta K_y}\right)</span> on a :<br>
<span class="math display">
y^* = r_x\left[r_yy^*\left(\frac{1}{r_y}-\frac{1}{\beta}+\frac{y^*}{\beta K_y}\right)\right]\left(\frac{1}{r_x}-\frac{1}{\beta}+\frac{r_yy^*\left(\frac{1}{r_y}-\frac{1}{\beta}+\frac{y^*}{\beta K_y}\right)}{\beta K_x}\right)
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
y^* = y^* - \frac{r_yy^*}{\beta} + \frac{r_y{y^*}^2}{\beta K_y} - \frac{r_xy^*}{\beta} + \frac{r_xr_yy^*}{\beta^2} - \frac{r_xr_y{y^*}^2}{\beta^2 K_y} + \\[.2cm]
\frac{r_x{y^*}^2}{\beta K_x} - \frac{r_xr_y{y^*}^2}{\beta^2 K_x} + \frac{r_xr_y{y^*}^3}{\beta^2 K_xK_y} - \frac{r_xr_y{y^*}^2}{\beta^2 K_x} + \\[.2cm]
\frac{r_xr_y^2{y^*}^2}{\beta^3 K_x} - \frac{r_xr_y^2{y^*}^3}{\beta^3 K_x K_y} + \frac{r_xr_y{y^*}^3}{\beta^2 K_xK_y} - \\[.2cm]
\frac{r_xr_y^2{y^*}^3}{\beta^3 K_xK_y} + \frac{r_xr_y^2{y^*}^4}{\beta^3K_xK_y^2}
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
y^*\left(- \frac{r_y}{\beta} - \frac{r_x}{\beta} + \frac{r_xr_y}{\beta^2}\right) + \\[.2cm]
{y^*}^2\left(\frac{r_y}{\beta K_y} - \frac{r_xr_y}{\beta^2 K_y} + \frac{r_x}{\beta K_x} - 2\frac{r_xr_y}{\beta^2 K_x} + \frac{r_xr_y^2}{\beta^3 K_x} \right) + \\[.2cm]
2{y^*}^3\left( \frac{r_xr_y}{\beta^2 K_xK_y} - \frac{r_xr_y^2}{\beta^3 K_xK_y} \right) +
{y^*}^4 \frac{r_xr_y^2}{\beta^3K_xK_y^2} = 0
</span></p>
<p>Ce qui donne après réarrangement : <span id="eq-polsmig"><span class="math display">
y^*\left(\frac{1}{\beta}\left[\frac{r_xr_y}{\beta} - r_y -r_x\right]\right)+ \\[.2cm]
{y^*}^2\left(\frac{r_y}{\beta K_y}\left[1-\frac{r_x}{\beta}\right]+\frac{r_x}{\beta K_x}\left[1-2\frac{r_y}{\beta}+\frac{r_xr_y}{\beta^2}\right]\right)+\\[.2cm]
2{y^*}^3\left(\frac{r_xr_y}{\beta^2 K_xK_y}\left[1-\frac{r_y}{\beta}\right]\right) +
{y^*}^4 \frac{r_xr_y^2}{\beta^3K_y^2K_x} = 0
\tag{3}</span></span></p>
<p>Ce polynôme est résoluble via <a href="https://numpy.org/"><code>numpy</code></a> pour obtenir <span class="math inline">y^*</span>:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">## On défnit un monome y, un polynôme p et on prend ses solutions:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.polynomial.Polynomial([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>pol <span class="op">=</span> y <span class="op">*</span> (rx <span class="op">*</span> ry <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>b) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>rx) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>ry)) <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>(rx <span class="op">*</span> ry)) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>(y<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> ((rx<span class="op">*</span>ry)<span class="op">/</span>b) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>Ky) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>rx) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>b)) <span class="op">+</span> (<span class="dv">1</span><span class="op">/</span>Kx) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>ry) <span class="op">-</span> (<span class="dv">2</span><span class="op">/</span>b) <span class="op">+</span> (ry<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span>)))) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">*</span> (y<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> ((rx <span class="op">*</span> ry)<span class="op">/</span>((b<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> Kx <span class="op">*</span> Ky)) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> (ry<span class="op">/</span>b)) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>(y<span class="op">**</span><span class="dv">4</span>) <span class="op">*</span> ((rx <span class="op">*</span> (ry<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>((b<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> (Ky<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> Kx))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution qu'on obtient avec un masque booléen qui sélectionne les racines réelles et strictement positives:</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> pol.roots()[ (np.isreal( pol.roots() )) <span class="op">*</span> (pol.roots() <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>yeq<span class="op">=</span>sol[<span class="dv">0</span>].real</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On déduit <span class="math inline">x^*</span> via sa définition par le système <a href="#eq-pdpsmig">(&nbsp;2</a>:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>xeq <span class="op">=</span> (ry <span class="op">*</span> yeq <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>ry) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">+</span> (yeq<span class="op">/</span>(b <span class="op">*</span> Ky)))).real</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Avec la valeur des équilibres on va maintenant tracer le plan de phase :</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Plan de phase du système'</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Isocline nulles:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Pour xdot = 0:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>ax.plot(xt,xt <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> (rx <span class="op">*</span> ((xt<span class="op">/</span>Kx) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> b), </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                    color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>ax.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">## Pour ydot = 0:</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>ax.plot(xt <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> (ry <span class="op">*</span> ((xt<span class="op">/</span>Ky) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> b), xt,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                    color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">## On réduit la vue à ce qui nous intéresse:</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span>, right <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(top <span class="op">=</span> <span class="dv">3</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">## On trace la droite la somme des capacités:</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>ax.plot(x, <span class="op">-</span>x <span class="op">+</span> Kx <span class="op">+</span> Ky, label <span class="op">=</span> <span class="st">'$K_x+K_y$'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">## On nomme les axes:</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'$x$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>) <span class="op">;</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'$y$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>) <span class="op">;</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">## On plot les deux équilibres:</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>ax.plot(xeq.real, yeq.real, label <span class="op">=</span> <span class="st">'$(x^*,y^*)$'</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">6</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, label <span class="op">=</span> <span class="st">'$(0,0)$'</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>                    marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">6</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">## Localisation de la légende:</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>ax.legend(loc <span class="op">=</span> <span class="st">'upper left'</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">## Ajout du champ de vecteur via la fonction quiver :</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.6</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.6</span>)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>ax.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>                    color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">80</span>, width <span class="op">=</span> <span class="fl">0.003</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="modelesansmigrationass_files/figure-html/cell-8-output-1.png" width="602" height="480"></p>
</div>
</div>
<p>Comme dit plus haut on a bien un croisement dans le quadrant positif qui correspond à l’équilibre <span class="math inline">(x^*,y^*)</span>.</p>
<p>Les paraboles, en fonction des valeurs de leurs racines, peuvent croiser de différentes manières les axes des abssices et des ordonnées.<br>
Le plan de phase peut donc présenter plusieurs profils, autre que celui tracé ici. Néanmoins, le croisement des paraboles dans le quadrant positif (l’équilibre non nul) est toujours présent quelque soit le profil.</p>
<p>En faisant apparaître le champ de vecteur on peut déduire que l’équilibre en <span class="math inline">(0,0)</span> est instable et l’équilibre en <span class="math inline">(x^*,y^*)</span> est stable.</p>
<section id="stabilité-mathématique-des-équilibres" class="level4">
<h4 class="anchored" data-anchor-id="stabilité-mathématique-des-équilibres">Stabilité mathématique des équilibres</h4>
<p>Il est clair que <span class="math inline">(0,0)</span> est instable et <span class="math inline">(x^*,y^*)</span> est stable (par le champ de vecteur).<br>
Mathématiquement considérons la jacobienne de (<a href="#eq-modsmig">1</a>): <span id="eq-jacob"><span class="math display">
\mathbb{J}=\begin{pmatrix}
\ r_x-\frac{2r_xx}{K_x}-\beta &amp; \beta \\
\ \beta &amp; r_y -\frac{2r_yy}{K_y}-\beta
\end{pmatrix}
\tag{4}</span></span></p>
<p>et donc <strong>pour <span class="math inline">(0,0)</span></strong>:</p>
<p><span class="math display">
\mathbb{J_{\vec{0}}}=\begin{pmatrix}
\ r_x-\beta &amp; \beta \\
\ \beta &amp; r_y -\beta
\end{pmatrix}
</span></p>
<p>Les valeurs propres <span class="math inline">\lambda _1</span> et <span class="math inline">\lambda _2</span> de cette matrice sont les solutions du polynôme caractéristique définit par : <span class="math display">
\begin{vmatrix}
r_x-\beta-\lambda &amp; \beta \\
\beta &amp; r_y -\beta -\lambda \
\end{vmatrix} = 0
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
(r_x-\beta-\lambda)(r_y-\beta - \lambda) - \beta^2 = 0
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
\lambda^2 + \lambda\left(2\beta - r_x - r_y\right) + r_xr_y - \beta(r_x+r_y) = 0
</span></p>
<p>Le discriminant <span class="math inline">\Lambda</span> est donc définit par :<br>
<span class="math display">
\Lambda = \left(2\beta - r_x - r_y\right)^2 - 4(r_xr_y - \beta[r_x+r_y]) \\
= 4\beta^2 -4\beta(r_x +r_y) + r_x^2 +r_y^2 +2r_xr_y -4r_xr_y +4\beta(r_x +r_y) \\ = 4\beta^2 + (r_x-r_y)^2
</span></p>
<p>Et donc le spectre <span class="math inline">\sigma</span> de la jacobienne est :<br>
<span class="math display">
\sigma_\mathbb{J} = \left(\lambda_1 = \frac{r_x+r_y-2\beta-2\beta \sqrt{\frac{(r_x-r_y)^2}{4\beta^2}+1}}{2},\lambda_2=\frac{r_x+r_y-2\beta+2\beta \sqrt{\frac{(r_x-r_y)^2}{4\beta^2}+1}}{2}\right)
</span></p>
<p>et on a ainsi,</p>
<p><span class="math display">
\lambda_2 &gt; 0
</span></p>
<p>Donc <span class="math inline">(0,0)</span> est bien instable.</p>
<p><strong>Pour <span class="math inline">(x^*,y^*)</span></strong> on a : <span id="eq-jacob"><span class="math display">
\mathbb{J_{x^*,y^*}}=\begin{pmatrix}
\ r_x-\frac{2r_xx^*}{K_x}-\beta &amp; \beta \\
\ \beta &amp; r_y -\frac{2r_yy^*}{K_y}-\beta
\end{pmatrix}
\tag{5}</span></span></p>
<p>or, on a aussi d’après (<a href="#eq-pdpsmig">2</a>) :</p>
<p><span class="math display">
\left\{\begin{array}{l}
\frac{y^*\beta}{x^*} = \beta - r_x + \frac{r_xx^*}{K_x}   \\
\frac{x^*\beta}{y^*} = \beta - r_y + \frac{r_yy^*}{K_y}  
\end{array}\right.
</span></p>
<p>ce qui simplifie la jacobienne en <span class="math inline">(x^*,y^*)</span> à l’expression suivante :</p>
<p><span class="math display"> \mathbb{J_{x^*,y^*}} = \begin{pmatrix}
\ -\frac{\beta y^*}{x^*}-\frac{r_xx^*}{K_x} &amp; \beta \\
\ \beta &amp; -\frac{\beta x^*}{y^*}-\frac{r_yy^*}{K_y}
\end{pmatrix}
</span></p>
<p>Il est alors facile de vérifier que la trace de cette matrice est négative.</p>
<p>Le déterminant quant à lui est donné par : <span class="math display">
\alpha = \left(\frac{\beta y^*}{x^*}+\frac{r_xx^*}{K_x}\right)\left(\frac{\beta x^*}{y^*}+\frac{r_yy^*}{K_y}\right) - \beta^2 \\
= \frac{\beta r_y{y^*}^2}{x^*K_y} + \frac{\beta r_x {x^*}^2}{y^*K_x} + \frac{r_xr_yx^*y^*}{K_xK_y} &gt; 0
</span></p>
<p>Le déterminant est lui positif, d’après la classification des portaits de plan de phase dans <span class="math inline">\mathbb{R}^2</span> on a que <span class="math inline">(x^*,y^*)</span> est stable.</p>
</section>
</section>
<section id="analyse-du-plan-de-phase" class="level3">
<h3 class="anchored" data-anchor-id="analyse-du-plan-de-phase">Analyse du plan de phase</h3>
<p>On remarque sur le plan de phase du système tracé précédemment que l’équilibre atteint n’est pas sur la droite <span class="math inline">x^*+y^*=K_x+K_y</span> (en gris), on appellera cette droite <span class="math inline">d</span>.<br>
Si le croisement des isoclines est au dessus de cette droite le système (<a href="#eq-modsmig">1</a>) subit une inflation et si le croisement est en dessous de cette droite il subit une déflation (voir <a href="./contexte.html">contexte</a>).</p>
<p>On voit que la structuration de l’espace, et les migrations qui en découle, perturbent les équilibres qui auraient dû être la somme des équilires des deux régions (la logistique tend vers la capacité maximale à l’équilibre).</p>
<p>Plus généralement, on peut montrer qu’en cas de mixité parfaite entre les deux structures (<span class="math inline">\beta \to \infty</span>) on a d’après <span class="citation" data-cites="arditi2015">Arditi (<a href="#ref-arditi2015" role="doc-biblioref">2015</a>)</span>:</p>
<p><span id="eq-inf"><span class="math display">
x^*+y^* = K_x + K_y + (K_x-K_y)\frac{r_xK_y-r_yK_x}{r_xK_y+r_yK_x}
\tag{6}</span></span></p>
<p>Ce qui montre qu’en général on a pas <span class="math inline">x^*+y^* = K_x + K_x</span>.<br>
De plus par (<a href="#eq-inf">6</a>), si <span class="math inline">K_y&lt;K_x</span> et si <span class="math inline">r_xK_y&lt;r_yK_x</span> alors <span class="math inline">x^*+y^* &lt; K_x+K_y</span> ce qui nous intéresse particulièrement pour la lutte biologique.</p>
<p>Ensuite, en faisant <span class="math inline">\dot x + \dot y = 0</span>, dans le cas de l’équilibre, on a: <span id="eq-ell"><span class="math display">
r_xx^*\left(1-\frac{x^*}{K_x}\right)+r_yy^*\left(1-\frac{y^*}{K_y}\right) = 0
\tag{7}</span></span></p>
<p>Autrement dit les points d’équilibres vivent sur une ellipse (si on ne modifie que <span class="math inline">\beta</span> ), qu’on va tracer avec <code>contour</code> :</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>xg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>yg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>X2, Y2 <span class="op">=</span> np.meshgrid(xg2, yg2)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> rx <span class="op">*</span> X2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> X2<span class="op">/</span>Kx)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> ry <span class="op">*</span> Y2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> Y2<span class="op">/</span>Ky)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>ax.contour(X2, Y2, (X <span class="op">+</span> Y), [<span class="dv">0</span>], colors <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'Ellipse des solutions'</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">## Localisation de la légende:</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>ax.legend(loc <span class="op">=</span> <span class="st">'upper left'</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">## On place les différents points d'intérêts...</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>xv <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, Ky, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">7</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx, <span class="dv">0</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">7</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx, Ky, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">6</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">##...et on les relie aux axes:</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>xc <span class="op">=</span> np.arange(<span class="dv">0</span>, Kx, <span class="fl">0.01</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>ax.plot(xc, Ky <span class="op">*</span> np.ones_like(xc), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>yc<span class="op">=</span>np.arange(<span class="dv">0</span>,Ky,<span class="fl">0.01</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx <span class="op">*</span> np.ones_like(yc), yc, linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co">#On nomme les points:</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="op">-</span><span class="fl">0.2</span>, Ky, <span class="st">'$K_y$'</span>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>ax.text(Kx, <span class="op">-</span><span class="fl">0.2</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co">#On place les points d'équilibres :</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.arange(<span class="dv">0</span>, yeq, <span class="fl">0.01</span>)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.arange(<span class="dv">0</span>, xeq, <span class="fl">0.01</span>)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>ax.plot(xeq <span class="op">*</span> np.ones_like(ys), ys, linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>ax.plot(xs, yeq <span class="op">*</span> np.ones_like(xs), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="op">-</span><span class="fl">0.2</span>, yeq, <span class="st">'$y^*$'</span>)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>ax.text(xeq, <span class="op">-</span><span class="fl">0.2</span>, <span class="st">'$x^*$'</span>)</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>display(fig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="modelesansmigrationass_files/figure-html/cell-9-output-1.png" width="602" height="480"></p>
</div>
</div>
<p>Les conditions d’inflations et de déflations suivantes proviennent de l’article d’<span class="citation" data-cites="arditi2018">Arditi (<a href="#ref-arditi2018" role="doc-biblioref">2018</a>)</span>.</p>
<section id="a-première-condition-à-un-système-déflationiste" class="level4">
<h4 class="anchored" data-anchor-id="a-première-condition-à-un-système-déflationiste">a) Première condition à un système déflationiste</h4>
<p>On remarque que le point <span class="math inline">(K_x,K_y)</span> est en permanence sur la droite <span class="math inline">d</span> qui coupe en permanence l’ellipse (en deux points) sauf pour une situation où <span class="math inline">d</span> est tangente à l’ellipse.<br>
Ce cas nous intéresse car il rend compte d’un système entièrement déflationiste. Représentons le sur le plan de phase :</p>
<p>On redéfinit les paramètres pour être dans le cas qui nous intéresse :</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres: </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>rxnew <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>rynew <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Et on trace de la même manière que précédemment le plan de phase :</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">'Plan de phase du système'</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Isocline nulles:</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Pour xdot = 0:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt,xt <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> (rxnew <span class="op">*</span> ((xt<span class="op">/</span>Kx) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> b), color <span class="op">=</span> <span class="st">'C2'</span>, </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">## Pour ydot = 0:</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> (rynew <span class="op">*</span> ((xt<span class="op">/</span>Ky) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> b), xt, color <span class="op">=</span> <span class="st">'C3'</span>, </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">## On réduit la vue à ce qui nous intéresse:</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span>, right <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(top <span class="op">=</span> <span class="dv">3</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">## On trace la droite la somme des capacités:</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>ax2.plot(x, <span class="op">-</span>x <span class="op">+</span> Kx <span class="op">+</span> Ky, label <span class="op">=</span> <span class="st">'$K_x+K_y$'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">## On nomme les axes:</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'$x$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>) <span class="op">;</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'$y$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>) <span class="op">;</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">## On recalcule les équilibres avec les nouveaux paramètres:</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">## On défnit un monome y, un polynôme p et on prend ses solutions:</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.polynomial.Polynomial([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>pol2 <span class="op">=</span> y <span class="op">*</span> (rxnew <span class="op">*</span> rynew <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>b) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>rxnew) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>rynew)) <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>(rxnew <span class="op">*</span> rynew)) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>(y<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> ((rxnew<span class="op">*</span>rynew)<span class="op">/</span>b) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>Ky) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>rxnew) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>b)) <span class="op">+</span> (<span class="dv">1</span><span class="op">/</span>Kx) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>rynew) <span class="op">-</span> (<span class="dv">2</span><span class="op">/</span>b) <span class="op">+</span> (rynew<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span>)))) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">*</span> (y<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> ((rxnew <span class="op">*</span> rynew)<span class="op">/</span>((b<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> Kx <span class="op">*</span> Ky)) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> (rynew<span class="op">/</span>b)) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>(y<span class="op">**</span><span class="dv">4</span>) <span class="op">*</span> ((rx <span class="op">*</span> (rynew<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>((b<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> (Ky<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> Kx))</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution qu'on obtient avec un masque booléen qui sélectionne les </span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co">## racines réelles et strictement positives:</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>sol2 <span class="op">=</span> pol2.roots()[ (np.isreal( pol2.roots() )) <span class="op">*</span> (pol2.roots() <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>yeq2<span class="op">=</span>sol2[<span class="dv">0</span>].real</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="co">## On calcule x*</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>xeq2 <span class="op">=</span> (rynew <span class="op">*</span> yeq2 <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>rynew) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">+</span> (yeq2<span class="op">/</span>(b <span class="op">*</span> Ky)))).real</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co">## On plot les deux équilibres:</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>ax2.plot(xeq2.real, yeq2.real, label <span class="op">=</span> <span class="st">'$(x^*,y^*)$'</span>, marker <span class="op">=</span> <span class="st">'.'</span>, </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>                markersize <span class="op">=</span> <span class="dv">6</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, label <span class="op">=</span> <span class="st">'$(0,0)$'</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">6</span>, </span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co">## Localisation de la légende:</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc <span class="op">=</span> <span class="st">'upper left'</span>)</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co">## Ajout du champ de vecteur via la fonction quiver :</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.6</span>)</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.6</span>)</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug)</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>ax2.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, </span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>                scale <span class="op">=</span> <span class="dv">80</span>, width <span class="op">=</span> <span class="fl">0.003</span>) <span class="op">;</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>xg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>yg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>X2, Y2 <span class="op">=</span> np.meshgrid(xg2, yg2)</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> rxnew <span class="op">*</span> X2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> X2<span class="op">/</span>Kx)</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> rynew <span class="op">*</span> Y2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> Y2<span class="op">/</span>Ky)</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>ax2.contour(X2, Y2, (X <span class="op">+</span> Y), [<span class="dv">0</span>], colors <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'Ellipse des solutions'</span>)</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a><span class="co">## Localisation de la légende:</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc <span class="op">=</span> <span class="st">'upper left'</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="co">## On place les différents points d'intérêts...</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>xv <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, Ky, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">7</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, <span class="dv">0</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">7</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, Ky, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">6</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="co">##...et on les relie aux axes:</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>xc <span class="op">=</span> np.arange(<span class="dv">0</span>, Kx, <span class="fl">0.01</span>)</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>ax2.plot(xc, Ky <span class="op">*</span> np.ones_like(xc), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>yc<span class="op">=</span>np.arange(<span class="dv">0</span>,Ky,<span class="fl">0.01</span>)</span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx <span class="op">*</span> np.ones_like(yc), yc, linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a><span class="co">#On nomme les points:</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="op">-</span><span class="fl">0.2</span>, Ky, <span class="st">'$K_y$'</span>)</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx, <span class="op">-</span><span class="fl">0.2</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a><span class="co">#On place les points d'équilibres :</span></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.arange(<span class="dv">0</span>, yeq2, <span class="fl">0.01</span>)</span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.arange(<span class="dv">0</span>, xeq2, <span class="fl">0.01</span>)</span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>ax2.plot(xeq2 <span class="op">*</span> np.ones_like(ys), ys, linestyle <span class="op">=</span> <span class="st">'dashed'</span>,</span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>ax2.plot(xs, yeq2 <span class="op">*</span> np.ones_like(xs), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="op">-</span><span class="fl">0.2</span>, yeq2, <span class="st">'$y^*$'</span>)<span class="op">;</span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>ax2.text(xeq2, <span class="op">-</span><span class="fl">0.2</span>, <span class="st">'$x^*$'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modelesansmigrationass_files/figure-html/cell-11-output-1.png" width="602" height="480"></p>
</div>
</div>
<p>L’ellipse, d’équation <span class="math inline">f(x,y)=r_xx\left(1-\frac{x}{K_x}\right)+r_yy\left(1-\frac{y}{K_y}\right) = 0</span> , peut être vue comme la ligne de niveau de <span class="math inline">f</span> en <span class="math inline">0</span>.</p>
<p>Ainsi, une équation de la tangente au point <span class="math inline">(x_0,y_0)</span> est donnée par:<br>
<span id="eq-eqa"><span class="math display">
\frac{\partial f}{\partial x}(x_0,y_0)(x-x_0)+ \frac{\partial f}{\partial y}(x_0,y_0)(y-y_0) = 0
\tag{8}</span></span></p>
<p>autrement dit : <span class="math display">
\left(r_x - 2\frac{r_xx_0}{K_x}\right)(x-x_0) + \left(r_y -2\frac{r_yy_0}{K_y}\right)(y-y_0) = 0
</span></p>
<p>Dans le cas où <span class="math inline">x_0=K_x</span> et <span class="math inline">y_0=K_y</span> on a alors : <span class="math display">
-r_x(x-K_x) -r_y(y-K_y) = 0
</span> <span class="math display">
\Leftrightarrow
</span> <span id="eq-tang"><span class="math display">
y = -\frac{r_x}{r_y}\left(x-K_x\right) + K_y
\tag{9}</span></span></p>
<p>qui est donc l’équation de la tangente à l’ellipse au point <span class="math inline">(K_x,K_y)</span>.</p>
<p>Si maintenant on prend <span class="math inline">r_x=r_y</span> alors on remarque que (<a href="#eq-tang">9</a>) est égale à l’équation de la droite <span class="math inline">d</span> ce qui implique que toute l’ellipse est en dessous de <span class="math inline">d</span> et donc que tous les équilibres sont déflationistes.</p>
<p><strong>Donc : si <span class="math inline">r_x=r_y</span> on a (<a href="#eq-modsmig">1</a>) qui est déflationiste quelque soit le taux de migration.</strong></p>
<p>On va effectuer une simulation avec les paramètres déduits à l’instant pour confirmer ce qu’on vient de dire.<br>
Pour cela on va, pour chaque <span class="math inline">\beta</span>, simuler un temps suffisament large pour atteindre l’équilibre et représenter la somme des deux équilibres.</p>
<p>Il faut donc définir une fonction qui prend en compte le changement de <span class="math inline">\beta</span> :</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug2(etat, t, param, h):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky <span class="op">=</span> param</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> h</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y <span class="op">-</span> x), </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x <span class="op">-</span> y)]</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ainsi qu’un temps d’intégration large, des conditions initiales et des paramètres :</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Temps d'intégration :</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">400</span>, <span class="fl">0.01</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres : </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="fl">0.5</span> <span class="co"># =on prend rx1=rx2</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1])</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">## Condition initiale:</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>c10 <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Et enfin on simule avec <code>odeint</code> et on fait une boucle pour simuler que <span class="math inline">\beta</span> va de <span class="math inline">0</span> à <span class="math inline">4</span> (suffisant pour avoir une courbe intéressante):</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">## On crée la figure et l'axe:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig3, ax3 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fig3.suptitle(<span class="st">"Somme des équilibres en fonction de β quand $r_x = r_y$"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Boucle ou i prend les valeurs de beta:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param1, i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ax3.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot de la droite Kx+Ky:</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>,markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>ax3.text(<span class="fl">3.2</span>, Kx <span class="op">+</span> Ky <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">## Légendes:</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kx1 <span class="op">+</span> Ky1, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>) <span class="co">#Si on avait mis label dans la boucle la légende aurait été trop grande</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">## On adapte la fenêtre:</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(<span class="fl">2.2</span>, <span class="fl">3.2</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>ax3.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="modelesansmigrationass_files/figure-html/cell-14-output-1.png" width="589" height="477"></p>
</div>
</div>
<p>On voit que la courbe bleu représentant la somme des équilibres est en permanence en dessous de la droite <span class="math inline">K_x+K_y</span>. On a bien un système entièrement déflationiste quand <span class="math inline">r_x = r_y</span>.</p>
</section>
<section id="b-deuxième-condition-à-un-système-déflationiste" class="level4">
<h4 class="anchored" data-anchor-id="b-deuxième-condition-à-un-système-déflationiste">b) Deuxième condition à un système déflationiste</h4>
<p>On va maintenant considérer le cas où <span class="math inline">r_x &lt; r_y</span> c’est à dire qu’on va prendre l’ellipse dans un seul sens (voir sur l’animation Geogebra).</p>
<p>On va analyser graphiquement le plan de phase. On aura besoin de tracer les droites définies par <span class="math inline">\beta = 0</span> et <span class="math inline">\beta = +\infty</span> dans l’équation <span class="math inline">y^*=r_xx^*\left(\frac{1}{r_x}-\frac{1}{\beta}+\frac{x^*}{\beta K_x}\right)</span> (la parabole verte dans le plan de phase définie par <span class="math inline">\dot x =0</span>).</p>
<p>En effet, ceci va permettre d’encadrer l’équilibre <span class="math inline">(x^*,y^*)</span> en fonction du taux de migration.</p>
<p>Lorsque <span class="math inline">\beta = 0</span> on a, par la première équation de (<a href="#eq-pdpsmig">2</a>) : <span class="math display">
0 = r_xx^*(1-\frac{x^*}{K_x})
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
x^*=K_x \vee x^* = 0
</span></p>
<p>Donc lorsque le taux de migration est nul la parabole correspondant à <span class="math inline">\dot x = 0</span> a pour équation les droites <span class="math inline">x^*=0</span> et <span class="math inline">x^*=K_x</span> qu’on appelle respectivement <span class="math inline">P_{10}</span> et <span class="math inline">P_{20}</span>.</p>
<p>Lorsque <span class="math inline">\beta = + \infty</span> on a, encore une fois par la première équation de (<a href="#eq-pdpsmig">2</a>):</p>
<p><span class="math display">
y^* = r_xx^*\frac{1}{r_x} = x^*
</span></p>
<p>Ainsi quand le taux de migration tend vers l’infini la parabole <span class="math inline">\dot x = 0</span> correspond à la droite <span class="math inline">y^*=x^*</span> qu’on appelle <span class="math inline">P_\infty</span>.</p>
<p>On notera dans la suite <span class="math inline">A=(K_x,K_y)</span>, <span class="math inline">B</span> l’intersection non trivial (pas <span class="math inline">(0,0)</span>) entre <span class="math inline">P_\infty</span> et l’ellipse et <span class="math inline">C</span> l’intersection non trivial (pas <span class="math inline">(K_x,0)</span>) entre <span class="math inline">P_{20}</span> et <span class="math inline">P_\infty</span>.</p>
<p>Pour calculer les coordonées de <span class="math inline">B</span> on utilise que <span class="math inline">y^*=x^*</span> et on le rentre dans (<a href="#eq-ell">7</a>) ce qui donne : <span class="math display">
x^*\left(r_x\left(1-\frac{x^*}{K_x}\right)+r_y\left(1-\frac{x^*}{K_y}\right)\right) = 0
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
x^* = \frac{r_x+r_y}{\frac{r_x}{K_x}+\frac{r_y}{K_y}}
</span></p>
<p>et comme <span class="math inline">B</span> est sur <span class="math inline">P_\infty</span> alors on a : <span class="math display">
y^*= \frac{r_x+r_y}{\frac{r_x}{K_x}+\frac{r_y}{K_y}}
</span> <span class="math inline">B</span> est donc définie comme :<br>
<span class="math display">
B = (\frac{r_x+r_y}{\frac{r_x}{K_x}+\frac{r_y}{K_y}},\frac{r_x+r_y}{\frac{r_x}{K_x}+\frac{r_y}{K_y}})
</span></p>
<p>Pour calculer les coordonées de <span class="math inline">C</span> on utilise que <span class="math inline">y^*=x^*</span> dans la définition de <span class="math inline">P_{20}</span>, ie comme <span class="math inline">P_{20}</span> est défini par <span class="math inline">x^* =K_x</span> alors <span class="math inline">y^*=K_x</span> et donc on a : <span class="math display">
C=(K_x,K_x)
</span></p>
<p>Représentons le tout sur le premier plan de phase:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Parabole xdot=0 b=0:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx <span class="op">*</span> np.ones_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>, label <span class="op">=</span> <span class="st">'Parabole b=0'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>ax.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Parabole xdot=0 b=+inf:</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, xt, color <span class="op">=</span> <span class="st">'C6'</span>, label <span class="op">=</span> <span class="st">'Parabole b=$+\infty$'</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">## On place des textes indiquant les trois droites:</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.05</span>, yeq <span class="op">+</span> <span class="fl">0.4</span>, <span class="st">"$P_</span><span class="sc">{10}</span><span class="st">$"</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>ax.text(Kx <span class="op">+</span> <span class="fl">0.05</span>, <span class="fl">2.8</span>, <span class="st">"$P_</span><span class="sc">{20}</span><span class="st">$"</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">2.65</span>, <span class="fl">2.45</span>, <span class="st">"$P_\infty$"</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">## On place les trois points:</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">## A :</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx, Ky, marker <span class="op">=</span> <span class="st">'.'</span>,color <span class="op">=</span> <span class="st">'C0'</span>, markersize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>ax.text(Kx <span class="op">+</span> <span class="fl">0.1</span>, Ky <span class="op">+</span> <span class="fl">0.1</span>, <span class="st">"$A$"</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">## B :</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>ax.plot((rx <span class="op">+</span> ry)<span class="op">/</span>(rx<span class="op">/</span>Kx <span class="op">+</span> ry<span class="op">/</span>Ky), (rx <span class="op">+</span> ry)<span class="op">/</span>(rx<span class="op">/</span>Kx <span class="op">+</span> ry<span class="op">/</span>Ky), </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>            marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>, markersize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>ax.text((rx <span class="op">+</span> ry)<span class="op">/</span>(rx<span class="op">/</span>Kx <span class="op">+</span> ry<span class="op">/</span>Ky) <span class="op">-</span> <span class="fl">0.1</span>, (rx <span class="op">+</span> ry)<span class="op">/</span>(rx<span class="op">/</span>Kx <span class="op">+</span> ry<span class="op">/</span>Ky) <span class="op">+</span> <span class="fl">0.1</span>, <span class="st">"$B$"</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">## C : </span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx, Kx, marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>, markersize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>ax.text(Kx <span class="op">-</span> <span class="fl">0.1</span>, Kx <span class="op">+</span> <span class="fl">0.1</span>, <span class="st">"$C$"</span>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>ax.legend(loc <span class="op">=</span> <span class="st">"upper left"</span>, fontsize <span class="op">=</span> <span class="fl">6.5</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>display(fig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-pdp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="modelesansmigrationass_files/figure-html/fig-pdp-output-1.png" width="602" height="480" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Plan de phase complet</figcaption>
</figure>
</div>
</div>
</div>
<p>Lorsque <span class="math inline">\beta</span> augmente de <span class="math inline">0</span> à <span class="math inline">+\infty</span> on a l’équilibre qui parcourt l’ellipse de <span class="math inline">A</span> à <span class="math inline">B</span>.<br>
Pour que le système soit déflationiste on veut que la portion de l’ellipse de <span class="math inline">A</span> à <span class="math inline">B</span> soit complètement en dessous de la droite <span class="math inline">d</span> (grise).<br>
Pour ce faire on peut voir sur notre plan de phase qu’il faut que <span class="math inline">C</span> ait une coordonée <span class="math inline">y</span> plus grande que <span class="math inline">A</span> afin que <span class="math inline">B</span> soit toujours à gauche de <span class="math inline">A</span> (et donc en dessous de <span class="math inline">d</span>).</p>
<p>Mathématiquement on veut donc que <span class="math inline">K_x &gt; K_y</span>.</p>
<p>Ainsi si on a <span class="math inline">r_x &lt; r_y</span> et <span class="math inline">K_x&gt;K_y</span> on aura tout le temps un modèle déflationiste pour les ravageurs.</p>
<p>Ceci est intéressant pour l’augmentorium, si on a la capacité de charge l’augmentorium qui est plus faible que celle de la culture alors le système est toujours négatif pour la population totale de ravageurs.</p>
<p>On peut aussi voir graphiquement que dans ce cas là on a toujours <span class="math inline">x^* &lt; K_x</span>, c’est ce que l’on cherche à obtenir.</p>
<p>On peut illustrer notre condition avec une simulation similaire à la partie précédente :</p>
<p>On utilise le même modèle, on change uniquement les paramètres :</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres : </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span>  <span class="co">#On a bien rx2 &lt; ry2 </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span>  <span class="co">#On a bien Kx2&gt;Ky2</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">## En l'occurence il s'agit des paramètres de base qu'on avait utilisé ##pour la simulation du premier plan de phase expliquant qu'on se ##retrouvait avec un équilibre déflationiste.</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Et on simule à nouveau :</p>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">## On crée la figure et l'axe:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>fig4, ax4 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>fig4.suptitle(<span class="st">"Somme des équilibre en fonction de β quand $r_x &lt; r_y$ et $K_x &gt; K_y$"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Boucle ou i prend les valeurs de beta:</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param2, i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    ax4.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot de la droite Kx+Ky:</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>ax4.plot(xt, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>ax4.text(<span class="fl">3.2</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">## Légendes:</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>ax4.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>ax4.plot(Kx2<span class="op">+</span>Ky2, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>) <span class="co">#Si on avait mis label dans la boucle la légende aurait été trop grande</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co">## On adapte la fenêtre:</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>ax4.set_ylim(<span class="fl">2.2</span>, <span class="fl">3.2</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>ax4.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modelesansmigrationass_files/figure-html/cell-17-output-1.png" width="589" height="477"></p>
</div>
</div>
<p>On observe qu’on a bien une déflation du système quelque soit le taux de migration.</p>
</section>
<section id="c-conditions-pour-une-inflation-etou-une-déflation" class="level4">
<h4 class="anchored" data-anchor-id="c-conditions-pour-une-inflation-etou-une-déflation">c) Conditions pour une inflation et/ou une déflation</h4>
<p>Sur la base de la <a href="#fig-pdp">Figure&nbsp;1</a> on peut aussi déduire quand est-ce qu’on peut avoir inflation selon les paramètres.</p>
<p>Il s’agit de la même idée de preuve graphique qu’avant mais en complexifiant un peu. Pour cela on va avoir besoin d’un quatrième point qu’on appellera <span class="math inline">D</span> et qui correspond à l’autre intersection entre l’ellipse et la droite <span class="math inline">d</span> (pas <span class="math inline">(K_x,K_y)</span>).</p>
<p>Pour trouver les coordonnées de <span class="math inline">D</span> on a simplement que comme <span class="math inline">D</span> est sur <span class="math inline">d</span> alors on a <span class="math inline">y^* = -x^* + K_x + K_y</span> et on remplace <span class="math inline">y^*</span> dans (<a href="#eq-ell">7</a>) ce qui donne : <span class="math display">
r_xx^*\left(1-\frac{x^*}{K_x}\right) +r_y(-x^*+K_x+K_y)\left(1-\frac{-x^*+K_x+K_y}{K_y} \right) = 0
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
x^*\left(r_x\left(1-\frac{x^*}{K_x}\right) + \frac{r_yK_x}{K_y}\left(1-\frac{x^*}{K_x} \right) \right) + \frac{r_y(K_x+K_y)}{K_y}(x^*-K_x) = 0
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
\left(1-\frac{x^*}{K_x}\right)\left(x^*\left[r_x+\frac{r_yK_x}{K_y}\right]-\frac{r_yK_x(K_x+K_y)}{K_y}\right) = 0
</span></p>
<p>Ce qui donne soit <span class="math inline">x^* = K_x</span> et on retouve alors <span class="math inline">A</span>, soit :<br>
<span class="math display">
x^*\left[r_x+\frac{r_yK_x}{K_y}\right] = \frac{r_yK_x(K_x+K_y)}{K_y}
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
x^* = \frac{r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x}
</span></p>
<p>Et donc d’après la définition de <span class="math inline">y^*</span> : <span class="math display">
y^* = - \frac{r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x} + K_x + K_y
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
y^* = \frac{(K_x+K_y)(r_xK_y+r_yK_x)-r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x}
</span> <span class="math display">
\Leftrightarrow
</span> <span class="math display">
y^*=\frac{r_xK_y(K_x+K_y)}{r_xK_y+r_yK_x}
</span></p>
<p>Ainsi, <span class="math inline">D = (\frac{r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x} , \frac{r_xK_y(K_x+K_y)}{r_xK_y+r_yK_x} )</span> .</p>
<p>Ajoutons <span class="math inline">D</span> au plan de phase :</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">## On ajoute D:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ax.plot((ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky))<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        (rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky))<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">'C0'</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>ax.text((ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky))<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx) <span class="op">+</span> <span class="fl">0.07</span>, </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.08</span> <span class="op">+</span> (rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky))<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), <span class="st">"$D$"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>display(fig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="modelesansmigrationass_files/figure-html/cell-18-output-1.png" width="602" height="480"></p>
</div>
</div>
<p>On voit maintenant aisément que si <span class="math inline">B</span> est entre <span class="math inline">A</span> et <span class="math inline">D</span> alors les équilibres vont parcourir des valeurs inflationistes seulement (arc orange au dessus de la droite grise).</p>
<p>Si <span class="math inline">B</span> est en dessous de <span class="math inline">D</span> (la coordonnée y de <span class="math inline">B</span> est plus petite que celle de <span class="math inline">D</span>) alors on a d’abord des équilibres inflationistes (de <span class="math inline">A</span> à <span class="math inline">D</span>) puis déflationistes (de <span class="math inline">D</span> à <span class="math inline">B</span>).</p>
<p>Mathématiquement on a donc :</p>
<p>Si <span class="math inline">K_y &gt; K_x</span> (la coordonnée <span class="math inline">y</span> de <span class="math inline">B</span> est plus grande que celle de <span class="math inline">A</span>) et <span class="math inline">K_xr_y &gt; K_yr_x</span> (la coordonnée <span class="math inline">y</span> de <span class="math inline">B</span> est plus grande que celle de <span class="math inline">D</span>) alors le système est toujours inflationiste.</p>
<p>Si <span class="math inline">K_xr_y &lt; K_yr_x</span> (la coordonnée <span class="math inline">y</span> de <span class="math inline">B</span> est plus petite que celle de <span class="math inline">D</span>) alors le système est d’abord inflationiste puis déflationiste.</p>
<p>On peut vérifier ces deux assertions avec des simulations similaires à la partie précédente :</p>
<p>On utilise le même modèle, on change uniquement les paramètres :</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres condition 1: </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">1</span>  <span class="co">#On a bien rx3 &lt; ry3 </span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="dv">2</span>  <span class="co">#On a bien Ky3&gt;Kx3</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#On a la première condition de Kxry &gt; Kyrx</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres condition 2: </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>rx4 <span class="op">=</span> <span class="fl">0.6</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>ry4 <span class="op">=</span> <span class="dv">1</span>  <span class="co">#On a bien rx4 &lt; ry4 </span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>Kx4 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>Ky4 <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#On a la deuxième condition de Kxry &gt; Kyrx</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>param4 <span class="op">=</span> np.array([rx4, ry4, Kx4, Ky4])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Et on simule à nouveau :</p>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">## On crée la figure et l'axe:</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>fig5, (ax5, ax6) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>ax5.set_title(<span class="st">"Somme des équilibre en fonction de β quand $r_x &lt; r_y$ et $K_y &gt; K_x$ et $K_xr_y &gt; K_yr_x$"</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>ax6.set_title(<span class="st">"Somme des équilibre en fonction de β quand $r_x &lt; r_y$ et $K_xr_y &lt; K_yr_x$"</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.4</span>) <span class="co">#On ajuste l'écart entre figures</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">## Boucle ou i prend les valeurs de beta:</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param3, i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    ax5.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param4, i))</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    ax6.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot de la droite Kx+Ky:</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>xt<span class="op">=</span>np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>ax5.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>ax5.text(<span class="fl">3.2</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>ax6.plot(xt, (Kx4 <span class="op">+</span> Ky4) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>ax6.text(<span class="fl">3.2</span>, Kx4 <span class="op">+</span> Ky4 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="co">## Légendes:</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>ax5.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>ax5.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>ax5.plot(Kx3 <span class="op">+</span> Ky3, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>) <span class="co">#Si on avait mis label dans la boucle la légende aurait été trop grande</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>ax6.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>ax6.plot(Kx4 <span class="op">+</span> Ky4, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>)</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="co">## On adapte la fenêtre:</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>ax5.set_ylim(<span class="fl">2.9</span>, <span class="fl">3.2</span>)</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>ax6.set_ylim(<span class="fl">2.9</span>, <span class="fl">3.1</span>)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>ax5.legend()<span class="op">;</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>ax6.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modelesansmigrationass_files/figure-html/cell-20-output-1.png" width="620" height="445"></p>
</div>
</div>
<p>On observe qu’on a bien dans la partie gauche tout le temps inflation et dans la partie droite d’abord inflation puis déflation.</p>
</section>
</section>
</section>
<section id="animation" class="level2">
<h2 class="anchored" data-anchor-id="animation">Animation</h2>
<p>Pour mieux comprendre comment se déplace le système en fonction des paramètres :</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Technique pour utiliser une fenêtre geogebra:</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> IPython.display <span class="im">as</span> display</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>fig01 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;iframe width = "700" height = "550" src = "https://www.geogebra.org/classic/ajaycvqe" style = "overflow: hidden border: 1px solid black" scroll="no"&gt;&lt;/iframe&gt;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>display.HTML(fig01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">

<iframe width="700" height="550" src="https://www.geogebra.org/classic/ajaycvqe" style="overflow: hidden border: 1px solid black" scroll="no"></iframe>
</div>
</div>
</section>
<section id="inflation-et-déflation-du-système-en-fonction-de-la-migration" class="level2">
<h2 class="anchored" data-anchor-id="inflation-et-déflation-du-système-en-fonction-de-la-migration">Inflation et déflation du système en fonction de la migration</h2>
<p>Dans cette partie on va s’intéresser aux sommes des équilibres en fonction de <span class="math inline">\beta</span>.<br>
On a déja plus ou moins tracé les différents profils de courbe qu’on peut obtenir pour cette partie (quand on a vérifié les propositions de conditions d’inflation/déflation) mais il existe un quatrième profil de courbe.</p>
<p>On va utiliser les mêmes méthodes que précédemment :</p>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#On redéinit la même fonction:</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug2(etat, t, param, h):</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky <span class="op">=</span> param</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> h</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y <span class="op">-</span> x), </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x <span class="op">-</span> y)]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">## Temps d'intégration :</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">400</span>, <span class="fl">0.01</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres : </span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres de la condition b):</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1])</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres condition c.1): </span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2])</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres condition c.2): </span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="fl">0.6</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3])</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres nouveau profil: </span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>rx4 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>ry4 <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>Kx4 <span class="op">=</span> <span class="fl">0.5</span>  </span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>Ky4 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>param4 <span class="op">=</span> np.array([rx4, ry4, Kx4, Ky4])</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="co">## Condition initiale:</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>c10 <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">0</span>]</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="co">## On crée la figure et l'axe:</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>fig6, (ax7, ax8, ax9, ax10) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">5</span>))</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>ax7.set_title(<span class="st">"Déflation"</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>ax8.set_title(<span class="st">"Inflation"</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>ax9.set_title(<span class="st">"Les deux"</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>ax10.set_title(<span class="st">"Inflation"</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.45</span>) <span class="co">#On ajuste l'écart entre figures</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a><span class="co">## Boucle ou i prend les valeurs de beta:</span></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param1, i)) </span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>    ax7.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param2, i))</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>    ax8.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>    s3 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param3, i))</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>    ax9.plot(i, s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>    s4 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param4, i))</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>    ax10.plot(i, s4[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s4[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot de la droite Kx+Ky:</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>ax7.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>,markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>ax7.text(<span class="fl">2.5</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>ax8.plot(xt, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>ax8.text(<span class="fl">2.5</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>ax9.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>ax9.text(<span class="fl">2.5</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>ax10.plot(xt, (Kx4 <span class="op">+</span> Ky4) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>ax10.text(<span class="fl">2.5</span>, Kx4 <span class="op">+</span> Ky4 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a><span class="co">## Légendes:</span></span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>ax7.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>ax7.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>ax7.plot(Kx1 <span class="op">+</span> Ky1, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>) <span class="co">#Si on avait mis label dans la boucle la légende aurait été trop grande</span></span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>ax8.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>ax9.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>ax10.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a><span class="co">## On adapte la fenêtre:</span></span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>ax7.set_ylim(<span class="fl">2.4</span>, <span class="fl">3.1</span>)</span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>ax8.set_ylim(<span class="fl">2.95</span>, <span class="fl">3.15</span>)</span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a>ax9.set_ylim(<span class="fl">2.9</span>, <span class="fl">3.1</span>)</span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>ax10.set_ylim(<span class="fl">1.25</span>, <span class="fl">1.75</span>)</span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a>ax7.legend(bbox_to_anchor <span class="op">=</span> (<span class="fl">1.75</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="modelesansmigrationass_files/figure-html/cell-22-output-1.png" width="738" height="492"></p>
</div>
</div>
<p>On observe quatre profils différents. Les trois premiers ont déjà été obtenus précédemment.<br>
Le quatrième correspond à un système inflationiste où le maximum d’inflation est atteint pour <span class="math inline">\beta = +\infty</span> contrairement à l’autre profil d’inflation.</p>
<p>&nbsp;</p>
<p><a href="./modeleavecmigrationass.html">Passons</a> mainenant à un modèle qui prend en compte que les migrations peuvent êtres assymétriques.</p>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-arditi2015" class="csl-entry" role="listitem">
Arditi, Lobry, R. 2015. <span>“Is Dispersal Always Beneficial to Carrying Capacity ? New Insights from the Multi-Patch Logistic Equation.”</span> <em>Theor. Popul. Biol.</em> 106: 45–59.
</div>
<div id="ref-arditi2018" class="csl-entry" role="listitem">
———. 2018. <span>“Asymmetric Dispersal in the Multi-Patch Logistic Equation.”</span> <em>Theor. Popul. Biol.</em> 120: 11–15.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb22" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Modèle logistique structuré avec migration symétrique</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>*Modules à importer :*</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Définition du modèle</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>On pose le modèle suivant d'après @arditi2015 :</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>\dot x = r_xx\left(1-\frac{x}{K_x}\right)+\beta(y-x)<span class="sc">\\</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>\dot y = r_yy\left(1-\frac{y}{K_y}\right)+\beta(x-y).</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>$$ {#eq-modsmig}</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>avec :   </span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$x$ la population dans la première structure,  </span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$y$ la population dans la seconde structure,  </span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$r_x$ et $r_y$ le taux de croissance dans les deux structures,  </span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$K_x$ et $K_y$ les capacités de charge des deux structures,  </span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta$ la force de migration entre les structures.  </span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>Ce modèle est un modèle ressemblant peu à notre situation d'augmentorium car celui-ci est caractérisé par une migration assymétrique, il permet néanmoins de situer la démarche et les outils que nous allons utiliser pour étudier des modèles plus complexes.  </span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dynamique du modèle</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>On va tracer la dynamique de la population en fonction du temps pour se faire une première idée de comment se comporte la population.</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>On définit le modèle sous <span class="co">[</span><span class="ot">`Python`</span><span class="co">](https://www.python.org/)</span> :</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug(etat, t, param):</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky, b <span class="op">=</span> param</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [ rx <span class="op">*</span> x <span class="op">*</span> ( <span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx ) <span class="op">+</span> b <span class="op">*</span> ( y <span class="op">-</span> x ), </span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> ( <span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky ) <span class="op">+</span> b <span class="op">*</span> ( x <span class="op">-</span> y )]</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>On va utiliser <span class="in">`odeint`</span> de <span class="co">[</span><span class="ot">`Scipy`</span><span class="co">](https://scipy.org/)</span> afin de simuler une solution en fonction du temps. </span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>Il faut donc définir un temps d'intégration, des conditions initiales et les paramètres du modèle : </span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a><span class="co">## Temps d'intégration:</span></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>ti <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a><span class="co">## Etats initiaux:</span></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>e0 <span class="op">=</span> [x0 ,y0]</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres: </span></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>rx <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>ry <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>param_aug <span class="op">=</span> np.array([rx, ry, Kx, Ky, b])</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a><span class="co">## Simulation:</span></span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> odeint(aug, e0, ti, args <span class="op">=</span> (param_aug, ))</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>Maintenant qu'on a la simulation on peut réprésenter la figure avec <span class="co">[</span><span class="ot">`matplotlib`</span><span class="co">](https://matplotlib.org/)</span> :</span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize <span class="op">=</span> (<span class="dv">7</span>, <span class="dv">4</span> ))</span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Dynamique des ravageurs dans le temps'</span>)</span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[:, <span class="dv">0</span>], color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'culture'</span>)</span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a>ax.plot(ti, s[:, <span class="dv">1</span>], color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'augmentorium'</span>)</span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>ax.grid() <span class="co">#on ajoute la grille</span></span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a>ax.legend() <span class="co">#on ajoute la légende</span></span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Temps, t'</span>)<span class="op">;</span></span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Densité de pop.'</span>)<span class="op">;</span></span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a>Cette simulation nous montre une hausse de la population dans l'augmentorium et une baisse de la population dans la culture.  </span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a>Les deux populations atteignent un équilibre qui semble stable (il se maintient dans le temps).  </span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a>Dans le cas d'un augmentorium, on voit que le simple fait de débarasser les fruits et de les mettre dans un espace séparé de la culture ammène à une baisse de la population de ravageurs dans la culture.</span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plan de phase</span></span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a><span class="fu">### Equilibres et stabilités</span></span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a>Nous allons tracer le plan de phase associé à ce système pour voir les équilibres et leurs stabilités.</span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a>A l'équilibre on a par définition $\dot x = 0$ et $\dot y =0$ ce qui donne : </span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-113"><a href="#cb22-113" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb22-114"><a href="#cb22-114" aria-hidden="true" tabindex="-1"></a>0 = r_xx^*\left(1-\frac{x^*}{K_x}\right)+\beta(y^*-x^*) \Leftrightarrow  y^*=r_xx^*\left(\frac{1}{r_x}-\frac{1}{\beta}+\frac{x^*}{\beta K_x}\right)<span class="sc">\\</span></span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a>0 = r_yy^*\left(1-\frac{y^*}{K_y}\right)+\beta(x^*-y^*) \Leftrightarrow  x^*=r_yy^*\left(\frac{1}{r_y}-\frac{1}{\beta}+\frac{y^*}{\beta K_y}\right)</span>
<span id="cb22-116"><a href="#cb22-116" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a>$${#eq-pdpsmig}</span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a>avec $x^*$ et $y^*$ la valeur des équilibres.</span>
<span id="cb22-120"><a href="#cb22-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-121"><a href="#cb22-121" aria-hidden="true" tabindex="-1"></a>Ainsi, les deux isoclines correspondent à des paraboles. Celles-ci se croisent trivialement en $(0,0)$ et dans le quadrant positif en $(x^*,y^*)$. </span>
<span id="cb22-122"><a href="#cb22-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-123"><a href="#cb22-123" aria-hidden="true" tabindex="-1"></a>Pour calculer $(x^*,y^*)$ on va utiliser l'expression de $x^*$ trouvée en ([-@eq-pdpsmig]) qu'on va rentrer dans l'équation de $y^*$ :  </span>
<span id="cb22-124"><a href="#cb22-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-125"><a href="#cb22-125" aria-hidden="true" tabindex="-1"></a>Comme $x^* = r_yy^*\left(\frac{1}{r_y}-\frac{1}{\beta}+\frac{y^*}{\beta K_y}\right)$ on a :  </span>
<span id="cb22-126"><a href="#cb22-126" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-127"><a href="#cb22-127" aria-hidden="true" tabindex="-1"></a>y^* = r_x\left<span class="co">[</span><span class="ot">r_yy^*\left(\frac{1}{r_y}-\frac{1}{\beta}+\frac{y^*}{\beta K_y}\right)\right</span><span class="co">]</span>\left(\frac{1}{r_x}-\frac{1}{\beta}+\frac{r_yy^*\left(\frac{1}{r_y}-\frac{1}{\beta}+\frac{y^*}{\beta K_y}\right)}{\beta K_x}\right)</span>
<span id="cb22-128"><a href="#cb22-128" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-129"><a href="#cb22-129" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-130"><a href="#cb22-130" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-131"><a href="#cb22-131" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-132"><a href="#cb22-132" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-133"><a href="#cb22-133" aria-hidden="true" tabindex="-1"></a>y^* = y^* - \frac{r_yy^*}{\beta} + \frac{r_y{y^*}^2}{\beta K_y} - \frac{r_xy^*}{\beta} + \frac{r_xr_yy^*}{\beta^2} - \frac{r_xr_y{y^*}^2}{\beta^2 K_y} + <span class="sc">\\</span><span class="co">[</span><span class="ot">.2cm</span><span class="co">]</span></span>
<span id="cb22-134"><a href="#cb22-134" aria-hidden="true" tabindex="-1"></a>\frac{r_x{y^*}^2}{\beta K_x} - \frac{r_xr_y{y^*}^2}{\beta^2 K_x} + \frac{r_xr_y{y^*}^3}{\beta^2 K_xK_y} - \frac{r_xr_y{y^*}^2}{\beta^2 K_x} + <span class="sc">\\</span><span class="co">[</span><span class="ot">.2cm</span><span class="co">]</span> </span>
<span id="cb22-135"><a href="#cb22-135" aria-hidden="true" tabindex="-1"></a> \frac{r_xr_y^2{y^*}^2}{\beta^3 K_x} - \frac{r_xr_y^2{y^*}^3}{\beta^3 K_x K_y} + \frac{r_xr_y{y^*}^3}{\beta^2 K_xK_y} - <span class="sc">\\</span><span class="co">[</span><span class="ot">.2cm</span><span class="co">]</span></span>
<span id="cb22-136"><a href="#cb22-136" aria-hidden="true" tabindex="-1"></a> \frac{r_xr_y^2{y^*}^3}{\beta^3 K_xK_y} + \frac{r_xr_y^2{y^*}^4}{\beta^3K_xK_y^2} </span>
<span id="cb22-137"><a href="#cb22-137" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-138"><a href="#cb22-138" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-139"><a href="#cb22-139" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-140"><a href="#cb22-140" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-141"><a href="#cb22-141" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-142"><a href="#cb22-142" aria-hidden="true" tabindex="-1"></a>y^*\left(- \frac{r_y}{\beta} - \frac{r_x}{\beta} + \frac{r_xr_y}{\beta^2}\right) + <span class="sc">\\</span><span class="co">[</span><span class="ot">.2cm</span><span class="co">]</span></span>
<span id="cb22-143"><a href="#cb22-143" aria-hidden="true" tabindex="-1"></a>{y^*}^2\left(\frac{r_y}{\beta K_y} - \frac{r_xr_y}{\beta^2 K_y} + \frac{r_x}{\beta K_x} - 2\frac{r_xr_y}{\beta^2 K_x} + \frac{r_xr_y^2}{\beta^3 K_x} \right) + <span class="sc">\\</span><span class="co">[</span><span class="ot">.2cm</span><span class="co">]</span></span>
<span id="cb22-144"><a href="#cb22-144" aria-hidden="true" tabindex="-1"></a>2{y^*}^3\left( \frac{r_xr_y}{\beta^2 K_xK_y} - \frac{r_xr_y^2}{\beta^3 K_xK_y} \right) + </span>
<span id="cb22-145"><a href="#cb22-145" aria-hidden="true" tabindex="-1"></a>{y^*}^4 \frac{r_xr_y^2}{\beta^3K_xK_y^2} = 0</span>
<span id="cb22-146"><a href="#cb22-146" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-147"><a href="#cb22-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-148"><a href="#cb22-148" aria-hidden="true" tabindex="-1"></a>Ce qui donne après réarrangement : </span>
<span id="cb22-149"><a href="#cb22-149" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a>y^*\left(\frac{1}{\beta}\left<span class="co">[</span><span class="ot">\frac{r_xr_y}{\beta} - r_y -r_x\right</span><span class="co">]</span>\right)+ <span class="sc">\\</span><span class="co">[</span><span class="ot">.2cm</span><span class="co">]</span></span>
<span id="cb22-151"><a href="#cb22-151" aria-hidden="true" tabindex="-1"></a>{y^*}^2\left(\frac{r_y}{\beta K_y}\left<span class="co">[</span><span class="ot">1-\frac{r_x}{\beta}\right</span><span class="co">]</span>+\frac{r_x}{\beta K_x}\left<span class="co">[</span><span class="ot">1-2\frac{r_y}{\beta}+\frac{r_xr_y}{\beta^2}\right</span><span class="co">]</span>\right)+<span class="sc">\\</span><span class="co">[</span><span class="ot">.2cm</span><span class="co">]</span></span>
<span id="cb22-152"><a href="#cb22-152" aria-hidden="true" tabindex="-1"></a>2{y^*}^3\left(\frac{r_xr_y}{\beta^2 K_xK_y}\left<span class="co">[</span><span class="ot">1-\frac{r_y}{\beta}\right</span><span class="co">]</span>\right) + </span>
<span id="cb22-153"><a href="#cb22-153" aria-hidden="true" tabindex="-1"></a>{y^*}^4 \frac{r_xr_y^2}{\beta^3K_y^2K_x} = 0</span>
<span id="cb22-154"><a href="#cb22-154" aria-hidden="true" tabindex="-1"></a>$${#eq-polsmig}</span>
<span id="cb22-155"><a href="#cb22-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-156"><a href="#cb22-156" aria-hidden="true" tabindex="-1"></a>Ce polynôme est résoluble via <span class="co">[</span><span class="ot">`numpy`</span><span class="co">](https://numpy.org/)</span> pour obtenir $y^*$:</span>
<span id="cb22-157"><a href="#cb22-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-160"><a href="#cb22-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-161"><a href="#cb22-161" aria-hidden="true" tabindex="-1"></a><span class="co">## On défnit un monome y, un polynôme p et on prend ses solutions:</span></span>
<span id="cb22-162"><a href="#cb22-162" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.polynomial.Polynomial([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb22-163"><a href="#cb22-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-164"><a href="#cb22-164" aria-hidden="true" tabindex="-1"></a>pol <span class="op">=</span> y <span class="op">*</span> (rx <span class="op">*</span> ry <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>b) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>rx) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>ry)) <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>(rx <span class="op">*</span> ry)) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb22-165"><a href="#cb22-165" aria-hidden="true" tabindex="-1"></a>(y<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> ((rx<span class="op">*</span>ry)<span class="op">/</span>b) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>Ky) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>rx) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>b)) <span class="op">+</span> (<span class="dv">1</span><span class="op">/</span>Kx) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>ry) <span class="op">-</span> (<span class="dv">2</span><span class="op">/</span>b) <span class="op">+</span> (ry<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span>)))) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb22-166"><a href="#cb22-166" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">*</span> (y<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> ((rx <span class="op">*</span> ry)<span class="op">/</span>((b<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> Kx <span class="op">*</span> Ky)) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> (ry<span class="op">/</span>b)) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb22-167"><a href="#cb22-167" aria-hidden="true" tabindex="-1"></a>(y<span class="op">**</span><span class="dv">4</span>) <span class="op">*</span> ((rx <span class="op">*</span> (ry<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>((b<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> (Ky<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> Kx))</span>
<span id="cb22-168"><a href="#cb22-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-169"><a href="#cb22-169" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution qu'on obtient avec un masque booléen qui sélectionne les racines réelles et strictement positives:</span></span>
<span id="cb22-170"><a href="#cb22-170" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> pol.roots()[ (np.isreal( pol.roots() )) <span class="op">*</span> (pol.roots() <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb22-171"><a href="#cb22-171" aria-hidden="true" tabindex="-1"></a>yeq<span class="op">=</span>sol[<span class="dv">0</span>].real</span>
<span id="cb22-172"><a href="#cb22-172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-173"><a href="#cb22-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-174"><a href="#cb22-174" aria-hidden="true" tabindex="-1"></a>On déduit $x^*$ via sa définition par le système <span class="co">[</span><span class="ot">(-@eq-pdpsmig)</span><span class="co">]</span>:</span>
<span id="cb22-175"><a href="#cb22-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-178"><a href="#cb22-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-179"><a href="#cb22-179" aria-hidden="true" tabindex="-1"></a>xeq <span class="op">=</span> (ry <span class="op">*</span> yeq <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>ry) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">+</span> (yeq<span class="op">/</span>(b <span class="op">*</span> Ky)))).real</span>
<span id="cb22-180"><a href="#cb22-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-181"><a href="#cb22-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-182"><a href="#cb22-182" aria-hidden="true" tabindex="-1"></a>Avec la valeur des équilibres on va maintenant tracer le plan de phase : </span>
<span id="cb22-183"><a href="#cb22-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-186"><a href="#cb22-186" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-187"><a href="#cb22-187" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb22-188"><a href="#cb22-188" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Plan de phase du système'</span>)</span>
<span id="cb22-189"><a href="#cb22-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-190"><a href="#cb22-190" aria-hidden="true" tabindex="-1"></a><span class="co">## Isocline nulles:</span></span>
<span id="cb22-191"><a href="#cb22-191" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-192"><a href="#cb22-192" aria-hidden="true" tabindex="-1"></a><span class="co">## Pour xdot = 0:</span></span>
<span id="cb22-193"><a href="#cb22-193" aria-hidden="true" tabindex="-1"></a>ax.plot(xt,xt <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> (rx <span class="op">*</span> ((xt<span class="op">/</span>Kx) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> b), </span>
<span id="cb22-194"><a href="#cb22-194" aria-hidden="true" tabindex="-1"></a>                    color <span class="op">=</span> <span class="st">'C2'</span>, label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb22-195"><a href="#cb22-195" aria-hidden="true" tabindex="-1"></a>ax.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb22-196"><a href="#cb22-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-197"><a href="#cb22-197" aria-hidden="true" tabindex="-1"></a><span class="co">## Pour ydot = 0:</span></span>
<span id="cb22-198"><a href="#cb22-198" aria-hidden="true" tabindex="-1"></a>ax.plot(xt <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> (ry <span class="op">*</span> ((xt<span class="op">/</span>Ky) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> b), xt,</span>
<span id="cb22-199"><a href="#cb22-199" aria-hidden="true" tabindex="-1"></a>                    color <span class="op">=</span> <span class="st">'C3'</span>, label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb22-200"><a href="#cb22-200" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb22-201"><a href="#cb22-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-202"><a href="#cb22-202" aria-hidden="true" tabindex="-1"></a><span class="co">## On réduit la vue à ce qui nous intéresse:</span></span>
<span id="cb22-203"><a href="#cb22-203" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span>, right <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb22-204"><a href="#cb22-204" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(top <span class="op">=</span> <span class="dv">3</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span>)</span>
<span id="cb22-205"><a href="#cb22-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-206"><a href="#cb22-206" aria-hidden="true" tabindex="-1"></a><span class="co">## On trace la droite la somme des capacités:</span></span>
<span id="cb22-207"><a href="#cb22-207" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-208"><a href="#cb22-208" aria-hidden="true" tabindex="-1"></a>ax.plot(x, <span class="op">-</span>x <span class="op">+</span> Kx <span class="op">+</span> Ky, label <span class="op">=</span> <span class="st">'$K_x+K_y$'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>)</span>
<span id="cb22-209"><a href="#cb22-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-210"><a href="#cb22-210" aria-hidden="true" tabindex="-1"></a><span class="co">## On nomme les axes:</span></span>
<span id="cb22-211"><a href="#cb22-211" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'$x$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>) <span class="op">;</span></span>
<span id="cb22-212"><a href="#cb22-212" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'$y$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>) <span class="op">;</span></span>
<span id="cb22-213"><a href="#cb22-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-214"><a href="#cb22-214" aria-hidden="true" tabindex="-1"></a><span class="co">## On plot les deux équilibres:</span></span>
<span id="cb22-215"><a href="#cb22-215" aria-hidden="true" tabindex="-1"></a>ax.plot(xeq.real, yeq.real, label <span class="op">=</span> <span class="st">'$(x^*,y^*)$'</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">6</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb22-216"><a href="#cb22-216" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, label <span class="op">=</span> <span class="st">'$(0,0)$'</span>,</span>
<span id="cb22-217"><a href="#cb22-217" aria-hidden="true" tabindex="-1"></a>                    marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">6</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb22-218"><a href="#cb22-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-219"><a href="#cb22-219" aria-hidden="true" tabindex="-1"></a><span class="co">## Localisation de la légende:</span></span>
<span id="cb22-220"><a href="#cb22-220" aria-hidden="true" tabindex="-1"></a>ax.legend(loc <span class="op">=</span> <span class="st">'upper left'</span>)</span>
<span id="cb22-221"><a href="#cb22-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-222"><a href="#cb22-222" aria-hidden="true" tabindex="-1"></a><span class="co">## Ajout du champ de vecteur via la fonction quiver :</span></span>
<span id="cb22-223"><a href="#cb22-223" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.6</span>)</span>
<span id="cb22-224"><a href="#cb22-224" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.6</span>)</span>
<span id="cb22-225"><a href="#cb22-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-226"><a href="#cb22-226" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb22-227"><a href="#cb22-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-228"><a href="#cb22-228" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug)</span>
<span id="cb22-229"><a href="#cb22-229" aria-hidden="true" tabindex="-1"></a>ax.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, </span>
<span id="cb22-230"><a href="#cb22-230" aria-hidden="true" tabindex="-1"></a>                    color <span class="op">=</span> <span class="st">'grey'</span>, scale <span class="op">=</span> <span class="dv">80</span>, width <span class="op">=</span> <span class="fl">0.003</span>)<span class="op">;</span></span>
<span id="cb22-231"><a href="#cb22-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-232"><a href="#cb22-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-233"><a href="#cb22-233" aria-hidden="true" tabindex="-1"></a>Comme dit plus haut on a bien un croisement dans le quadrant positif qui correspond à l'équilibre $(x^*,y^*)$. </span>
<span id="cb22-234"><a href="#cb22-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-235"><a href="#cb22-235" aria-hidden="true" tabindex="-1"></a>Les paraboles, en fonction des valeurs de leurs racines, peuvent croiser de différentes manières les axes des abssices et des ordonnées.  </span>
<span id="cb22-236"><a href="#cb22-236" aria-hidden="true" tabindex="-1"></a>Le plan de phase peut donc présenter plusieurs profils, autre que </span>
<span id="cb22-237"><a href="#cb22-237" aria-hidden="true" tabindex="-1"></a>celui tracé ici. Néanmoins, le croisement des paraboles dans le quadrant positif (l'équilibre non nul) est toujours présent quelque soit le profil.</span>
<span id="cb22-238"><a href="#cb22-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-239"><a href="#cb22-239" aria-hidden="true" tabindex="-1"></a>En faisant apparaître le champ de vecteur on peut déduire que l'équilibre en $(0,0)$ est instable et l'équilibre en $(x^*,y^*)$ est stable.</span>
<span id="cb22-240"><a href="#cb22-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-241"><a href="#cb22-241" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Stabilité mathématique des équilibres</span></span>
<span id="cb22-242"><a href="#cb22-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-243"><a href="#cb22-243" aria-hidden="true" tabindex="-1"></a>Il est clair que $(0,0)$ est instable et $(x^*,y^*)$ est stable (par le champ de vecteur).  </span>
<span id="cb22-244"><a href="#cb22-244" aria-hidden="true" tabindex="-1"></a>Mathématiquement considérons la jacobienne de (<span class="co">[</span><span class="ot">-@eq-modsmig</span><span class="co">]</span>): </span>
<span id="cb22-245"><a href="#cb22-245" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb22-246"><a href="#cb22-246" aria-hidden="true" tabindex="-1"></a>\mathbb{J}=\begin{pmatrix}</span>
<span id="cb22-247"><a href="#cb22-247" aria-hidden="true" tabindex="-1"></a>\ r_x-\frac{2r_xx}{K_x}-\beta &amp; \beta <span class="sc">\\</span></span>
<span id="cb22-248"><a href="#cb22-248" aria-hidden="true" tabindex="-1"></a>\ \beta &amp; r_y -\frac{2r_yy}{K_y}-\beta</span>
<span id="cb22-249"><a href="#cb22-249" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb22-250"><a href="#cb22-250" aria-hidden="true" tabindex="-1"></a>$${#eq-jacob}</span>
<span id="cb22-251"><a href="#cb22-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-252"><a href="#cb22-252" aria-hidden="true" tabindex="-1"></a>et donc **pour $(0,0)$**:  </span>
<span id="cb22-253"><a href="#cb22-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-254"><a href="#cb22-254" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-255"><a href="#cb22-255" aria-hidden="true" tabindex="-1"></a>\mathbb{J_{\vec{0}}}=\begin{pmatrix}</span>
<span id="cb22-256"><a href="#cb22-256" aria-hidden="true" tabindex="-1"></a>\ r_x-\beta &amp; \beta <span class="sc">\\</span></span>
<span id="cb22-257"><a href="#cb22-257" aria-hidden="true" tabindex="-1"></a>\ \beta &amp; r_y -\beta</span>
<span id="cb22-258"><a href="#cb22-258" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb22-259"><a href="#cb22-259" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-260"><a href="#cb22-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-261"><a href="#cb22-261" aria-hidden="true" tabindex="-1"></a>Les valeurs propres $\lambda _1$ et $\lambda _2$ de cette matrice sont les solutions du polynôme caractéristique définit par : </span>
<span id="cb22-262"><a href="#cb22-262" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-263"><a href="#cb22-263" aria-hidden="true" tabindex="-1"></a>\begin{vmatrix}</span>
<span id="cb22-264"><a href="#cb22-264" aria-hidden="true" tabindex="-1"></a>r_x-\beta-\lambda &amp; \beta <span class="sc">\\</span></span>
<span id="cb22-265"><a href="#cb22-265" aria-hidden="true" tabindex="-1"></a>\beta &amp; r_y -\beta -\lambda \</span>
<span id="cb22-266"><a href="#cb22-266" aria-hidden="true" tabindex="-1"></a>\end{vmatrix} = 0</span>
<span id="cb22-267"><a href="#cb22-267" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-268"><a href="#cb22-268" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-269"><a href="#cb22-269" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-270"><a href="#cb22-270" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-271"><a href="#cb22-271" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-272"><a href="#cb22-272" aria-hidden="true" tabindex="-1"></a>(r_x-\beta-\lambda)(r_y-\beta - \lambda) - \beta^2 = 0</span>
<span id="cb22-273"><a href="#cb22-273" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-274"><a href="#cb22-274" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-275"><a href="#cb22-275" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-276"><a href="#cb22-276" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-277"><a href="#cb22-277" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-278"><a href="#cb22-278" aria-hidden="true" tabindex="-1"></a>\lambda^2 + \lambda\left(2\beta - r_x - r_y\right) + r_xr_y - \beta(r_x+r_y) = 0</span>
<span id="cb22-279"><a href="#cb22-279" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-280"><a href="#cb22-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-281"><a href="#cb22-281" aria-hidden="true" tabindex="-1"></a>Le discriminant $\Lambda$ est donc définit par :  </span>
<span id="cb22-282"><a href="#cb22-282" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-283"><a href="#cb22-283" aria-hidden="true" tabindex="-1"></a>\Lambda = \left(2\beta - r_x - r_y\right)^2 - 4(r_xr_y - \beta<span class="co">[</span><span class="ot">r_x+r_y</span><span class="co">]</span>) <span class="sc">\\</span></span>
<span id="cb22-284"><a href="#cb22-284" aria-hidden="true" tabindex="-1"></a>= 4\beta^2 -4\beta(r_x +r_y) + r_x^2 +r_y^2 +2r_xr_y -4r_xr_y +4\beta(r_x +r_y) <span class="sc">\\</span> = 4\beta^2 + (r_x-r_y)^2</span>
<span id="cb22-285"><a href="#cb22-285" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-286"><a href="#cb22-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-287"><a href="#cb22-287" aria-hidden="true" tabindex="-1"></a>Et donc le spectre $\sigma$ de la jacobienne est :  </span>
<span id="cb22-288"><a href="#cb22-288" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-289"><a href="#cb22-289" aria-hidden="true" tabindex="-1"></a>\sigma_\mathbb{J} = \left(\lambda_1 = \frac{r_x+r_y-2\beta-2\beta \sqrt{\frac{(r_x-r_y)^2}{4\beta^2}+1}}{2},\lambda_2=\frac{r_x+r_y-2\beta+2\beta \sqrt{\frac{(r_x-r_y)^2}{4\beta^2}+1}}{2}\right)</span>
<span id="cb22-290"><a href="#cb22-290" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-291"><a href="#cb22-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-292"><a href="#cb22-292" aria-hidden="true" tabindex="-1"></a>et on a ainsi,</span>
<span id="cb22-293"><a href="#cb22-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-294"><a href="#cb22-294" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-295"><a href="#cb22-295" aria-hidden="true" tabindex="-1"></a>\lambda_2 &gt; 0</span>
<span id="cb22-296"><a href="#cb22-296" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-297"><a href="#cb22-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-298"><a href="#cb22-298" aria-hidden="true" tabindex="-1"></a>Donc $(0,0)$ est bien instable.  </span>
<span id="cb22-299"><a href="#cb22-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-300"><a href="#cb22-300" aria-hidden="true" tabindex="-1"></a>**Pour $(x^*,y^*)$** on a :</span>
<span id="cb22-301"><a href="#cb22-301" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb22-302"><a href="#cb22-302" aria-hidden="true" tabindex="-1"></a>\mathbb{J_{x^*,y^*}}=\begin{pmatrix}</span>
<span id="cb22-303"><a href="#cb22-303" aria-hidden="true" tabindex="-1"></a>\ r_x-\frac{2r_xx^*}{K_x}-\beta &amp; \beta <span class="sc">\\</span></span>
<span id="cb22-304"><a href="#cb22-304" aria-hidden="true" tabindex="-1"></a>\ \beta &amp; r_y -\frac{2r_yy^*}{K_y}-\beta</span>
<span id="cb22-305"><a href="#cb22-305" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb22-306"><a href="#cb22-306" aria-hidden="true" tabindex="-1"></a>$${#eq-jacob}</span>
<span id="cb22-307"><a href="#cb22-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-308"><a href="#cb22-308" aria-hidden="true" tabindex="-1"></a>or, on a aussi d'après (<span class="co">[</span><span class="ot">-@eq-pdpsmig</span><span class="co">]</span>) : </span>
<span id="cb22-309"><a href="#cb22-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-310"><a href="#cb22-310" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-311"><a href="#cb22-311" aria-hidden="true" tabindex="-1"></a>\left<span class="sc">\{</span>\begin{array}{l}</span>
<span id="cb22-312"><a href="#cb22-312" aria-hidden="true" tabindex="-1"></a>\frac{y^*\beta}{x^*} = \beta - r_x + \frac{r_xx^*}{K_x}   <span class="sc">\\</span></span>
<span id="cb22-313"><a href="#cb22-313" aria-hidden="true" tabindex="-1"></a>\frac{x^*\beta}{y^*} = \beta - r_y + \frac{r_yy^*}{K_y}  </span>
<span id="cb22-314"><a href="#cb22-314" aria-hidden="true" tabindex="-1"></a>\end{array}\right.</span>
<span id="cb22-315"><a href="#cb22-315" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-316"><a href="#cb22-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-317"><a href="#cb22-317" aria-hidden="true" tabindex="-1"></a>ce qui simplifie la jacobienne en $(x^*,y^*)$ à l'expression suivante :</span>
<span id="cb22-318"><a href="#cb22-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-319"><a href="#cb22-319" aria-hidden="true" tabindex="-1"></a>$$ \mathbb{J_{x^*,y^*}} = \begin{pmatrix}</span>
<span id="cb22-320"><a href="#cb22-320" aria-hidden="true" tabindex="-1"></a>\ -\frac{\beta y^*}{x^*}-\frac{r_xx^*}{K_x} &amp; \beta <span class="sc">\\</span></span>
<span id="cb22-321"><a href="#cb22-321" aria-hidden="true" tabindex="-1"></a>\ \beta &amp; -\frac{\beta x^*}{y^*}-\frac{r_yy^*}{K_y}</span>
<span id="cb22-322"><a href="#cb22-322" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb22-323"><a href="#cb22-323" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-324"><a href="#cb22-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-325"><a href="#cb22-325" aria-hidden="true" tabindex="-1"></a>Il est alors facile de vérifier que la trace de cette matrice est négative.  </span>
<span id="cb22-326"><a href="#cb22-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-327"><a href="#cb22-327" aria-hidden="true" tabindex="-1"></a>Le déterminant quant à lui est donné par : </span>
<span id="cb22-328"><a href="#cb22-328" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-329"><a href="#cb22-329" aria-hidden="true" tabindex="-1"></a>\alpha = \left(\frac{\beta y^*}{x^*}+\frac{r_xx^*}{K_x}\right)\left(\frac{\beta x^*}{y^*}+\frac{r_yy^*}{K_y}\right) - \beta^2 <span class="sc">\\</span></span>
<span id="cb22-330"><a href="#cb22-330" aria-hidden="true" tabindex="-1"></a>= \frac{\beta r_y{y^*}^2}{x^*K_y} + \frac{\beta r_x {x^*}^2}{y^*K_x} + \frac{r_xr_yx^*y^*}{K_xK_y} &gt; 0</span>
<span id="cb22-331"><a href="#cb22-331" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-332"><a href="#cb22-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-333"><a href="#cb22-333" aria-hidden="true" tabindex="-1"></a>Le déterminant est lui positif, d'après la classification des portaits de plan de phase dans $\mathbb{R}^2$ on a que $(x^*,y^*)$ est stable.</span>
<span id="cb22-334"><a href="#cb22-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-335"><a href="#cb22-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-336"><a href="#cb22-336" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analyse du plan de phase</span></span>
<span id="cb22-337"><a href="#cb22-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-338"><a href="#cb22-338" aria-hidden="true" tabindex="-1"></a>On remarque sur le plan de phase du système tracé précédemment que l'équilibre atteint n'est pas sur la droite $x^*+y^*=K_x+K_y$ (en gris), on appellera cette droite $d$.  </span>
<span id="cb22-339"><a href="#cb22-339" aria-hidden="true" tabindex="-1"></a>Si le croisement des isoclines est au dessus de cette droite le système (<span class="co">[</span><span class="ot">-@eq-modsmig</span><span class="co">]</span>) subit une inflation et si le croisement est en dessous de cette droite il subit une déflation (voir <span class="co">[</span><span class="ot">contexte</span><span class="co">](contexte.qmd)</span>).  </span>
<span id="cb22-340"><a href="#cb22-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-341"><a href="#cb22-341" aria-hidden="true" tabindex="-1"></a>On voit que la structuration de l'espace, et les migrations qui en découle, perturbent les équilibres qui auraient dû être la somme des équilires des deux régions (la logistique tend vers la capacité maximale à l'équilibre).   </span>
<span id="cb22-342"><a href="#cb22-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-343"><a href="#cb22-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-344"><a href="#cb22-344" aria-hidden="true" tabindex="-1"></a>Plus généralement, on peut montrer qu'en cas de mixité parfaite entre les deux structures ($\beta \to \infty$) on a d'après @arditi2015:</span>
<span id="cb22-345"><a href="#cb22-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-346"><a href="#cb22-346" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-347"><a href="#cb22-347" aria-hidden="true" tabindex="-1"></a>x^*+y^* = K_x + K_y + (K_x-K_y)\frac{r_xK_y-r_yK_x}{r_xK_y+r_yK_x}</span>
<span id="cb22-348"><a href="#cb22-348" aria-hidden="true" tabindex="-1"></a>$${#eq-inf}</span>
<span id="cb22-349"><a href="#cb22-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-350"><a href="#cb22-350" aria-hidden="true" tabindex="-1"></a>Ce qui montre qu'en général on a pas $x^*+y^* = K_x + K_x$.  </span>
<span id="cb22-351"><a href="#cb22-351" aria-hidden="true" tabindex="-1"></a>De plus par (<span class="co">[</span><span class="ot">-@eq-inf</span><span class="co">]</span>), si $K_y&lt;K_x$ et si $r_xK_y&lt;r_yK_x$ alors $x^*+y^* &lt; K_x+K_y$ ce qui nous intéresse particulièrement pour la lutte biologique.  </span>
<span id="cb22-352"><a href="#cb22-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-353"><a href="#cb22-353" aria-hidden="true" tabindex="-1"></a>Ensuite, en faisant $\dot x + \dot y = 0$, dans le cas de l'équilibre, on a:</span>
<span id="cb22-354"><a href="#cb22-354" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb22-355"><a href="#cb22-355" aria-hidden="true" tabindex="-1"></a>r_xx^*\left(1-\frac{x^*}{K_x}\right)+r_yy^*\left(1-\frac{y^*}{K_y}\right) = 0 </span>
<span id="cb22-356"><a href="#cb22-356" aria-hidden="true" tabindex="-1"></a>$${#eq-ell}</span>
<span id="cb22-357"><a href="#cb22-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-358"><a href="#cb22-358" aria-hidden="true" tabindex="-1"></a>Autrement dit les points d'équilibres vivent sur une ellipse (si on ne modifie que $\beta$ ), qu'on va tracer avec <span class="in">`contour`</span> :</span>
<span id="cb22-359"><a href="#cb22-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-362"><a href="#cb22-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-363"><a href="#cb22-363" aria-hidden="true" tabindex="-1"></a>xg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-364"><a href="#cb22-364" aria-hidden="true" tabindex="-1"></a>yg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-365"><a href="#cb22-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-366"><a href="#cb22-366" aria-hidden="true" tabindex="-1"></a>X2, Y2 <span class="op">=</span> np.meshgrid(xg2, yg2)</span>
<span id="cb22-367"><a href="#cb22-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-368"><a href="#cb22-368" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> rx <span class="op">*</span> X2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> X2<span class="op">/</span>Kx)</span>
<span id="cb22-369"><a href="#cb22-369" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> ry <span class="op">*</span> Y2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> Y2<span class="op">/</span>Ky)</span>
<span id="cb22-370"><a href="#cb22-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-371"><a href="#cb22-371" aria-hidden="true" tabindex="-1"></a>ax.contour(X2, Y2, (X <span class="op">+</span> Y), [<span class="dv">0</span>], colors <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb22-372"><a href="#cb22-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-373"><a href="#cb22-373" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'Ellipse des solutions'</span>)</span>
<span id="cb22-374"><a href="#cb22-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-375"><a href="#cb22-375" aria-hidden="true" tabindex="-1"></a><span class="co">## Localisation de la légende:</span></span>
<span id="cb22-376"><a href="#cb22-376" aria-hidden="true" tabindex="-1"></a>ax.legend(loc <span class="op">=</span> <span class="st">'upper left'</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb22-377"><a href="#cb22-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-378"><a href="#cb22-378" aria-hidden="true" tabindex="-1"></a><span class="co">## On place les différents points d'intérêts...</span></span>
<span id="cb22-379"><a href="#cb22-379" aria-hidden="true" tabindex="-1"></a>xv <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb22-380"><a href="#cb22-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-381"><a href="#cb22-381" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="dv">0</span>, Ky, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">7</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb22-382"><a href="#cb22-382" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx, <span class="dv">0</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">7</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb22-383"><a href="#cb22-383" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx, Ky, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">6</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb22-384"><a href="#cb22-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-385"><a href="#cb22-385" aria-hidden="true" tabindex="-1"></a><span class="co">##...et on les relie aux axes:</span></span>
<span id="cb22-386"><a href="#cb22-386" aria-hidden="true" tabindex="-1"></a>xc <span class="op">=</span> np.arange(<span class="dv">0</span>, Kx, <span class="fl">0.01</span>)</span>
<span id="cb22-387"><a href="#cb22-387" aria-hidden="true" tabindex="-1"></a>ax.plot(xc, Ky <span class="op">*</span> np.ones_like(xc), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb22-388"><a href="#cb22-388" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb22-389"><a href="#cb22-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-390"><a href="#cb22-390" aria-hidden="true" tabindex="-1"></a>yc<span class="op">=</span>np.arange(<span class="dv">0</span>,Ky,<span class="fl">0.01</span>)</span>
<span id="cb22-391"><a href="#cb22-391" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx <span class="op">*</span> np.ones_like(yc), yc, linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb22-392"><a href="#cb22-392" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb22-393"><a href="#cb22-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-394"><a href="#cb22-394" aria-hidden="true" tabindex="-1"></a><span class="co">#On nomme les points:</span></span>
<span id="cb22-395"><a href="#cb22-395" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="op">-</span><span class="fl">0.2</span>, Ky, <span class="st">'$K_y$'</span>)</span>
<span id="cb22-396"><a href="#cb22-396" aria-hidden="true" tabindex="-1"></a>ax.text(Kx, <span class="op">-</span><span class="fl">0.2</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb22-397"><a href="#cb22-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-398"><a href="#cb22-398" aria-hidden="true" tabindex="-1"></a><span class="co">#On place les points d'équilibres :</span></span>
<span id="cb22-399"><a href="#cb22-399" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.arange(<span class="dv">0</span>, yeq, <span class="fl">0.01</span>)</span>
<span id="cb22-400"><a href="#cb22-400" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.arange(<span class="dv">0</span>, xeq, <span class="fl">0.01</span>)</span>
<span id="cb22-401"><a href="#cb22-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-402"><a href="#cb22-402" aria-hidden="true" tabindex="-1"></a>ax.plot(xeq <span class="op">*</span> np.ones_like(ys), ys, linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb22-403"><a href="#cb22-403" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb22-404"><a href="#cb22-404" aria-hidden="true" tabindex="-1"></a>ax.plot(xs, yeq <span class="op">*</span> np.ones_like(xs), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb22-405"><a href="#cb22-405" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb22-406"><a href="#cb22-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-407"><a href="#cb22-407" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="op">-</span><span class="fl">0.2</span>, yeq, <span class="st">'$y^*$'</span>)</span>
<span id="cb22-408"><a href="#cb22-408" aria-hidden="true" tabindex="-1"></a>ax.text(xeq, <span class="op">-</span><span class="fl">0.2</span>, <span class="st">'$x^*$'</span>)</span>
<span id="cb22-409"><a href="#cb22-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-410"><a href="#cb22-410" aria-hidden="true" tabindex="-1"></a>display(fig)</span>
<span id="cb22-411"><a href="#cb22-411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-412"><a href="#cb22-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-413"><a href="#cb22-413" aria-hidden="true" tabindex="-1"></a>Les conditions d'inflations et de déflations suivantes proviennent de l'article d'@arditi2018.</span>
<span id="cb22-414"><a href="#cb22-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-415"><a href="#cb22-415" aria-hidden="true" tabindex="-1"></a><span class="fu">#### a) Première condition à un système déflationiste </span></span>
<span id="cb22-416"><a href="#cb22-416" aria-hidden="true" tabindex="-1"></a>On remarque que le point $(K_x,K_y)$ est en permanence sur la droite $d$ qui coupe en permanence l'ellipse (en deux points) sauf pour une situation où $d$ est tangente à l'ellipse.  </span>
<span id="cb22-417"><a href="#cb22-417" aria-hidden="true" tabindex="-1"></a>Ce cas nous intéresse car il rend compte d'un système entièrement déflationiste. Représentons le sur le plan de phase :</span>
<span id="cb22-418"><a href="#cb22-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-419"><a href="#cb22-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-420"><a href="#cb22-420" aria-hidden="true" tabindex="-1"></a>On redéfinit les paramètres pour être dans le cas qui nous intéresse :</span>
<span id="cb22-423"><a href="#cb22-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-424"><a href="#cb22-424" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres: </span></span>
<span id="cb22-425"><a href="#cb22-425" aria-hidden="true" tabindex="-1"></a>rxnew <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb22-426"><a href="#cb22-426" aria-hidden="true" tabindex="-1"></a>rynew <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb22-427"><a href="#cb22-427" aria-hidden="true" tabindex="-1"></a>Kx <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb22-428"><a href="#cb22-428" aria-hidden="true" tabindex="-1"></a>Ky <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-429"><a href="#cb22-429" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-430"><a href="#cb22-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-431"><a href="#cb22-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-432"><a href="#cb22-432" aria-hidden="true" tabindex="-1"></a>Et on trace de la même manière que précédemment le plan de phase :</span>
<span id="cb22-433"><a href="#cb22-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-436"><a href="#cb22-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-437"><a href="#cb22-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb22-438"><a href="#cb22-438" aria-hidden="true" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb22-439"><a href="#cb22-439" aria-hidden="true" tabindex="-1"></a>fig2.suptitle(<span class="st">'Plan de phase du système'</span>)</span>
<span id="cb22-440"><a href="#cb22-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-441"><a href="#cb22-441" aria-hidden="true" tabindex="-1"></a><span class="co">## Isocline nulles:</span></span>
<span id="cb22-442"><a href="#cb22-442" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-443"><a href="#cb22-443" aria-hidden="true" tabindex="-1"></a><span class="co">## Pour xdot = 0:</span></span>
<span id="cb22-444"><a href="#cb22-444" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt,xt <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> (rxnew <span class="op">*</span> ((xt<span class="op">/</span>Kx) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> b), color <span class="op">=</span> <span class="st">'C2'</span>, </span>
<span id="cb22-445"><a href="#cb22-445" aria-hidden="true" tabindex="-1"></a>                label <span class="op">=</span> <span class="st">'$\dot x=0$'</span>)</span>
<span id="cb22-446"><a href="#cb22-446" aria-hidden="true" tabindex="-1"></a>ax2.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb22-447"><a href="#cb22-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-448"><a href="#cb22-448" aria-hidden="true" tabindex="-1"></a><span class="co">## Pour ydot = 0:</span></span>
<span id="cb22-449"><a href="#cb22-449" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> (rynew <span class="op">*</span> ((xt<span class="op">/</span>Ky) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> b), xt, color <span class="op">=</span> <span class="st">'C3'</span>, </span>
<span id="cb22-450"><a href="#cb22-450" aria-hidden="true" tabindex="-1"></a>                label <span class="op">=</span> <span class="st">'$\dot y=0$'</span>)</span>
<span id="cb22-451"><a href="#cb22-451" aria-hidden="true" tabindex="-1"></a>ax2.plot(xt, np.zeros_like(xt), color <span class="op">=</span> <span class="st">'0.8'</span>, markersize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb22-452"><a href="#cb22-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-453"><a href="#cb22-453" aria-hidden="true" tabindex="-1"></a><span class="co">## On réduit la vue à ce qui nous intéresse:</span></span>
<span id="cb22-454"><a href="#cb22-454" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(left <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span>, right <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb22-455"><a href="#cb22-455" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(top <span class="op">=</span> <span class="dv">3</span>, bottom <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span>)</span>
<span id="cb22-456"><a href="#cb22-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-457"><a href="#cb22-457" aria-hidden="true" tabindex="-1"></a><span class="co">## On trace la droite la somme des capacités:</span></span>
<span id="cb22-458"><a href="#cb22-458" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-459"><a href="#cb22-459" aria-hidden="true" tabindex="-1"></a>ax2.plot(x, <span class="op">-</span>x <span class="op">+</span> Kx <span class="op">+</span> Ky, label <span class="op">=</span> <span class="st">'$K_x+K_y$'</span>, color <span class="op">=</span> <span class="st">'0.8'</span>)</span>
<span id="cb22-460"><a href="#cb22-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-461"><a href="#cb22-461" aria-hidden="true" tabindex="-1"></a><span class="co">## On nomme les axes:</span></span>
<span id="cb22-462"><a href="#cb22-462" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'$x$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>) <span class="op">;</span></span>
<span id="cb22-463"><a href="#cb22-463" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'$y$'</span>, fontsize <span class="op">=</span> <span class="st">'12'</span>) <span class="op">;</span></span>
<span id="cb22-464"><a href="#cb22-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-465"><a href="#cb22-465" aria-hidden="true" tabindex="-1"></a><span class="co">## On recalcule les équilibres avec les nouveaux paramètres:</span></span>
<span id="cb22-466"><a href="#cb22-466" aria-hidden="true" tabindex="-1"></a><span class="co">## On défnit un monome y, un polynôme p et on prend ses solutions:</span></span>
<span id="cb22-467"><a href="#cb22-467" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.polynomial.Polynomial([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb22-468"><a href="#cb22-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-469"><a href="#cb22-469" aria-hidden="true" tabindex="-1"></a>pol2 <span class="op">=</span> y <span class="op">*</span> (rxnew <span class="op">*</span> rynew <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>b) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>b) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>rxnew) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>rynew)) <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>(rxnew <span class="op">*</span> rynew)) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb22-470"><a href="#cb22-470" aria-hidden="true" tabindex="-1"></a>(y<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> ((rxnew<span class="op">*</span>rynew)<span class="op">/</span>b) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>Ky) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>rxnew) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>b)) <span class="op">+</span> (<span class="dv">1</span><span class="op">/</span>Kx) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>rynew) <span class="op">-</span> (<span class="dv">2</span><span class="op">/</span>b) <span class="op">+</span> (rynew<span class="op">/</span>(b<span class="op">**</span><span class="dv">2</span>)))) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb22-471"><a href="#cb22-471" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">*</span> (y<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> ((rxnew <span class="op">*</span> rynew)<span class="op">/</span>((b<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> Kx <span class="op">*</span> Ky)) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> (rynew<span class="op">/</span>b)) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb22-472"><a href="#cb22-472" aria-hidden="true" tabindex="-1"></a>(y<span class="op">**</span><span class="dv">4</span>) <span class="op">*</span> ((rx <span class="op">*</span> (rynew<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>((b<span class="op">**</span><span class="dv">3</span>) <span class="op">*</span> (Ky<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> Kx))</span>
<span id="cb22-473"><a href="#cb22-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-474"><a href="#cb22-474" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution qu'on obtient avec un masque booléen qui sélectionne les </span></span>
<span id="cb22-475"><a href="#cb22-475" aria-hidden="true" tabindex="-1"></a><span class="co">## racines réelles et strictement positives:</span></span>
<span id="cb22-476"><a href="#cb22-476" aria-hidden="true" tabindex="-1"></a>sol2 <span class="op">=</span> pol2.roots()[ (np.isreal( pol2.roots() )) <span class="op">*</span> (pol2.roots() <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb22-477"><a href="#cb22-477" aria-hidden="true" tabindex="-1"></a>yeq2<span class="op">=</span>sol2[<span class="dv">0</span>].real</span>
<span id="cb22-478"><a href="#cb22-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-479"><a href="#cb22-479" aria-hidden="true" tabindex="-1"></a><span class="co">## On calcule x*</span></span>
<span id="cb22-480"><a href="#cb22-480" aria-hidden="true" tabindex="-1"></a>xeq2 <span class="op">=</span> (rynew <span class="op">*</span> yeq2 <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>rynew) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>b) <span class="op">+</span> (yeq2<span class="op">/</span>(b <span class="op">*</span> Ky)))).real</span>
<span id="cb22-481"><a href="#cb22-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-482"><a href="#cb22-482" aria-hidden="true" tabindex="-1"></a><span class="co">## On plot les deux équilibres:</span></span>
<span id="cb22-483"><a href="#cb22-483" aria-hidden="true" tabindex="-1"></a>ax2.plot(xeq2.real, yeq2.real, label <span class="op">=</span> <span class="st">'$(x^*,y^*)$'</span>, marker <span class="op">=</span> <span class="st">'.'</span>, </span>
<span id="cb22-484"><a href="#cb22-484" aria-hidden="true" tabindex="-1"></a>                markersize <span class="op">=</span> <span class="dv">6</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb22-485"><a href="#cb22-485" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, label <span class="op">=</span> <span class="st">'$(0,0)$'</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">6</span>, </span>
<span id="cb22-486"><a href="#cb22-486" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb22-487"><a href="#cb22-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-488"><a href="#cb22-488" aria-hidden="true" tabindex="-1"></a><span class="co">## Localisation de la légende:</span></span>
<span id="cb22-489"><a href="#cb22-489" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc <span class="op">=</span> <span class="st">'upper left'</span>)</span>
<span id="cb22-490"><a href="#cb22-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-491"><a href="#cb22-491" aria-hidden="true" tabindex="-1"></a><span class="co">## Ajout du champ de vecteur via la fonction quiver :</span></span>
<span id="cb22-492"><a href="#cb22-492" aria-hidden="true" tabindex="-1"></a>xg <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.6</span>)</span>
<span id="cb22-493"><a href="#cb22-493" aria-hidden="true" tabindex="-1"></a>yg <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.6</span>)</span>
<span id="cb22-494"><a href="#cb22-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-495"><a href="#cb22-495" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(xg, yg)</span>
<span id="cb22-496"><a href="#cb22-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-497"><a href="#cb22-497" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> aug([X, Y], <span class="dv">0</span>, param_aug)</span>
<span id="cb22-498"><a href="#cb22-498" aria-hidden="true" tabindex="-1"></a>ax2.quiver(X, Y, dx, dy, angles <span class="op">=</span> <span class="st">'xy'</span>, color <span class="op">=</span> <span class="st">'grey'</span>, </span>
<span id="cb22-499"><a href="#cb22-499" aria-hidden="true" tabindex="-1"></a>                scale <span class="op">=</span> <span class="dv">80</span>, width <span class="op">=</span> <span class="fl">0.003</span>) <span class="op">;</span></span>
<span id="cb22-500"><a href="#cb22-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-501"><a href="#cb22-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-502"><a href="#cb22-502" aria-hidden="true" tabindex="-1"></a>xg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-503"><a href="#cb22-503" aria-hidden="true" tabindex="-1"></a>yg2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-504"><a href="#cb22-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-505"><a href="#cb22-505" aria-hidden="true" tabindex="-1"></a>X2, Y2 <span class="op">=</span> np.meshgrid(xg2, yg2)</span>
<span id="cb22-506"><a href="#cb22-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-507"><a href="#cb22-507" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> rxnew <span class="op">*</span> X2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> X2<span class="op">/</span>Kx)</span>
<span id="cb22-508"><a href="#cb22-508" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> rynew <span class="op">*</span> Y2 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> Y2<span class="op">/</span>Ky)</span>
<span id="cb22-509"><a href="#cb22-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-510"><a href="#cb22-510" aria-hidden="true" tabindex="-1"></a>ax2.contour(X2, Y2, (X <span class="op">+</span> Y), [<span class="dv">0</span>], colors <span class="op">=</span> <span class="st">'C1'</span>)</span>
<span id="cb22-511"><a href="#cb22-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-512"><a href="#cb22-512" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C1'</span>, label <span class="op">=</span> <span class="st">'Ellipse des solutions'</span>)</span>
<span id="cb22-513"><a href="#cb22-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-514"><a href="#cb22-514" aria-hidden="true" tabindex="-1"></a><span class="co">## Localisation de la légende:</span></span>
<span id="cb22-515"><a href="#cb22-515" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc <span class="op">=</span> <span class="st">'upper left'</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb22-516"><a href="#cb22-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-517"><a href="#cb22-517" aria-hidden="true" tabindex="-1"></a><span class="co">## On place les différents points d'intérêts...</span></span>
<span id="cb22-518"><a href="#cb22-518" aria-hidden="true" tabindex="-1"></a>xv <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb22-519"><a href="#cb22-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-520"><a href="#cb22-520" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="dv">0</span>, Ky, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">7</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb22-521"><a href="#cb22-521" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, <span class="dv">0</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">7</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb22-522"><a href="#cb22-522" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx, Ky, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">6</span>, color <span class="op">=</span> <span class="st">'k'</span>)</span>
<span id="cb22-523"><a href="#cb22-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-524"><a href="#cb22-524" aria-hidden="true" tabindex="-1"></a><span class="co">##...et on les relie aux axes:</span></span>
<span id="cb22-525"><a href="#cb22-525" aria-hidden="true" tabindex="-1"></a>xc <span class="op">=</span> np.arange(<span class="dv">0</span>, Kx, <span class="fl">0.01</span>)</span>
<span id="cb22-526"><a href="#cb22-526" aria-hidden="true" tabindex="-1"></a>ax2.plot(xc, Ky <span class="op">*</span> np.ones_like(xc), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb22-527"><a href="#cb22-527" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb22-528"><a href="#cb22-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-529"><a href="#cb22-529" aria-hidden="true" tabindex="-1"></a>yc<span class="op">=</span>np.arange(<span class="dv">0</span>,Ky,<span class="fl">0.01</span>)</span>
<span id="cb22-530"><a href="#cb22-530" aria-hidden="true" tabindex="-1"></a>ax2.plot(Kx <span class="op">*</span> np.ones_like(yc), yc, linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb22-531"><a href="#cb22-531" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb22-532"><a href="#cb22-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-533"><a href="#cb22-533" aria-hidden="true" tabindex="-1"></a><span class="co">#On nomme les points:</span></span>
<span id="cb22-534"><a href="#cb22-534" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="op">-</span><span class="fl">0.2</span>, Ky, <span class="st">'$K_y$'</span>)</span>
<span id="cb22-535"><a href="#cb22-535" aria-hidden="true" tabindex="-1"></a>ax2.text(Kx, <span class="op">-</span><span class="fl">0.2</span>, <span class="st">'$K_x$'</span>)</span>
<span id="cb22-536"><a href="#cb22-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-537"><a href="#cb22-537" aria-hidden="true" tabindex="-1"></a><span class="co">#On place les points d'équilibres :</span></span>
<span id="cb22-538"><a href="#cb22-538" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.arange(<span class="dv">0</span>, yeq2, <span class="fl">0.01</span>)</span>
<span id="cb22-539"><a href="#cb22-539" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.arange(<span class="dv">0</span>, xeq2, <span class="fl">0.01</span>)</span>
<span id="cb22-540"><a href="#cb22-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-541"><a href="#cb22-541" aria-hidden="true" tabindex="-1"></a>ax2.plot(xeq2 <span class="op">*</span> np.ones_like(ys), ys, linestyle <span class="op">=</span> <span class="st">'dashed'</span>,</span>
<span id="cb22-542"><a href="#cb22-542" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb22-543"><a href="#cb22-543" aria-hidden="true" tabindex="-1"></a>ax2.plot(xs, yeq2 <span class="op">*</span> np.ones_like(xs), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, </span>
<span id="cb22-544"><a href="#cb22-544" aria-hidden="true" tabindex="-1"></a>                color <span class="op">=</span> <span class="st">'k'</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb22-545"><a href="#cb22-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-546"><a href="#cb22-546" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="op">-</span><span class="fl">0.2</span>, yeq2, <span class="st">'$y^*$'</span>)<span class="op">;</span></span>
<span id="cb22-547"><a href="#cb22-547" aria-hidden="true" tabindex="-1"></a>ax2.text(xeq2, <span class="op">-</span><span class="fl">0.2</span>, <span class="st">'$x^*$'</span>)<span class="op">;</span></span>
<span id="cb22-548"><a href="#cb22-548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-549"><a href="#cb22-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-550"><a href="#cb22-550" aria-hidden="true" tabindex="-1"></a>L'ellipse, d'équation $f(x,y)=r_xx\left(1-\frac{x}{K_x}\right)+r_yy\left(1-\frac{y}{K_y}\right) = 0$  , peut être vue comme la ligne de niveau de $f$ en $0$. </span>
<span id="cb22-551"><a href="#cb22-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-552"><a href="#cb22-552" aria-hidden="true" tabindex="-1"></a>Ainsi, une équation de la tangente au point $(x_0,y_0)$ est donnée par:   </span>
<span id="cb22-553"><a href="#cb22-553" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-554"><a href="#cb22-554" aria-hidden="true" tabindex="-1"></a>\frac{\partial f}{\partial x}(x_0,y_0)(x-x_0)+ \frac{\partial f}{\partial y}(x_0,y_0)(y-y_0) = 0</span>
<span id="cb22-555"><a href="#cb22-555" aria-hidden="true" tabindex="-1"></a>$${#eq-eqa}</span>
<span id="cb22-556"><a href="#cb22-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-557"><a href="#cb22-557" aria-hidden="true" tabindex="-1"></a>autrement dit :</span>
<span id="cb22-558"><a href="#cb22-558" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-559"><a href="#cb22-559" aria-hidden="true" tabindex="-1"></a>\left(r_x - 2\frac{r_xx_0}{K_x}\right)(x-x_0) + \left(r_y -2\frac{r_yy_0}{K_y}\right)(y-y_0) = 0</span>
<span id="cb22-560"><a href="#cb22-560" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-561"><a href="#cb22-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-562"><a href="#cb22-562" aria-hidden="true" tabindex="-1"></a>Dans le cas où $x_0=K_x$ et $y_0=K_y$ on a alors :</span>
<span id="cb22-563"><a href="#cb22-563" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-564"><a href="#cb22-564" aria-hidden="true" tabindex="-1"></a>-r_x(x-K_x) -r_y(y-K_y) = 0</span>
<span id="cb22-565"><a href="#cb22-565" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-566"><a href="#cb22-566" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-567"><a href="#cb22-567" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-568"><a href="#cb22-568" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-569"><a href="#cb22-569" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-570"><a href="#cb22-570" aria-hidden="true" tabindex="-1"></a>y = -\frac{r_x}{r_y}\left(x-K_x\right) + K_y</span>
<span id="cb22-571"><a href="#cb22-571" aria-hidden="true" tabindex="-1"></a>$${#eq-tang}</span>
<span id="cb22-572"><a href="#cb22-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-573"><a href="#cb22-573" aria-hidden="true" tabindex="-1"></a>qui est donc l'équation de la tangente à l'ellipse au point $(K_x,K_y)$.</span>
<span id="cb22-574"><a href="#cb22-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-575"><a href="#cb22-575" aria-hidden="true" tabindex="-1"></a>Si maintenant on prend $r_x=r_y$ alors on remarque que (<span class="co">[</span><span class="ot">-@eq-tang</span><span class="co">]</span>) est égale à l'équation de la droite $d$ ce qui implique que toute l'ellipse est en dessous de $d$ et donc que tous les équilibres sont déflationistes.</span>
<span id="cb22-576"><a href="#cb22-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-577"><a href="#cb22-577" aria-hidden="true" tabindex="-1"></a>**Donc : si $r_x=r_y$ on a ([-@eq-modsmig]) qui est déflationiste quelque soit le taux de migration.**</span>
<span id="cb22-578"><a href="#cb22-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-579"><a href="#cb22-579" aria-hidden="true" tabindex="-1"></a>On va effectuer une simulation avec les paramètres déduits à l'instant pour confirmer ce qu'on vient de dire.  </span>
<span id="cb22-580"><a href="#cb22-580" aria-hidden="true" tabindex="-1"></a>Pour cela on va, pour chaque $\beta$, simuler un temps suffisament large pour atteindre l'équilibre et représenter la somme des deux équilibres.</span>
<span id="cb22-581"><a href="#cb22-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-582"><a href="#cb22-582" aria-hidden="true" tabindex="-1"></a>Il faut donc définir une fonction qui prend en compte le changement de $\beta$ :</span>
<span id="cb22-583"><a href="#cb22-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-586"><a href="#cb22-586" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-587"><a href="#cb22-587" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug2(etat, t, param, h):</span>
<span id="cb22-588"><a href="#cb22-588" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky <span class="op">=</span> param</span>
<span id="cb22-589"><a href="#cb22-589" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> h</span>
<span id="cb22-590"><a href="#cb22-590" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb22-591"><a href="#cb22-591" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y <span class="op">-</span> x), </span>
<span id="cb22-592"><a href="#cb22-592" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x <span class="op">-</span> y)]</span>
<span id="cb22-593"><a href="#cb22-593" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb22-594"><a href="#cb22-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-595"><a href="#cb22-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-596"><a href="#cb22-596" aria-hidden="true" tabindex="-1"></a>Ainsi qu'un temps d'intégration large, des conditions initiales et des paramètres :</span>
<span id="cb22-599"><a href="#cb22-599" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-600"><a href="#cb22-600" aria-hidden="true" tabindex="-1"></a><span class="co">## Temps d'intégration :</span></span>
<span id="cb22-601"><a href="#cb22-601" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">400</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-602"><a href="#cb22-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-603"><a href="#cb22-603" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres : </span></span>
<span id="cb22-604"><a href="#cb22-604" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb22-605"><a href="#cb22-605" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="fl">0.5</span> <span class="co"># =on prend rx1=rx2</span></span>
<span id="cb22-606"><a href="#cb22-606" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb22-607"><a href="#cb22-607" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-608"><a href="#cb22-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-609"><a href="#cb22-609" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1])</span>
<span id="cb22-610"><a href="#cb22-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-611"><a href="#cb22-611" aria-hidden="true" tabindex="-1"></a><span class="co">## Condition initiale:</span></span>
<span id="cb22-612"><a href="#cb22-612" aria-hidden="true" tabindex="-1"></a>c10 <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">0</span>]</span>
<span id="cb22-613"><a href="#cb22-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-614"><a href="#cb22-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-615"><a href="#cb22-615" aria-hidden="true" tabindex="-1"></a>Et enfin on simule avec <span class="in">`odeint`</span> et on fait une boucle pour simuler que $\beta$ va de $0$ à $4$ (suffisant pour avoir une courbe intéressante):</span>
<span id="cb22-616"><a href="#cb22-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-619"><a href="#cb22-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-620"><a href="#cb22-620" aria-hidden="true" tabindex="-1"></a><span class="co">## On crée la figure et l'axe:</span></span>
<span id="cb22-621"><a href="#cb22-621" aria-hidden="true" tabindex="-1"></a>fig3, ax3 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb22-622"><a href="#cb22-622" aria-hidden="true" tabindex="-1"></a>fig3.suptitle(<span class="st">"Somme des équilibres en fonction de β quand $r_x = r_y$"</span>)</span>
<span id="cb22-623"><a href="#cb22-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-624"><a href="#cb22-624" aria-hidden="true" tabindex="-1"></a><span class="co">## Boucle ou i prend les valeurs de beta:</span></span>
<span id="cb22-625"><a href="#cb22-625" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb22-626"><a href="#cb22-626" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param1, i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb22-627"><a href="#cb22-627" aria-hidden="true" tabindex="-1"></a>    ax3.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb22-628"><a href="#cb22-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-629"><a href="#cb22-629" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot de la droite Kx+Ky:</span></span>
<span id="cb22-630"><a href="#cb22-630" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-631"><a href="#cb22-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-632"><a href="#cb22-632" aria-hidden="true" tabindex="-1"></a>ax3.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>,markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb22-633"><a href="#cb22-633" aria-hidden="true" tabindex="-1"></a>ax3.text(<span class="fl">3.2</span>, Kx <span class="op">+</span> Ky <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb22-634"><a href="#cb22-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-635"><a href="#cb22-635" aria-hidden="true" tabindex="-1"></a><span class="co">## Légendes:</span></span>
<span id="cb22-636"><a href="#cb22-636" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb22-637"><a href="#cb22-637" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb22-638"><a href="#cb22-638" aria-hidden="true" tabindex="-1"></a>ax3.plot(Kx1 <span class="op">+</span> Ky1, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>) <span class="co">#Si on avait mis label dans la boucle la légende aurait été trop grande</span></span>
<span id="cb22-639"><a href="#cb22-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-640"><a href="#cb22-640" aria-hidden="true" tabindex="-1"></a><span class="co">## On adapte la fenêtre:</span></span>
<span id="cb22-641"><a href="#cb22-641" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(<span class="fl">2.2</span>, <span class="fl">3.2</span>)</span>
<span id="cb22-642"><a href="#cb22-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-643"><a href="#cb22-643" aria-hidden="true" tabindex="-1"></a>ax3.legend()<span class="op">;</span></span>
<span id="cb22-644"><a href="#cb22-644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-645"><a href="#cb22-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-646"><a href="#cb22-646" aria-hidden="true" tabindex="-1"></a>On voit que la courbe bleu représentant la somme des équilibres est en permanence en dessous de la droite $K_x+K_y$. On a bien un système entièrement déflationiste quand $r_x = r_y$.  </span>
<span id="cb22-647"><a href="#cb22-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-648"><a href="#cb22-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-649"><a href="#cb22-649" aria-hidden="true" tabindex="-1"></a><span class="fu">#### b) Deuxième condition à un système déflationiste</span></span>
<span id="cb22-650"><a href="#cb22-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-651"><a href="#cb22-651" aria-hidden="true" tabindex="-1"></a>On va maintenant considérer le cas où $r_x &lt; r_y$ c'est à dire qu'on va prendre l'ellipse dans un seul sens (voir sur l'animation Geogebra).</span>
<span id="cb22-652"><a href="#cb22-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-653"><a href="#cb22-653" aria-hidden="true" tabindex="-1"></a>On va analyser graphiquement le plan de phase.  On aura besoin de tracer les droites définies par $\beta = 0$ et $\beta = +\infty$ dans l'équation $y^*=r_xx^*\left(\frac{1}{r_x}-\frac{1}{\beta}+\frac{x^*}{\beta K_x}\right)$  (la parabole verte dans le plan de phase définie par $\dot x =0$).</span>
<span id="cb22-654"><a href="#cb22-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-655"><a href="#cb22-655" aria-hidden="true" tabindex="-1"></a>En effet, ceci va permettre d'encadrer l'équilibre $(x^*,y^*)$ en fonction du taux de migration.</span>
<span id="cb22-656"><a href="#cb22-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-657"><a href="#cb22-657" aria-hidden="true" tabindex="-1"></a>Lorsque $\beta = 0$ on a, par la première équation de (<span class="co">[</span><span class="ot">-@eq-pdpsmig</span><span class="co">]</span>) :</span>
<span id="cb22-658"><a href="#cb22-658" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-659"><a href="#cb22-659" aria-hidden="true" tabindex="-1"></a>0 = r_xx^*(1-\frac{x^*}{K_x})</span>
<span id="cb22-660"><a href="#cb22-660" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-661"><a href="#cb22-661" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-662"><a href="#cb22-662" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-663"><a href="#cb22-663" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-664"><a href="#cb22-664" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-665"><a href="#cb22-665" aria-hidden="true" tabindex="-1"></a>x^*=K_x \vee x^* = 0</span>
<span id="cb22-666"><a href="#cb22-666" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-667"><a href="#cb22-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-668"><a href="#cb22-668" aria-hidden="true" tabindex="-1"></a>Donc lorsque le taux de migration est nul la parabole correspondant à $\dot x = 0$ a pour équation les droites $x^*=0$ et $x^*=K_x$ qu'on appelle respectivement $P_{10}$ et $P_{20}$. </span>
<span id="cb22-669"><a href="#cb22-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-670"><a href="#cb22-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-671"><a href="#cb22-671" aria-hidden="true" tabindex="-1"></a>Lorsque $\beta = + \infty$ on a, encore une fois par la première équation de (<span class="co">[</span><span class="ot">-@eq-pdpsmig</span><span class="co">]</span>):</span>
<span id="cb22-672"><a href="#cb22-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-673"><a href="#cb22-673" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-674"><a href="#cb22-674" aria-hidden="true" tabindex="-1"></a>y^* = r_xx^*\frac{1}{r_x} = x^*</span>
<span id="cb22-675"><a href="#cb22-675" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb22-676"><a href="#cb22-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-677"><a href="#cb22-677" aria-hidden="true" tabindex="-1"></a>Ainsi quand le taux de migration tend vers l'infini la parabole $\dot x = 0$ correspond à la droite $y^*=x^*$ qu'on appelle $P_\infty$.</span>
<span id="cb22-678"><a href="#cb22-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-679"><a href="#cb22-679" aria-hidden="true" tabindex="-1"></a>On notera dans la suite $A=(K_x,K_y)$, $B$ l'intersection non trivial (pas $(0,0)$) entre $P_\infty$ et l'ellipse et $C$ l'intersection non trivial (pas $(K_x,0)$) entre $P_{20}$ et $P_\infty$. </span>
<span id="cb22-680"><a href="#cb22-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-681"><a href="#cb22-681" aria-hidden="true" tabindex="-1"></a>Pour calculer les coordonées de $B$ on utilise que $y^*=x^*$ et on le rentre dans (<span class="co">[</span><span class="ot">-@eq-ell</span><span class="co">]</span>) ce qui donne :</span>
<span id="cb22-682"><a href="#cb22-682" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-683"><a href="#cb22-683" aria-hidden="true" tabindex="-1"></a>x^*\left(r_x\left(1-\frac{x^*}{K_x}\right)+r_y\left(1-\frac{x^*}{K_y}\right)\right) = 0</span>
<span id="cb22-684"><a href="#cb22-684" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-685"><a href="#cb22-685" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-686"><a href="#cb22-686" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-687"><a href="#cb22-687" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-688"><a href="#cb22-688" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-689"><a href="#cb22-689" aria-hidden="true" tabindex="-1"></a>x^* = \frac{r_x+r_y}{\frac{r_x}{K_x}+\frac{r_y}{K_y}}</span>
<span id="cb22-690"><a href="#cb22-690" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb22-691"><a href="#cb22-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-692"><a href="#cb22-692" aria-hidden="true" tabindex="-1"></a>et comme $B$ est sur $P_\infty$ alors on a :</span>
<span id="cb22-693"><a href="#cb22-693" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-694"><a href="#cb22-694" aria-hidden="true" tabindex="-1"></a>y^*= \frac{r_x+r_y}{\frac{r_x}{K_x}+\frac{r_y}{K_y}}</span>
<span id="cb22-695"><a href="#cb22-695" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-696"><a href="#cb22-696" aria-hidden="true" tabindex="-1"></a>$B$ est donc définie comme :  </span>
<span id="cb22-697"><a href="#cb22-697" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-698"><a href="#cb22-698" aria-hidden="true" tabindex="-1"></a>B = (\frac{r_x+r_y}{\frac{r_x}{K_x}+\frac{r_y}{K_y}},\frac{r_x+r_y}{\frac{r_x}{K_x}+\frac{r_y}{K_y}})</span>
<span id="cb22-699"><a href="#cb22-699" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-700"><a href="#cb22-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-701"><a href="#cb22-701" aria-hidden="true" tabindex="-1"></a>Pour calculer les coordonées de $C$ on utilise que $y^*=x^*$ dans la définition de $P_{20}$, ie comme $P_{20}$ est défini par $x^* =K_x$ alors $y^*=K_x$ et donc on a :</span>
<span id="cb22-702"><a href="#cb22-702" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-703"><a href="#cb22-703" aria-hidden="true" tabindex="-1"></a>C=(K_x,K_x)</span>
<span id="cb22-704"><a href="#cb22-704" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-705"><a href="#cb22-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-706"><a href="#cb22-706" aria-hidden="true" tabindex="-1"></a>Représentons le tout sur le premier plan de phase:</span>
<span id="cb22-707"><a href="#cb22-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-710"><a href="#cb22-710" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-711"><a href="#cb22-711" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pdp</span></span>
<span id="cb22-712"><a href="#cb22-712" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plan de phase complet"</span></span>
<span id="cb22-713"><a href="#cb22-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-714"><a href="#cb22-714" aria-hidden="true" tabindex="-1"></a><span class="co">## Parabole xdot=0 b=0:</span></span>
<span id="cb22-715"><a href="#cb22-715" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx <span class="op">*</span> np.ones_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>, label <span class="op">=</span> <span class="st">'Parabole b=0'</span>)</span>
<span id="cb22-716"><a href="#cb22-716" aria-hidden="true" tabindex="-1"></a>ax.plot(np.zeros_like(xt), xt, color <span class="op">=</span> <span class="st">'C9'</span>)</span>
<span id="cb22-717"><a href="#cb22-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-718"><a href="#cb22-718" aria-hidden="true" tabindex="-1"></a><span class="co">## Parabole xdot=0 b=+inf:</span></span>
<span id="cb22-719"><a href="#cb22-719" aria-hidden="true" tabindex="-1"></a>ax.plot(xt, xt, color <span class="op">=</span> <span class="st">'C6'</span>, label <span class="op">=</span> <span class="st">'Parabole b=$+\infty$'</span>)</span>
<span id="cb22-720"><a href="#cb22-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-721"><a href="#cb22-721" aria-hidden="true" tabindex="-1"></a><span class="co">## On place des textes indiquant les trois droites:</span></span>
<span id="cb22-722"><a href="#cb22-722" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.05</span>, yeq <span class="op">+</span> <span class="fl">0.4</span>, <span class="st">"$P_</span><span class="sc">{10}</span><span class="st">$"</span>)</span>
<span id="cb22-723"><a href="#cb22-723" aria-hidden="true" tabindex="-1"></a>ax.text(Kx <span class="op">+</span> <span class="fl">0.05</span>, <span class="fl">2.8</span>, <span class="st">"$P_</span><span class="sc">{20}</span><span class="st">$"</span>)</span>
<span id="cb22-724"><a href="#cb22-724" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">2.65</span>, <span class="fl">2.45</span>, <span class="st">"$P_\infty$"</span>)</span>
<span id="cb22-725"><a href="#cb22-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-726"><a href="#cb22-726" aria-hidden="true" tabindex="-1"></a><span class="co">## On place les trois points:</span></span>
<span id="cb22-727"><a href="#cb22-727" aria-hidden="true" tabindex="-1"></a><span class="co">## A :</span></span>
<span id="cb22-728"><a href="#cb22-728" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx, Ky, marker <span class="op">=</span> <span class="st">'.'</span>,color <span class="op">=</span> <span class="st">'C0'</span>, markersize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb22-729"><a href="#cb22-729" aria-hidden="true" tabindex="-1"></a>ax.text(Kx <span class="op">+</span> <span class="fl">0.1</span>, Ky <span class="op">+</span> <span class="fl">0.1</span>, <span class="st">"$A$"</span>)</span>
<span id="cb22-730"><a href="#cb22-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-731"><a href="#cb22-731" aria-hidden="true" tabindex="-1"></a><span class="co">## B :</span></span>
<span id="cb22-732"><a href="#cb22-732" aria-hidden="true" tabindex="-1"></a>ax.plot((rx <span class="op">+</span> ry)<span class="op">/</span>(rx<span class="op">/</span>Kx <span class="op">+</span> ry<span class="op">/</span>Ky), (rx <span class="op">+</span> ry)<span class="op">/</span>(rx<span class="op">/</span>Kx <span class="op">+</span> ry<span class="op">/</span>Ky), </span>
<span id="cb22-733"><a href="#cb22-733" aria-hidden="true" tabindex="-1"></a>            marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>, markersize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb22-734"><a href="#cb22-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-735"><a href="#cb22-735" aria-hidden="true" tabindex="-1"></a>ax.text((rx <span class="op">+</span> ry)<span class="op">/</span>(rx<span class="op">/</span>Kx <span class="op">+</span> ry<span class="op">/</span>Ky) <span class="op">-</span> <span class="fl">0.1</span>, (rx <span class="op">+</span> ry)<span class="op">/</span>(rx<span class="op">/</span>Kx <span class="op">+</span> ry<span class="op">/</span>Ky) <span class="op">+</span> <span class="fl">0.1</span>, <span class="st">"$B$"</span>)</span>
<span id="cb22-736"><a href="#cb22-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-737"><a href="#cb22-737" aria-hidden="true" tabindex="-1"></a><span class="co">## C : </span></span>
<span id="cb22-738"><a href="#cb22-738" aria-hidden="true" tabindex="-1"></a>ax.plot(Kx, Kx, marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>, markersize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb22-739"><a href="#cb22-739" aria-hidden="true" tabindex="-1"></a>ax.text(Kx <span class="op">-</span> <span class="fl">0.1</span>, Kx <span class="op">+</span> <span class="fl">0.1</span>, <span class="st">"$C$"</span>)</span>
<span id="cb22-740"><a href="#cb22-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-741"><a href="#cb22-741" aria-hidden="true" tabindex="-1"></a>ax.legend(loc <span class="op">=</span> <span class="st">"upper left"</span>, fontsize <span class="op">=</span> <span class="fl">6.5</span>)</span>
<span id="cb22-742"><a href="#cb22-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-743"><a href="#cb22-743" aria-hidden="true" tabindex="-1"></a>display(fig)</span>
<span id="cb22-744"><a href="#cb22-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-745"><a href="#cb22-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-746"><a href="#cb22-746" aria-hidden="true" tabindex="-1"></a>Lorsque $\beta$ augmente de $0$ à $+\infty$ on a l'équilibre qui parcourt l'ellipse de $A$ à $B$.  </span>
<span id="cb22-747"><a href="#cb22-747" aria-hidden="true" tabindex="-1"></a>Pour que le système soit déflationiste on veut que la portion de l'ellipse de $A$ à $B$ soit complètement en dessous de la droite $d$ (grise).  </span>
<span id="cb22-748"><a href="#cb22-748" aria-hidden="true" tabindex="-1"></a>Pour ce faire on peut voir sur notre plan de phase qu'il faut que $C$ ait une coordonée $y$ plus grande que $A$ afin que $B$ soit toujours à gauche de $A$ (et donc en dessous de $d$). </span>
<span id="cb22-749"><a href="#cb22-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-750"><a href="#cb22-750" aria-hidden="true" tabindex="-1"></a>Mathématiquement on veut donc que $K_x &gt; K_y$. </span>
<span id="cb22-751"><a href="#cb22-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-752"><a href="#cb22-752" aria-hidden="true" tabindex="-1"></a>Ainsi si on a $r_x &lt; r_y$ et $K_x&gt;K_y$ on aura tout le temps un modèle déflationiste pour les ravageurs.</span>
<span id="cb22-753"><a href="#cb22-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-754"><a href="#cb22-754" aria-hidden="true" tabindex="-1"></a>Ceci est intéressant pour l'augmentorium, si on a la capacité de charge l'augmentorium qui est plus faible que celle de la culture alors le système est toujours négatif pour la population totale de ravageurs. </span>
<span id="cb22-755"><a href="#cb22-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-756"><a href="#cb22-756" aria-hidden="true" tabindex="-1"></a>On peut aussi voir graphiquement que dans ce cas là on a toujours $x^* &lt; K_x$, c'est ce que l'on cherche à obtenir. </span>
<span id="cb22-757"><a href="#cb22-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-758"><a href="#cb22-758" aria-hidden="true" tabindex="-1"></a>On peut illustrer notre condition avec une simulation similaire à la partie précédente : </span>
<span id="cb22-759"><a href="#cb22-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-760"><a href="#cb22-760" aria-hidden="true" tabindex="-1"></a>On utilise le même modèle, on change uniquement les paramètres :</span>
<span id="cb22-761"><a href="#cb22-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-764"><a href="#cb22-764" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-765"><a href="#cb22-765" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres : </span></span>
<span id="cb22-766"><a href="#cb22-766" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb22-767"><a href="#cb22-767" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span>  <span class="co">#On a bien rx2 &lt; ry2 </span></span>
<span id="cb22-768"><a href="#cb22-768" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb22-769"><a href="#cb22-769" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">1</span>  <span class="co">#On a bien Kx2&gt;Ky2</span></span>
<span id="cb22-770"><a href="#cb22-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-771"><a href="#cb22-771" aria-hidden="true" tabindex="-1"></a><span class="co">## En l'occurence il s'agit des paramètres de base qu'on avait utilisé ##pour la simulation du premier plan de phase expliquant qu'on se ##retrouvait avec un équilibre déflationiste.</span></span>
<span id="cb22-772"><a href="#cb22-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-773"><a href="#cb22-773" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2])</span>
<span id="cb22-774"><a href="#cb22-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-775"><a href="#cb22-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-776"><a href="#cb22-776" aria-hidden="true" tabindex="-1"></a>Et on simule à nouveau :</span>
<span id="cb22-777"><a href="#cb22-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-780"><a href="#cb22-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-781"><a href="#cb22-781" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb22-782"><a href="#cb22-782" aria-hidden="true" tabindex="-1"></a><span class="co">## On crée la figure et l'axe:</span></span>
<span id="cb22-783"><a href="#cb22-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-784"><a href="#cb22-784" aria-hidden="true" tabindex="-1"></a>fig4, ax4 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb22-785"><a href="#cb22-785" aria-hidden="true" tabindex="-1"></a>fig4.suptitle(<span class="st">"Somme des équilibre en fonction de β quand $r_x &lt; r_y$ et $K_x &gt; K_y$"</span>)</span>
<span id="cb22-786"><a href="#cb22-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-787"><a href="#cb22-787" aria-hidden="true" tabindex="-1"></a><span class="co">## Boucle ou i prend les valeurs de beta:</span></span>
<span id="cb22-788"><a href="#cb22-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-789"><a href="#cb22-789" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb22-790"><a href="#cb22-790" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param2, i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb22-791"><a href="#cb22-791" aria-hidden="true" tabindex="-1"></a>    ax4.plot(i, s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb22-792"><a href="#cb22-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-793"><a href="#cb22-793" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot de la droite Kx+Ky:</span></span>
<span id="cb22-794"><a href="#cb22-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-795"><a href="#cb22-795" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-796"><a href="#cb22-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-797"><a href="#cb22-797" aria-hidden="true" tabindex="-1"></a>ax4.plot(xt, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb22-798"><a href="#cb22-798" aria-hidden="true" tabindex="-1"></a>ax4.text(<span class="fl">3.2</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb22-799"><a href="#cb22-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-800"><a href="#cb22-800" aria-hidden="true" tabindex="-1"></a><span class="co">## Légendes:</span></span>
<span id="cb22-801"><a href="#cb22-801" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb22-802"><a href="#cb22-802" aria-hidden="true" tabindex="-1"></a>ax4.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb22-803"><a href="#cb22-803" aria-hidden="true" tabindex="-1"></a>ax4.plot(Kx2<span class="op">+</span>Ky2, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>) <span class="co">#Si on avait mis label dans la boucle la légende aurait été trop grande</span></span>
<span id="cb22-804"><a href="#cb22-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-805"><a href="#cb22-805" aria-hidden="true" tabindex="-1"></a><span class="co">## On adapte la fenêtre:</span></span>
<span id="cb22-806"><a href="#cb22-806" aria-hidden="true" tabindex="-1"></a>ax4.set_ylim(<span class="fl">2.2</span>, <span class="fl">3.2</span>)</span>
<span id="cb22-807"><a href="#cb22-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-808"><a href="#cb22-808" aria-hidden="true" tabindex="-1"></a>ax4.legend()<span class="op">;</span></span>
<span id="cb22-809"><a href="#cb22-809" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-810"><a href="#cb22-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-811"><a href="#cb22-811" aria-hidden="true" tabindex="-1"></a>On observe qu'on a bien une déflation du système quelque soit le taux de migration.</span>
<span id="cb22-812"><a href="#cb22-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-813"><a href="#cb22-813" aria-hidden="true" tabindex="-1"></a><span class="fu">#### c) Conditions pour une inflation et/ou une déflation</span></span>
<span id="cb22-814"><a href="#cb22-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-815"><a href="#cb22-815" aria-hidden="true" tabindex="-1"></a>Sur la base de la @fig-pdp on peut aussi déduire quand est-ce qu'on peut avoir inflation selon les paramètres.  </span>
<span id="cb22-816"><a href="#cb22-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-817"><a href="#cb22-817" aria-hidden="true" tabindex="-1"></a>Il s'agit de la même idée de preuve graphique qu'avant mais en complexifiant un peu.  Pour cela on va avoir besoin d'un quatrième point qu'on appellera $D$ et qui correspond à l'autre intersection entre l'ellipse et la droite $d$ (pas $(K_x,K_y)$).</span>
<span id="cb22-818"><a href="#cb22-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-819"><a href="#cb22-819" aria-hidden="true" tabindex="-1"></a>Pour trouver les coordonnées de $D$ on a simplement que comme $D$ est sur $d$ alors on a $y^* = -x^* + K_x + K_y$ et on remplace $y^*$ dans (<span class="co">[</span><span class="ot">-@eq-ell</span><span class="co">]</span>) ce qui donne : </span>
<span id="cb22-820"><a href="#cb22-820" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-821"><a href="#cb22-821" aria-hidden="true" tabindex="-1"></a>r_xx^*\left(1-\frac{x^*}{K_x}\right) +r_y(-x^*+K_x+K_y)\left(1-\frac{-x^*+K_x+K_y}{K_y} \right) = 0 </span>
<span id="cb22-822"><a href="#cb22-822" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-823"><a href="#cb22-823" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-824"><a href="#cb22-824" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-825"><a href="#cb22-825" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-826"><a href="#cb22-826" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-827"><a href="#cb22-827" aria-hidden="true" tabindex="-1"></a>x^*\left(r_x\left(1-\frac{x^*}{K_x}\right) + \frac{r_yK_x}{K_y}\left(1-\frac{x^*}{K_x} \right) \right) + \frac{r_y(K_x+K_y)}{K_y}(x^*-K_x) = 0</span>
<span id="cb22-828"><a href="#cb22-828" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-829"><a href="#cb22-829" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-830"><a href="#cb22-830" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-831"><a href="#cb22-831" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-832"><a href="#cb22-832" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-833"><a href="#cb22-833" aria-hidden="true" tabindex="-1"></a>\left(1-\frac{x^*}{K_x}\right)\left(x^*\left<span class="co">[</span><span class="ot">r_x+\frac{r_yK_x}{K_y}\right</span><span class="co">]</span>-\frac{r_yK_x(K_x+K_y)}{K_y}\right) = 0</span>
<span id="cb22-834"><a href="#cb22-834" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-835"><a href="#cb22-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-836"><a href="#cb22-836" aria-hidden="true" tabindex="-1"></a>Ce qui donne soit $x^* = K_x$ et on retouve alors $A$, soit :  </span>
<span id="cb22-837"><a href="#cb22-837" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-838"><a href="#cb22-838" aria-hidden="true" tabindex="-1"></a>x^*\left<span class="co">[</span><span class="ot">r_x+\frac{r_yK_x}{K_y}\right</span><span class="co">]</span> = \frac{r_yK_x(K_x+K_y)}{K_y}</span>
<span id="cb22-839"><a href="#cb22-839" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-840"><a href="#cb22-840" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-841"><a href="#cb22-841" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-842"><a href="#cb22-842" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-843"><a href="#cb22-843" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-844"><a href="#cb22-844" aria-hidden="true" tabindex="-1"></a>x^* = \frac{r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x}</span>
<span id="cb22-845"><a href="#cb22-845" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-846"><a href="#cb22-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-847"><a href="#cb22-847" aria-hidden="true" tabindex="-1"></a>Et donc d'après la définition de $y^*$ :</span>
<span id="cb22-848"><a href="#cb22-848" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-849"><a href="#cb22-849" aria-hidden="true" tabindex="-1"></a>y^* = - \frac{r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x} + K_x + K_y</span>
<span id="cb22-850"><a href="#cb22-850" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-851"><a href="#cb22-851" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-852"><a href="#cb22-852" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-853"><a href="#cb22-853" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-854"><a href="#cb22-854" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-855"><a href="#cb22-855" aria-hidden="true" tabindex="-1"></a>y^* = \frac{(K_x+K_y)(r_xK_y+r_yK_x)-r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x}</span>
<span id="cb22-856"><a href="#cb22-856" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-857"><a href="#cb22-857" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-858"><a href="#cb22-858" aria-hidden="true" tabindex="-1"></a>\Leftrightarrow</span>
<span id="cb22-859"><a href="#cb22-859" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-860"><a href="#cb22-860" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-861"><a href="#cb22-861" aria-hidden="true" tabindex="-1"></a>y^*=\frac{r_xK_y(K_x+K_y)}{r_xK_y+r_yK_x}</span>
<span id="cb22-862"><a href="#cb22-862" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-863"><a href="#cb22-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-864"><a href="#cb22-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-865"><a href="#cb22-865" aria-hidden="true" tabindex="-1"></a>Ainsi, $D = (\frac{r_yK_x(K_x+K_y)}{r_xK_y+r_yK_x} , \frac{r_xK_y(K_x+K_y)}{r_xK_y+r_yK_x} )$ .</span>
<span id="cb22-866"><a href="#cb22-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-867"><a href="#cb22-867" aria-hidden="true" tabindex="-1"></a>Ajoutons $D$ au plan de phase :</span>
<span id="cb22-870"><a href="#cb22-870" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-871"><a href="#cb22-871" aria-hidden="true" tabindex="-1"></a><span class="co">## On ajoute D:</span></span>
<span id="cb22-872"><a href="#cb22-872" aria-hidden="true" tabindex="-1"></a>ax.plot((ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky))<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), </span>
<span id="cb22-873"><a href="#cb22-873" aria-hidden="true" tabindex="-1"></a>        (rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky))<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx),</span>
<span id="cb22-874"><a href="#cb22-874" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">'C0'</span>, marker <span class="op">=</span> <span class="st">'.'</span>, markersize <span class="op">=</span> <span class="dv">7</span>)</span>
<span id="cb22-875"><a href="#cb22-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-876"><a href="#cb22-876" aria-hidden="true" tabindex="-1"></a>ax.text((ry <span class="op">*</span> Kx <span class="op">*</span> (Kx <span class="op">+</span> Ky))<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx) <span class="op">+</span> <span class="fl">0.07</span>, </span>
<span id="cb22-877"><a href="#cb22-877" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.08</span> <span class="op">+</span> (rx <span class="op">*</span> Ky <span class="op">*</span> (Kx <span class="op">+</span> Ky))<span class="op">/</span>(rx <span class="op">*</span> Ky <span class="op">+</span> ry <span class="op">*</span> Kx), <span class="st">"$D$"</span>)</span>
<span id="cb22-878"><a href="#cb22-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-879"><a href="#cb22-879" aria-hidden="true" tabindex="-1"></a>display(fig)</span>
<span id="cb22-880"><a href="#cb22-880" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-881"><a href="#cb22-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-882"><a href="#cb22-882" aria-hidden="true" tabindex="-1"></a>On voit maintenant aisément que si $B$ est entre $A$ et $D$ alors les équilibres vont parcourir des valeurs inflationistes seulement (arc orange au dessus de la droite grise).  </span>
<span id="cb22-883"><a href="#cb22-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-884"><a href="#cb22-884" aria-hidden="true" tabindex="-1"></a>Si $B$ est en dessous de $D$ (la coordonnée y de $B$ est plus petite que celle de $D$) alors on a d'abord des équilibres inflationistes (de $A$ à $D$) puis déflationistes (de $D$ à $B$).</span>
<span id="cb22-885"><a href="#cb22-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-886"><a href="#cb22-886" aria-hidden="true" tabindex="-1"></a>Mathématiquement on a donc : </span>
<span id="cb22-887"><a href="#cb22-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-888"><a href="#cb22-888" aria-hidden="true" tabindex="-1"></a>Si $K_y &gt; K_x$ (la coordonnée $y$ de $B$ est plus grande que celle de $A$) et $K_xr_y &gt; K_yr_x$ (la coordonnée $y$ de $B$ est plus grande que celle de $D$) alors le système est toujours inflationiste.</span>
<span id="cb22-889"><a href="#cb22-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-890"><a href="#cb22-890" aria-hidden="true" tabindex="-1"></a>Si $K_xr_y &lt; K_yr_x$ (la coordonnée $y$ de $B$ est plus petite que celle de $D$) alors le système est d'abord inflationiste puis déflationiste.</span>
<span id="cb22-891"><a href="#cb22-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-892"><a href="#cb22-892" aria-hidden="true" tabindex="-1"></a>On peut vérifier ces deux assertions avec des simulations similaires à la partie précédente : </span>
<span id="cb22-893"><a href="#cb22-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-894"><a href="#cb22-894" aria-hidden="true" tabindex="-1"></a>On utilise le même modèle, on change uniquement les paramètres :</span>
<span id="cb22-895"><a href="#cb22-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-898"><a href="#cb22-898" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-899"><a href="#cb22-899" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres condition 1: </span></span>
<span id="cb22-900"><a href="#cb22-900" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb22-901"><a href="#cb22-901" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">1</span>  <span class="co">#On a bien rx3 &lt; ry3 </span></span>
<span id="cb22-902"><a href="#cb22-902" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-903"><a href="#cb22-903" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="dv">2</span>  <span class="co">#On a bien Ky3&gt;Kx3</span></span>
<span id="cb22-904"><a href="#cb22-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-905"><a href="#cb22-905" aria-hidden="true" tabindex="-1"></a><span class="co">#On a la première condition de Kxry &gt; Kyrx</span></span>
<span id="cb22-906"><a href="#cb22-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-907"><a href="#cb22-907" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3])</span>
<span id="cb22-908"><a href="#cb22-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-909"><a href="#cb22-909" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres condition 2: </span></span>
<span id="cb22-910"><a href="#cb22-910" aria-hidden="true" tabindex="-1"></a>rx4 <span class="op">=</span> <span class="fl">0.6</span></span>
<span id="cb22-911"><a href="#cb22-911" aria-hidden="true" tabindex="-1"></a>ry4 <span class="op">=</span> <span class="dv">1</span>  <span class="co">#On a bien rx4 &lt; ry4 </span></span>
<span id="cb22-912"><a href="#cb22-912" aria-hidden="true" tabindex="-1"></a>Kx4 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb22-913"><a href="#cb22-913" aria-hidden="true" tabindex="-1"></a>Ky4 <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb22-914"><a href="#cb22-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-915"><a href="#cb22-915" aria-hidden="true" tabindex="-1"></a><span class="co">#On a la deuxième condition de Kxry &gt; Kyrx</span></span>
<span id="cb22-916"><a href="#cb22-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-917"><a href="#cb22-917" aria-hidden="true" tabindex="-1"></a>param4 <span class="op">=</span> np.array([rx4, ry4, Kx4, Ky4])</span>
<span id="cb22-918"><a href="#cb22-918" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-919"><a href="#cb22-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-920"><a href="#cb22-920" aria-hidden="true" tabindex="-1"></a>Et on simule à nouveau :</span>
<span id="cb22-921"><a href="#cb22-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-924"><a href="#cb22-924" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-925"><a href="#cb22-925" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb22-926"><a href="#cb22-926" aria-hidden="true" tabindex="-1"></a><span class="co">## On crée la figure et l'axe:</span></span>
<span id="cb22-927"><a href="#cb22-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-928"><a href="#cb22-928" aria-hidden="true" tabindex="-1"></a>fig5, (ax5, ax6) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb22-929"><a href="#cb22-929" aria-hidden="true" tabindex="-1"></a>ax5.set_title(<span class="st">"Somme des équilibre en fonction de β quand $r_x &lt; r_y$ et $K_y &gt; K_x$ et $K_xr_y &gt; K_yr_x$"</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb22-930"><a href="#cb22-930" aria-hidden="true" tabindex="-1"></a>ax6.set_title(<span class="st">"Somme des équilibre en fonction de β quand $r_x &lt; r_y$ et $K_xr_y &lt; K_yr_x$"</span>, fontsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb22-931"><a href="#cb22-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-932"><a href="#cb22-932" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.4</span>) <span class="co">#On ajuste l'écart entre figures</span></span>
<span id="cb22-933"><a href="#cb22-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-934"><a href="#cb22-934" aria-hidden="true" tabindex="-1"></a><span class="co">## Boucle ou i prend les valeurs de beta:</span></span>
<span id="cb22-935"><a href="#cb22-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-936"><a href="#cb22-936" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb22-937"><a href="#cb22-937" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param3, i)) <span class="co">#On calcule pour chaque beta l'équilibre</span></span>
<span id="cb22-938"><a href="#cb22-938" aria-hidden="true" tabindex="-1"></a>    ax5.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>) <span class="co">#On plot un point qui correspond à la valeur de la somme des éq. en fonction de beta</span></span>
<span id="cb22-939"><a href="#cb22-939" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param4, i))</span>
<span id="cb22-940"><a href="#cb22-940" aria-hidden="true" tabindex="-1"></a>    ax6.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb22-941"><a href="#cb22-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-942"><a href="#cb22-942" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot de la droite Kx+Ky:</span></span>
<span id="cb22-943"><a href="#cb22-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-944"><a href="#cb22-944" aria-hidden="true" tabindex="-1"></a>xt<span class="op">=</span>np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-945"><a href="#cb22-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-946"><a href="#cb22-946" aria-hidden="true" tabindex="-1"></a>ax5.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb22-947"><a href="#cb22-947" aria-hidden="true" tabindex="-1"></a>ax5.text(<span class="fl">3.2</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb22-948"><a href="#cb22-948" aria-hidden="true" tabindex="-1"></a>ax6.plot(xt, (Kx4 <span class="op">+</span> Ky4) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb22-949"><a href="#cb22-949" aria-hidden="true" tabindex="-1"></a>ax6.text(<span class="fl">3.2</span>, Kx4 <span class="op">+</span> Ky4 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb22-950"><a href="#cb22-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-951"><a href="#cb22-951" aria-hidden="true" tabindex="-1"></a><span class="co">## Légendes:</span></span>
<span id="cb22-952"><a href="#cb22-952" aria-hidden="true" tabindex="-1"></a>ax5.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb22-953"><a href="#cb22-953" aria-hidden="true" tabindex="-1"></a>ax5.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb22-954"><a href="#cb22-954" aria-hidden="true" tabindex="-1"></a>ax5.plot(Kx3 <span class="op">+</span> Ky3, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>) <span class="co">#Si on avait mis label dans la boucle la légende aurait été trop grande</span></span>
<span id="cb22-955"><a href="#cb22-955" aria-hidden="true" tabindex="-1"></a>ax6.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb22-956"><a href="#cb22-956" aria-hidden="true" tabindex="-1"></a>ax6.plot(Kx4 <span class="op">+</span> Ky4, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>)</span>
<span id="cb22-957"><a href="#cb22-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-958"><a href="#cb22-958" aria-hidden="true" tabindex="-1"></a><span class="co">## On adapte la fenêtre:</span></span>
<span id="cb22-959"><a href="#cb22-959" aria-hidden="true" tabindex="-1"></a>ax5.set_ylim(<span class="fl">2.9</span>, <span class="fl">3.2</span>)</span>
<span id="cb22-960"><a href="#cb22-960" aria-hidden="true" tabindex="-1"></a>ax6.set_ylim(<span class="fl">2.9</span>, <span class="fl">3.1</span>)</span>
<span id="cb22-961"><a href="#cb22-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-962"><a href="#cb22-962" aria-hidden="true" tabindex="-1"></a>ax5.legend()<span class="op">;</span></span>
<span id="cb22-963"><a href="#cb22-963" aria-hidden="true" tabindex="-1"></a>ax6.legend()<span class="op">;</span></span>
<span id="cb22-964"><a href="#cb22-964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-965"><a href="#cb22-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-966"><a href="#cb22-966" aria-hidden="true" tabindex="-1"></a>On observe qu'on a bien dans la partie gauche tout le temps inflation et dans la partie droite d'abord inflation puis déflation.</span>
<span id="cb22-967"><a href="#cb22-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-968"><a href="#cb22-968" aria-hidden="true" tabindex="-1"></a><span class="fu">## Animation </span></span>
<span id="cb22-969"><a href="#cb22-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-970"><a href="#cb22-970" aria-hidden="true" tabindex="-1"></a>Pour mieux comprendre comment se déplace le système en fonction des paramètres :</span>
<span id="cb22-971"><a href="#cb22-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-974"><a href="#cb22-974" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-975"><a href="#cb22-975" aria-hidden="true" tabindex="-1"></a><span class="co">#Technique pour utiliser une fenêtre geogebra:</span></span>
<span id="cb22-976"><a href="#cb22-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-977"><a href="#cb22-977" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> IPython.display <span class="im">as</span> display</span>
<span id="cb22-978"><a href="#cb22-978" aria-hidden="true" tabindex="-1"></a>fig01 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb22-979"><a href="#cb22-979" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;iframe width = "700" height = "550" src = "https://www.geogebra.org/classic/ajaycvqe" style = "overflow: hidden border: 1px solid black" scroll="no"&gt;&lt;/iframe&gt;</span></span>
<span id="cb22-980"><a href="#cb22-980" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb22-981"><a href="#cb22-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-982"><a href="#cb22-982" aria-hidden="true" tabindex="-1"></a>display.HTML(fig01)</span>
<span id="cb22-983"><a href="#cb22-983" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>   </span>
<span id="cb22-984"><a href="#cb22-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-985"><a href="#cb22-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-986"><a href="#cb22-986" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inflation et déflation du système en fonction de la migration</span></span>
<span id="cb22-987"><a href="#cb22-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-988"><a href="#cb22-988" aria-hidden="true" tabindex="-1"></a>Dans cette partie on va s'intéresser aux sommes des équilibres en fonction de $\beta$.  </span>
<span id="cb22-989"><a href="#cb22-989" aria-hidden="true" tabindex="-1"></a>On a déja plus ou moins tracé les différents profils de courbe qu'on peut obtenir pour cette partie (quand on a vérifié les propositions de conditions d'inflation/déflation) mais il existe un quatrième profil de courbe.  </span>
<span id="cb22-990"><a href="#cb22-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-991"><a href="#cb22-991" aria-hidden="true" tabindex="-1"></a>On va utiliser les mêmes méthodes que précédemment :</span>
<span id="cb22-992"><a href="#cb22-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-993"><a href="#cb22-993" aria-hidden="true" tabindex="-1"></a><span class="in">```&nbsp;{python}</span></span>
<span id="cb22-994"><a href="#cb22-994" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb22-995"><a href="#cb22-995" aria-hidden="true" tabindex="-1"></a><span class="co">#On redéinit la même fonction:</span></span>
<span id="cb22-996"><a href="#cb22-996" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aug2(etat, t, param, h):</span>
<span id="cb22-997"><a href="#cb22-997" aria-hidden="true" tabindex="-1"></a>    rx, ry, Kx, Ky <span class="op">=</span> param</span>
<span id="cb22-998"><a href="#cb22-998" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> h</span>
<span id="cb22-999"><a href="#cb22-999" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> etat</span>
<span id="cb22-1000"><a href="#cb22-1000" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> [rx <span class="op">*</span> x <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x<span class="op">/</span>Kx) <span class="op">+</span> b <span class="op">*</span> (y <span class="op">-</span> x), </span>
<span id="cb22-1001"><a href="#cb22-1001" aria-hidden="true" tabindex="-1"></a>    ry <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y<span class="op">/</span>Ky) <span class="op">+</span> b <span class="op">*</span> (x <span class="op">-</span> y)]</span>
<span id="cb22-1002"><a href="#cb22-1002" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s </span>
<span id="cb22-1003"><a href="#cb22-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1004"><a href="#cb22-1004" aria-hidden="true" tabindex="-1"></a><span class="co">## Temps d'intégration :</span></span>
<span id="cb22-1005"><a href="#cb22-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1006"><a href="#cb22-1006" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">400</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-1007"><a href="#cb22-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1008"><a href="#cb22-1008" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres : </span></span>
<span id="cb22-1009"><a href="#cb22-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#Paramètres de la condition b):</span></span>
<span id="cb22-1010"><a href="#cb22-1010" aria-hidden="true" tabindex="-1"></a>rx1 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb22-1011"><a href="#cb22-1011" aria-hidden="true" tabindex="-1"></a>ry1 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb22-1012"><a href="#cb22-1012" aria-hidden="true" tabindex="-1"></a>Kx1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb22-1013"><a href="#cb22-1013" aria-hidden="true" tabindex="-1"></a>Ky1 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb22-1014"><a href="#cb22-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1015"><a href="#cb22-1015" aria-hidden="true" tabindex="-1"></a>param1 <span class="op">=</span> np.array([rx1, ry1, Kx1, Ky1])</span>
<span id="cb22-1016"><a href="#cb22-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1017"><a href="#cb22-1017" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres condition c.1): </span></span>
<span id="cb22-1018"><a href="#cb22-1018" aria-hidden="true" tabindex="-1"></a>rx2 <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb22-1019"><a href="#cb22-1019" aria-hidden="true" tabindex="-1"></a>ry2 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb22-1020"><a href="#cb22-1020" aria-hidden="true" tabindex="-1"></a>Kx2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-1021"><a href="#cb22-1021" aria-hidden="true" tabindex="-1"></a>Ky2 <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb22-1022"><a href="#cb22-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1023"><a href="#cb22-1023" aria-hidden="true" tabindex="-1"></a>param2 <span class="op">=</span> np.array([rx2, ry2, Kx2, Ky2])</span>
<span id="cb22-1024"><a href="#cb22-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1025"><a href="#cb22-1025" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres condition c.2): </span></span>
<span id="cb22-1026"><a href="#cb22-1026" aria-hidden="true" tabindex="-1"></a>rx3 <span class="op">=</span> <span class="fl">0.6</span></span>
<span id="cb22-1027"><a href="#cb22-1027" aria-hidden="true" tabindex="-1"></a>ry3 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb22-1028"><a href="#cb22-1028" aria-hidden="true" tabindex="-1"></a>Kx3 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb22-1029"><a href="#cb22-1029" aria-hidden="true" tabindex="-1"></a>Ky3 <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb22-1030"><a href="#cb22-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1031"><a href="#cb22-1031" aria-hidden="true" tabindex="-1"></a>param3 <span class="op">=</span> np.array([rx3, ry3, Kx3, Ky3])</span>
<span id="cb22-1032"><a href="#cb22-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1033"><a href="#cb22-1033" aria-hidden="true" tabindex="-1"></a><span class="co">## Paramètres nouveau profil: </span></span>
<span id="cb22-1034"><a href="#cb22-1034" aria-hidden="true" tabindex="-1"></a>rx4 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb22-1035"><a href="#cb22-1035" aria-hidden="true" tabindex="-1"></a>ry4 <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb22-1036"><a href="#cb22-1036" aria-hidden="true" tabindex="-1"></a>Kx4 <span class="op">=</span> <span class="fl">0.5</span>  </span>
<span id="cb22-1037"><a href="#cb22-1037" aria-hidden="true" tabindex="-1"></a>Ky4 <span class="op">=</span> <span class="dv">1</span>  </span>
<span id="cb22-1038"><a href="#cb22-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1039"><a href="#cb22-1039" aria-hidden="true" tabindex="-1"></a>param4 <span class="op">=</span> np.array([rx4, ry4, Kx4, Ky4])</span>
<span id="cb22-1040"><a href="#cb22-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1041"><a href="#cb22-1041" aria-hidden="true" tabindex="-1"></a><span class="co">## Condition initiale:</span></span>
<span id="cb22-1042"><a href="#cb22-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1043"><a href="#cb22-1043" aria-hidden="true" tabindex="-1"></a>c10 <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">0</span>]</span>
<span id="cb22-1044"><a href="#cb22-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1045"><a href="#cb22-1045" aria-hidden="true" tabindex="-1"></a><span class="co">## On crée la figure et l'axe:</span></span>
<span id="cb22-1046"><a href="#cb22-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1047"><a href="#cb22-1047" aria-hidden="true" tabindex="-1"></a>fig6, (ax7, ax8, ax9, ax10) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">5</span>))</span>
<span id="cb22-1048"><a href="#cb22-1048" aria-hidden="true" tabindex="-1"></a>ax7.set_title(<span class="st">"Déflation"</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb22-1049"><a href="#cb22-1049" aria-hidden="true" tabindex="-1"></a>ax8.set_title(<span class="st">"Inflation"</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb22-1050"><a href="#cb22-1050" aria-hidden="true" tabindex="-1"></a>ax9.set_title(<span class="st">"Les deux"</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb22-1051"><a href="#cb22-1051" aria-hidden="true" tabindex="-1"></a>ax10.set_title(<span class="st">"Inflation"</span>, fontsize <span class="op">=</span> <span class="dv">8</span>)</span>
<span id="cb22-1052"><a href="#cb22-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1053"><a href="#cb22-1053" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace <span class="op">=</span> <span class="fl">0.45</span>) <span class="co">#On ajuste l'écart entre figures</span></span>
<span id="cb22-1054"><a href="#cb22-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1055"><a href="#cb22-1055" aria-hidden="true" tabindex="-1"></a><span class="co">## Boucle ou i prend les valeurs de beta:</span></span>
<span id="cb22-1056"><a href="#cb22-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1057"><a href="#cb22-1057" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>):</span>
<span id="cb22-1058"><a href="#cb22-1058" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param1, i)) </span>
<span id="cb22-1059"><a href="#cb22-1059" aria-hidden="true" tabindex="-1"></a>    ax7.plot(i, s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s1[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb22-1060"><a href="#cb22-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1061"><a href="#cb22-1061" aria-hidden="true" tabindex="-1"></a>    s2 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param2, i))</span>
<span id="cb22-1062"><a href="#cb22-1062" aria-hidden="true" tabindex="-1"></a>    ax8.plot(i, s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb22-1063"><a href="#cb22-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1064"><a href="#cb22-1064" aria-hidden="true" tabindex="-1"></a>    s3 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param3, i))</span>
<span id="cb22-1065"><a href="#cb22-1065" aria-hidden="true" tabindex="-1"></a>    ax9.plot(i, s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s3[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb22-1066"><a href="#cb22-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1067"><a href="#cb22-1067" aria-hidden="true" tabindex="-1"></a>    s4 <span class="op">=</span> odeint(aug2, c10, t1, args <span class="op">=</span> (param4, i))</span>
<span id="cb22-1068"><a href="#cb22-1068" aria-hidden="true" tabindex="-1"></a>    ax10.plot(i, s4[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> s4[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>], marker <span class="op">=</span> <span class="st">'.'</span>, color <span class="op">=</span> <span class="st">'C0'</span>)</span>
<span id="cb22-1069"><a href="#cb22-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1070"><a href="#cb22-1070" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot de la droite Kx+Ky:</span></span>
<span id="cb22-1071"><a href="#cb22-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1072"><a href="#cb22-1072" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-1073"><a href="#cb22-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1074"><a href="#cb22-1074" aria-hidden="true" tabindex="-1"></a>ax7.plot(xt, (Kx1 <span class="op">+</span> Ky1) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>,markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb22-1075"><a href="#cb22-1075" aria-hidden="true" tabindex="-1"></a>ax7.text(<span class="fl">2.5</span>, Kx1 <span class="op">+</span> Ky1 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb22-1076"><a href="#cb22-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1077"><a href="#cb22-1077" aria-hidden="true" tabindex="-1"></a>ax8.plot(xt, (Kx2 <span class="op">+</span> Ky2) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb22-1078"><a href="#cb22-1078" aria-hidden="true" tabindex="-1"></a>ax8.text(<span class="fl">2.5</span>, Kx2 <span class="op">+</span> Ky2 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb22-1079"><a href="#cb22-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1080"><a href="#cb22-1080" aria-hidden="true" tabindex="-1"></a>ax9.plot(xt, (Kx3 <span class="op">+</span> Ky3) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb22-1081"><a href="#cb22-1081" aria-hidden="true" tabindex="-1"></a>ax9.text(<span class="fl">2.5</span>, Kx3 <span class="op">+</span> Ky3 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb22-1082"><a href="#cb22-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1083"><a href="#cb22-1083" aria-hidden="true" tabindex="-1"></a>ax10.plot(xt, (Kx4 <span class="op">+</span> Ky4) <span class="op">*</span> np.ones_like(xt), linestyle <span class="op">=</span> <span class="st">'dashed'</span>, color <span class="op">=</span> <span class="st">'k'</span>, markersize <span class="op">=</span> <span class="st">'6'</span>)</span>
<span id="cb22-1084"><a href="#cb22-1084" aria-hidden="true" tabindex="-1"></a>ax10.text(<span class="fl">2.5</span>, Kx4 <span class="op">+</span> Ky4 <span class="op">+</span> <span class="fl">0.01</span>, <span class="st">'$K_x+K_y$'</span>)</span>
<span id="cb22-1085"><a href="#cb22-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1086"><a href="#cb22-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1087"><a href="#cb22-1087" aria-hidden="true" tabindex="-1"></a><span class="co">## Légendes:</span></span>
<span id="cb22-1088"><a href="#cb22-1088" aria-hidden="true" tabindex="-1"></a>ax7.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb22-1089"><a href="#cb22-1089" aria-hidden="true" tabindex="-1"></a>ax7.set_ylabel(<span class="st">'Population'</span>)</span>
<span id="cb22-1090"><a href="#cb22-1090" aria-hidden="true" tabindex="-1"></a>ax7.plot(Kx1 <span class="op">+</span> Ky1, <span class="dv">0</span>, color <span class="op">=</span> <span class="st">'C0'</span>, label <span class="op">=</span> <span class="st">'Somme des équilibres'</span>) <span class="co">#Si on avait mis label dans la boucle la légende aurait été trop grande</span></span>
<span id="cb22-1091"><a href="#cb22-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1092"><a href="#cb22-1092" aria-hidden="true" tabindex="-1"></a>ax8.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb22-1093"><a href="#cb22-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1094"><a href="#cb22-1094" aria-hidden="true" tabindex="-1"></a>ax9.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb22-1095"><a href="#cb22-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1096"><a href="#cb22-1096" aria-hidden="true" tabindex="-1"></a>ax10.set_xlabel(<span class="st">'β'</span>)</span>
<span id="cb22-1097"><a href="#cb22-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1098"><a href="#cb22-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1099"><a href="#cb22-1099" aria-hidden="true" tabindex="-1"></a><span class="co">## On adapte la fenêtre:</span></span>
<span id="cb22-1100"><a href="#cb22-1100" aria-hidden="true" tabindex="-1"></a>ax7.set_ylim(<span class="fl">2.4</span>, <span class="fl">3.1</span>)</span>
<span id="cb22-1101"><a href="#cb22-1101" aria-hidden="true" tabindex="-1"></a>ax8.set_ylim(<span class="fl">2.95</span>, <span class="fl">3.15</span>)</span>
<span id="cb22-1102"><a href="#cb22-1102" aria-hidden="true" tabindex="-1"></a>ax9.set_ylim(<span class="fl">2.9</span>, <span class="fl">3.1</span>)</span>
<span id="cb22-1103"><a href="#cb22-1103" aria-hidden="true" tabindex="-1"></a>ax10.set_ylim(<span class="fl">1.25</span>, <span class="fl">1.75</span>)</span>
<span id="cb22-1104"><a href="#cb22-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1105"><a href="#cb22-1105" aria-hidden="true" tabindex="-1"></a><span class="co">#On déplace la légende hors de la figure:</span></span>
<span id="cb22-1106"><a href="#cb22-1106" aria-hidden="true" tabindex="-1"></a>ax7.legend(bbox_to_anchor <span class="op">=</span> (<span class="fl">1.75</span>, <span class="op">-</span><span class="fl">0.65</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))<span class="op">;</span></span>
<span id="cb22-1107"><a href="#cb22-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1108"><a href="#cb22-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1109"><a href="#cb22-1109" aria-hidden="true" tabindex="-1"></a>On observe quatre profils différents. Les trois premiers ont déjà été obtenus précédemment.   </span>
<span id="cb22-1110"><a href="#cb22-1110" aria-hidden="true" tabindex="-1"></a>Le quatrième correspond à un système inflationiste où le maximum d'inflation est atteint pour $\beta = +\infty$ contrairement à l'autre profil d'inflation.</span>
<span id="cb22-1111"><a href="#cb22-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1112"><a href="#cb22-1112" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span>     </span>
<span id="cb22-1113"><a href="#cb22-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1114"><a href="#cb22-1114" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Passons</span><span class="co">](modeleavecmigrationass.qmd)</span> mainenant à un modèle qui prend en compte que les migrations peuvent êtres assymétriques.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Pour plus d’informations, voyez <a href="./about.html">ici</a>.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>